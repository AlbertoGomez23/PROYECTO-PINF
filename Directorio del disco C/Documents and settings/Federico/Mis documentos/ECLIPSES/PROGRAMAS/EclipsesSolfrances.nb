(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.0'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[    147008,       3149]*)
(*NotebookOutlinePosition[    147655,       3171]*)
(*  CellTagsIndexPosition[    147611,       3167]*)
(*WindowFrame->Normal*)



Notebook[{
Cell[BoxData[
    \(\ \)], "Input"],

Cell[CellGroupData[{

Cell["Funciones auxiliares.", "Subsection"],

Cell[CellGroupData[{

Cell["Formatos de horas, grados y radianes", "Subsubsection"],

Cell[BoxData[
    \(hms2h[hora_] := 
      N[First[hora] + Part[hora, 2]/60 + Last[hora]/3600]\)], "Input"],

Cell[BoxData[
    \(h2hms[hora_] := 
      Module[{h, m, s}, h = IntegerPart[hora]; \n
        m = IntegerPart[\((hora - h)\)*60]; 
        s = \((hora - h - m/60)\)*3600; {h, m, s}]\)], "Input"],

Cell[BoxData[
    \(gms2rad[ang_] := 
      N[First[ang] + Part[ang, 2]/60 + Last[ang]/3600]*Degree\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(rad2gms[ang_] := 
      Module[{grad, min, sec}, grad = IntegerPart[ang/Degree]; 
        min = IntegerPart[\((\((ang/Degree)\) - \ grad)\)*60]; 
        sec = \((\((ang/Degree)\) - grad - min/60)\)*3600; {grad, min, 
          sec}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(min\\)\\\" is similar to existing symbol \
\\\"\\!\\(Min\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(sec\\)\\\" is similar to existing symbol \
\\\"\\!\\(Sec\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(grad2gm[ang_] := 
      Module[{grad, min}, grad = IntegerPart[ang]; 
        min = \((ang - \ grad)\)*60; {grad, min}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(hms2rad[ang_] := 
      N[First[ang]*15 + Part[ang, 2]*15/60 + Last[ang]*15/3600]*
        Degree\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(hms2rad\\)\\\" is similar to existing symbol \
\\\"\\!\\(gms2rad\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(rad2hms[ang_] := 
      Module[{hor, min, sec}, hor = IntegerPart[\(ang/Degree\)/15]; 
        min = IntegerPart[\((\((\(ang/Degree\)/15)\) - \ hor)\)*60]; 
        sec = \((\((\(ang/Degree\)/15)\) - hor - min/60)\)*3600; {hor, min, 
          sec}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(rad2hms\\)\\\" is similar to existing symbol \
\\\"\\!\\(rad2gms\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(hms2gms[ang_] := rad2gms[hms2rad[ang]]\)], "Input"],

Cell[BoxData[
    \(gms2hms[ang_] := rad2hms[gms2rad[ang]]\)], "Input"],

Cell[BoxData[
    \(gm2grad[ang_] := N[First[ang] + 1/60\ Last[ang]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(h2ms[hora_] := 
      Module[{m, s}, m = IntegerPart[hora*60]; 
        s = \((hora - m/60)\)*3600; {m, s}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(h2ms\\)\\\" is similar to existing symbol \\\
\"\\!\\(h2hms\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fechas y tiempos", "Subsubsection"],

Cell[BoxData[
    \(diajuliano[dia_, mes_, a\[NTilde]o_] := 
      367*a\[NTilde]o - 
        IntegerPart[
          7*\((a\[NTilde]o + IntegerPart[\((mes + 9)\)\/12])\)\/4] + 
        IntegerPart[\(275*mes\)\/9] + dia + 1721013.5\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(tsidmedloc[dia_, mes_, a\[NTilde]o_, ut_, long_] := 
      Module[{t, ts, tsh, tslh, tshms}, 
        t = \((diajuliano[dia, mes, a\[NTilde]o] - 2451545)\)\/36525; 
        ts = 24110.54841 + 8640184.812866*t + 0.093104*t\^2 - 0.0000062*t\^3; 
        tsh = ts + 1.00273790935*3600*hms2h[ut]; 
        tslh = tsh + 3600*hms2h[gms2hms[long]]; 
        tshms = h2hms[Mod[tslh\/3600, 24]]; tshms]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(tslh\\)\\\" is similar to existing symbol \\\
\"\\!\\(tsh\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\
\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Transformaci\[OAcute]n coordenadas", "Subsubsection"],

Cell[BoxData[
    \(ecu2cart[{\[Alpha]rec_, dec_, dis_}] := 
      Module[{x, y, z}, x = dis*Cos[\[Alpha]rec\ Degree]*Cos[dec\ Degree]; 
        y = dis*Sin[\[Alpha]rec\ Degree]*Cos[dec\ Degree]; 
        z = dis*Sin[dec\ Degree]; {x, y, z}]\)], "Input"],

Cell[BoxData[
    \(cart2ecu[{x_, y_, z_}] := 
      Module[{\[Alpha]rec, dec, dis}, dis = \@\(x\^2 + y\^2 + z\^2\); 
        dec = N[ArcSin[z\/dis]]; \[Alpha]rec = 
          N[ArcTan[x, y]]; {\[Alpha]rec/Degree, dec/Degree, dis}]\)], "Input"],

Cell[BoxData[{
    RowBox[{\(Rx[ang_]\), ":=", 
      RowBox[{"(", GridBox[{
            {"1", "0", "0"},
            {"0", \(Cos[ang\ Degree]\), \(Sin[ang\ Degree]\)},
            {"0", \(-Sin[ang\ Degree]\), \(Cos[ang\ Degree]\)}
            }], ")"}]}], "\n", 
    RowBox[{\(Ry[ang_]\), ":=", 
      RowBox[{"(", GridBox[{
            {\(Cos[ang\ Degree]\), "0", \(-Sin[ang\ Degree]\)},
            {"0", "1", "0"},
            {\(Sin[ang\ Degree]\), "0", \(Cos[ang\ Degree]\)}
            }], ")"}]}], "\n", 
    RowBox[{\(Rz[ang_]\), ":=", 
      RowBox[{"(", GridBox[{
            {\(Cos[ang\ Degree]\), \(Sin[ang\ Degree]\), "0"},
            {\(-Sin[ang\ Degree]\), \(Cos[ang\ Degree]\), "0"},
            {"0", "0", "1"}
            }], ")"}]}]}], "Input"],

Cell[BoxData[
    \(Matcambcoor[d_, \[Mu]_] := Rz[\[Mu] - 90] . Rx[d - 90]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(matcambcoor[t_] := Matcambcoor[peled[t], pele\[Mu][t]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(matcambcoor\\)\\\" is similar to existing \
symbol \\\"\\!\\(Matcambcoor\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(cambcoorcart[{x_, y_, z_, t_}] := matcambcoor[t] . {x, y, z}\)], "Input"],

Cell[BoxData[
    \(geodes2geocen[{\[Phi]_, h_}] := 
      Module[{a, f, C, S, x, z}, a = 6378.1366; f = \((0.0033472)\); 
        C = 1\/\@\(1 - \((2  f - f\^2)\)*Sin[\[Phi]\ Degree]\^2\); 
        S = \((1 - f)\)\^2*C; x = a*\((C + h\/a)\)*Cos[\[Phi]\ Degree]; 
        z = a*\((S + h\/a)\)*
            Sin[\[Phi]\ Degree]; {ArcTan[x, z]\/Degree, \@\(x\^2 + \
z\^2\)}]\)], "Input"],

Cell[BoxData[
    \(latgeocen2latgeode[\[Phi]_] := 
      ArcTan[Cos[\[Phi]\ Degree], Sin[\[Phi]\ Degree]\/\((1 - \
1\/298.257)\)\^2]\/Degree\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(\(ecu2ecli[{t_, \[Alpha]rec_, dec_, dist_}] := 
      Module[{\[Lambda]cel, \[Beta]cel, \[Epsilon] = 23.4393}, \[Beta]cel = 
          N[ArcSin[\(-Sin[\[Epsilon]\ Degree]\)*Cos[dec\ Degree]*
                  Sin[15\ \[Alpha]rec\ Degree] + 
                Cos[\[Epsilon]\ Degree]*Sin[dec\ Degree]]]; \[Lambda]cel = 
          N[ArcTan[Cos\ [dec\ Degree]*Cos[15\ \[Alpha]rec\ Degree], 
              Cos[\[Epsilon]\ Degree]*Cos[dec\ Degree]*
                  Sin[15\ \[Alpha]rec\ Degree] + 
                Sin[\[Epsilon]\ Degree]*Sin[dec\ Degree]]]; {t, \[Lambda]cel/
            Degree, \[Beta]cel/Degree, dist}]\)\(\[IndentingNewLine]\)
    \)\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(\[Beta]cel\\)\\\" is similar to existing \
symbol \\\"\\!\\(\[Lambda]cel\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[BoxData[
    \(ecli2ecu[{t_, \[Lambda]cel_, \[Beta]cel_, dist_}] := 
      Module[{\[Alpha]rec, dec, \[Epsilon] = 23.4393}, 
        dec = N[ArcSin[
              Sin[\[Epsilon]\ Degree]*Cos[\[Beta]cel\ Degree]*
                  Sin[\[Lambda]cel\ Degree] + 
                Cos[\[Epsilon]\ Degree]*
                  Sin[\[Beta]cel\ Degree]]]; \[Alpha]rec = 
          N[ArcTan[Cos[\[Beta]cel\ Degree]*Cos[\[Lambda]cel\ Degree], 
              Cos[\[Epsilon]\ Degree]*Cos[\[Beta]cel\ Degree]*
                  Sin[\[Lambda]cel\ Degree] - 
                Sin[\[Epsilon]\ Degree]*Sin[\[Beta]cel\ Degree]]]; {t, 
          Mod[\[Alpha]rec/Degree, 360], dec/Degree, dist/ua}]\)], "Input"],

Cell[BoxData[
    \(correcluna[{t_, \[Alpha]rec_, dec_, dist_}] := 
      Module[{\[Lambda]\[Beta], \[Lambda]\[Beta]cor}, \[Lambda]\[Beta] = 
          ecu2ecli[{t, \[Alpha]rec, dec, 
              dist}]; \[Lambda]\[Beta]cor = \[Lambda]\[Beta] + {0, 
              0.5/3600, \(-0.25\)/3600, 0}; 
        ecli2ecu[\[Lambda]\[Beta]cor]]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Transformaci\[OAcute]n coordenadas del plano fundamental", \
"Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\[Xi]\[Eta]fun[t_] := 
      Module[{utfun, relit}, 
        utfun = u /. 
            FindRoot[
              peley[t] - preliphor[t]*Sin[u] - 
                  1/preliphor[t]*Tan[u]*\((pelex[t] - Cos[u])\) \[Equal] 
                0, {u, ArcTan[pelex[t], peley[t]]}]; 
        relit = preliphor[t]; {Cos[utfun], relit*Sin[utfun]}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(peley\\)\\\" is similar to existing symbol \
\\\"\\!\\(peled\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pelex\\)\\\" is similar to existing symbols \
\\!\\({peled, peley}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \( (*\[Xi]\[Eta]par2xyz[t_] := 
        cambcoorcart[{\(\[Xi]\[Eta]fun[t]\)[\([1]\)] 
              Cos[ArcTan[peleip[t]]], \(\[Xi]\[Eta]fun[t]\)[\([2]\)] 
              Cos[ArcTan[peleip[t]]], \(-Sin[ArcTan[peleip[t]]]\), 
            t}]*) \)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]par2xyz[t_] := \[Xi]\[Eta]fun2xyz[t]\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]fun2xyz[t_] := 
      cambcoorcart[{\(\[Xi]\[Eta]fun[t]\)[\([1]\)], \(\[Xi]\[Eta]fun[
              t]\)[\([2]\)], 0, t}]\)], "Input"],

Cell[BoxData[
    \( (*\[Xi]\[Eta]tot2xyz[t_] := 
        cambcoorcart[{\(\[Xi]\[Eta]fun[t]\)[\([1]\)] 
              Cos[ArcTan[peleis[t]]], \(\[Xi]\[Eta]fun[t]\)[\([2]\)] 
              Cos[ArcTan[peleis[t]]], \(-Sign[pelels[t]]\)*
              Sin[ArcTan[peleis[t]]], t}]*) \)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]tot2xyz[t_] := \[Xi]\[Eta]fun2xyz[t]\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]par2ecu[t_] := cart2ecu[\[Xi]\[Eta]par2xyz[t]]\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]fun2ecu[t_] := cart2ecu[\[Xi]\[Eta]fun2xyz[t]]\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]tot2ecu[t_] := cart2ecu[\[Xi]\[Eta]tot2xyz[t]]\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]par2lonlat[
        t_] := {grad2gm[cormerefe[\(\[Xi]\[Eta]par2ecu[t]\)[\([1]\)]]], 
        grad2gm[latgeocen2latgeode[\(\[Xi]\[Eta]par2ecu[
                t]\)[\([2]\)]]]}\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]fun2lonlat[
        t_] := {grad2gm[cormerefe[\(\[Xi]\[Eta]fun2ecu[t]\)[\([1]\)]]], 
        grad2gm[latgeocen2latgeode[\(\[Xi]\[Eta]fun2ecu[
                t]\)[\([2]\)]]]}\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]tot2lonlat[
        t_] := {grad2gm[cormerefe[\(\[Xi]\[Eta]tot2ecu[t]\)[\([1]\)]]], 
        grad2gm[latgeocen2latgeode[\(\[Xi]\[Eta]tot2ecu[
                t]\)[\([2]\)]]]}\)], "Input"],

Cell[BoxData[
    \(cormerefe[lon_] := 
      lon + 1.00273790935*\[CapitalDelta]t*15\/3600\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Transformaci\[OAcute]n coordenadas del elipsoide al plano fundamental\
\>", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(coramerefe[lon_] := 
      lon - 1.00273790935*\[CapitalDelta]t*15\/3600\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(coramerefe\\)\\\" is similar to existing \
symbol \\\"\\!\\(cormerefe\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(lonlatt2xyz[lon_, lat_, t_] := 
      Module[{lonc, latc, r}, lonc = coramerefe[gm2grad[lon]]; 
        latc = First[geodes2geocen[{gm2grad[lat], 0}]]; 
        r = Last[geodes2geocen[{gm2grad[lat], 0}]]; \(1\/6378.1366\) 
          ecu2cart[{lonc, latc, r}]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(lonc\\)\\\" is similar to existing symbols \
\\!\\({lon, long}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(latc\\)\\\" is similar to existing symbol \\\
\"\\!\\(lat\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\
\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(lonlatt2\[Xi]\[Eta]\[Zeta][lon_, lat_, t_] := 
      Inverse[matcambcoor[t]] . lonlatt2xyz[lon, lat, t]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones geom\[EAcute]tricas del elipsoide", "Subsubsection"],

Cell[BoxData[
    \(radeliphor[d_] := 
      Module[{a, f, \[Phi], u, x, z, r}, a = 1; 
        f = 0.0033472; \[Phi] = \((90 - d)\) Degree; 
        u = ArcTan[\((1 - f)\) Cos[\[Phi]], Sin[\[Phi]]]; x = a*Cos[u]; 
        z = a*\((1 - f)\)*Sin[u]; r = \@\(x\^2 + z\^2\)]\)], "Input"],

Cell[BoxData[
    \(disEjeElip[{x_, y_, b_, u_}] := 
      Sign[Abs[y] - Abs[b\ Sin[u]]] 
        Sqrt[\((y - b\ Sin[u])\)^2 + \((x - Cos[u])\)^2]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones corte eje de sombra con el elipsoide y duraci\[OAcute]n totalidad \
en eje.\
\>", "Subsubsection"],

Cell[BoxData[
    \(corteejeelip2\[Xi]\[Eta]\[Zeta][{elex_, eley_, eled_, ele\[Mu]_}] := 
      Select[{x, y, z} /. 
          NSolve[{x == elex, 
              y \[Equal] 
                eley, \((\((Matcambcoor[eled, ele\[Mu]] . {x, y, \
z})\)[\([1]\)])\)\^2 + \((\((Matcambcoor[eled, ele\[Mu]] . {x, y, z})\)[\([2]\
\)])\)\^2 + \(1\/\((1 - 0.0033472)\)\^2\) \((\((Matcambcoor[eled, ele\[Mu]] . \
{x, y, z})\)[\([3]\)])\)\^2 \[Equal] 1}, {x, y, z}], 
        Positive[#[\([3]\)]] &]\)], "Input"],

Cell[BoxData[
    \(\(\(corteejeelip2xyz[{elex_, eley_, eled_, ele\[Mu]_}] := 
      Module[{corte = 
            corteejeelip2\[Xi]\[Eta]\[Zeta][{elex, eley, eled, 
                ele\[Mu]}]}, \[IndentingNewLine]If[
          corte \[Equal] {}, "\<Error\>", 
          Matcambcoor[eled, ele\[Mu]] . corte[\([1]\)]]]\)\(\n\)
    \)\)], "Input"],

Cell[BoxData[
    \(corteejeelip2lonlat[{elex_, eley_, eled_, ele\[Mu]_, t_}] := 
      Module[{corte = 
            corteejeelip2xyz[{elex, eley, eled, 
                ele\[Mu]}]}, \[IndentingNewLine]If[
          corte === "\<Error\>", "\<Error\>", {grad2gm[
              cormerefe[\(cart2ecu[corte]\)[\([1]\)]]], 
            grad2gm[latgeocen2latgeode[\(cart2ecu[corte]\)[\([2]\)]]], 
            t}]]\)], "Input"],

Cell[BoxData[
    \(corteejeelip[t_] := 
      corteejeelip2lonlat[{pelex[t], peley[t], peled[t], pele\[Mu][t], 
          t}]\)], "Input"],

Cell[BoxData[
    \(datoreal[d_] := Select[d, Head[#] \[Equal] List\  &]\)], "Input"],

Cell[BoxData[
    \(listat[t_] := t + Range[\(-1\)/6, 1/6, 1/60]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(deltamenosL[{lon_, lat_, t_}] := 
      Module[{delta, L}, 
        delta = Sqrt[\((pelex[t] - First[lonlatt2\[Xi]\[Eta]\[Zeta][lon, lat, \
t]])\)\^2 + \((peley[t] - Part[lonlatt2\[Xi]\[Eta]\[Zeta][lon, lat, t], 2])\)\
\^2]; L = 
          pelels[t] - 
            Last[lonlatt2\[Xi]\[Eta]\[Zeta][lon, lat, t]]*peleis[t]; 
        delta - Abs[L]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(peleis\\)\\\" is similar to existing symbol \
\\\"\\!\\(pelels\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(deltamenosLt[{lon_, lat_, t_}] := 
      Map[deltamenosL[{lon, lat, #}] &, listat[t]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(deltamenosLt\\)\\\" is similar to existing \
symbol \\\"\\!\\(deltamenosL\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(duraciontoteje[{lon_, lat_, t_}] := 
      Module[{pdeltamenosL, t1, t2}, 
        pdeltamenosL = 
          Interpolation[Transpose[{listat[t], deltamenosLt[{lon, lat, t}]}]]; 
        t1 = n /. FindRoot[pdeltamenosL[n] \[Equal] 0, {n, t - 9/60}]; 
        t2 = n /. FindRoot[pdeltamenosL[n] \[Equal] 0, {n, t + 9/60}]; 
        h2ms[\((t2 - t1)\)]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdeltamenosL\\)\\\" is similar to existing \
symbol \\\"\\!\\(deltamenosL\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(puntoejedur[{lon_, lat_, t_}] := {h2hms[
          t + \((First[fech] - IntegerPart[First[fech]] - 
                  0.5)\)*24 - \[CapitalDelta]t/3600], lon, lat, 
        duraciontoteje[{lon, lat, t}]}\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones corte cono de penumbra con plano fundamental (horizonte terrestre). \
\
\>", "Subsubsection"],

Cell[BoxData[
    \(cortehor[{reli_, elex_, eley_, elel_, eled_, ele\[Mu]_}] := 
      Select[{x, y} /. 
          NSolve[{y\^2\/reli\^2 + x\^2 \[Equal] 
                1, \((y - eley)\)\^2 + \((x - elex)\)\^2 \[Equal] 
                elel\^2}, {x, y}], 
        Head[#[\([1]\)]] \[Equal] Real \[And] 
            Head[#[\([2]\)]] \[Equal] Real &]\)], "Input"],

Cell[BoxData[
    \(\(\(cortehor2xyz[{reli_, elex_, eley_, elel_, eled_, ele\[Mu]_}] := 
      Module[{corte = 
            cortehor[{reli, elex, eley, elel, eled, 
                ele\[Mu]}]}, \[IndentingNewLine]If[
          corte \[Equal] {}, "\<Error\>", 
          Map[Matcambcoor[eled, ele\[Mu]] . {#[\([1]\)], #[\([2]\)], 0} &, 
            corte]]]\)\(\n\)
    \)\)], "Input"],

Cell[BoxData[
    \(\(\(cortehor2lonlat[{reli_, elex_, eley_, elel_, eled_, ele\[Mu]_}] := 
      Module[{corte = 
            cortehor2xyz[{reli, elex, eley, elel, eled, 
                ele\[Mu]}]}, \[IndentingNewLine]If[
          corte === "\<Error\>", "\<Error\>", 
          Map[{grad2gm[cormerefe[\(cart2ecu[#]\)[\([1]\)]]], 
                grad2gm[latgeocen2latgeode[\(cart2ecu[#]\)[\([2]\)]]]} &, 
            corte]]]\)\(\[IndentingNewLine]\)
    \)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(cortehor2lonlatt[
        t_] := {h2hms[
          t + \((First[fech] - IntegerPart[First[fech]] - 
                  0.5)\)*24 - \[CapitalDelta]t/3600], 
        cortehor2lonlat[{preliphor[t], pelex[t], peley[t], pelelp[t], 
            peled[t], pele\[Mu][t]}]}\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(cortehor2lonlatt\\)\\\" is similar to \
existing symbol \\\"\\!\\(cortehor2lonlat\\)\\\". \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pelelp\\)\\\" is similar to existing symbol \
\\\"\\!\\(pelels\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones corte cono de penumbra con el elipsoide. ", "Subsubsection"],

Cell[BoxData[
    \(\(lista\[Zeta] = 0.02*Range[1, 50];\)\)], "Input"],

Cell[BoxData[
    \(corteconopelip2\[Xi]\[Eta]\[Zeta][{elex_, eley_, eled_, ele\[Mu]_, 
          elelp_, eleip_}] := 
      Map[Select[\(({x, y, z} /. 
                NSolve[{z \[Equal] #, \((x - elex)\)\^2 + \((y - eley)\)\^2 \
\[Equal] \((elelp - #*eleip)\)\^2, \((\((Matcambcoor[eled, ele\[Mu]] . {x, y, \
z})\)[\([1]\)])\)\^2 + \((\((Matcambcoor[eled, ele\[Mu]] . {x, y, z})\)[\([2]\
\)])\)\^2 + \(1\/\((1 - 0.0033472)\)\^2\) \((\((Matcambcoor[eled, ele\[Mu]] . \
{x, y, z})\)[\([3]\)])\)\^2 \[Equal] 1}, {x, y, z}])\), 
            Function[v, Head[v[\([1]\)]] \[Equal] Real]] &, 
        lista\[Zeta]]\)], "Input"],

Cell[BoxData[
    \(\(\(corteconopelip2xyz[{elex_, eley_, eled_, ele\[Mu]_, elelp_, 
          eleip_}] := 
      Module[{corte = 
            corteconopelip2\[Xi]\[Eta]\[Zeta][{elex, eley, eled, ele\[Mu], 
                elelp, eleip}]}, \[IndentingNewLine]If[
          corte \[Equal] {}, "\<Error\>", 
          Map[Matcambcoor[eled, 
                  ele\[Mu]] . {#[\([1]\)], #[\([2]\)], #[\([3]\)]} &, 
            corte, {2}]]]\)\(\n\)
    \)\)], "Input"],

Cell[BoxData[
    \(\(\(corteconopelip2lonlat[{elex_, eley_, eled_, ele\[Mu]_, elelp_, 
          eleip_}] := 
      Module[{corte = 
            corteconopelip2xyz[{elex, eley, eled, ele\[Mu], elelp, 
                eleip}]}, \[IndentingNewLine]If[
          corte === "\<Error\>", "\<Error\>", 
          Map[{grad2gm[cormerefe[\(cart2ecu[#]\)[\([1]\)]]], 
                grad2gm[latgeocen2latgeode[\(cart2ecu[#]\)[\([2]\)]]]} &, 
            corte, {2}]]]\)\(\[IndentingNewLine]\)
    \)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(corteconopelip[t_] := 
      corteconopelip2lonlat[{pelex[t], peley[t], peled[t], pele\[Mu][t], 
          pelelp[t], peleip[t]}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(peleip\\)\\\" is similar to existing symbols \
\\!\\({eleip, peleis, pelelp}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones curvas l\[IAcute]mite Norte y Sur. ", "Subsubsection"],

Cell[BoxData[
    \(elxelylpipd\[Mu]2\[Zeta]Q[{elex_, delex_, eley_, deley_, elelp_, 
          delelp_, eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_}] := 
      Module[{\[Zeta], Q}, 
        Select[{\[Zeta], Q} /. 
            NSolve[{\[Zeta] == 
                  1/\((\((1 + 
                              eleip\^2)\)*\((\((dele\[Mu]\ Degree)\)*
                                Cos[eled\ Degree]*
                                Sin[Q] - \((deled\ Degree)\)*
                                Cos[Q])\))\) \((\(-delelp\) + \((deled\ \
Degree)\)*eley*eleip - \((dele\[Mu]\ Degree)\)*elex*Cos[eled\ Degree]*eleip + 
                        Cos[Q]*\((deley - \((dele\[Mu]\ Degree)\)*elex*
                                Sin[eled\ Degree] - \((deled\ Degree)\)*elelp*
                                eleip)\) + 
                        Sin[Q]*\((delex + \((dele\[Mu]\ Degree)\)*eley*
                                Sin[eled\ Degree] + 
                              elelp*\((dele\[Mu]\ Degree)\)*Cos[eled\ Degree]*
                                eleip)\))\), \((\((Matcambcoor[eled, \
ele\[Mu]] . {elex - \((elelp - \[Zeta]*eleip)\)*Sin[Q], eley - \((elelp - \
\[Zeta]*eleip)\)*Cos[Q], \[Zeta]})\)[\([1]\)])\)\^2 + \((\((Matcambcoor[eled, \
ele\[Mu]] . {elex - \((elelp - \[Zeta]*eleip)\)*Sin[Q], eley - \((elelp - \
\[Zeta]*eleip)\)*Cos[Q], \[Zeta]})\)[\([2]\)])\)\^2 + \(1\/\((1 - \
0.0033472)\)\^2\) \((\((Matcambcoor[eled, ele\[Mu]] . {elex - \((elelp - \
\[Zeta]*eleip)\)*Sin[Q], eley - \((elelp - \[Zeta]*eleip)\)*Cos[Q], \[Zeta]})\
\)[\([3]\)])\)\^2 \[Equal] 1}, {\[Zeta], Q}], 
          Positive[#[\([1]\)]] &]]\)], "Input"],

Cell[BoxData[
    \(elxelylpipd\[Mu]2xyz[{elex_, delex_, eley_, deley_, elelp_, delelp_, 
          eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_}] := 
      Module[{corte = 
            elxelylpipd\[Mu]2\[Zeta]Q[{elex, delex, eley, deley, elelp, 
                delelp, eleip, eled, deled, ele\[Mu], dele\[Mu]}]}, 
        Map[Matcambcoor[eled, 
                ele\[Mu]] . {elex - \((elelp - #[\([1]\)]*eleip)\)*
                    Sin[#[\([2]\)]], 
                eley - \((elelp - #[\([1]\)]*eleip)\)*
                    Cos[#[\([2]\)]], #[\([1]\)]} &, corte]]\)], "Input"],

Cell[BoxData[
    \(elxelylpipd\[Mu]2lonlat[{elex_, delex_, eley_, deley_, elelp_, delelp_, 
          eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_}] := 
      Module[{corte = 
            elxelylpipd\[Mu]2xyz[{elex, delex, eley, deley, elelp, delelp, 
                eleip, eled, deled, ele\[Mu], dele\[Mu]}]}, 
        Map[{grad2gm[cormerefe[\(cart2ecu[#]\)[\([1]\)]]], 
              grad2gm[latgeocen2latgeode[\(cart2ecu[#]\)[\([2]\)]]]} &, 
          corte]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(puntoslimitep[
        t_] := {h2hms[
          t + \((First[fech] - IntegerPart[First[fech]] - 
                  0.5)\)*24 - \[CapitalDelta]t/3600], 
        elxelylpipd\[Mu]2lonlat[{pelex[t], pdelex[t], peley[t], pdeley[t], 
            pelelp[t], pdelelp[t], peleip[t], peled[t], pdeled[t], 
            pele\[Mu][t], pdele\[Mu][t]}]}\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdelex\\)\\\" is similar to existing symbols \
\\!\\({delex, pelex}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdeley\\)\\\" is similar to existing symbols \
\\!\\({deley, pdelex, peley}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdelelp\\)\\\" is similar to existing \
symbols \\!\\({delelp, pelelp}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(General :: \\\"spell\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(puntoslimites[
        t_] := {h2hms[
          t + \((First[fech] - IntegerPart[First[fech]] - 
                  0.5)\)*24 - \[CapitalDelta]t/3600], 
        elxelylpipd\[Mu]2lonlat[{pelex[t], pdelex[t], peley[t], pdeley[t], 
            pelels[t], pdelels[t], peleis[t], peled[t], pdeled[t], 
            pele\[Mu][t], pdele\[Mu][t]}]}\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(puntoslimites\\)\\\" is similar to existing \
symbol \\\"\\!\\(puntoslimitep\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\
\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdelels\\)\\\" is similar to existing \
symbols \\!\\({pdelelp, pelels}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones curvas de m\[AAcute]ximo de eclipse al orto/ocaso. ", \
"Subsubsection"],

Cell[BoxData[
    \( (*maxhor2\[Xi]\[Eta]\[Zeta][{elex_, delex_, eley_, deley_, elelp_, 
            delelp_, eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_, 
            reliphor_}] := \(Select[{\[Xi], \[Eta], \[Zeta]} /. 
                NSolve[{\[Zeta] \[Equal] 
                      0, \[Xi]\^2 + \[Eta]\^2\/reliphor\^2 \[Equal] 
                      1, \((eley - \[Eta])\)\ \((\((deled\ Degree)\) \[Zeta] \
+ deley - \((dele\[Mu]\ Degree)\)\ \[Xi]\ Sin[
                                  eled\ Degree])\) + \ \((elex - \[Xi])\)\ \
\((delex - \((dele\[Mu]\ Degree)\)\ \((\[Zeta]\ Cos[
                                        eled\ Degree] - \[Eta]\ Sin[
                                        eled\ Degree])\))\) == \ \((elelp - \
\[Zeta]\ eleip)\)\ \((delelp - \((\((deled\ Degree)\)\ \[Eta] - \((dele\[Mu]\ \
Degree)\)\ \[Xi]\ Cos[eled\ Degree])\) eleip)\)}, {\[Xi], \[Eta], \[Zeta]}], 
              Head[#[\([1]\)]] \[Equal] 
                    Real \[And] \ \@\(\((elex - #[\([1]\)])\)\^2 + \((eley - \
#[\([2]\)])\)\^2\) \[LessEqual] 
                    elelp\  &]\ esta\ es\ con\ \[CapitalDelta]\^2 = 
          L\^2\)\ *) \)], "Input"],

Cell[BoxData[
    \(maxhor2\[Xi]\[Eta]\[Zeta][{elex_, delex_, eley_, deley_, elelp_, 
          delelp_, eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Select[{\[Xi], \[Eta], \[Zeta]} /. 
          NSolve[{\[Zeta] \[Equal] 
                0, \[Xi]\^2 + \[Eta]\^2\/reliphor\^2 \[Equal] 
                1, \(-delelp\) + \((2*\((elex - \[Xi])\) \((delex + \[Eta]\ \
\((dele\[Mu]\ Degree)\)\ Sin[eled\ Degree])\) + 
                        2 \((\(-\[Eta]\) + 
                              eley)\) \((deley - \((dele\[Mu]\ Degree)\)\ \
\[Xi]\ Sin[
                                  eled\ Degree])\))\)/\((2\ \@\(\((elex - \
\[Xi])\)\^2 + \((eley - \[Eta])\)\^2\))\) + \((\((deled\ Degree)\)\ \[Eta]\  \
- \((dele\[Mu]\ Degree)\)\ \[Xi]\ Cos[eled\ Degree])\) eleip \[Equal] 
                0}, {\[Xi], \[Eta], \[Zeta]}], 
        Head[#[\([1]\)]] \[Equal] 
              Real \[And] \ \@\(\((elex - #[\([1]\)])\)\^2 + \((eley - \
#[\([2]\)])\)\^2\) \[LessEqual] elelp\  &]\)], "Input"],

Cell[BoxData[
    \(maxhor2xyz[{elex_, delex_, eley_, deley_, elelp_, delelp_, eleip_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Map[Matcambcoor[eled, 
              ele\[Mu]] . {#[\([1]\)], #[\([2]\)], #[\([3]\)]} &, 
        maxhor2\[Xi]\[Eta]\[Zeta][{elex, delex, eley, deley, elelp, delelp, 
            eleip, eled, deled, ele\[Mu], dele\[Mu], reliphor}]]\)], "Input"],

Cell[BoxData[
    \(maxhor2lonlat[{elex_, delex_, eley_, deley_, elelp_, delelp_, eleip_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Module[{puntos = 
            maxhor2xyz[{elex, delex, eley, deley, elelp, delelp, eleip, eled, 
                deled, ele\[Mu], dele\[Mu], reliphor}]}, 
        Map[{grad2gm[cormerefe[\(cart2ecu[#]\)[\([1]\)]]], 
              grad2gm[latgeocen2latgeode[\(cart2ecu[#]\)[\([2]\)]]]} &, 
          puntos]]\)], "Input"],

Cell[BoxData[
    \(maxhor[
        t_] := {h2hms[
          t + \((First[fech] - IntegerPart[First[fech]] - 
                  0.5)\)*24 - \[CapitalDelta]t/3600], 
        maxhor2lonlat[{pelex[t], pdelex[t], peley[t], pdeley[t], pelelp[t], 
            pdelelp[t], peleip[t], peled[t], pdeled[t], pele\[Mu][t], 
            pdele\[Mu][t], preliphor[t]}]}\)], "Input"],

Cell[BoxData[
    \(maxhorbis2\[Xi]\[Eta]\[Zeta][{elex_, delex_, eley_, deley_, elelp_, 
          delelp_, eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Select[{\[Xi], \[Eta], \[Zeta]} /. 
          NSolve[{\[Zeta] \[Equal] 
                0, \[Xi]\^2 + \[Eta]\^2\/reliphor\^2 \[Equal] 
                1, \(-delelp\) + \((2*\((elex - \[Xi])\) \((delex + \[Eta]\ \
\((dele\[Mu]\ Degree)\)\ Sin[eled\ Degree])\) + 
                        2 \((\(-\[Eta]\) + 
                              eley)\) \((deley - \((dele\[Mu]\ Degree)\)\ \
\[Xi]\ Sin[
                                  eled\ Degree])\))\)/\((2\ \@\(\((elex - \
\[Xi])\)\^2 + \((eley - \[Eta])\)\^2\))\) + \((\((deled\ Degree)\)\ \[Eta]\  \
- \((dele\[Mu]\ Degree)\)\ \[Xi]\ Cos[eled\ Degree])\) eleip \[Equal] 
                0}, {\[Xi], \[Eta], \[Zeta]}], 
        Head[#[\([1]\)]] \[Equal] Real\  &]\)], "Input"],

Cell[BoxData[
    \(maxhorbisselec\[Xi]\[Eta]\[Zeta][{elex_, delex_, eley_, deley_, elelp_, 
          delelp_, eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Module[{dismin}, 
        dismin = 
          dismaxconopsign[{elex, delex, eley, deley, elelp, delelp, eleip, 
              eled, deled, ele\[Mu], dele\[Mu], reliphor}]\ ; 
        Select[maxhorbis2\[Xi]\[Eta]\[Zeta][{elex, delex, eley, deley, elelp, 
              delelp, eleip, eled, deled, ele\[Mu], dele\[Mu], reliphor}], 
          Sqrt[\((#[\([1]\)] - elex)\)\^2 + \((#[\([2]\)] - eley)\)\^2] - 
                elelp \[Equal] dismin &]]\)], "Input"],

Cell[BoxData[
    \(maxhorbis2xyz[{elex_, delex_, eley_, deley_, elelp_, delelp_, eleip_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Map[Matcambcoor[eled, 
              ele\[Mu]] . {#[\([1]\)], #[\([2]\)], #[\([3]\)]} &, 
        maxhorbisselec\[Xi]\[Eta]\[Zeta][{elex, delex, eley, deley, elelp, 
            delelp, eleip, eled, deled, ele\[Mu], dele\[Mu], 
            reliphor}]]\)], "Input"],

Cell[BoxData[
    \(maxhorbis2lonlat[{elex_, delex_, eley_, deley_, elelp_, delelp_, 
          eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Module[{puntos = 
            maxhorbis2xyz[{elex, delex, eley, deley, elelp, delelp, eleip, 
                eled, deled, ele\[Mu], dele\[Mu], reliphor}]}, 
        Map[{grad2gm[cormerefe[\(cart2ecu[#]\)[\([1]\)]]], 
              grad2gm[latgeocen2latgeode[\(cart2ecu[#]\)[\([2]\)]]]} &, 
          puntos]]\)], "Input"],

Cell[BoxData[
    \(maxhorbis[
        t_] := {h2hms[
          t + \((First[fech] - IntegerPart[First[fech]] - 
                  0.5)\)*24 - \[CapitalDelta]t/3600], 
        maxhorbis2lonlat[{pelex[t], pdelex[t], peley[t], pdeley[t], 
            pelelp[t], pdelelp[t], peleip[t], peled[t], pdeled[t], 
            pele\[Mu][t], pdele\[Mu][t], preliphor[t]}]}\)], "Input"],

Cell[BoxData[
    \(dismaxconop[{elex_, delex_, eley_, deley_, elelp_, delelp_, eleip_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Map[Sqrt[\((#[\([1]\)] - elex)\)\^2 + \((#[\([2]\)] - eley)\)\^2] - 
            elelp &, 
        maxhorbis2\[Xi]\[Eta]\[Zeta][{elex, delex, eley, deley, elelp, 
            delelp, eleip, eled, deled, ele\[Mu], dele\[Mu], 
            reliphor}]]\)], "Input"],

Cell[BoxData[
    \(minabsconsign[l_] := 
      Module[{min = Min[Abs[l]]}, 
        Select[l, Abs[#] \[Equal] min &]]\)], "Input"],

Cell[BoxData[
    \(dismaxconopsign[{elex_, delex_, eley_, deley_, elelp_, delelp_, eleip_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Module[{aux}, 
        aux = minabsconsign[
            dismaxconop[{elex, delex, eley, deley, elelp, delelp, eleip, 
                eled, deled, ele\[Mu], dele\[Mu], 
                reliphor}]]; \[IndentingNewLine]If[aux \[Equal] {}, {}, 
          aux[\([1]\)]]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(dismaxconos[{elex_, delex_, eley_, deley_, elels_, delels_, eleis_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Map[Sqrt[\((#[\([1]\)] - elex)\)\^2 + \((#[\([2]\)] - eley)\)\^2] - 
            Abs[elels] &, 
        maxhorbis2\[Xi]\[Eta]\[Zeta][{elex, delex, eley, deley, elels, 
            delels, eleis, eled, deled, ele\[Mu], dele\[Mu], 
            reliphor}]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(dismaxconos\\)\\\" is similar to existing \
symbol \\\"\\!\\(dismaxconop\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(dismaxconossign[{elex_, delex_, eley_, deley_, elels_, delels_, eleis_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Module[{aux}, 
        aux = minabsconsign[
            dismaxconos[{elex, delex, eley, deley, elels, delels, eleis, 
                eled, deled, ele\[Mu], dele\[Mu], 
                reliphor}]]; \[IndentingNewLine]If[aux \[Equal] {}, {}, 
          aux[\([1]\)]]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(dismaxconossign\\)\\\" is similar to \
existing symbol \\\"\\!\\(dismaxconopsign\\)\\\". \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constantes y par\[AAcute]metros.", "Subsection"],

Cell[BoxData[{
    \(\(\[CapitalDelta]t = 
        66;\)\[IndentingNewLine] (*\(ua = 
          1.49597870691\ 10^8;\)*) \), "\[IndentingNewLine]", 
    \(\(ua = 1.4959787550\ 10^8;\)\), "\[IndentingNewLine]", 
    \(\(radioS2 = 695950\/ua;\)\), "\[IndentingNewLine]", 
    \(\(radioS = 
        ArcSin[\((15/60 + 59.64/3600)\) Degree];\)\), "\[IndentingNewLine]", 
    \(\(radioecT = 6378.1366\/ua;\)\), "\[IndentingNewLine]", 
    \(\(radioL = 0.2725076*radioecT;\)\), "\[IndentingNewLine]", 
    \(\(radioL2 = 1738.3\/ua;\)\)}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Lectura de datos", "Subsection"],

Cell["\<\
Fichero Sol: tiempo en DJ, AR en horas, dec en \.ba, distancia en ua
Fichero Luna: tiempo en DJ, AR en horas, dec en \.ba, distancia en km\
\>", "Text"],

Cell[BoxData[{
    \(\(fichS = "\<D:\\Documents and Settings\\ESCUELA1\\Escritorio\\Eclipses\
\\Sol090126.dat\>";\)\), "\[IndentingNewLine]", 
    \(\(fichL = "\<D:\\Documents and Settings\\ESCUELA1\\Escritorio\\Eclipses\
\\Luna090126.dat\>";\)\), "\[IndentingNewLine]", 
    \(\(\(fichTS = "\<D:\\Documents and \
Settings\\ESCUELA1\\Escritorio\\Eclipses\\TS090126.dat\>";\)\(\
\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\(datsol = ReadList[fichS, Array[Number &, 4]];\)\), "\n", 
    \(\(datlun = 
        ReadList[fichL, Array[Number &, 4]];\)\), "\[IndentingNewLine]", 
    \(\(\(datTS = 
        ReadList[fichTS, Array[Number &, 10]];\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\(sol = 
        Map[\((#\ {1, 15, 1, 1})\) &, datsol];\)\[IndentingNewLine] (*luna = 
        Map[\((#\ {1, 15, 1, 1/ua})\) &, datlun]; 
      sin\ corregir\ por\ \[CapitalDelta]\[Lambda]\ y\ \[CapitalDelta]\[Beta]\
\ *) \), "\n", 
    \(\(luna = Map[correcluna, datlun];\)\), "\[IndentingNewLine]", 
    \(\(\(TS = 
        15*Map[hms2h, 
            Transpose[\(Transpose[
                  datTS]\)[\([{2, 3, 5}]\)]]];\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\({fech, \[Alpha]recS, decS, distS} = Transpose[sol];\)\), "\n", 
    \(\({fech, \[Alpha]recL, decL, distL} = 
        Transpose[
          luna];\)\[IndentingNewLine]\[IndentingNewLine] (*\(horas = \((fech \
- Min[fech])\) 24;\)*) \), "\[IndentingNewLine]", 
    \(\(horas = \(1\/60\) Range[0, Length[fech] - 1];\)\)}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones Interpolantes de ascensi\[OAcute]n recta, declinaci\[OAcute]n y \
distancia.\
\>", "Subsection"],

Cell[BoxData[{
    \(\(p\[Alpha]recS = 
        Interpolation[
          Transpose[{horas, \[Alpha]recS}]];\)\), "\[IndentingNewLine]", 
    \(\(pdecS = 
        Interpolation[Transpose[{horas, decS}]];\)\), "\[IndentingNewLine]", 
    \(\(pdistS = 
        Interpolation[
          Transpose[{horas, distS}]];\)\), "\[IndentingNewLine]", 
    \(\(p\[Alpha]recL = 
        Interpolation[Transpose[{horas, \[Alpha]recL}]];\)\), "\n", 
    \(\(pdecL = Interpolation[Transpose[{horas, decL}]];\)\), "\n", 
    \(\(pdistL = Interpolation[Transpose[{horas, distL}]];\)\)}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Conjunci\[OAcute]n en AR (hcon1). Obtenci\[OAcute]n de ascensi\[OAcute]n \
recta, declinaciones, paralajes horizontales ecuatoriales y \
semidi\[AAcute]metros verdaderos de Sol y Luna para esa hora. \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(hcon = \((t /. 
            FindRoot[
              p\[Alpha]recS[t] - p\[Alpha]recL[t] \[Equal] 0, {t, 
                0}])\);\)\), "\[IndentingNewLine]", 
    \(\(\(h2hms[
      hcon + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\)\(\[IndentingNewLine]\)
    \) (*hcon = 
        hms2h[{2, 46, 14.756}] + 74/3600*) \), "\[IndentingNewLine]", 
    \(p\[Alpha]recS[hcon]/15 // h2hms\), "\n", 
    \(pdecS[hcon] // h2hms\), "\n", 
    \(ArcSin[radioecT/\ pdistS[hcon]]/Degree // h2hms\), "\n", 
    \(ArcSin[radioS/\ pdistS[hcon]]/Degree // h2hms\), "\n", 
    \(p\[Alpha]recL[hcon]/15 // h2hms\), "\n", 
    \(pdecL[hcon] // h2hms\), "\n", 
    \(ArcSin[radioecT/pdistL[hcon]]/Degree // h2hms\), "\n", 
    \(ArcSin[radioL/pdistL[hcon]]/Degree // h2hms\)}], "Input"],

Cell[BoxData[
    \({7, 46, 22.962355672901282`}\)], "Output"],

Cell[BoxData[
    \({20, 35, 30.683083144486865`}\)], "Output"],

Cell[BoxData[
    \({\(-18\), \(-39\), \(-2.750552342083301`\)}\)], "Output"],

Cell[BoxData[
    \({0, 0, 8.931365568019476`}\)], "Output"],

Cell[BoxData[
    \({0, 16, 14.621229413132353`}\)], "Output"],

Cell[BoxData[
    \({20, 35, 30.683083144486865`}\)], "Output"],

Cell[BoxData[
    \({\(-18\), \(-55\), \(-23.67016536755684`\)}\)], "Output"],

Cell[BoxData[
    \({0, 54, 32.03423725840855`}\)], "Output"],

Cell[BoxData[
    \({0, 14, 51.61957786326777`}\)], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo elementos Besselianos: elementos x, y, z, ls, lp (en unidad \
de radio ecuatorial terrestre), a,d, \[Mu] (en grados sexagesimales), is e \
ip.\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(CartSol = 
        ecu2cart[{\[Alpha]recS, decS, distS}];\)\), "\[IndentingNewLine]", 
    \(\(CartLuna = 
        ecu2cart[{\[Alpha]recL, decL, distL}];\)\), "\[IndentingNewLine]", 
    \(\(CartLunaSol = CartSol - CartLuna;\)\), "\[IndentingNewLine]", 
    \(\(\(EcuLunaSol = cart2ecu[CartLunaSol];\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\(elementoa = EcuLunaSol[\([1]\)];\)\), "\n", 
    \(\(elementod = EcuLunaSol[\([2]\)];\)\), "\n", 
    \(\(elementox = \(1\/radioecT\) distL*Cos[decL\ Degree]*
          Sin[\((\[Alpha]recL - elementoa)\) Degree];\)\), "\n", 
    \(\(elementoy = \(1\/radioecT\) 
          distL*\((Sin[decL\ Degree]*Cos[elementod\ Degree] - 
              Cos[decL\ Degree]*Sin[elementod\ Degree]*
                Cos[\((\[Alpha]recL - elementoa)\) Degree])\);\)\), "\n", 
    \(\(elementoz = \(1\/radioecT\) 
          distL*\((Sin[decL\ Degree]*Sin[elementod\ Degree] + 
              Cos[decL\ Degree]*Cos[elementod\ Degree]*
                Cos[\((\[Alpha]recL - elementoa)\) Degree])\);\)\), "\n", 
    \(\(elementois = 
        Tan[ArcSin[\(radioS - radioL\)\/EcuLunaSol[\([3]\)]]];\)\), "\n", 
    \(\(\(elementoip = 
        Tan[ArcSin[\(radioS + radioL\)\/EcuLunaSol[\([3]\)]]];\)\(\
\[IndentingNewLine]\)
    \)\), "\n", 
    \(\(elementols = 
        elementoz*elementois - 
          radioL\/radioecT*
            Sec[ArcSin[\(radioS - radioL\)\/EcuLunaSol[\([3]\)]]];\)\), "\n", \

    \(\(elementolp = 
        elementoz*elementoip + 
          radioL\/radioecT*
            Sec[ArcSin[\(radioS + radioL\)\/EcuLunaSol[\([3]\)]]];\)\), "\n", \

    \(\(elemento\[Mu] = TS - elementoa;\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementod\\)\\\" is similar to existing \
symbol \\\"\\!\\(elementoa\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementox\\)\\\" is similar to existing \
symbols \\!\\({elementoa, elementod}\\). \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementoy\\)\\\" is similar to existing \
symbols \\!\\({elementoa, elementod, elementox}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementoz\\)\\\" is similar to existing \
symbols \\!\\({elementoa, elementod, elementox, elementoy}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementoip\\)\\\" is similar to existing \
symbol \\\"\\!\\(elementois\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementols\\)\\\" is similar to existing \
symbol \\\"\\!\\(elementois\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementolp\\)\\\" is similar to existing \
symbols \\!\\({elementoip, elementols}\\). \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de funciones interpolantes de los elementos Besselianos y de \
sus derivadas.\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(pelex = 
        Interpolation[
          Transpose[{horas, elementox}]];\)\), "\[IndentingNewLine]", 
    \(\(pdelex = \(Derivative[1]\)[pelex];\)\), "\n", 
    \(\(peley = 
        Interpolation[
          Transpose[{horas, elementoy}]];\)\), "\[IndentingNewLine]", 
    \(\(pdeley = \(Derivative[1]\)[peley];\)\), "\[IndentingNewLine]", 
    \(\(pelez = 
        Interpolation[
          Transpose[{horas, elementoz}]];\)\), "\[IndentingNewLine]", 
    \(\(pdelez = \(Derivative[1]\)[pelez];\)\), "\[IndentingNewLine]", 
    \(\(peled = Interpolation[Transpose[{horas, elementod}]];\)\), "\n", 
    \(\(pdeled = \(Derivative[1]\)[peled];\)\), "\[IndentingNewLine]", 
    \(\(pele\[Mu] = 
        Interpolation[Transpose[{horas, elemento\[Mu]}]];\)\), "\n", 
    \(\(pdele\[Mu] = \(Derivative[1]\)[
          pele\[Mu]];\)\), "\[IndentingNewLine]", 
    \(\(pelels = Interpolation[Transpose[{horas, elementols}]];\)\), "\n", 
    \(\(pdelels = \(Derivative[1]\)[pelels];\)\), "\[IndentingNewLine]", 
    \(\(pelelp = Interpolation[Transpose[{horas, elementolp}]];\)\), "\n", 
    \(\(pdelelp = \(Derivative[1]\)[pelelp];\)\), "\[IndentingNewLine]", 
    \(\(peleis = 
        Interpolation[
          Transpose[{horas, elementois}]];\)\), "\[IndentingNewLine]", 
    \(\(peleip = Interpolation[Transpose[{horas, elementoip}]];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pelez\\)\\\" is similar to existing symbols \
\\!\\({peled, pelex, peley}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdelez\\)\\\" is similar to existing symbols \
\\!\\({pdeled, pdelex, pdeley, pelez}\\). \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo del eje menor en la elipse del plano fundamental (reliphor) y \
calculo de la distancia del eje de sombra a dicha elipse (disejeelip). \
\>", "Subsection"],

Cell[BoxData[{
    \(\(reliphor = Map[radeliphor, elementod];\)\), "\[IndentingNewLine]", 
    \(\(lisEcu = 
        elementoy - reliphor*Sin[u] - 
          1/reliphor*Tan[u]*\((elementox - Cos[u])\);\)\), "\n", 
    \(\(lisVI = 
        Map[ArcTan @@ # &, Transpose[{elementox, elementoy}]];\)\), "\n", 
    \(\(listaU = 
        u /. Map[FindRoot[#[\([1]\)] \[Equal] 0, {u, #[\([2]\)]}] &, 
            Transpose[{lisEcu, lisVI}]];\)\), "\[IndentingNewLine]", 
    \(\(disejeelip = 
        disEjeElip[{elementox, elementoy, reliphor, 
            listaU}];\)\), "\[IndentingNewLine]", 
    \(\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(preliphor = 
        Interpolation[
          Transpose[{horas, reliphor}]];\)\), "\[IndentingNewLine]", 
    \(\(pdisejeelip = 
        Interpolation[
          Transpose[{horas, disejeelip}]];\)\), "\[IndentingNewLine]", 
    \(\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdisejeelip\\)\\\" is similar to existing \
symbol \\\"\\!\\(disejeelip\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de principio y fin del eclipse parcial igualando \
la distancia eje de sombra-elipse fundamental (pdisejeelip) al radio del cono \
de penumbra en el plano fundamental (plp). \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(tinipar = \((t /. 
            FindRoot[
              pelelp[t] + \((Sec[ArcTan[peleip[t]]] - 1)\) - 
                  pdisejeelip[t] \[Equal] 0, {t, 
                First[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      tinipar + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\[IndentingNewLine]", 
    \(\(tfinpar = \((t /. 
            FindRoot[
              pelelp[t] + \((Sec[ArcTan[peleip[t]]] - 1)\) - 
                  pdisejeelip[t] \[Equal] 0, {t, 
                Last[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      tfinpar + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\[IndentingNewLine]", 
    \(\(intervalosminuto = 
        Select[horas, \((# > \((tinipar\  - \ 
                      1/20)\)\  && \ # < \((tfinpar\  + \ 
                      1/20)\))\)\  &];\)\)}], "Input"],

Cell[BoxData[
    \({4, 56, 35.680981295577126`}\)], "Output"],

Cell[BoxData[
    \({11, 0, 39.89282933635394`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de contactos interiores del cono de penumbra.  \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(t2par = \((t /. 
            FindRoot[
              pelelp[t] + \((Sec[ArcTan[peleip[t]]] - 1)\) + 
                  pdisejeelip[t] \[Equal] 0, {t, 
                First[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      t2par + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\[IndentingNewLine]", 
    \(\(t3par = \((t /. 
            FindRoot[
              pelelp[t] + \((Sec[ArcTan[peleip[t]]] - 1)\) + 
                  pdisejeelip[t] \[Equal] 0, {t, 
                Last[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      t3par + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\)}], "Input"],

Cell[BoxData[
    \({7, 21, 5.25557984468592`}\)], "Output"],

Cell[BoxData[
    \({8, 36, 28.88465493153398`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de principio y fin del eclipse total/anular \
igualando la distancia eje de sombra-elipse fundamental (pdisejeelip) al \
radio del cono de sombra en el plano fundamental (pls)\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(tinitot = \((t /. 
            FindRoot[
              pelels[t] + Sign[pelels[t]] \((Sec[ArcTan[peleis[t]]] - 1)\) - 
                  pdisejeelip[t] \[Equal] 0, {t, 
                First[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      tinitot + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\[IndentingNewLine]", 
    \(\(tfintot = \((t /. 
            FindRoot[
              pelels[t] + Sign[pelels[t]] \((Sec[ArcTan[peleis[t]]] - 1)\) - 
                  pdisejeelip[t] \[Equal] 0, {t, 
                Last[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      tfintot + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\)}], "Input"],

Cell[BoxData[
    \({6, 2, 39.27075459730489`}\)], "Output"],

Cell[BoxData[
    \({9, 54, 40.85279013848129`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de contactos interiores del cono de sombra.\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(t2tot = \((t /. 
            FindRoot[
              pelels[t] + Sign[pelels[t]] \((Sec[ArcTan[peleis[t]]] - 1)\) + 
                  pdisejeelip[t] \[Equal] 0, {t, 
                First[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      t2tot + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\[IndentingNewLine]", 
    \(\(t3tot = \((t /. 
            FindRoot[
              pelels[t] + Sign[pelels[t]] \((Sec[ArcTan[peleis[t]]] - 1)\) + 
                  pdisejeelip[t] \[Equal] 0, {t, 
                Last[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      t3tot + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\)}], "Input"],

Cell[BoxData[
    \({6, 8, 55.63682816770069`}\)], "Output"],

Cell[BoxData[
    \({9, 48, 28.779414094225597`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de principio y fin de la curva central del eclipse \
haciendo nula la distancia eje de sombra-elipse fundamental (pdisejeelip). \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(tinicen = \((t /. 
            FindRoot[
              pdisejeelip[t] \[Equal] 0, {t, 
                First[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      tinicen + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\[IndentingNewLine]", 
    \(\(tfincen = \((t /. 
            FindRoot[
              pdisejeelip[t] \[Equal] 0, {t, 
                Last[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      tfincen + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\)}], "Input"],

Cell[BoxData[
    \({6, 5, 47.2526833224226`}\)], "Output"],

Cell[BoxData[
    \({9, 51, 35.06169142771136`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de coincidencia de la curva de m\[AAcute]ximo en \
el horizonte con las curvas l\[IAcute]mite Norte/Sur sombra/penumbra. \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(pdismaxconop = 
        Interpolation[
          Select[Transpose[{intervalosminuto, 
                Map[dismaxconopsign, 
                  Transpose[{Map[pelex, intervalosminuto], 
                      Map[pdelex, intervalosminuto], 
                      Map[peley, intervalosminuto], 
                      Map[pdeley, intervalosminuto], 
                      Map[pelelp, intervalosminuto], 
                      Map[pdelelp, intervalosminuto], 
                      Map[peleip, intervalosminuto], 
                      Map[peled, intervalosminuto], 
                      Map[pdeled, intervalosminuto], 
                      Map[pele\[Mu], intervalosminuto], 
                      Map[pdele\[Mu], intervalosminuto], 
                      Map[preliphor, intervalosminuto]}]]}], 
            NumberQ[#[\([2]\)]] &]];\)\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdismaxconop\\)\\\" is similar to existing \
symbol \\\"\\!\\(dismaxconop\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(pdismaxconos = 
        Interpolation[
          Select[Transpose[{intervalosminuto, 
                Map[dismaxconossign, 
                  Transpose[{Map[pelex, intervalosminuto], 
                      Map[pdelex, intervalosminuto], 
                      Map[peley, intervalosminuto], 
                      Map[pdeley, intervalosminuto], 
                      Map[pelels, intervalosminuto], 
                      Map[pdelels, intervalosminuto], 
                      Map[peleis, intervalosminuto], 
                      Map[peled, intervalosminuto], 
                      Map[pdeled, intervalosminuto], 
                      Map[pele\[Mu], intervalosminuto], 
                      Map[pdele\[Mu], intervalosminuto], 
                      Map[preliphor, intervalosminuto]}]]}], 
            NumberQ[#[\([2]\)]] &]];\)\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdismaxconos\\)\\\" is similar to existing \
symbols \\!\\({dismaxconos, pdismaxconop}\\). \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(t1maxpen = \((t /. 
            FindRoot[
              pdismaxconop[t] \[Equal] 0, {t, 
                tinipar}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      t1maxpen + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\)}], "Input"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({0.461579303628089`}\\) lies outside the range of data in the \
interpolating function. Extrapolation will be used. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\
\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({0.461579303628089`}\\) lies outside the range of data in the \
interpolating function. Extrapolation will be used. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\
\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({0.7948269703234379`}\\) lies outside the range of data in the \
interpolating function. Extrapolation will be used. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\
\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(InterpolatingFunction :: \\\"dmval\\\"\\) will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\
\"RefGuideLinkText\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\
\\)\"\>"}]], "Message"],

Cell[BoxData[
    \({5, 54, 29.035786110049024`}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(t2maxpen = \((t /. 
            FindRoot[
              pdismaxconop[t] \[Equal] 0, {t, 
                t2par}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      t2maxpen + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\[IndentingNewLine]", 
    \(\(t3maxpen = \((t /. 
            FindRoot[pdismaxconop[t] \[Equal] 0, {t, t3par}])\);\)\), "\n", 
    \(h2hms[
      t3maxpen + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\n", 
    \(\(t4maxpen = \((t /. 
            FindRoot[
              pdismaxconop[t] \[Equal] 0, {t, tfinpar}])\);\)\), "\n", 
    \(h2hms[
      t4maxpen + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\[IndentingNewLine]", 
    \(\(t1maxsom = \((t /. 
            FindRoot[
              pdismaxconos[t] \[Equal] 0, {t, 
                tinitot}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      t1maxsom + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\[IndentingNewLine]", 
    \(\(t2maxsom = \((t /. 
            FindRoot[
              pdismaxconos[t] \[Equal] 0, {t, 
                t2tot}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      t2maxsom + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\[IndentingNewLine]", 
    \(\(t3maxsom = \((t /. 
            FindRoot[pdismaxconos[t] \[Equal] 0, {t, t3tot}])\);\)\), "\n", 
    \(h2hms[
      t3maxsom + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\), "\n", 
    \(\(t4maxsom = \((t /. 
            FindRoot[
              pdismaxconos[t] \[Equal] 0, {t, tfintot}])\);\)\), "\n", 
    \(h2hms[
      t4maxsom + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\)}], "Input"],

Cell[BoxData[
    \({7, 2, 43.218056575650294`}\)], "Output"],

Cell[BoxData[
    \({8, 54, 59.09691539111797`}\)], "Output"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({6.529415726600102`}\\) lies outside the range of data in the \
interpolating function. Extrapolation will be used. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\
\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({6.529415726600102`}\\) lies outside the range of data in the \
interpolating function. Extrapolation will be used. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\
\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({6.19116326999374`}\\) lies outside the range of data in the \
interpolating function. Extrapolation will be used. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\
\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(InterpolatingFunction :: \\\"dmval\\\"\\) will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\
\"RefGuideLinkText\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\
\\)\"\>"}]], "Message"],

Cell[BoxData[
    \({10, 2, 32.67109493237214`}\)], "Output"],

Cell[BoxData[
    \({6, 4, 28.422014078786834`}\)], "Output"],

Cell[BoxData[
    \({6, 7, 9.18351442724471`}\)], "Output"],

Cell[BoxData[
    \({9, 50, 12.837277005382797`}\)], "Output"],

Cell[BoxData[
    \({9, 52, 52.00637144357447`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de los puntos del principio y fin de eclipses parciales y \
total/anular.
\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\[Xi]\[Eta]par2lonlat[tinipar]\), "\[IndentingNewLine]", 
    \(\[Xi]\[Eta]par2lonlat[tfinpar]\), "\[IndentingNewLine]", 
    \(\[Xi]\[Eta]tot2lonlat[tinitot]\), "\[IndentingNewLine]", 
    \(\[Xi]\[Eta]tot2lonlat[tfintot]\)}], "Input"],

Cell[BoxData[
    \({{8, 
        18.65442558278332`}, {\(-28\), \(-52.934269307138635`\)}}\)], "Output"],

Cell[BoxData[
    \({{104, 46.69192878894535`}, {9, 27.586287934744327`}}\)], "Output"],

Cell[BoxData[
    \({{\(-10\), \(-42.39177054736494`\)}, {\(-34\), \
\(-11.447268858574375`\)}}\)], "Output"],

Cell[BoxData[
    \({{123, 5.6658415731322975`}, {4, 5.916765981552974`}}\)], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la curva de eclipse central mediante el corte del eje de \
sombra con el elipsoide terrestre (hora UT, lon, lat, duraci\[OAcute]n).
\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(\(\[IndentingNewLine]\)\(\[Xi]\[Eta]fun2lonlat[
      tinicen]\[IndentingNewLine]
    \[Xi]\[Eta]fun2lonlat[tfincen]\[IndentingNewLine]
    \(curvacentral = 
        datoreal[
          Map[corteejeelip, 
            Take[intervalosminuto, {1, Length[intervalosminuto], 
                5}]]];\)\[IndentingNewLine]
    curvacentraldur = Map[puntoejedur, curvacentral]\[IndentingNewLine]
    \)\)\)], "Input"],

Cell[BoxData[
    \({{\(-11\), \(-41.301184257205`\)}, {\(-34\), \(-35.028716723270605`\)}}\
\)], "Output"],

Cell[BoxData[
    \({{124, 0.09171069273776311`}, {3, 42.18770577422489`}}\)], "Output"],

Cell[BoxData[
    \({{{6, 8, 54.00000000000035`}, {2, 
          36.009082276708604`}, {\(-39\), \(-4.513396425879392`\)}, {6, 
          3.0950779982104826`}}, {{6, 13, 53.99999999999925`}, {11, 
          27.380012524292106`}, {\(-41\), \(-14.347026155296874`\)}, {6, 
          19.08075353438029`}}, {{6, 18, 53.99999999999825`}, {17, 
          48.17517864500843`}, {\(-42\), \(-25.740483283482263`\)}, {6, 
          31.35100175056914`}}, {{6, 23, 54.00000000000025`}, {23, 
          1.6080690792324503`}, {\(-43\), \(-9.321588307381177`\)}, {6, 
          41.889735346700476`}}, {{6, 28, 53.99999999999925`}, {27, 
          33.72097348532229`}, {\(-43\), \(-35.11785073056714`\)}, {6, 
          51.231823700479616`}}, {{6, 33, 54.00000000000125`}, {31, 
          36.615824649401816`}, {\(-43\), \(-47.99169288028324`\)}, {6, 
          59.65891339382002`}}, {{6, 38, 53.99999999999725`}, {35, 
          17.06795472813525`}, {\(-43\), \(-50.822865111814224`\)}, {7, 
          7.298749550751815`}}, {{6, 43, 53.99999999999925`}, {38, 
          39.33460798321889`}, {\(-43\), \(-45.479394265715456`\)}, {7, 
          14.240192306186039`}}, {{6, 48, 54.00000000000125`}, {41, 
          46.33482782427734`}, {\(-43\), \(-33.29135151882227`\)}, {7, 
          20.53584917686716`}}, {{6, 53, 53.99999999999725`}, {44, 
          40.20167445213332`}, {\(-43\), \(-15.24629796898438`\)}, {7, 
          26.19617614277142`}}, {{6, 58, 53.99999999999925`}, {47, 
          22.528677657697926`}, {\(-42\), \(-52.11419808315668`\)}, {7, 
          31.23357426730219`}}, {{7, 3, 54.0000000000014`}, {49, 
          54.60012085316407`}, {\(-42\), \(-24.49914047282448`\)}, {7, 
          35.66707759975617`}}, {{7, 8, 53.99999999999715`}, {52, 
          17.50355390670137`}, {\(-41\), \(-52.8985111278935`\)}, {7, 
          39.51045320870171`}}, {{7, 13, 53.99999999999925`}, {54, 
          32.12023928325095`}, {\(-41\), \(-17.7172993666953`\)}, {7, 
          42.78479067082702`}}, {{7, 18, 54.00000000000145`}, {56, 
          39.2513003248429`}, {\(-40\), \(-39.30080368144999`\)}, {7, 
          45.471033616384304`}}, {{7, 23, 53.99999999999705`}, {58, 
          39.59003512262001`}, {\(-39\), \(-57.925352374103625`\)}, {7, 
          47.61668055870568`}}, {{7, 28, 53.99999999999925`}, {60, 
          33.77231499370524`}, {\(-39\), \(-13.835406274589985`\)}, {7, 
          49.24278322062171`}}, {{7, 33, 54.00000000000125`}, {62, 
          22.366705069229482`}, {\(-38\), \(-27.236742172356116`\)}, {7, 
          50.30507298825696`}}, {{7, 38, 53.99999999999725`}, {64, 
          5.906961588175648`}, {\(-37\), \(-38.29537097470052`\)}, {7, 
          50.862860141206234`}}, {{7, 43, 53.99999999999925`}, {65, 
          44.89153004005004`}, {\(-36\), \(-47.15325483677532`\)}, {7, 
          50.94197141921316`}}, {{7, 48, 54.00000000000125`}, {67, 
          19.797466807214334`}, {\(-35\), \(-53.92726339897095`\)}, {7, 
          50.53275539803713`}}, {{7, 53, 53.99999999999725`}, {68, 
          51.07312765340737`}, {\(-34\), \(-58.71584054143611`\)}, {7, 
          49.68770746734378`}}, {{7, 58, 53.99999999999925`}, {70, 
          19.14292129783462`}, {\(-34\), \(-1.5813222964078477`\)}, {7, 
          48.41420424047246`}}, {{8, 3, 54.0000000000046`}, {71, 
          44.420730849899144`}, {\(-33\), \(-2.594797199004404`\)}, {7, 
          46.75366437846328`}}, {{8, 8, 54.00000000000035`}, {73, 
          7.331001351826103`}, {\(-32\), \(-1.7847653868084024`\)}, {7, 
          44.68290664119837`}}, {{8, 13, 54.000000000002444`}, {74, 
          28.28926784355076`}, {\(-30\), \(-59.16963512034066`\)}, {7, 
          42.24617109653642`}}, {{8, 18, 54.00000000000465`}, {75, 
          47.68319823105031`}, {\(-29\), \(-54.760069598035486`\)}, {7, 
          39.483961824009405`}}, {{8, 23, 54.00000000000025`}, {77, 
          5.94947486931602`}, {\(-28\), \(-48.5224234477397`\)}, {7, 
          36.41091356243652`}}, {{8, 28, 54.000000000002444`}, {78, 
          23.53154046801137`}, {\(-27\), \(-40.43102443252714`\)}, {7, 
          33.028859783732855`}}, {{8, 33, 53.99999999999805`}, {79, 
          40.86667923815867`}, {\(-26\), \(-30.42284880511552`\)}, {7, 
          29.347976375343087`}}, {{8, 38, 54.00000000000684`}, {80, 
          58.4544694657248`}, {\(-25\), \(-18.42779611648851`\)}, {7, 
          25.417772102310032`}}, {{8, 43, 54.000000000002444`}, {82, 
          16.834521053077935`}, {\(-24\), \(-4.325624329151481`\)}, {7, 
          21.213228237893766`}}, {{8, 48, 53.99999999999805`}, {83, 
          36.600600827858045`}, {\(-22\), \(-47.98790342305118`\)}, {7, 
          16.766828292810764`}}, {{8, 53, 54.00000000000684`}, {84, 
          58.4357859468426`}, {\(-21\), \(-29.218553149716584`\)}, {7, 
          12.064178744920461`}}, {{8, 58, 54.000000000002444`}, {86, 
          23.124726952961225`}, {\(-20\), \(-7.804543938215929`\)}, {7, 
          7.111975142882365`}}, {{9, 3, 53.9999999999982`}, {87, 
          51.63648063483805`}, {\(-18\), \(-43.439223768968986`\)}, {7, 
          1.9162967711930823`}}, {{9, 8, 54.00000000000674`}, {89, 
          25.12784864872657`}, {\(-17\), \(-15.738007270869971`\)}, {6, 
          56.483903997037054`}}, {{9, 13, 54.000000000002444`}, {91, 
          5.092881759064483`}, {\(-15\), \(-44.20542238325151`\)}, {6, 
          50.737126860865565`}}, {{9, 18, 53.99999999999825`}, {92, 
          53.49973882326253`}, {\(-14\), \(-8.147470922478135`\)}, {6, 
          44.710371568773986`}}, {{9, 23, 54.000000000006644`}, {94, 
          53.0840433208283`}, {\(-12\), \(-26.596787794036274`\)}, {6, 
          38.33221773637495`}}, {{9, 28, 54.000000000002444`}, {97, 
          7.839567455579868`}, {\(-10\), \(-38.128253275523925`\)}, {6, 
          31.491481920176533`}}, {{9, 33, 53.99999999999805`}, {99, 
          44.12808953615411`}, {\(-8\), \(-40.471888957357365`\)}, {6, 
          24.081684026035198`}}, {{9, 38, 54.00000000000684`}, {102, 
          53.26565842838278`}, {\(-6\), \(-29.61396760256367`\)}, {6, 
          15.883442166948692`}}, {{9, 43, 54.000000000002444`}, {106, 
          59.761347334066954`}, {\(-3\), \(-56.91099502411908`\)}, {6, 
          6.329703800411346`}}, {{9, 48, 53.99999999999805`}, {113, 
          25.768923464666216`}, {0, \(-33.822910367344626`\)}, {5, 
          53.57824353405755`}}}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de punto de m\[AAcute]ximo eclipse (punto eje sombra m\
\[AAcute]s pr\[OAcute]ximo a centro tierra).
\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(pdisejecen = 
        Interpolation[
          Transpose[{horas, 
              elementox\^2 + elementoy\^2}]];\)\), "\[IndentingNewLine]", 
    \(\(tmaxecl = \((t /. 
            FindRoot[D[pdisejecen[t], t], {t, First[horas]}])\);\)\), "\n", 
    \(\(\(h2hms[
      tmaxecl + \((First[fech] - IntegerPart[First[fech]] - 
              0.5)\)*24 - \[CapitalDelta]t/3600]\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(corteejeelip2lonlat[{pelex[tmaxecl], peley[tmaxecl], peled[tmaxecl], 
        pele\[Mu][tmaxecl], tmaxecl}]\)}], "Input"],

Cell[BoxData[
    \({7, 58, 37.61393264610295`}\)], "Output"],

Cell[BoxData[
    \({{70, 14.407009797825197`}, {\(-34\), \(-4.749556951541649`\)}, 
      3.4954483146239177`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de puntos de inicio/fin del eclipse parcial al orto/ocaso \
(suponiendo dichos puntos en el plano fundamental, es decir, asimilando el \
cono a un cilindro y englobando el error dentro de las imprecisiones debidas \
a la refracci\[OAcute]n). 
\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(curvainifinhor = 
      Map[cortehor2lonlatt[#] &, 
        Take[intervalosminuto, {1, Length[intervalosminuto], 5}]]\)], "Input"],

Cell[BoxData[
    \({{{4, 53, 54.00000000000045`}, 
        "Error"}, {{4, 58, 
          53.99999999999925`}, {{{10, 
              21.166503081230488`}, {\(-22\), \(-39.287519790400864`\)}}, \
{{4, 39.635198571270095`}, {\(-35\), \(-17.40294053134477`\)}}}}, {{5, 3, 
          53.9999999999982`}, {{{10, 
              53.875983277393296`}, {\(-17\), \(-59.71702578102338`\)}}, {{0, 
              34.87655864524022`}, {\(-40\), \(-21.364207270700035`\)}}}}, \
{{5, 8, 54.00000000000035`}, {{{10, 
              45.45981094771953`}, {\(-14\), \(-58.40090361872328`\)}}, \
{{\(-2\), \(-52.65903765983035`\)}, {\(-43\), \(-48.38567620869398`\)}}}}, \
{{5, 13, 53.99999999999925`}, {{{10, 
              20.487485475099056`}, {\(-12\), \(-38.443340703120086`\)}}, \
{{\(-6\), \(-7.784226752155021`\)}, {\(-46\), \(-35.48997473667555`\)}}}}, \
{{5, 18, 53.99999999999825`}, {{{9, 
              45.71577948403558`}, {\(-10\), \(-43.876467342198744`\)}}, \
{{\(-9\), \(-17.521614794165785`\)}, {\(-48\), \(-58.780949461816476`\)}}}}, \
{{5, 23, 54.00000000000025`}, {{{9, 
              4.09777826071263`}, {\(-9\), \(-7.6162130821370155`\)}}, \
{{\(-12\), \(-25.09052712670833`\)}, {\(-51\), \(-5.511817944329067`\)}}}}, \
{{5, 28, 53.99999999999925`}, {{{8, 
              17.198131269114043`}, {\(-7\), \(-45.8617300594001`\)}}, \
{{\(-15\), \(-32.303246432965054`\)}, {\(-52\), \(-59.65293182034074`\)}}}}, \
{{5, 33, 53.99999999999805`}, {{{7, 
              25.923843607507546`}, {\(-6\), \(-36.390457830839296`\)}}, \
{{\(-18\), \(-40.327479307024205`\)}, {\(-54\), \(-43.65407769256265`\)}}}}, \
{{5, 38, 54.00000000000045`}, {{{6, 
              30.821473837942932`}, {\(-5\), \(-37.859015035246415`\)}}, \
{{\(-21\), \(-49.94497291867127`\)}, {\(-56\), \(-19.116337640893164`\)}}}}, \
{{5, 43, 53.99999999999925`}, {{{5, 
              32.221000159551814`}, {\(-4\), \(-49.46039357773735`\)}}, \
{{\(-25\), \(-1.6713070599048052`\)}, {\(-57\), \(-47.1269488562352`\)}}}}, \
{{5, 48, 53.99999999999805`}, {{{4, 
              30.29938226107241`}, {\(-4\), \(-10.77672159607685`\)}}, \
{{\(-28\), \(-15.858007681699249`\)}, {\(-59\), \(-8.472911727594834`\)}}}}, \
{{5, 53, 54.00000000000045`}, {{{3, 
              25.12524442554816`}, {\(-3\), \(-41.6726953645786`\)}}, {{\(-31\
\), \(-32.64742323915982`\)}, {\(-60\), \(-23.696650610062733`\)}}}}, {{5, 
          58, 53.99999999999925`}, {{{2, 
              16.677250732309695`}, {\(-3\), \(-22.25325683081617`\)}}, \
{{\(-34\), \(-52.03413194273779`\)}, {\(-61\), \(-33.2040717854305`\)}}}}, \
{{6, 3, 53.9999999999982`}, {{{1, 
              4.856409460081252`}, {\(-3\), \(-12.83719712150603`\)}}, \
{{\(-38\), \(-13.800964820530908`\)}, {\(-62\), \(-37.27626397747244`\)}}}}, \
{{6, 8, 54.00000000000035`}, {{{0, \(-10.512988948126855`\)}, {\(-3\), \
\(-13.958592874850968`\)}}, {{\(-41\), \(-37.51632706393039`\)}, {\(-63\), \
\(-36.11474664093322`\)}}}}, {{6, 13, 
          53.99999999999925`}, {{{\(-1\), \(-29.681516961887926`\)}, {\(-3\), \
\(-26.361081168360574`\)}}, {{\(-45\), \(-2.4744626967871852`\)}, {\(-64\), \
\(-29.85196327549005`\)}}}}, {{6, 18, 
          53.99999999999825`}, {{{\(-2\), \(-52.994005994771356`\)}, {\(-3\), \
\(-51.05363284729471`\)}}, {{\(-48\), \(-27.66306272607693`\)}, {\(-65\), \
\(-18.575850312431612`\)}}}}, {{6, 23, 
          54.00000000000025`}, {{{\(-51\), \(-51.645758938404356`\)}, \
{\(-66\), \(-2.320153308050692`\)}}, {{\(-4\), \(-20.890296732538705`\)}, \
{\(-4\), \(-29.30152740208987`\)}}}}, {{6, 28, 
          53.99999999999925`}, {{{\(-55\), \(-12.562775352770217`\)}, \
{\(-66\), \(-41.100057517698474`\)}}, {{\(-5\), \(-53.951362861394955`\)}, \
{\(-5\), \(-22.740216463181486`\)}}}}, {{6, 33, 
          54.00000000000125`}, {{{\(-58\), \(-27.87651785316882`\)}, \
{\(-67\), \(-14.862910577580806`\)}}, {{\(-7\), \(-32.91759046848787`\)}, \
{\(-6\), \(-33.389145507618814`\)}}}}, {{6, 38, 
          53.99999999999725`}, {{{\(-61\), \(-34.35300785441811`\)}, \
{\(-67\), \(-43.51717765302595`\)}}, {{\(-9\), \(-18.776711684830865`\)}, \
{\(-8\), \(-3.8312220707937783`\)}}}}, {{6, 43, 
          53.99999999999925`}, {{{\(-64\), \(-27.65888503730622`\)}, \
{\(-68\), \(-6.847505950203185`\)}}, {{\(-11\), \(-12.844206398424163`\)}, \
{\(-9\), \(-57.301971025812115`\)}}}}, {{6, 48, 
          54.00000000000125`}, {{{\(-67\), \(-2.0760030977177735`\)}, \
{\(-68\), \(-24.45843678045179`\)}}, {{\(-13\), \(-16.960305097877786`\)}, \
{\(-12\), \(-17.984206645839045`\)}}}}, {{6, 53, 
          53.99999999999725`}, {{{\(-69\), \(-9.786011931649057`\)}, \
{\(-68\), \(-35.58064776412266`\)}}, {{\(-15\), \(-33.80431530860587`\)}, \
{\(-15\), \(-11.368235661378172`\)}}}}, {{6, 58, 
          53.99999999999925`}, {{{\(-70\), \(-39.689124975615755`\)}, \
{\(-68\), \(-38.68449627587978`\)}}, {{\(-18\), \(-7.502124560084127`\)}, \
{\(-18\), \(-44.85143880517711`\)}}}}, {{7, 3, 
          54.0000000000014`}, {{{\(-71\), \(-15.07334320468459`\)}, {\(-68\), \
\(-30.566261489079807`\)}}, {{\(-21\), \(-4.9696408000802705`\)}, {\(-23\), \
\(-8.968299898477596`\)}}}}, {{7, 8, 
          53.99999999999715`}, {{{\(-70\), \(-28.661990392849646`\)}, \
{\(-68\), \(-3.9359595620504706`\)}}, {{\(-24\), \(-39.32572011526581`\)}, \
{\(-28\), \(-40.244877976860565`\)}}}}, {{7, 13, 
          53.99999999999925`}, {{{\(-67\), \(-28.59370860215165`\)}, \
{\(-66\), \(-59.133395144556005`\)}}, {{\(-29\), \(-21.014879806914166`\)}, {\
\(-35\), \(-49.75491841653863`\)}}}}, {{7, 18, 
          54.00000000000145`}, {{{\(-59\), \(-47.402913847420365`\)}, \
{\(-63\), \(-54.11693878679287`\)}}, {{\(-37\), \(-4.570851324702403`\)}, \
{\(-46\), \(-13.590675702482855`\)}}}}, {{7, 23, 53.99999999999705`}, 
        "Error"}, {{7, 28, 53.99999999999925`}, 
        "Error"}, {{7, 33, 54.00000000000125`}, 
        "Error"}, {{7, 38, 53.99999999999725`}, 
        "Error"}, {{7, 43, 53.99999999999925`}, 
        "Error"}, {{7, 48, 54.00000000000125`}, 
        "Error"}, {{7, 53, 53.99999999999725`}, 
        "Error"}, {{7, 58, 53.99999999999925`}, 
        "Error"}, {{8, 3, 54.0000000000046`}, 
        "Error"}, {{8, 8, 54.00000000000035`}, 
        "Error"}, {{8, 13, 54.000000000002444`}, 
        "Error"}, {{8, 18, 54.00000000000465`}, 
        "Error"}, {{8, 23, 54.00000000000025`}, 
        "Error"}, {{8, 28, 54.000000000002444`}, 
        "Error"}, {{8, 33, 53.99999999999805`}, 
        "Error"}, {{8, 38, 
          54.00000000000684`}, {{{154, 
              13.515692734201252`}, {\(-29\), \(-14.488654960786889`\)}}, \
{{145, 57.862213691282705`}, {\(-7\), \(-34.0034564950807`\)}}}}, {{8, 43, 
          54.000000000002444`}, {{{154, 
              59.76854285650063`}, {\(-33\), \(-32.384443912776675`\)}}, \
{{141, 7.35576371071204`}, {3, 6.171060217881648`}}}}, {{8, 48, 
          53.99999999999805`}, {{{154, 
              38.18814427178836`}, {\(-35\), \(-18.025287205985308`\)}}, \
{{137, 24.67670732703425`}, {10, 19.96031026236352`}}}}, {{8, 53, 
          54.00000000000684`}, {{{153, 
              47.72237053873823`}, {\(-36\), \(-4.976060620016938`\)}}, \
{{134, 12.614272687935681`}, {15, 50.18145374170743`}}}}, {{8, 58, 
          54.000000000002444`}, {{{152, 
              40.412809617012044`}, {\(-36\), \(-19.53655011491989`\)}}, \
{{131, 20.479300901260444`}, {20, 10.733711661235859`}}}}, {{9, 3, 
          53.9999999999982`}, {{{151, 
              22.04219854261396`}, {\(-36\), \(-13.26862553274438`\)}}, \
{{128, 43.45377666188597`}, {23, 39.50630457609989`}}}}, {{9, 8, 
          54.00000000000674`}, {{{149, 
              55.9326889247842`}, {\(-35\), \(-52.313150074151906`\)}}, \
{{126, 18.906836587343037`}, {26, 27.77837885978812`}}}}, {{9, 13, 
          54.000000000002444`}, {{{148, 
              24.204441778674095`}, {\(-35\), \(-20.33548835184618`\)}}, \
{{124, 5.195786609933464`}, {28, 43.36525657206927`}}}}, {{9, 18, 
          53.99999999999825`}, {{{146, 
              48.27083531438518`}, {\(-34\), \(-39.63989448192493`\)}}, \
{{122, 1.1670563119236022`}, {30, 32.002585705037276`}}}}, {{9, 23, 
          54.000000000006644`}, {{{145, 
              9.122724992216149`}, {\(-33\), \(-51.762759955062734`\)}}, \
{{120, 5.9453117279358025`}, {31, 58.01258108421209`}}}}, {{9, 28, 
          54.000000000002444`}, {{{143, 
              27.46649615478816`}, {\(-32\), \(-57.74815646614272`\)}}, \
{{118, 18.815365248321427`}, {33, 4.723034110907491`}}}}, {{9, 33, 
          53.99999999999805`}, {{{141, 
              43.81194209593616`}, {\(-31\), \(-58.312795692661226`\)}}, \
{{116, 39.16007263374382`}, {33, 54.73149344725542`}}}}, {{9, 38, 
          54.00000000000684`}, {{{139, 
              58.53056112701154`}, {\(-30\), \(-53.94894447163445`\)}}, \
{{115, 6.43397202584282`}, {34, 30.070192180168505`}}}}, {{9, 43, 
          54.000000000002444`}, {{{138, 
              11.878045454086532`}, {\(-29\), \(-44.955014745652164`\)}}, \
{{113, 40.13283407853464`}, {34, 52.354753643335954`}}}}, {{9, 48, 
          53.99999999999805`}, {{{136, 
              24.035616442396872`}, {\(-28\), \(-31.510025127849914`\)}}, \
{{112, 19.80785504440405`}, {35, 2.8271254512389987`}}}}, {{9, 53, 
          54.00000000000684`}, {{{134, 
              35.112614620699105`}, {\(-27\), \(-13.664476181584178`\)}}, \
{{111, 5.046489640112952`}, {35, 2.4511773303223094`}}}}, {{9, 58, 
          54.000000000002444`}, {{{132, 
              45.16204573298353`}, {\(-25\), \(-51.36301433732065`\)}}, \
{{109, 55.48318913110194`}, {34, 51.93449542225892`}}}}, {{10, 3, 
          53.9999999999982`}, {{{130, 
              54.184346744257255`}, {\(-24\), \(-24.442332936809095`\)}}, \
{{108, 50.80414141773531`}, {34, 31.752812489084192`}}}}, {{10, 8, 
          54.00000000000674`}, {{{129, 
              2.125401572391752`}, {\(-22\), \(-52.61362174705759`\)}}, \
{{107, 50.746556941058145`}, {34, 2.1742753712254625`}}}}, {{10, 13, 
          54.000000000002444`}, {{{127, 
              8.8787554718823`}, {\(-21\), \(-15.458139159419844`\)}}, {{106, 
              55.11215444320953`}, {33, 23.246818149251425`}}}}, {{10, 18, 
          53.99999999999825`}, {{{125, 
              14.264719159015726`}, {\(-19\), \(-32.36134534434889`\)}}, \
{{106, 3.7858909022224907`}, {32, 34.76422458485757`}}}}, {{10, 23, 
          54.000000000006644`}, {{{123, 
              18.024135747008927`}, {\(-17\), \(-42.48310654980045`\)}}, \
{{105, 16.74546443913073`}, {31, 36.239154504358666`}}}}, {{10, 28, 
          54.000000000002444`}, {{{121, 
              19.773951827618816`}, {\(-15\), \(-44.62458757556931`\)}}, \
{{104, 34.114780463537784`}, {30, 26.769248059148865`}}}}, {{10, 33, 
          53.99999999999805`}, {{{119, 
              18.948544132143468`}, {\(-13\), \(-37.04762711799624`\)}}, \
{{103, 56.21065051746086`}, {29, 4.888319176697067`}}}}, {{10, 38, 
          54.00000000000684`}, {{{117, 
              14.677326531663084`}, {\(-11\), \(-17.10772061301398`\)}}, \
{{103, 23.678765973113514`}, {27, 28.178293834605768`}}}}, {{10, 43, 
          54.000000000002444`}, {{{115, 
              5.523090262590813`}, {\(-8\), \(-40.47607020049181`\)}}, {{102, 
              57.743438054716876`}, {25, 32.5217510345162`}}}}, {{10, 48, 
          53.99999999999805`}, {{{112, 
              48.81979962011002`}, {\(-5\), \(-39.18213876384472`\)}}, {{102, 
              40.881607719310296`}, {23, 10.119928375051686`}}}}, {{10, 53, 
          54.00000000000684`}, {{{110, 
              18.430858234453353`}, {\(-1\), \(-55.020292822857684`\)}}, \
{{102, 39.04938143648309`}, {20, 2.942153314127083`}}}}, {{10, 58, 
          54.000000000002444`}, {{{107, 10.040888111876427`}, {3, 
              43.47149602869622`}}, {{103, 16.403161294923336`}, {14, 
              59.66650324355445`}}}}}\)], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de m\[AAcute]ximo de eclipse al orto/ocaso (suponiendo dichos \
puntos en el plano fundamental, es decir, asimilando el cono a un cilindro y \
englobando el error dentro de las imprecisiones debidas a la \
refracci\[OAcute]n). 
\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(puntoslimitemaxhor = 
      Map[maxhorbis, {t1maxpen, t2maxpen, t3maxpen, 
          t4maxpen}]\), "\[IndentingNewLine]", 
    \(puntoscurvcensommaxhor = 
      Map[maxhor, {t1maxsom, t2maxsom, t3maxsom, 
          t4maxsom}]\), "\[IndentingNewLine]", 
    \(curvasmaxhor = Map[maxhor, intervalosminuto]\)}], "Input"],

Cell[BoxData[
    \({{{5, 54, 
          29.035786110049024`}, {{{3, 
              18.8859619919533`}, {\(-3\), \(-34.19985574733311`\)}}}}, {{7, 
          2, 43.218056575650294`}, {{{\(-71\), \(-12.895597707691593`\)}, \
{\(-68\), \(-33.78551580934243`\)}}}}, {{8, 54, 
          59.09691539111797`}, {{{153, 
              34.18333251155502`}, {\(-36\), \(-10.156043687486829`\)}}}}, \
{{10, 2, 32.67109493237214`}, {{{109, 6.4264896935867455`}, {34, 
              41.0012354130555`}}}}}\)], "Output"],

Cell[BoxData[
    \({{{6, 4, 
          28.422014078786834`}, {{{\(-10\), \(-39.42601687803208`\)}, \
{\(-33\), \(-10.643357702408167`\)}}}}, {{6, 7, 
          9.18351442724471`}, {{{\(-12\), \(-45.30615058832595`\)}, {\(-35\), \
\(-58.99520470712602`\)}}}}, {{9, 50, 
          12.837277005382797`}, {{{124, 50.11523344432533`}, {2, 
              14.435349489411866`}}}}, {{9, 52, 
          52.00637144357447`}, {{{123, 12.065848558993082`}, {5, 
              7.6353891416559705`}}}}}\)], "Output"],

Cell[BoxData[
    RowBox[{\(LessEqual::"nord"\), \(\(:\)\(\ \)\), "\<\"Invalid comparison \
with \\!\\(\\(\\(0.6562400245128618`\[InvisibleSpace]\\)\\) + \
\\(\\(1.0513338714760847`\\\\ \[ImaginaryI]\\)\\)\\) attempted. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::nord\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(LessEqual::"nord"\), \(\(:\)\(\ \)\), "\<\"Invalid comparison \
with \\!\\(\\(\\(0.6562400245128618`\[InvisibleSpace]\\)\\) - \
\\(\\(1.0513338714760847`\\\\ \[ImaginaryI]\\)\\)\\) attempted. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::nord\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(LessEqual::"nord"\), \(\(:\)\(\ \)\), "\<\"Invalid comparison \
with \\!\\(\\(\\(0.6524124805831369`\[InvisibleSpace]\\)\\) + \
\\(\\(1.0410925499025554`\\\\ \[ImaginaryI]\\)\\)\\) attempted. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::nord\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(LessEqual :: \\\"nord\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    \({{{4, 53, 54.00000000000045`}, {}}, {{4, 54, 
          54.00000000000005`}, {}}, {{4, 55, 54.00000000000005`}, {}}, {{4, 
          56, 53.999999999999645`}, {}}, {{4, 57, 
          53.999999999999645`}, {}}, {{4, 58, 53.99999999999925`}, {}}, {{4, 
          59, 53.99999999999925`}, {}}, {{5, 0, 
          53.99999999999885`}, {}}, {{5, 1, 53.999999999998636`}, {}}, {{5, 
          2, 53.99999999999842`}, {}}, {{5, 3, 53.9999999999982`}, {}}, {{5, 
          4, 53.999999999997996`}, {}}, {{5, 5, 
          54.000000000000995`}, {}}, {{5, 6, 53.99999999999755`}, {}}, {{5, 
          7, 54.00000000000055`}, {}}, {{5, 8, 54.00000000000035`}, {}}, {{5, 
          9, 54.00000000000015`}, {}}, {{5, 10, 
          53.99999999999995`}, {}}, {{5, 11, 53.99999999999975`}, {}}, {{5, 
          12, 53.999999999999446`}, {}}, {{5, 13, 
          53.99999999999925`}, {}}, {{5, 14, 53.99999999999905`}, {}}, {{5, 
          15, 53.99999999999885`}, {}}, {{5, 16, 
          53.99999999999865`}, {}}, {{5, 17, 53.99999999999845`}, {}}, {{5, 
          18, 53.99999999999825`}, {}}, {{5, 19, 
          53.99999999999805`}, {}}, {{5, 20, 54.000000000001044`}, {}}, {{5, 
          21, 53.99999999999765`}, {}}, {{5, 22, 
          54.00000000000065`}, {}}, {{5, 23, 54.00000000000025`}, {}}, {{5, 
          24, 54.00000000000005`}, {}}, {{5, 25, 
          53.99999999999985`}, {}}, {{5, 26, 53.999999999999645`}, {}}, {{5, 
          27, 53.999999999999446`}, {}}, {{5, 28, 
          53.99999999999925`}, {}}, {{5, 29, 53.99999999999905`}, {}}, {{5, 
          30, 53.99999999999885`}, {}}, {{5, 31, 
          53.99999999999845`}, {}}, {{5, 32, 53.99999999999845`}, {}}, {{5, 
          33, 53.99999999999805`}, {}}, {{5, 34, 
          53.99999999999805`}, {}}, {{5, 35, 54.000000000000846`}, {}}, {{5, 
          36, 53.99999999999765`}, {}}, {{5, 37, 
          54.00000000000045`}, {}}, {{5, 38, 54.00000000000045`}, {}}, {{5, 
          39, 54.00000000000005`}, {}}, {{5, 40, 
          54.00000000000005`}, {}}, {{5, 41, 53.999999999999645`}, {}}, {{5, 
          42, 53.999999999999645`}, {}}, {{5, 43, 
          53.99999999999925`}, {}}, {{5, 44, 53.99999999999925`}, {}}, {{5, 
          45, 53.99999999999885`}, {}}, {{5, 46, 
          53.99999999999845`}, {}}, {{5, 47, 53.99999999999845`}, {}}, {{5, 
          48, 53.99999999999805`}, {}}, {{5, 49, 
          53.99999999999805`}, {}}, {{5, 50, 54.000000000000846`}, {}}, {{5, 
          51, 53.99999999999765`}, {}}, {{5, 52, 
          54.00000000000045`}, {}}, {{5, 53, 
          54.00000000000045`}, {{{2, 
              35.80651980862488`}, {\(-6\), \(-7.461630328750193`\)}}, {{0, \
\(-7.176593139683395`\)}, {\(-13\), \(-56.659143830506906`\)}}}}, {{5, 54, 
          54.00000000000005`}, {{{\(-1\), \(-49.43308823387687`\)}, {\(-17\), \
\(-55.821559119754696`\)}}}}, {{5, 55, 
          54.00000000000005`}, {{{\(-3\), \(-3.4710661267167264`\)}, \
{\(-20\), \(-31.549187867085777`\)}}}}, {{5, 56, 
          53.999999999999645`}, {{{\(-4\), \(-7.684161400952103`\)}, \
{\(-22\), \(-37.232557488386604`\)}}}}, {{5, 57, 
          53.999999999999645`}, {{{\(-5\), \(-6.365606249171449`\)}, \
{\(-24\), \(-25.482461960423493`\)}}}}, {{5, 58, 
          53.99999999999925`}, {{{\(-6\), \(-1.6305857099952448`\)}, \
{\(-26\), \(-2.42530654371663`\)}}}}, {{5, 59, 
          53.99999999999925`}, {{{\(-6\), \(-54.46993943745879`\)}, {\(-27\), \
\(-30.99743911734734`\)}}}}, {{6, 0, 
          53.99999999999885`}, {{{\(-7\), \(-45.53973546681165`\)}, {\(-28\), \
\(-53.120471085659986`\)}}}}, {{6, 1, 
          53.999999999998636`}, {{{\(-8\), \(-35.36983947838582`\)}, \
{\(-30\), \(-10.273679416395751`\)}}}}, {{6, 2, 
          53.99999999999842`}, {{{\(-9\), \(-24.147589230629407`\)}, \
{\(-31\), \(-23.081250218606684`\)}}}}, {{6, 3, 
          53.9999999999982`}, {{{\(-10\), \(-12.160503082241831`\)}, \
{\(-32\), \(-32.33095191368491`\)}}}}, {{6, 4, 
          53.999999999997996`}, {{{\(-10\), \(-59.580596025862604`\)}, {\(-33\
\), \(-38.51364704554328`\)}}}}, {{6, 5, 
          54.000000000000995`}, {{{\(-11\), \(-46.587070718358135`\)}, {\(-34\
\), \(-42.09669655000354`\)}}}}, {{6, 6, 
          53.99999999999755`}, {{{\(-12\), \(-33.48009149930487`\)}, \
{\(-35\), \(-43.74081485001312`\)}}}}, {{6, 7, 
          54.00000000000055`}, {{{\(-13\), \(-20.113948052242847`\)}, \
{\(-36\), \(-43.218915276702745`\)}}}}, {{6, 8, 
          54.00000000000035`}, {{{\(-14\), \(-6.556485813675685`\)}, \
{\(-37\), \(-40.72091289938541`\)}}}}, {{6, 9, 
          54.00000000000015`}, {{{\(-14\), \(-52.94189172865991`\)}, \
{\(-38\), \(-36.53998835617415`\)}}}}, {{6, 10, 
          53.99999999999995`}, {{{\(-15\), \(-39.2247550842071`\)}, {\(-39\), \
\(-30.638334520418482`\)}}}}, {{6, 11, 
          53.99999999999975`}, {{{\(-16\), \(-25.623050207609452`\)}, \
{\(-40\), \(-23.424490525044774`\)}}}}, {{6, 12, 
          53.999999999999446`}, {{{\(-17\), \(-12.047344474583497`\)}, {\(-41\
\), \(-14.77143656667323`\)}}}}, {{6, 13, 
          53.99999999999925`}, {{{\(-17\), \(-58.5901137002962`\)}, {\(-42\), \
\(-4.855384988312608`\)}}}}, {{6, 14, 
          53.99999999999905`}, {{{\(-18\), \(-45.29772261108569`\)}, \
{\(-42\), \(-53.76670215619839`\)}}}}, {{6, 15, 
          53.99999999999885`}, {{{\(-19\), \(-32.23755394644634`\)}, \
{\(-43\), \(-41.61988908857907`\)}}}}, {{6, 16, 
          53.99999999999865`}, {{{\(-20\), \(-19.418145888466114`\)}, \
{\(-44\), \(-28.434745436222215`\)}}}}, {{6, 17, 
          53.99999999999845`}, {{{\(-21\), \(-6.889575071194258`\)}, \
{\(-45\), \(-14.289182451756801`\)}}}}, {{6, 18, 
          53.99999999999825`}, {{{\(-21\), \(-54.7211672430565`\)}, {\(-45\), \
\(-59.27995406650254`\)}}}}, {{6, 19, 
          53.99999999999805`}, {{{\(-22\), \(-42.89623929345531`\)}, \
{\(-46\), \(-43.38195701616016`\)}}}}, {{6, 20, 
          54.000000000001044`}, {{{\(-23\), \(-31.456259044414026`\)}, {\(-47\
\), \(-26.647885242292233`\)}}}}, {{6, 21, 
          53.99999999999765`}, {{{\(-24\), \(-20.38024088632909`\)}, \
{\(-48\), \(-9.049008571080748`\)}}}}, {{6, 22, 
          54.00000000000065`}, {{{\(-25\), \(-9.837651025231366`\)}, \
{\(-48\), \(-50.78844150171676`\)}}}}, {{6, 23, 
          54.00000000000025`}, {{{\(-25\), \(-59.85757154133495`\)}, \
{\(-49\), \(-31.88346313271154`\)}}}}, {{6, 24, 
          54.00000000000005`}, {{{\(-26\), \(-50.22156122758112`\)}, \
{\(-50\), \(-12.072197628706363`\)}}}}, {{6, 25, 
          
          53.99999999999985`}, {{{\(-27\), \(-41.32381612570214`\)}, \
{\(-50\), \(-51.78950837243818`\)}}}}, {{6, 26, 
          53.999999999999645`}, {{{\(-28\), \(-32.790250576975595`\)}, {\(-51\
\), \(-30.611881572733353`\)}}}}, {{6, 27, 
          53.999999999999446`}, {{{\(-29\), \(-25.120521061617964`\)}, {\(-52\
\), \(-9.05395808792278`\)}}}}, {{6, 28, 
          53.99999999999925`}, {{{\(-30\), \(-18.13227991127107`\)}, \
{\(-52\), \(-46.89731135410824`\)}}}}, {{6, 29, 
          53.99999999999905`}, {{{\(-31\), \(-11.746377016032952`\)}, \
{\(-53\), \(-24.048074527984227`\)}}}}, {{6, 30, 
          53.99999999999885`}, {{{\(-32\), \(-5.93392741302722`\)}, {\(-54\), \
\(-0.47093533222451356`\)}}}}, {{6, 31, 
          53.99999999999845`}, {{{\(-33\), \(-1.1902568651299816`\)}, \
{\(-54\), \(-36.597799190629274`\)}}}}, {{6, 32, 
          53.99999999999845`}, {{{\(-33\), \(-57.145853852019144`\)}, \
{\(-55\), \(-12.065745814163478`\)}}}}, {{6, 33, 
          54.00000000000125`}, {{{\(-34\), \(-53.7037084526564`\)}, {\(-55\), \
\(-46.78355921045622`\)}}}}, {{6, 34, 
          53.99999999999805`}, {{{\(-35\), \(-51.21943963402998`\)}, \
{\(-56\), \(-21.031385689245496`\)}}}}, {{6, 35, 
          54.000000000000846`}, {{{\(-36\), \(-50.10392073833842`\)}, \
{\(-56\), \(-55.09159151713959`\)}}}}, {{6, 36, 
          53.99999999999765`}, {{{\(-37\), \(-49.37278855534174`\)}, \
{\(-57\), \(-28.18004165119504`\)}}}}, {{6, 37, 
          54.00000000000045`}, {{{\(-38\), \(-49.891024716978905`\)}, \
{\(-58\), \(-0.9305820394327213`\)}}}}, {{6, 38, 
          53.99999999999725`}, {{{\(-39\), \(-51.49767677116046`\)}, \
{\(-58\), \(-33.18794304166232`\)}}}}, {{6, 39, 
          54.00000000000005`}, {{{\(-40\), \(-54.079374994915526`\)}, \
{\(-59\), \(-4.848581180311982`\)}}}}, {{6, 40, 
          54.00000000000005`}, {{{\(-41\), \(-57.66152499510014`\)}, \
{\(-59\), \(-35.91036469980793`\)}}}}, {{6, 41, 
          53.999999999999645`}, {{{\(-43\), \(-2.683697053327876`\)}, \
{\(-60\), \(-6.619911239100134`\)}}}}, {{6, 42, 
          53.999999999999645`}, {{{\(-44\), \(-8.742411000944088`\)}, \
{\(-60\), \(-36.69712666093133`\)}}}}, {{6, 43, 
          53.99999999999925`}, {{{\(-45\), \(-16.31107217312831`\)}, \
{\(-61\), \(-6.389039391162754`\)}}}}, {{6, 44, 
          53.99999999999925`}, {{{\(-46\), \(-24.855572583677485`\)}, \
{\(-61\), \(-35.36728250198465`\)}}}}, {{6, 45, 
          53.99999999999885`}, {{{\(-47\), \(-34.82995561852363`\)}, \
{\(-62\), \(-3.856607067632325`\)}}}}, {{6, 46, 
          53.99999999999845`}, {{{\(-48\), \(-45.92580064887116`\)}, \
{\(-62\), \(-31.673956689587186`\)}}}}, {{6, 47, 
          53.99999999999845`}, {{{\(-49\), \(-59.36873866982836`\)}, \
{\(-62\), \(-59.37630828770125`\)}}}}, {{6, 48, 
          54.00000000000125`}, {{{\(-51\), \(-13.211581894845779`\)}, \
{\(-63\), \(-26.01717539154592`\)}}}}, {{6, 49, 
          53.99999999999805`}, {{{\(-52\), \(-29.332311834284468`\)}, \
{\(-63\), \(-52.42818855166746`\)}}}}, {{6, 50, 
          54.000000000000846`}, {{{\(-53\), \(-46.33581661026611`\)}, \
{\(-64\), \(-17.975715187371577`\)}}}}, {{6, 51, 
          53.99999999999765`}, {{{\(-55\), \(-5.718316800051895`\)}, \
{\(-64\), \(-43.245586695676934`\)}}}}, {{6, 52, 
          54.00000000000045`}, {{{\(-56\), \(-25.978722232009375`\)}, \
{\(-65\), \(-7.621070263721208`\)}}}}, {{6, 53, 
          53.99999999999725`}, {{{\(-57\), \(-48.70426872315505`\)}, \
{\(-65\), \(-31.667824816400696`\)}}}}, {{6, 54, 
          54.00000000000005`}, {{{\(-59\), \(-12.623788856426756`\)}, \
{\(-65\), \(-54.901681846942836`\)}}}}, {{6, 55, 
          54.00000000000005`}, {{{\(-60\), \(-38.79270114497956`\)}, \
{\(-66\), \(-17.65426717943427`\)}}}}, {{6, 56, 
          53.999999999999645`}, {{{\(-62\), \(-6.137521617148565`\)}, \
{\(-66\), \(-39.56108237548051`\)}}}}, {{6, 57, 
          53.999999999999645`}, {{{\(-63\), \(-34.85808567306577`\)}, \
{\(-67\), \(-0.6849491549354525`\)}}}}, {{6, 58, 
          53.99999999999925`}, {{{\(-65\), \(-7.061433506668777`\)}, \
{\(-67\), \(-21.57760493958648`\)}}}}, {{6, 59, 
          53.99999999999925`}, {{{\(-66\), \(-40.247326161516526`\)}, \
{\(-67\), \(-41.52334496575463`\)}}}}, {{7, 0, 
          
          53.99999999999885`}, {{{\(-68\), \(-15.400638197110368`\)}, \
{\(-68\), \(-0.7713816659023109`\)}}}}, {{7, 1, 
          53.999999999998636`}, {{{\(-69\), \(-51.41853218014859`\)}, \
{\(-68\), \(-19.05776549031856`\)}}}}, {{7, 2, 53.99999999999842`}, {}}, {{7, 
          3, 54.0000000000014`}, {}}, {{7, 4, 53.999999999997996`}, {}}, {{7, 
          5, 54.000000000000995`}, {}}, {{7, 6, 
          53.99999999999755`}, {}}, {{7, 7, 54.00000000000055`}, {}}, {{7, 8, 
          53.99999999999715`}, {}}, {{7, 9, 54.00000000000015`}, {}}, {{7, 
          10, 53.99999999999995`}, {}}, {{7, 11, 
          53.99999999999975`}, {}}, {{7, 12, 53.999999999999446`}, {}}, {{7, 
          13, 53.99999999999925`}, {}}, {{7, 14, 
          53.99999999999905`}, {}}, {{7, 15, 53.99999999999885`}, {}}, {{7, 
          16, 53.99999999999865`}, {}}, {{7, 17, 
          53.99999999999845`}, {}}, {{7, 18, 54.00000000000145`}, {}}, {{7, 
          19, 53.99999999999805`}, {}}, {{7, 20, 
          54.000000000001044`}, {}}, {{7, 21, 53.99999999999765`}, {}}, {{7, 
          22, 54.00000000000065`}, {}}, {{7, 23, 
          53.99999999999705`}, {}}, {{7, 24, 54.00000000000005`}, {}}, {{7, 
          25, 53.99999999999985`}, {}}, {{7, 26, 
          53.999999999999645`}, {}}, {{7, 27, 53.999999999999446`}, {}}, {{7, 
          28, 53.99999999999925`}, {}}, {{7, 29, 
          53.99999999999905`}, {}}, {{7, 30, 53.99999999999885`}, {}}, {{7, 
          31, 53.99999999999845`}, {}}, {{7, 32, 
          53.99999999999845`}, {}}, {{7, 33, 54.00000000000125`}, {}}, {{7, 
          34, 53.99999999999805`}, {}}, {{7, 35, 
          54.000000000000846`}, {}}, {{7, 36, 53.99999999999765`}, {}}, {{7, 
          37, 54.00000000000045`}, {}}, {{7, 38, 
          53.99999999999725`}, {}}, {{7, 39, 54.00000000000005`}, {}}, {{7, 
          40, 54.00000000000005`}, {}}, {{7, 41, 
          53.999999999999645`}, {}}, {{7, 42, 53.999999999999645`}, {}}, {{7, 
          43, 53.99999999999925`}, {}}, {{7, 44, 
          53.99999999999925`}, {}}, {{7, 45, 53.99999999999885`}, {}}, {{7, 
          46, 53.99999999999845`}, {}}, {{7, 47, 
          53.99999999999845`}, {}}, {{7, 48, 54.00000000000125`}, {}}, {{7, 
          49, 53.99999999999805`}, {}}, {{7, 50, 
          54.000000000000846`}, {}}, {{7, 51, 53.99999999999765`}, {}}, {{7, 
          52, 54.00000000000045`}, {}}, {{7, 53, 
          53.99999999999725`}, {}}, {{7, 54, 54.00000000000005`}, {}}, {{7, 
          55, 54.00000000000005`}, {}}, {{7, 56, 
          53.999999999999645`}, {}}, {{7, 57, 53.999999999999645`}, {}}, {{7, 
          58, 53.99999999999925`}, {}}, {{7, 59, 
          53.99999999999605`}, {}}, {{8, 0, 54.000000000002046`}, {}}, {{8, 
          1, 54.00000000000503`}, {}}, {{8, 2, 54.00000000000162`}, {}}, {{8, 
          3, 54.0000000000046`}, {}}, {{8, 4, 54.000000000001194`}, {}}, {{8, 
          5, 54.00000000000419`}, {}}, {{8, 6, 
          54.000000000000746`}, {}}, {{8, 7, 54.000000000003745`}, {}}, {{8, 
          8, 54.00000000000035`}, {}}, {{8, 9, 54.00000000000335`}, {}}, {{8, 
          10, 53.99999999999995`}, {}}, {{8, 11, 
          54.00000000000295`}, {}}, {{8, 12, 54.00000000000584`}, {}}, {{8, 
          13, 54.000000000002444`}, {}}, {{8, 14, 
          53.99999999999905`}, {}}, {{8, 15, 54.000000000002046`}, {}}, {{8, 
          16, 54.000000000005045`}, {}}, {{8, 17, 
          54.00000000000165`}, {}}, {{8, 18, 54.00000000000465`}, {}}, {{8, 
          19, 54.00000000000125`}, {}}, {{8, 20, 
          54.00000000000424`}, {}}, {{8, 21, 54.000000000000846`}, {}}, {{8, 
          22, 54.000000000003844`}, {}}, {{8, 23, 
          54.00000000000025`}, {}}, {{8, 24, 54.00000000000325`}, {}}, {{8, 
          25, 53.99999999999985`}, {}}, {{8, 26, 
          54.00000000000284`}, {}}, {{8, 27, 54.00000000000584`}, {}}, {{8, 
          28, 54.000000000002444`}, {}}, {{8, 29, 
          53.99999999999905`}, {}}, {{8, 30, 54.000000000002046`}, {}}, {{8, 
          31, 54.000000000004846`}, {}}, {{8, 32, 
          54.00000000000165`}, {}}, {{8, 33, 53.99999999999805`}, {}}, {{8, 
          34, 54.00000000000125`}, {}}, {{8, 35, 
          54.00000000000404`}, {}}, {{8, 36, 54.000000000000846`}, {}}, {{8, 
          37, 54.000000000003645`}, {}}, {{8, 38, 
          54.00000000000684`}, {}}, {{8, 39, 54.00000000000325`}, {}}, {{8, 
          40, 54.00000000000005`}, {}}, {{8, 41, 
          54.00000000000284`}, {}}, {{8, 42, 54.00000000000604`}, {}}, {{8, 
          43, 54.000000000002444`}, {}}, {{8, 44, 
          53.99999999999925`}, {}}, {{8, 45, 54.000000000002046`}, {}}, {{8, 
          46, 54.000000000004846`}, {}}, {{8, 47, 
          54.00000000000165`}, {}}, {{8, 48, 53.99999999999805`}, {}}, {{8, 
          49, 54.00000000000125`}, {}}, {{8, 50, 
          54.00000000000404`}, {}}, {{8, 51, 54.000000000000846`}, {}}, {{8, 
          52, 54.000000000003645`}, {}}, {{8, 53, 
          54.00000000000684`}, {}}, {{8, 54, 54.00000000000325`}, {}}, {{8, 
          55, 54.00000000000005`}, {{{153, 
              4.554687434939524`}, {\(-35\), \(-39.96721366808444`\)}}}}, \
{{8, 56, 54.00000000000284`}, {{{152, 
              32.421051635292315`}, {\(-35\), \(-6.970822752163031`\)}}}}, \
{{8, 57, 54.00000000000604`}, {{{152, 
              0.38072924335608604`}, {\(-34\), \(-33.66500555228669`\)}}}}, \
{{8, 58, 54.000000000002444`}, {{{151, 
              28.73704899153836`}, {\(-34\), \(-0.6609041179373776`\)}}}}, \
{{8, 59, 53.99999999999925`}, {{{150, 
              56.9409711961265`}, {\(-33\), \(-26.8761437091797`\)}}}}, {{9, 
          0, 54.000000000002046`}, {{{150, 
              25.383364467166416`}, {\(-32\), \(-53.09827545954363`\)}}}}, \
{{9, 1, 54.00000000000503`}, {{{149, 
              53.934021199057725`}, {\(-32\), \(-19.07374499896818`\)}}}}, \
{{9, 2, 54.00000000000162`}, {{{149, 
              22.58713477678441`}, {\(-31\), \(-44.7974060801328`\)}}}}, {{9, 
          3, 53.9999999999982`}, {{{148, 
              51.547961124809945`}, {\(-31\), \(-10.715563276000069`\)}}}}, \
{{9, 4, 54.000000000001194`}, {{{148, 
              20.440812861967856`}, {\(-30\), \(-36.03818556033367`\)}}}}, \
{{9, 5, 54.00000000000419`}, {{{147, 
              49.47312017136824`}, {\(-30\), \(-1.2142155828215806`\)}}}}, \
{{9, 6, 54.000000000000746`}, {{{147, 
              18.551336057298045`}, {\(-29\), \(-26.046495773493135`\)}}}}, \
{{9, 7, 54.000000000003745`}, {{{146, 
              47.99374802160628`}, {\(-28\), \(-51.25536487739616`\)}}}}, \
{{9, 8, 54.00000000000674`}, {{{146, 
              17.100227038649223`}, {\(-28\), \(-15.275699380864225`\)}}}}, \
{{9, 9, 54.00000000000335`}, {{{145, 
              46.73193174993003`}, {\(-27\), \(-40.065862822066904`\)}}}}, \
{{9, 10, 53.99999999999995`}, {{{145, 
              16.215228493861105`}, {\(-27\), \(-4.09858118538402`\)}}}}, \
{{9, 11, 54.00000000000295`}, {{{144, 
              45.77509477510887`}, {\(-26\), \(-27.893755942948104`\)}}}}, \
{{9, 12, 54.00000000000584`}, {{{144, 
              15.455617894458555`}, {\(-25\), \(-51.56451825117237`\)}}}}, \
{{9, 13, 54.000000000002444`}, {{{143, 
              45.11917283223909`}, {\(-25\), \(-14.790420781141407`\)}}}}, \
{{9, 14, 53.99999999999905`}, {{{143, 
              14.895006072202932`}, {\(-24\), \(-37.887999428143715`\)}}}}, \
{{9, 15, 54.000000000002046`}, {{{142, 
              44.73422802225912`}, {\(-24\), \(-0.7482687059503945`\)}}}}, \
{{9, 16, 54.000000000005045`}, {{{142, 
              14.609697539289073`}, {\(-23\), \(-23.312028266620715`\)}}}}, \
{{9, 17, 54.00000000000165`}, {{{141, 
              44.57302773041306`}, {\(-22\), \(-45.71543018800753`\)}}}}, \
{{9, 18, 53.99999999999825`}, {{{141, 
              14.31184220281068`}, {\(-22\), \(-7.17618251397397`\)}}}}, {{9, 
          19, 54.00000000000125`}, {{{140, 
              44.35305166639921`}, {\(-21\), \(-29.032998942223927`\)}}}}, \
{{9, 20, 54.00000000000424`}, {{{140, 
              14.281895965452236`}, {\(-20\), \(-50.23992428240312`\)}}}}, \
{{9, 21, 54.000000000000846`}, {{{139, 
              44.31214062102583`}, {\(-20\), \(-11.3525511371828`\)}}}}, {{9, 
          22, 54.000000000003844`}, {{{139, 
              14.262095654241875`}, {\(-19\), \(-31.905432809516157`\)}}}}, \
{{9, 23, 54.000000000006644`}, {{{138, 
              44.1231018226722`}, {\(-18\), \(-51.87660089252226`\)}}}}, {{9, 
          24, 54.00000000000325`}, {{{138, 
              14.078238471149689`}, {\(-18\), \(-11.757287372809486`\)}}}}, \
{{9, 25, 53.99999999999985`}, {{{137, 
              44.04306046278805`}, {\(-17\), \(-31.333598590997696`\)}}}}, \
{{9, 26, 54.00000000000284`}, {{{137, 
              14.016087942710556`}, {\(-16\), \(-50.610163846079246`\)}}}}, \
{{9, 27, 54.00000000000584`}, {{{136, 
              43.824532064426194`}, {\(-16\), \(-9.1221566749509`\)}}}}, {{9, 
          28, 54.000000000002444`}, {{{136, 
              13.514311735572733`}, {\(-15\), \(-26.995419939270455`\)}}}}, \
{{9, 29, 53.99999999999905`}, {{{135, 
              43.32709863095545`}, {\(-14\), \(-44.90514317636734`\)}}}}, \
{{9, 30, 54.000000000002046`}, {{{135, 
              13.031377855519963`}, {\(-14\), \(-2.2204177974346706`\)}}}}, \
{{9, 31, 54.000000000004846`}, {{{134, 
              42.541914540539096`}, {\(-13\), \(-18.706021479383317`\)}}}}, \
{{9, 32, 54.00000000000165`}, {{{134, 
              12.060621718385391`}, {\(-12\), \(-34.936054478260026`\)}}}}, \
{{9, 33, 53.99999999999805`}, {{{133, 
              41.43350348298554`}, {\(-11\), \(-50.48403873660902`\)}}}}, \
{{9, 34, 54.00000000000125`}, {{{133, 
              10.743220345146938`}, {\(-11\), \(-5.5932108249408685`\)}}}}, \
{{9, 35, 54.00000000000404`}, {{{132, 
              39.86029035169395`}, {\(-10\), \(-19.90124952903418`\)}}}}, \
{{9, 36, 54.000000000000846`}, {{{132, 
              8.820609996783446`}, {\(-9\), \(-33.51842936432966`\)}}}}, {{9, 
          37, 54.000000000003645`}, {{{131, 
              37.69966939604558`}, {\(-8\), \(-46.67402626009334`\)}}}}, {{9, 
          38, 54.00000000000684`}, {{{131, 
              6.301736627590344`}, {\(-7\), \(-58.80903147315438`\)}}}}, {{9, 
          39, 54.00000000000325`}, {{{130, 
              34.718500849871816`}, {\(-7\), \(-10.20039995267167`\)}}}}, \
{{9, 40, 54.00000000000005`}, {{{130, 
              2.9395583542037684`}, {\(-6\), \(-20.83058084417951`\)}}}}, \
{{9, 41, 54.00000000000284`}, {{{129, 
              30.919154868197438`}, {\(-5\), \(-30.57852096965366`\)}}}}, \
{{9, 42, 54.00000000000604`}, {{{128, 
              58.56316581036879`}, {\(-4\), \(-39.18012916551714`\)}}}}, {{9, 
          43, 54.000000000002444`}, {{{128, 
              25.95942895211749`}, {\(-3\), \(-46.911486929348754`\)}}}}, \
{{9, 44, 53.99999999999925`}, {{{127, 
              52.98235431837753`}, {\(-2\), \(-53.41906511274186`\)}}}}, {{9, 
          45, 54.000000000002046`}, {{{127, 
              19.60804379596965`}, {\(-1\), \(-58.651902094398096`\)}}}}, \
{{9, 46, 54.000000000004846`}, {{{126, 
              45.86061871733165`}, {\(-1\), \(-2.7060425666316013`\)}}}}, \
{{9, 47, 54.00000000000165`}, {{{126, 
              11.582679084054632`}, {0, \(-5.139746388865524`\)}}}}, {{9, 48, 
          53.99999999999805`}, {{{125, 36.78064523141131`}, {0, 
              53.99548388696889`}}}}, {{9, 49, 
          54.00000000000125`}, {{{125, 1.3621831700845632`}, {1, 
              54.936934628812836`}}}}, {{9, 50, 
          54.00000000000404`}, {{{124, 25.260953202649148`}, {2, 
              57.8367338589948`}}}}, {{9, 51, 
          54.000000000000846`}, {{{123, 48.416260735357355`}, {4, 
              2.820988021774671`}}}}, {{9, 52, 
          54.000000000003645`}, {{{123, 10.800243428867873`}, {5, 
              9.907376174465359`}}}}, {{9, 53, 
          54.00000000000684`}, {{{122, 32.15215642453245`}, {6, 
              19.78904815405489`}}}}, {{9, 54, 
          54.00000000000325`}, {{{121, 52.264121695497465`}, {7, 
              32.976859881342016`}}}}, {{9, 55, 
          54.00000000000005`}, {{{121, 10.826248011668156`}, {8, 
              50.24659852851453`}}}}, {{9, 56, 
          54.00000000000284`}, {{{120, 27.674627726624124`}, {10, 
              11.901154035044534`}}}}, {{9, 57, 
          54.00000000000604`}, {{{119, 42.174073401112366`}, {11, 
              39.541431401266145`}}}}, {{9, 58, 
          54.000000000002444`}, {{{118, 53.62716084096007`}, {13, 
              14.817611908579167`}}}}, {{9, 59, 
          53.99999999999925`}, {{{118, 1.0000647776922733`}, {15, 
              0.13116888944118443`}}}}, {{10, 0, 
          54.000000000002046`}, {{{117, 2.3672822302367535`}, {16, 
              59.9878816411136`}}}}, {{10, 1, 
          54.00000000000503`}, {{{115, 53.38287317676702`}, {19, 
              24.587173017411388`}}}}, {{10, 2, 
          54.00000000000162`}, {{{114, 21.406093147949434`}, {22, 
              43.05840612634398`}}, {{109, 39.51068172758511`}, {33, 
              24.276764630398162`}}}}, {{10, 3, 
          53.9999999999982`}, {}}, {{10, 4, 54.000000000001194`}, {}}, {{10, 
          5, 54.00000000000419`}, {}}, {{10, 6, 
          54.000000000000746`}, {}}, {{10, 7, 
          54.000000000003745`}, {}}, {{10, 8, 54.00000000000674`}, {}}, {{10, 
          9, 54.00000000000335`}, {}}, {{10, 10, 
          53.99999999999995`}, {}}, {{10, 11, 54.00000000000295`}, {}}, {{10, 
          12, 54.00000000000584`}, {}}, {{10, 13, 
          54.000000000002444`}, {}}, {{10, 14, 
          53.99999999999905`}, {}}, {{10, 15, 
          54.000000000002046`}, {}}, {{10, 16, 
          54.000000000005045`}, {}}, {{10, 17, 
          54.00000000000165`}, {}}, {{10, 18, 53.99999999999825`}, {}}, {{10, 
          19, 54.00000000000125`}, {}}, {{10, 20, 
          54.00000000000424`}, {}}, {{10, 21, 
          54.000000000000846`}, {}}, {{10, 22, 
          54.000000000003844`}, {}}, {{10, 23, 
          54.000000000006644`}, {}}, {{10, 24, 
          54.00000000000325`}, {}}, {{10, 25, 53.99999999999985`}, {}}, {{10, 
          26, 54.00000000000284`}, {}}, {{10, 27, 
          54.00000000000584`}, {}}, {{10, 28, 
          54.000000000002444`}, {}}, {{10, 29, 
          53.99999999999905`}, {}}, {{10, 30, 
          54.000000000002046`}, {}}, {{10, 31, 
          54.000000000004846`}, {}}, {{10, 32, 
          54.00000000000165`}, {}}, {{10, 33, 53.99999999999805`}, {}}, {{10, 
          34, 54.00000000000125`}, {}}, {{10, 35, 
          54.00000000000404`}, {}}, {{10, 36, 
          54.000000000000846`}, {}}, {{10, 37, 
          54.000000000003645`}, {}}, {{10, 38, 
          54.00000000000684`}, {}}, {{10, 39, 54.00000000000325`}, {}}, {{10, 
          40, 54.00000000000005`}, {}}, {{10, 41, 
          54.00000000000284`}, {}}, {{10, 42, 54.00000000000604`}, {}}, {{10, 
          43, 54.000000000002444`}, {}}, {{10, 44, 
          53.99999999999925`}, {}}, {{10, 45, 
          54.000000000002046`}, {}}, {{10, 46, 
          54.000000000004846`}, {}}, {{10, 47, 
          54.00000000000165`}, {}}, {{10, 48, 53.99999999999805`}, {}}, {{10, 
          49, 54.00000000000125`}, {}}, {{10, 50, 
          54.00000000000404`}, {}}, {{10, 51, 
          54.000000000000846`}, {}}, {{10, 52, 
          54.000000000003645`}, {}}, {{10, 53, 
          54.00000000000684`}, {}}, {{10, 54, 54.00000000000325`}, {}}, {{10, 
          55, 54.00000000000005`}, {}}, {{10, 56, 
          54.00000000000284`}, {}}, {{10, 57, 54.00000000000604`}, {}}, {{10, 
          58, 54.000000000002444`}, {}}, {{10, 59, 
          53.99999999999925`}, {}}, {{11, 0, 54.000000000002046`}, {}}, {{11, 
          1, 54.00000000000503`}, {}}, {{11, 2, 
          54.00000000000162`}, {}}}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de puntos de corte cono de penumbra con elipsoide para un \
instante determinado.\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(corteconopelip[3.5]\)], "Input"],

Cell[BoxData[
    \({{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {{{118, 
            1.4531756470805135`}, {\(-65\), \(-11.197957852031664`\)}}, \
{{110, 28.258895300097038`}, {\(-70\), \(-5.294713538703206`\)}}}, {{{122, 
            3.6331258153614954`}, {\(-56\), \(-3.3853533572178662`\)}}, {{83, 
            31.443094485962888`}, {\(-74\), \(-54.48932104597844`\)}}}, \
{{{121, 54.07809657613967`}, {\(-50\), \(-52.843039015552904`\)}}, {{63, 
            55.629672133623274`}, {\(-74\), \(-34.16052282539084`\)}}}, \
{{{121, 3.639624274758546`}, {\(-46\), \(-39.80888409302736`\)}}, {{50, 
            29.68199848399081`}, {\(-72\), \(-40.456523610864394`\)}}}, \
{{{119, 55.58700211970745`}, {\(-42\), \(-56.46711723455397`\)}}, {{41, 
            45.64170987168481`}, {\(-70\), \(-6.8553742592513345`\)}}}, \
{{{118, 37.17898542845944`}, {\(-39\), \(-31.740922482142082`\)}}, {{36, 
            4.152554054133475`}, {\(-67\), \(-15.732189844176219`\)}}}, \
{{{117, 11.289338237762934`}, {\(-36\), \(-19.91670973116271`\)}}, {{32, 
            18.49189967373917`}, {\(-64\), \(-16.554433014483152`\)}}}, \
{{{115, 39.09558356052713`}, {\(-33\), \(-17.62547856955834`\)}}, {{29, 
            48.64334207955622`}, {\(-61\), \(-13.359130566900319`\)}}}, \
{{{114, 0.9629572124575247`}, {\(-30\), \(-22.717600383222774`\)}}, {{28, 
            10.743433445647597`}, {\(-58\), \(-7.816841250442366`\)}}}, \
{{{27, 10.237573811642733`}, {\(-55\), \(-0.5045085990411735`\)}}, {{112, 
            16.79134995303059`}, {\(-27\), \(-33.75779780134778`\)}}}, {{{26, 
            38.03396337707092`}, {\(-51\), \(-51.45560999722932`\)}}, {{110, 
            26.160788645150888`}, {\(-24\), \(-49.77131885129758`\)}}}, \
{{{26, 28.381673063720143`}, {\(-48\), \(-40.40543976837242`\)}}, {{108, 
            28.385633882917034`}, {\(-22\), \(-10.1083357682284`\)}}}, {{{26, 
            37.68805956162417`}, {\(-45\), \(-26.898505418424747`\)}}, {{106, 
            22.517381371058605`}, {\(-19\), \(-34.37179194681718`\)}}}, \
{{{27, 3.8588175785349677`}, {\(-42\), \(-10.326766959742457`\)}}, {{104, 
            7.3085006835040645`}, {\(-17\), \(-2.384869058410999`\)}}}, \
{{{27, 45.94913330744312`}, {\(-38\), \(-49.9261094447526`\)}}, {{101, 
            41.13473229472959`}, {\(-14\), \(-34.189084351397625`\)}}}, \
{{{28, 44.02764304940007`}, {\(-35\), \(-24.737886182677187`\)}}, {{99, 
            1.859008063185854`}, {\(-12\), \(-10.073852008661746`\)}}}, \
{{{29, 59.2292680556875`}, {\(-31\), \(-53.52699924129318`\)}}, {{96, 
            6.597200887733834`}, {\(-9\), \(-50.6492637292936`\)}}}, {{{31, 
            34.04996050567554`}, {\(-28\), \(-14.626329421332613`\)}}, {{92, 
            51.296155012509814`}, {\(-7\), \(-36.99364465248724`\)}}}, {{{33, 
            33.08025394534809`}, {\(-24\), \(-25.628112485270194`\)}}, {{89, 
            9.905356950022508`}, {\(-5\), \(-30.955922617453417`\)}}}, {{{36, 
            4.784198114802649`}, {\(-20\), \(-22.694674297817627`\)}}, {{84, 
            52.52213831626307`}, {\(-3\), \(-35.840812735703665`\)}}}, {{{39, 
            26.544003413339112`}, {\(-15\), \(-58.67316066659594`\)}}, {{79, 
            40.28124138186001`}, {\(-1\), \(-58.29264129690349`\)}}}, {{{44, 
            25.291904755499672`}, {\(-10\), \(-55.53480459230126`\)}}, {{72, 
            44.661149689994204`}, {0, \(-55.85794553679725`\)}}}, {}, {}, {}}\
\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["C\[AAcute]lculo de curvas l\[IAcute]mite (penumbra y sombra) Norte y \
Sur.", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(extresmospuntoslimitep = 
      Map[maxhorbis, {t1maxpen, t2maxpen, t3maxpen, t4maxpen}]\)], "Input"],

Cell[BoxData[
    \({{{{3, 
            18.8859619919533`}, {\(-3\), \(-34.19985574733311`\)}}}, {{{\(-71\
\), \(-12.895597707691593`\)}, {\(-68\), \(-33.78551580934243`\)}}}, {{{153, 
            34.18333251155502`}, {\(-36\), \(-10.156043687486829`\)}}}, \
{{{109, 6.4264896935867455`}, {34, 41.0012354130555`}}}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(curvaslimitep = 
      Map[puntoslimitep, 
        Take[intervalosminuto, {1, Length[intervalosminuto], 5}]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(Solve::"ifun"\), \(\(:\)\(\ \)\), "\<\"Inverse functions are \
being used by \\!\\(Solve\\), so some solutions may not be found; use Reduce \
for complete solution information. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"Solve::ifun\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(Solve::"ifun"\), \(\(:\)\(\ \)\), "\<\"Inverse functions are \
being used by \\!\\(Solve\\), so some solutions may not be found; use Reduce \
for complete solution information. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"Solve::ifun\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(Solve::"ifun"\), \(\(:\)\(\ \)\), "\<\"Inverse functions are \
being used by \\!\\(Solve\\), so some solutions may not be found; use Reduce \
for complete solution information. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"Solve::ifun\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Solve :: \\\"ifun\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \({{{4, 53, 54.00000000000045`}, {}}, {{4, 58, 
          53.99999999999925`}, {}}, {{5, 3, 53.9999999999982`}, {}}, {{5, 8, 
          54.00000000000035`}, {}}, {{5, 13, 53.99999999999925`}, {}}, {{5, 
          18, 53.99999999999825`}, {}}, {{5, 23, 
          54.00000000000025`}, {}}, {{5, 28, 53.99999999999925`}, {}}, {{5, 
          33, 53.99999999999805`}, {}}, {{5, 38, 
          54.00000000000045`}, {}}, {{5, 43, 53.99999999999925`}, {}}, {{5, 
          48, 53.99999999999805`}, {}}, {{5, 53, 
          54.00000000000045`}, {}}, {{5, 58, 
          53.99999999999925`}, {{{13, 
              42.2008153407144`}, {\(-6\), \(-58.921728769497804`\)}}}}, {{6, 
          3, 53.9999999999982`}, {{{18, 
              50.11203489945508`}, {\(-8\), \(-21.716930809136734`\)}}}}, \
{{6, 8, 54.00000000000035`}, {{{22, 
              29.504247770495695`}, {\(-9\), \(-11.81671308010646`\)}}}}, \
{{6, 13, 53.99999999999925`}, {{{25, 
              23.942310581357447`}, {\(-9\), \(-45.13189343075506`\)}}}}, \
{{6, 18, 53.99999999999825`}, {{{27, 
              50.44318451521114`}, {\(-10\), \(-7.8595501250752875`\)}}}}, \
{{6, 23, 54.00000000000025`}, {{{29, 
              56.93742579410056`}, {\(-10\), \(-23.030543609493748`\)}}}}, \
{{6, 28, 53.99999999999925`}, {{{31, 
              49.10155755050468`}, {\(-10\), \(-32.58047424654109`\)}}}}, \
{{6, 33, 54.00000000000125`}, {{{33, 
              29.875847700469933`}, {\(-10\), \(-37.64067590448807`\)}}}}, \
{{6, 38, 53.99999999999725`}, {{{35, 
              0.8753330542216986`}, {\(-10\), \(-39.04441432666012`\)}}}}, \
{{6, 43, 53.99999999999925`}, {{{36, 
              24.165862050768965`}, {\(-10\), \(-37.41494545786093`\)}}}}, \
{{6, 48, 54.00000000000125`}, {{{37, 
              41.56166171639185`}, {\(-10\), \(-33.1658244670739`\)}}}}, {{6, 
          53, 53.99999999999725`}, {{{38, 
              53.047711508119875`}, {\(-10\), \(-26.691321139195487`\)}}}}, \
{{6, 58, 53.99999999999925`}, {{{40, 
              0.20367079706261393`}, {\(-10\), \(-18.19446777636344`\)}}}}, \
{{7, 3, 54.0000000000014`}, {{{\(-57\), \(-48.54979734711179`\)}, {\(-76\), \
\(-12.330767240596003`\)}}, {{41, 
              3.2273793425287067`}, {\(-10\), \(-7.9207663248877935`\)}}}}, \
{{7, 8, 53.99999999999715`}, {{{\(-34\), \(-32.047330190380166`\)}, {\(-82\), \
\(-59.54609819021101`\)}}, {{42, 
              3.024084837906713`}, {\(-9\), \(-55.97207807212673`\)}}}}, {{7, 
          13, 53.99999999999925`}, {{{10, 
              23.610742790002277`}, {\(-85\), \(-56.17226505344604`\)}}, \
{{43, 0.2921430092681021`}, {\(-9\), \(-42.37744109149922`\)}}}}, {{7, 18, 
          54.00000000000145`}, {{{63, 
              32.64249244681963`}, {\(-85\), \(-3.8989709244606274`\)}}, \
{{43, 54.74786676626664`}, {\(-9\), \(-27.386616478877315`\)}}}}, {{7, 23, 
          53.99999999999705`}, {{{86, 
              56.55718050961639`}, {\(-82\), \(-27.32044401690615`\)}}, {{44, 
              46.73426830798064`}, {\(-9\), \(-11.084475033331955`\)}}}}, \
{{7, 28, 53.99999999999925`}, {{{97, 
              38.68247526970947`}, {\(-79\), \(-39.12841000633449`\)}}, {{45, 
              37.667841720096504`}, {\(-8\), \(-53.13924093878743`\)}}}}, \
{{7, 33, 54.00000000000125`}, {{{103, 
              56.54676720043312`}, {\(-76\), \(-54.27947931342118`\)}}, {{46, 
              26.39612711438957`}, {\(-8\), \(-34.064364471617345`\)}}}}, \
{{7, 38, 53.99999999999725`}, {{{108, 
              14.856018748790802`}, {\(-74\), \(-16.316466907716745`\)}}, \
{{47, 14.467453568818343`}, {\(-8\), \(-13.348498727626819`\)}}}}, {{7, 43, 
          53.99999999999925`}, {{{111, 
              31.827059208177673`}, {\(-71\), \(-43.833462371719634`\)}}, \
{{48, 0.9962629597632144`}, {\(-7\), \(-51.44739345451228`\)}}}}, {{7, 48, 
          54.00000000000125`}, {{{114, 
              12.273083974667713`}, {\(-69\), \(-16.808467316462554`\)}}, \
{{48, 47.14554528108749`}, {\(-7\), \(-27.888839275217077`\)}}}}, {{7, 53, 
          53.99999999999725`}, {{{116, 
              29.954576606586443`}, {\(-66\), \(-54.62263944343249`\)}}, \
{{49, 33.09384451395715`}, {\(-7\), \(-2.5914391546912796`\)}}}}, {{7, 58, 
          53.99999999999925`}, {{{118, 
              34.05718014756786`}, {\(-64\), \(-35.45490988340987`\)}}, {{50, 
              18.238807923171407`}, {\(-6\), \(-35.91761985665832`\)}}}}, \
{{8, 3, 54.0000000000046`}, {{{120, 
              29.29267532601756`}, {\(-62\), \(-19.45458718204179`\)}}, {{51, 
              
              3.4627170650968253`}, {\(-6\), \(-7.401263483903939`\)}}}}, \
{{8, 8, 54.00000000000035`}, {{{122, 
              19.928265284800943`}, {\(-60\), \(-5.613524803649739`\)}}, \
{{51, 48.72064304099098`}, {\(-5\), \(-37.080606173051024`\)}}}}, {{8, 13, 
          54.000000000002444`}, {{{124, 
              9.17757980589272`}, {\(-57\), \(-53.27358723474944`\)}}, {{52, 
              34.308525197876634`}, {\(-5\), \(-4.774532106315856`\)}}}}, \
{{8, 18, 54.00000000000465`}, {{{125, 
              59.827168052250954`}, {\(-55\), \(-41.853300154734114`\)}}, \
{{53, 20.499353075369555`}, {\(-4\), \(-30.280171619400793`\)}}}}, {{8, 23, 
          54.00000000000025`}, {{{127, 
              55.27784880465248`}, {\(-53\), \(-30.023167451173265`\)}}, \
{{54, 7.147731107042006`}, {\(-3\), \(-53.71708223666303`\)}}}}, {{8, 28, 
          54.000000000002444`}, {{{129, 
              59.19006541563192`}, {\(-51\), \(-16.67840311638514`\)}}, {{54, 
              54.44350332384843`}, {\(-3\), \(-14.98878620603457`\)}}}}, {{8, 
          33, 53.99999999999805`}, {{{132, 
              15.60933694449659`}, {\(-49\), \(-1.004281600499155`\)}}, {{55, 
              43.36637911924342`}, {\(-2\), \(-33.27442518292314`\)}}}}, {{8, 
          38, 54.00000000000684`}, {{{134, 
              52.353373674927184`}, {\(-46\), \(-40.16716098208832`\)}}, \
{{56, 33.16174786349109`}, {\(-1\), \(-49.25824520055767`\)}}}}, {{8, 43, 
          54.000000000002444`}, {{{138, 
              1.9783839967226413`}, {\(-44\), \(-10.489682030418805`\)}}, \
{{57, 24.878436667316777`}, {\(-1\), \(-2.056676524578025`\)}}}}, {{8, 48, 
          53.99999999999805`}, {{{142, 
              13.407730713395267`}, {\(-41\), \(-23.477896596745893`\)}}, \
{{58, 18.922598660820285`}, {0, \(-11.341852282129844`\)}}}}, {{8, 53, 
          54.00000000000684`}, {{{149, 
              38.21330569124768`}, {\(-37\), \(-39.57885721636629`\)}}, {{59, 
              14.343167387046662`}, {0, 41.896715385235865`}}}}, {{8, 58, 
          54.000000000002444`}, {{{60, 13.26424026134589`}, {1, 
              39.56057852784406`}}}}, {{9, 3, 
          53.9999999999982`}, {{{61, 14.891159031305676`}, {2, 
              40.700585679012164`}}}}, {{9, 8, 
          54.00000000000674`}, {{{62, 19.817701401911307`}, {3, 
              45.67031170462016`}}}}, {{9, 13, 
          54.000000000002444`}, {{{63, 30.460741685193824`}, {4, 
              56.56800047313999`}}}}, {{9, 18, 
          53.99999999999825`}, {{{64, 45.85798988733359`}, {6, 
              12.018526404965026`}}}}, {{9, 23, 
          54.000000000006644`}, {{{66, 8.591465386157324`}, {7, 
              34.03501109561661`}}}}, {{9, 28, 
          54.000000000002444`}, {{{67, 39.6865224457369`}, {9, 
              2.865653627904692`}}}}, {{9, 33, 
          53.99999999999805`}, {{{69, 22.099818677932603`}, {10, 
              40.315958348788996`}}}}, {{9, 38, 
          54.00000000000684`}, {{{71, 18.625263321112016`}, {12, 
              27.522379990751524`}}}}, {{9, 43, 
          54.000000000002444`}, {{{73, 34.75854013352574`}, {14, 
              27.33056331105896`}}}}, {{9, 48, 
          53.99999999999805`}, {{{76, 19.615708355807442`}, {16, 
              44.2171804167689`}}}}, {{9, 53, 
          54.00000000000684`}, {{{79, 50.79763129627537`}, {19, 
              26.554368032445765`}}}}, {{9, 58, 
          54.000000000002444`}, {{{84, 56.09844084882525`}, {22, 
              56.96181618954448`}}}}, {{10, 3, 53.9999999999982`}, {}}, {{10, 
          8, 54.00000000000674`}, {}}, {{10, 13, 
          54.000000000002444`}, {}}, {{10, 18, 
          53.99999999999825`}, {}}, {{10, 23, 
          54.000000000006644`}, {}}, {{10, 28, 
          54.000000000002444`}, {}}, {{10, 33, 
          53.99999999999805`}, {}}, {{10, 38, 54.00000000000684`}, {}}, {{10, 
          43, 54.000000000002444`}, {}}, {{10, 48, 
          53.99999999999805`}, {}}, {{10, 53, 54.00000000000684`}, {}}, {{10, 
          58, 54.000000000002444`}, {}}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(extresmospuntoslimites = 
      Map[maxhor, {t1maxsom, t2maxsom, t3maxsom, t4maxsom}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(extresmospuntoslimites\\)\\\" is similar to \
existing symbol \\\"\\!\\(extresmospuntoslimitep\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \({{{{\(-10\), \(-39.42601687803208`\)}, {\(-33\), \(-10.643357702408167`\
\)}}}, {{{\(-12\), \(-45.30615058832595`\)}, {\(-35\), \
\(-58.99520470712602`\)}}}, {{{124, 50.11523344432533`}, {2, 
            14.435349489411866`}}}, {{{123, 12.065848558993082`}, {5, 
            7.6353891416559705`}}}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(curvaslimites = 
      Map[puntoslimites, 
        Take[intervalosminuto, {1, Length[intervalosminuto], 5}]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(curvaslimites\\)\\\" is similar to existing \
symbol \\\"\\!\\(curvaslimitep\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\
\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Solve::"ifun"\), \(\(:\)\(\ \)\), "\<\"Inverse functions are \
being used by \\!\\(Solve\\), so some solutions may not be found; use Reduce \
for complete solution information. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"Solve::ifun\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(Solve::"ifun"\), \(\(:\)\(\ \)\), "\<\"Inverse functions are \
being used by \\!\\(Solve\\), so some solutions may not be found; use Reduce \
for complete solution information. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"Solve::ifun\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(Solve::"ifun"\), \(\(:\)\(\ \)\), "\<\"Inverse functions are \
being used by \\!\\(Solve\\), so some solutions may not be found; use Reduce \
for complete solution information. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"Solve::ifun\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Solve :: \\\"ifun\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \({{{4, 53, 54.00000000000045`}, {}}, {{4, 58, 
          53.99999999999925`}, {}}, {{5, 3, 53.9999999999982`}, {}}, {{5, 8, 
          54.00000000000035`}, {}}, {{5, 13, 53.99999999999925`}, {}}, {{5, 
          18, 53.99999999999825`}, {}}, {{5, 23, 
          54.00000000000025`}, {}}, {{5, 28, 53.99999999999925`}, {}}, {{5, 
          33, 53.99999999999805`}, {}}, {{5, 38, 
          54.00000000000045`}, {}}, {{5, 43, 53.99999999999925`}, {}}, {{5, 
          48, 53.99999999999805`}, {}}, {{5, 53, 
          54.00000000000045`}, {}}, {{5, 58, 53.99999999999925`}, {}}, {{6, 
          3, 53.9999999999982`}, {}}, {{6, 8, 
          54.00000000000035`}, {{{\(-1\), \(-35.43773405362299`\)}, {\(-39\), \
\(-32.5140462061249`\)}}, {{5, 
              47.242424906896154`}, {\(-38\), \(-19.801526627411477`\)}}}}, \
{{6, 13, 53.99999999999925`}, {{{9, 
              3.8554037754970594`}, {\(-42\), \(-16.151485513839106`\)}}, \
{{13, 30.305596170612077`}, {\(-40\), \(-9.10827168581676`\)}}}}, {{6, 18, 
          53.99999999999825`}, {{{16, 
              3.717173123467319`}, {\(-43\), \(-37.39198229362245`\)}}, {{19, 
              19.563764005603232`}, {\(-41\), \(-12.983320294170682`\)}}}}, \
{{6, 23, 54.00000000000025`}, {{{21, 
              41.94824475990188`}, {\(-44\), \(-25.72217773568596`\)}}, {{24, 
              11.702016182713919`}, {\(-41\), \(-52.76113538021704`\)}}}}, \
{{6, 28, 53.99999999999925`}, {{{26, 
              32.763376609484354`}, {\(-44\), \(-54.050568790377014`\)}}, \
{{28, 27.31999912407744`}, {\(-42\), \(-16.518629612912292`\)}}}}, {{6, 33, 
          54.00000000000125`}, {{{30, 
              50.93476163087381`}, {\(-45\), \(-8.207698773226184`\)}}, {{32, 
              16.545136377796013`}, {\(-42\), \(-28.392227084143826`\)}}}}, \
{{6, 38, 53.99999999999725`}, {{{34, 
              44.424441707175646`}, {\(-45\), \(-11.514088192952272`\)}}, \
{{35, 45.22150790064856`}, {\(-42\), \(-30.91326656990219`\)}}}}, {{6, 43, 
          53.99999999999925`}, {{{38, 
              18.052608698193353`}, {\(-45\), \(-6.076702694457765`\)}}, \
{{38, 57.1551239632727`}, {\(-42\), \(-25.754832679923254`\)}}}}, {{6, 48, 
          54.00000000000125`}, {{{41, 
              35.04880658958598`}, {\(-44\), \(-53.378372688909224`\)}}, \
{{41, 55.01230963156672`}, {\(-42\), \(-14.119175544089302`\)}}}}, {{6, 53, 
          53.99999999999725`}, {{{44, 
              37.82994444276767`}, {\(-44\), \(-34.504887482543865`\)}}, \
{{44, 40.681246999108396`}, {\(-41\), \(-56.9110049646433`\)}}}}, {{6, 58, 
          53.99999999999925`}, {{{47, 
              28.09681062905156`}, {\(-44\), \(-10.304826127729996`\)}}, \
{{47, 15.66935371689624`}, {\(-41\), \(-34.832377248362576`\)}}}}, {{7, 3, 
          54.0000000000014`}, {{{50, 
              7.279172317171856`}, {\(-43\), \(-41.43551649145181`\)}}, {{49, 
              41.13421881891199`}, {\(-41\), \(-8.441517952725093`\)}}}}, \
{{7, 8, 53.99999999999715`}, {{{52, 
              36.54052391903306`}, {\(-43\), \(-8.442650281878201`\)}}, {{51, 
              58.1007823638582`}, {\(-40\), \(-38.19318300294739`\)}}}}, {{7, 
          13, 53.99999999999925`}, {{{54, 
              56.83056083235854`}, {\(-42\), \(-31.771867320080247`\)}}, \
{{54, 7.393156705089297`}, {\(-40\), \(-4.456054437037267`\)}}}}, {{7, 18, 
          54.00000000000145`}, {{{57, 
              9.059127024514595`}, {\(-41\), \(-51.78850252108717`\)}}, {{56, 
              9.71547550528868`}, {\(-39\), \(-27.55814150030858`\)}}}}, {{7, 
          23, 53.99999999999705`}, {{{59, 
              13.981365878335481`}, {\(-41\), \(-8.791682144946407`\)}}, \
{{58, 5.708100729102057`}, {\(-38\), \(-47.75525384301105`\)}}}}, {{7, 28, 
          53.99999999999925`}, {{{61, 
              12.235142292114176`}, {\(-40\), \(-23.06686352157257`\)}}, \
{{59, 56.01121085168188`}, {\(-38\), \(-5.25327912930635`\)}}}}, {{7, 33, 
          54.00000000000125`}, {{{63, 
              4.5128761460409805`}, {\(-39\), \(-34.80966317498755`\)}}, \
{{61, 41.078685987593815`}, {\(-37\), \(-20.26850979018093`\)}}}}, {{7, 38, 
          53.99999999999725`}, {{{64, 
              51.33408857354709`}, {\(-38\), \(-44.22690084938495`\)}}, {{63, 
              21.463079820335622`}, {\(-36\), \(-32.927811412672696`\)}}}}, \
{{7, 43, 53.99999999999925`}, {{{66, 
              33.294308110357065`}, {\(-37\), \(-51.447807940354835`\)}}, \
{{64, 57.572452418302476`}, {\(-35\), \(-43.385776116124646`\)}}}}, {{7, 48, 
          54.00000000000125`}, {{{68, 
              10.868361681433498`}, {\(-36\), \(-56.62119565253349`\)}}, \
{{66, 29.890364799238682`}, {\(-34\), \(-51.72798148210745`\)}}}}, {{7, 53, 
          53.99999999999725`}, {{{69, 
              44.545928464157214`}, {\(-35\), \(-59.85407882916533`\)}}, \
{{67, 58.82783983733873`}, {\(-33\), \(-58.0445496192786`\)}}}}, {{7, 58, 
          53.99999999999925`}, {{{71, 
              14.820335060919376`}, {\(-35\), \(-1.1945413305353725`\)}}, \
{{69, 24.744988031153525`}, {\(-33\), \(-2.4113081191791252`\)}}}}, {{8, 3, 
          54.0000000000046`}, {{{72, 
              42.10924258717739`}, {\(-34\), \(-0.7374704701074108`\)}}, \
{{70, 48.0543868214275`}, {\(-32\), \(-4.875875981752245`\)}}}}, {{8, 8, 
          54.00000000000035`}, {{{74, 
              6.878338434623288`}, {\(-32\), \(-58.50873131827839`\)}}, {{72, 
              9.142238984662185`}, {\(-31\), \(-5.468923750030612`\)}}}}, \
{{8, 13, 54.000000000002444`}, {{{75, 
              29.56852724519848`}, {\(-31\), \(-54.532610417772744`\)}}, \
{{73, 28.401218492777787`}, {\(-30\), \(-4.202564056228795`\)}}}}, {{8, 18, 
          54.00000000000465`}, {{{76, 
              50.59123848343262`}, {\(-30\), \(-48.82537576090584`\)}}, {{74, 
              46.19721654086618`}, {\(-29\), \(-1.0815614782190863`\)}}}}, \
{{8, 23, 54.00000000000025`}, {{{78, 
              10.424099783477345`}, {\(-29\), \(-41.34274328291518`\)}}, \
{{76, 2.92831363243522`}, {\(-27\), \(-56.08212724229922`\)}}}}, {{8, 28, 
          54.000000000002444`}, {{{79, 
              29.538037800627706`}, {\(-28\), \(-32.0578394211379`\)}}, {{77, 
              19.01236826409928`}, {\(-26\), \(-49.17929159980666`\)}}}}, \
{{8, 33, 53.99999999999805`}, {{{80, 
              48.36913624931469`}, {\(-27\), \(-20.931439674791648`\)}}, \
{{78, 34.88965568473219`}, {\(-25\), \(-40.285553581527864`\)}}}}, {{8, 38, 
          54.00000000000684`}, {{{82, 
              7.479920256840273`}, {\(-26\), \(-7.860341740166632`\)}}, {{79, 
              50.99845571490647`}, {\(-24\), \(-29.3637872700198`\)}}}}, {{8, 
          43, 54.000000000002444`}, {{{83, 
              
              27.414907388259735`}, {\(-24\), \(-52.743946988232864`\)}}, \
{{81, 7.87641230022075`}, {\(-23\), \(-16.2725054233659`\)}}}}, {{8, 48, 
          53.99999999999805`}, {{{84, 
              48.79669795154342`}, {\(-23\), \(-35.454233670146564`\)}}, \
{{82, 26.090562887812325`}, {\(-22\), \(-0.8823962212657932`\)}}}}, {{8, 53, 
          54.00000000000684`}, {{{86, 
              12.393315741405502`}, {\(-22\), \(-15.74469199996237`\)}}, \
{{83, 46.24289553091245`}, {\(-20\), \(-43.047041443306355`\)}}}}, {{8, 58, 
          54.000000000002444`}, {{{87, 
              38.97738997297466`}, {\(-20\), \(-53.45020078457125`\)}}, {{85, 
              9.134133902898043`}, {\(-19\), \(-22.503646287188772`\)}}}}, \
{{9, 3, 53.9999999999982`}, {{{89, 
              9.625449930138359`}, {\(-19\), \(-28.207144350560895`\)}}, \
{{86, 35.63297185943668`}, {\(-17\), \(-59.001010884615965`\)}}}}, {{9, 8, 
          54.00000000000674`}, {{{90, 
              45.57705000471543`}, {\(-17\), \(-59.61205563546585`\)}}, {{88, 
              6.823354290323493`}, {\(-16\), \(-32.17075146283584`\)}}}}, \
{{9, 13, 54.000000000002444`}, {{{92, 
              28.3845142777281`}, {\(-16\), \(-27.19413954222503`\)}}, {{89, 
              44.15520379762569`}, {\(-15\), \(-1.4877320868762567`\)}}}}, \
{{9, 18, 53.99999999999825`}, {{{94, 
              20.255813492997845`}, {\(-14\), \(-50.15494865298649`\)}}, \
{{91, 29.382767082205703`}, {\(-13\), \(-26.356868469732397`\)}}}}, {{9, 23, 
          54.000000000006644`}, {{{96, 
              24.16140575714195`}, {\(-13\), \(-7.491065411106419`\)}}, {{93, 
              25.051304156671108`}, {\(-11\), \(-45.833326973448365`\)}}}}, \
{{9, 28, 54.000000000002444`}, {{{98, 
              44.60414372266797`}, {\(-11\), \(-17.622491174642363`\)}}, \
{{95, 34.73437328836923`}, {\(-9\), \(-58.622686250213434`\)}}}}, {{9, 33, 
          53.99999999999805`}, {{{101, 
              28.882428667961904`}, {\(-9\), \(-18.017524400661742`\)}}, \
{{98, 4.058014666685779`}, {\(-8\), \(-2.658448018089601`\)}}}}, {{9, 38, 
          54.00000000000684`}, {{{104, 
              50.58735586916498`}, {\(-7\), \(-3.96713951246495`\)}}, {{101, 
              2.633814340384788`}, {\(-5\), \(-54.4542892474313`\)}}}}, {{9, 
          43, 54.000000000002444`}, {{{109, 
              21.487758236024206`}, {\(-4\), \(-24.566998797130815`\)}}, \
{{104, 50.09613499312849`}, {\(-3\), \(-26.897023829149056`\)}}}}, {{9, 48, 
          53.99999999999805`}, {{{117, 
              20.157280850211805`}, {0, \(-33.002894658443545`\)}}, {{110, 
              22.48795285525773`}, {0, \(-19.983984173487144`\)}}}}, {{9, 53, 
          54.00000000000684`}, {}}, {{9, 58, 54.000000000002444`}, {}}, {{10, 
          3, 53.9999999999982`}, {}}, {{10, 8, 
          54.00000000000674`}, {}}, {{10, 13, 
          54.000000000002444`}, {}}, {{10, 18, 
          53.99999999999825`}, {}}, {{10, 23, 
          54.000000000006644`}, {}}, {{10, 28, 
          54.000000000002444`}, {}}, {{10, 33, 
          53.99999999999805`}, {}}, {{10, 38, 54.00000000000684`}, {}}, {{10, 
          43, 54.000000000002444`}, {}}, {{10, 48, 
          53.99999999999805`}, {}}, {{10, 53, 54.00000000000684`}, {}}, {{10, 
          58, 54.000000000002444`}, {}}}\)], "Output"]
}, Open  ]]
}, Closed]]
},
FrontEndVersion->"5.0 for Microsoft Windows",
ScreenRectangle->{{0, 1024}, {0, 685}},
WindowSize->{563, 627},
WindowMargins->{{Automatic, -77}, {Automatic, -26}}
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{
Cell[1754, 51, 35, 1, 30, "Input"],

Cell[CellGroupData[{
Cell[1814, 56, 43, 0, 38, "Subsection"],

Cell[CellGroupData[{
Cell[1882, 60, 61, 0, 29, "Subsubsection"],
Cell[1946, 62, 107, 2, 70, "Input"],
Cell[2056, 66, 195, 4, 70, "Input"],
Cell[2254, 72, 112, 2, 70, "Input"],

Cell[CellGroupData[{
Cell[2391, 78, 266, 5, 70, "Input"],
Cell[2660, 85, 354, 5, 70, "Message"],
Cell[3017, 92, 354, 5, 70, "Message"]
}, Open  ]],
Cell[3386, 100, 152, 3, 70, "Input"],

Cell[CellGroupData[{
Cell[3563, 107, 130, 3, 70, "Input"],
Cell[3696, 112, 362, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[4095, 122, 282, 5, 70, "Input"],
Cell[4380, 129, 362, 5, 70, "Message"]
}, Open  ]],
Cell[4757, 137, 71, 1, 70, "Input"],
Cell[4831, 140, 71, 1, 70, "Input"],
Cell[4905, 143, 81, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[5011, 148, 140, 3, 70, "Input"],
Cell[5154, 153, 357, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[5560, 164, 41, 0, 23, "Subsubsection"],
Cell[5604, 166, 243, 5, 70, "Input"],

Cell[CellGroupData[{
Cell[5872, 175, 426, 7, 70, "Input"],
Cell[6301, 184, 355, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[6705, 195, 59, 0, 23, "Subsubsection"],
Cell[6767, 197, 254, 4, 90, "Input"],
Cell[7024, 203, 244, 4, 107, "Input"],
Cell[7271, 209, 765, 18, 163, "Input"],
Cell[8039, 229, 87, 1, 30, "Input"],

Cell[CellGroupData[{
Cell[8151, 234, 87, 1, 30, "Input"],
Cell[8241, 237, 370, 5, 70, "Message"]
}, Open  ]],
Cell[8626, 245, 93, 1, 30, "Input"],
Cell[8722, 248, 384, 7, 163, "Input"],
Cell[9109, 257, 154, 3, 61, "Input"],

Cell[CellGroupData[{
Cell[9288, 264, 682, 11, 230, "Input"],
Cell[9973, 277, 372, 6, 70, "Message"]
}, Open  ]],
Cell[10360, 286, 692, 12, 190, "Input"],
Cell[11055, 300, 348, 6, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[11440, 311, 83, 1, 23, "Subsubsection"],

Cell[CellGroupData[{
Cell[11548, 316, 367, 8, 170, "Input"],
Cell[11918, 326, 358, 5, 70, "Message"],
Cell[12279, 333, 358, 5, 70, "Message"]
}, Open  ]],
Cell[12652, 341, 273, 5, 90, "Input"],
Cell[12928, 348, 80, 1, 30, "Input"],
Cell[13011, 351, 165, 3, 50, "Input"],
Cell[13179, 356, 291, 5, 90, "Input"],
Cell[13473, 363, 80, 1, 30, "Input"],
Cell[13556, 366, 90, 1, 30, "Input"],
Cell[13649, 369, 90, 1, 30, "Input"],
Cell[13742, 372, 90, 1, 30, "Input"],
Cell[13835, 375, 218, 4, 50, "Input"],
Cell[14056, 381, 218, 4, 50, "Input"],
Cell[14277, 387, 218, 4, 50, "Input"],
Cell[14498, 393, 104, 2, 42, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[14639, 400, 102, 2, 23, "Subsubsection"],

Cell[CellGroupData[{
Cell[14766, 406, 105, 2, 42, "Input"],
Cell[14874, 410, 369, 6, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[15280, 421, 292, 5, 124, "Input"],
Cell[15575, 428, 354, 5, 70, "Message"],
Cell[15932, 435, 355, 5, 70, "Message"]
}, Open  ]],
Cell[16302, 443, 136, 2, 50, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[16475, 450, 68, 0, 23, "Subsubsection"],
Cell[16546, 452, 284, 5, 95, "Input"],
Cell[16833, 459, 159, 3, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[17029, 467, 118, 3, 23, "Subsubsection"],
Cell[17150, 472, 497, 9, 210, "Input"],
Cell[17650, 483, 345, 7, 90, "Input"],
Cell[17998, 492, 420, 8, 110, "Input"],
Cell[18421, 502, 139, 3, 70, "Input"],
Cell[18563, 507, 85, 1, 30, "Input"],
Cell[18651, 510, 77, 1, 30, "Input"],

Cell[CellGroupData[{
Cell[18753, 515, 379, 8, 134, "Input"],
Cell[19135, 525, 360, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[19532, 535, 118, 2, 50, "Input"],
Cell[19653, 539, 371, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[20061, 549, 383, 7, 170, "Input"],
Cell[20447, 558, 371, 5, 70, "Message"]
}, Open  ]],
Cell[20833, 566, 236, 4, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[21106, 575, 113, 3, 23, "Subsubsection"],
Cell[21222, 580, 362, 7, 109, "Input"],
Cell[21587, 589, 384, 8, 110, "Input"],
Cell[21974, 599, 473, 9, 170, "Input"],

Cell[CellGroupData[{
Cell[22472, 612, 296, 6, 110, "Input"],
Cell[22771, 620, 379, 5, 70, "Message"],
Cell[23153, 627, 360, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[23562, 638, 76, 0, 23, "Subsubsection"],
Cell[23641, 640, 70, 1, 30, "Input"],
Cell[23714, 643, 622, 10, 278, "Input"],
Cell[24339, 655, 463, 10, 190, "Input"],
Cell[24805, 667, 505, 10, 210, "Input"],

Cell[CellGroupData[{
Cell[25335, 681, 162, 3, 90, "Input"],
Cell[25500, 686, 368, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[25917, 697, 70, 0, 23, "Subsubsection"],
Cell[25990, 699, 1633, 26, 554, "Input"],
Cell[27626, 727, 580, 10, 230, "Input"],
Cell[28209, 739, 477, 8, 170, "Input"],

Cell[CellGroupData[{
Cell[28711, 751, 371, 7, 130, "Input"],
Cell[29085, 760, 359, 5, 70, "Message"],
Cell[29447, 767, 367, 5, 70, "Message"],
Cell[29817, 774, 364, 6, 70, "Message"],
Cell[30184, 782, 332, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[30553, 792, 371, 7, 130, "Input"],
Cell[30927, 801, 374, 5, 70, "Message"],
Cell[31304, 808, 365, 6, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[31718, 820, 88, 1, 23, "Subsubsection"],
Cell[31809, 823, 1150, 18, 350, "Input"],
Cell[32962, 843, 1004, 17, 334, "Input"],
Cell[33969, 862, 402, 6, 110, "Input"],
Cell[34374, 870, 480, 8, 150, "Input"],
Cell[34857, 880, 368, 7, 130, "Input"],
Cell[35228, 889, 900, 15, 286, "Input"],
Cell[36131, 906, 639, 10, 193, "Input"],
Cell[36773, 918, 425, 7, 110, "Input"],
Cell[37201, 927, 486, 8, 170, "Input"],
Cell[37690, 937, 374, 7, 130, "Input"],
Cell[38067, 946, 420, 7, 112, "Input"],
Cell[38490, 955, 131, 3, 50, "Input"],
Cell[38624, 960, 442, 8, 150, "Input"],

Cell[CellGroupData[{
Cell[39091, 972, 425, 7, 112, "Input"],
Cell[39519, 981, 370, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[39926, 991, 442, 8, 150, "Input"],
Cell[40371, 1001, 378, 5, 70, "Message"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{
Cell[40810, 1013, 54, 0, 38, "Subsection"],
Cell[40867, 1015, 540, 10, 211, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[41444, 1030, 38, 0, 30, "Subsection"],
Cell[41485, 1032, 162, 3, 52, "Text"],
Cell[41650, 1037, 1540, 31, 463, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[43227, 1073, 116, 3, 48, "Subsection"],
Cell[43346, 1078, 577, 12, 130, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[43960, 1095, 229, 4, 66, "Subsection"],

Cell[CellGroupData[{
Cell[44214, 1103, 839, 17, 250, "Input"],
Cell[45056, 1122, 62, 1, 29, "Output"],
Cell[45121, 1125, 63, 1, 29, "Output"],
Cell[45187, 1128, 77, 1, 29, "Output"],
Cell[45267, 1131, 60, 1, 29, "Output"],
Cell[45330, 1134, 62, 1, 29, "Output"],
Cell[45395, 1137, 63, 1, 29, "Output"],
Cell[45461, 1140, 77, 1, 29, "Output"],
Cell[45541, 1143, 61, 1, 29, "Output"],
Cell[45605, 1146, 61, 1, 29, "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[45715, 1153, 188, 4, 74, "Subsection"],

Cell[CellGroupData[{
Cell[45928, 1161, 1686, 36, 616, "Input"],
Cell[47617, 1199, 368, 6, 37, "Message"],
Cell[47988, 1207, 370, 5, 52, "Message"],
Cell[48361, 1214, 383, 6, 52, "Message"],
Cell[48747, 1222, 394, 6, 52, "Message"],
Cell[49144, 1230, 370, 6, 37, "Message"],
Cell[49517, 1238, 370, 6, 37, "Message"],
Cell[49890, 1246, 373, 5, 52, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[50312, 1257, 123, 3, 48, "Subsection"],

Cell[CellGroupData[{
Cell[50460, 1264, 1367, 26, 70, "Input"],
Cell[51830, 1292, 365, 5, 70, "Message"],
Cell[52198, 1299, 376, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[52623, 1310, 181, 3, 66, "Subsection"],
Cell[52807, 1315, 610, 13, 170, "Input"],

Cell[CellGroupData[{
Cell[53442, 1332, 267, 7, 70, "Input"],
Cell[53712, 1341, 371, 6, 52, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[54132, 1353, 231, 4, 66, "Subsection"],

Cell[CellGroupData[{
Cell[54388, 1361, 952, 20, 350, "Input"],
Cell[55343, 1383, 62, 1, 29, "Output"],
Cell[55408, 1386, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[55518, 1393, 104, 2, 48, "Subsection"],

Cell[CellGroupData[{
Cell[55647, 1399, 742, 16, 250, "Input"],
Cell[56392, 1417, 60, 1, 29, "Output"],
Cell[56455, 1420, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[56565, 1427, 232, 4, 84, "Subsection"],

Cell[CellGroupData[{
Cell[56822, 1435, 782, 16, 330, "Input"],
Cell[57607, 1453, 60, 1, 29, "Output"],
Cell[57670, 1456, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[57780, 1463, 100, 2, 30, "Subsection"],

Cell[CellGroupData[{
Cell[57905, 1469, 774, 16, 290, "Input"],
Cell[58682, 1487, 60, 1, 29, "Output"],
Cell[58745, 1490, 62, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[58856, 1497, 185, 3, 66, "Subsection"],

Cell[CellGroupData[{
Cell[59066, 1504, 618, 14, 170, "Input"],
Cell[59687, 1520, 59, 1, 29, "Output"],
Cell[59749, 1523, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[59859, 1530, 178, 3, 48, "Subsection"],

Cell[CellGroupData[{
Cell[60062, 1537, 865, 17, 370, "Input"],
Cell[60930, 1556, 371, 5, 52, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[61338, 1566, 865, 17, 370, "Input"],
Cell[62206, 1585, 378, 5, 52, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[62621, 1595, 308, 7, 90, "Input"],
Cell[62932, 1604, 400, 6, 52, "Message"],
Cell[63335, 1612, 400, 6, 52, "Message"],
Cell[63738, 1620, 401, 6, 52, "Message"],
Cell[64142, 1628, 346, 5, 37, "Message"],
Cell[64491, 1635, 62, 1, 29, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[64590, 1641, 1942, 43, 570, "Input"],
Cell[66535, 1686, 61, 1, 29, "Output"],
Cell[66599, 1689, 61, 1, 29, "Output"],
Cell[66663, 1692, 400, 6, 52, "Message"],
Cell[67066, 1700, 400, 6, 52, "Message"],
Cell[67469, 1708, 399, 6, 52, "Message"],
Cell[67871, 1716, 346, 5, 37, "Message"],
Cell[68220, 1723, 61, 1, 29, "Output"],
Cell[68284, 1726, 61, 1, 29, "Output"],
Cell[68348, 1729, 59, 1, 29, "Output"],
Cell[68410, 1732, 62, 1, 29, "Output"],
Cell[68475, 1735, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[68585, 1742, 120, 4, 66, "Subsection"],

Cell[CellGroupData[{
Cell[68730, 1750, 257, 4, 90, "Input"],
Cell[68990, 1756, 105, 2, 29, "Output"],
Cell[69098, 1760, 87, 1, 29, "Output"],
Cell[69188, 1763, 109, 2, 29, "Output"],
Cell[69300, 1767, 87, 1, 29, "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[69436, 1774, 181, 4, 74, "Subsection"],

Cell[CellGroupData[{
Cell[69642, 1782, 430, 10, 170, "Input"],
Cell[70075, 1794, 107, 2, 29, "Output"],
Cell[70185, 1798, 88, 1, 29, "Output"],
Cell[70276, 1801, 6367, 91, 865, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[76692, 1898, 147, 4, 66, "Subsection"],

Cell[CellGroupData[{
Cell[76864, 1906, 581, 12, 231, "Input"],
Cell[77448, 1920, 61, 1, 29, "Output"],
Cell[77512, 1923, 125, 2, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[77686, 1931, 289, 6, 102, "Subsection"],

Cell[CellGroupData[{
Cell[78000, 1941, 150, 3, 50, "Input"],
Cell[78153, 1946, 11787, 191, 2385, "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[89989, 2143, 274, 6, 110, "Subsection"],

Cell[CellGroupData[{
Cell[90288, 2153, 338, 7, 110, "Input"],
Cell[90629, 2162, 506, 9, 86, "Output"],
Cell[91138, 2173, 503, 9, 86, "Output"],
Cell[91644, 2184, 385, 6, 37, "Message"],
Cell[92032, 2192, 385, 6, 37, "Message"],
Cell[92420, 2200, 385, 6, 37, "Message"],
Cell[92808, 2208, 333, 5, 37, "Message"],
Cell[93144, 2215, 26477, 439, 4133, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[119670, 2660, 127, 3, 48, "Subsection"],

Cell[CellGroupData[{
Cell[119822, 2667, 52, 1, 30, "Input"],
Cell[119877, 2670, 3469, 47, 865, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[123395, 2723, 97, 1, 30, "Subsection"],

Cell[CellGroupData[{
Cell[123517, 2728, 121, 2, 50, "Input"],
Cell[123641, 2732, 329, 5, 86, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[124007, 2742, 141, 3, 70, "Input"],
Cell[124151, 2747, 368, 6, 52, "Message"],
Cell[124522, 2755, 368, 6, 52, "Message"],
Cell[124893, 2763, 368, 6, 52, "Message"],
Cell[125264, 2771, 329, 5, 37, "Message"],
Cell[125596, 2778, 8540, 140, 1587, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[134173, 2923, 118, 2, 50, "Input"],
Cell[134294, 2927, 394, 6, 52, "Message"],
Cell[134691, 2935, 332, 5, 86, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[135060, 2945, 141, 3, 70, "Input"],
Cell[135204, 2950, 374, 5, 52, "Message"],
Cell[135581, 2957, 368, 6, 52, "Message"],
Cell[135952, 2965, 368, 6, 52, "Message"],
Cell[136323, 2973, 368, 6, 52, "Message"],
Cell[136694, 2981, 329, 5, 37, "Message"],
Cell[137026, 2988, 9954, 157, 1929, "Output"]
}, Open  ]]
}, Closed]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

