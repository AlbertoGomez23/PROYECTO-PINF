(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.0'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     84445,       2100]*)
(*NotebookOutlinePosition[     85091,       2122]*)
(*  CellTagsIndexPosition[     85047,       2118]*)
(*WindowFrame->Normal*)



Notebook[{
Cell[BoxData[
    \(\ \)], "Input"],

Cell[CellGroupData[{

Cell["Funciones auxiliares.", "Subsection"],

Cell[CellGroupData[{

Cell["Formatos de horas, grados y radianes", "Subsubsection"],

Cell[BoxData[
    \(hms2h[hora_] := 
      N[First[hora] + Part[hora, 2]/60 + Last[hora]/3600]\)], "Input"],

Cell[BoxData[
    \(h2hms[hora_] := 
      Module[{h, m, s}, h = IntegerPart[hora]; \n
        m = IntegerPart[\((hora - h)\)*60]; 
        s = \((hora - h - m/60)\)*3600; {h, m, s}]\)], "Input"],

Cell[BoxData[
    \(gms2rad[ang_] := 
      N[First[ang] + Part[ang, 2]/60 + Last[ang]/3600]*Degree\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(rad2gms[ang_] := 
      Module[{grad, min, sec}, grad = IntegerPart[ang/Degree]; 
        min = IntegerPart[\((\((ang/Degree)\) - \ grad)\)*60]; 
        sec = \((\((ang/Degree)\) - grad - min/60)\)*3600; {grad, min, 
          sec}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(min\\)\\\" is similar to existing symbol \
\\\"\\!\\(Min\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(sec\\)\\\" is similar to existing symbol \
\\\"\\!\\(Sec\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(grad2gm[ang_] := 
      Module[{grad, min}, grad = IntegerPart[ang]; 
        min = \((ang - \ grad)\)*60; {grad, min}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(hms2rad[ang_] := 
      N[First[ang]*15 + Part[ang, 2]*15/60 + Last[ang]*15/3600]*
        Degree\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(hms2rad\\)\\\" is similar to existing symbol \
\\\"\\!\\(gms2rad\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(rad2hms[ang_] := 
      Module[{hor, min, sec}, hor = IntegerPart[\(ang/Degree\)/15]; 
        min = IntegerPart[\((\((\(ang/Degree\)/15)\) - \ hor)\)*60]; 
        sec = \((\((\(ang/Degree\)/15)\) - hor - min/60)\)*3600; {hor, min, 
          sec}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(rad2hms\\)\\\" is similar to existing symbol \
\\\"\\!\\(rad2gms\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(hms2gms[ang_] := rad2gms[hms2rad[ang]]\)], "Input"],

Cell[BoxData[
    \(gms2hms[ang_] := rad2hms[gms2rad[ang]]\)], "Input"],

Cell[BoxData[
    \(gm2grad[ang_] := N[First[ang] + 1/60\ Last[ang]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(h2ms[hora_] := 
      Module[{m, s}, m = IntegerPart[hora*60]; 
        s = \((hora - m/60)\)*3600; {m, s}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(h2ms\\)\\\" is similar to existing symbol \\\
\"\\!\\(h2hms\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fechas y tiempos", "Subsubsection"],

Cell[BoxData[
    \(diajuliano[dia_, mes_, a\[NTilde]o_] := 
      367*a\[NTilde]o - 
        IntegerPart[
          7*\((a\[NTilde]o + IntegerPart[\((mes + 9)\)\/12])\)\/4] + 
        IntegerPart[\(275*mes\)\/9] + dia + 1721013.5\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(tsidmedloc[dia_, mes_, a\[NTilde]o_, ut_, long_] := 
      Module[{t, ts, tsh, tslh, tshms}, 
        t = \((diajuliano[dia, mes, a\[NTilde]o] - 2451545)\)\/36525; 
        ts = 24110.54841 + 8640184.812866*t + 0.093104*t\^2 - 0.0000062*t\^3; 
        tsh = ts + 1.00273790935*3600*hms2h[ut]; 
        tslh = tsh + 3600*hms2h[gms2hms[long]]; 
        tshms = h2hms[Mod[tslh\/3600, 24]]; tshms]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(tslh\\)\\\" is similar to existing symbol \\\
\"\\!\\(tsh\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\
\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Transformaci\[OAcute]n coordenadas", "Subsubsection"],

Cell[BoxData[
    \(ecu2cart[{\[Alpha]rec_, dec_, dis_}] := 
      Module[{x, y, z}, x = dis*Cos[\[Alpha]rec\ Degree]*Cos[dec\ Degree]; 
        y = dis*Sin[\[Alpha]rec\ Degree]*Cos[dec\ Degree]; 
        z = dis*Sin[dec\ Degree]; {x, y, z}]\)], "Input"],

Cell[BoxData[
    \(cart2ecu[{x_, y_, z_}] := 
      Module[{\[Alpha]rec, dec, dis}, dis = \@\(x\^2 + y\^2 + z\^2\); 
        dec = N[ArcSin[z\/dis]]; \[Alpha]rec = 
          N[ArcTan[x, y]]; {\[Alpha]rec/Degree, dec/Degree, dis}]\)], "Input"],

Cell[BoxData[{
    RowBox[{\(Rx[ang_]\), ":=", 
      RowBox[{"(", GridBox[{
            {"1", "0", "0"},
            {"0", \(Cos[ang\ Degree]\), \(Sin[ang\ Degree]\)},
            {"0", \(-Sin[ang\ Degree]\), \(Cos[ang\ Degree]\)}
            }], ")"}]}], "\n", 
    RowBox[{\(Ry[ang_]\), ":=", 
      RowBox[{"(", GridBox[{
            {\(Cos[ang\ Degree]\), "0", \(-Sin[ang\ Degree]\)},
            {"0", "1", "0"},
            {\(Sin[ang\ Degree]\), "0", \(Cos[ang\ Degree]\)}
            }], ")"}]}], "\n", 
    RowBox[{\(Rz[ang_]\), ":=", 
      RowBox[{"(", GridBox[{
            {\(Cos[ang\ Degree]\), \(Sin[ang\ Degree]\), "0"},
            {\(-Sin[ang\ Degree]\), \(Cos[ang\ Degree]\), "0"},
            {"0", "0", "1"}
            }], ")"}]}]}], "Input"],

Cell[BoxData[
    \(Matcambcoor[d_, \[Mu]_] := Rz[\[Mu] - 90] . Rx[d - 90]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(matcambcoor[t_] := Matcambcoor[peled[t], pele\[Mu][t]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(matcambcoor\\)\\\" is similar to existing \
symbol \\\"\\!\\(Matcambcoor\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(cambcoorcart[{x_, y_, z_, t_}] := matcambcoor[t] . {x, y, z}\)], "Input"],

Cell[BoxData[
    \(geodes2geocen[{\[Phi]_, h_}] := 
      Module[{a, f, C, S, x, z}, a = 6378.14; f = \((1\/298.257)\); 
        C = 1\/\@\(1 - \((2  f - f\^2)\)*Sin[\[Phi]\ Degree]\^2\); 
        S = \((1 - f)\)\^2*C; x = a*\((C + h\/a)\)*Cos[\[Phi]\ Degree]; 
        z = a*\((S + h\/a)\)*
            Sin[\[Phi]\ Degree]; {ArcTan[x, z]\/Degree, \@\(x\^2 + \
z\^2\)}]\)], "Input"],

Cell[BoxData[
    \(latgeocen2latgeode[\[Phi]_] := 
      ArcTan[Cos[\[Phi]\ Degree], Sin[\[Phi]\ Degree]\/\((1 - \
1\/298.257)\)\^2]\/Degree\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(geo2topo[{\[Lambda]_, \[Phi]_, h_, tsid_, \[Alpha]rec_, dec_, r_}] := 
      Module[{lat, \[Rho], x, y, z, \[Alpha]rect, dect, rt}, 
        lat = \(geodes2geocen[{\[Phi], 
                h}]\)[\([1]\)]; \[Rho] = \(geodes2geocen[{\[Phi], 
                h}]\)[\([2]\)]; 
        x = ua*r*Cos[dec\ Degree]*Cos[\[Alpha]rec\ Degree] - \[Rho]*
              Cos[lat\ Degree]*Cos[\((tsid + \[Lambda])\)\ Degree]; 
        y = ua*r*Cos[dec\ Degree]*Sin[\[Alpha]rec\ Degree] - \[Rho]*
              Cos[lat\ Degree]*Sin[\((tsid + \[Lambda])\)\ Degree]; 
        z = ua*r*Sin[dec\ Degree] - \[Rho]*Sin[lat\ Degree]; \[Alpha]rect = 
          ArcTan[x, y]; dect = ArcTan[y/Sin[\[Alpha]rect], z]; 
        rt = Sqrt[x^2 + y^2 + z^2]; {\[Alpha]rect/Degree, dect/Degree, 
          rt/ua}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(\[Alpha]rect\\)\\\" is similar to existing \
symbol \\\"\\!\\(\[Alpha]rec\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(dect\\)\\\" is similar to existing symbol \\\
\"\\!\\(dec\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\
\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(eh2ho[{lat_, hor_, dec_}] := 
      Module[{alt, azi}, 
        alt = N[ArcSin[
              Cos[lat\ Degree]*Cos[dec\ Degree]*Cos[hor\ Degree] + 
                Sin[lat\ Degree]*Sin[dec\ Degree]]]; 
        azi = N[ArcTan[
              Sin[lat\ Degree]*Cos[dec\ Degree]*Cos[hor\ Degree] - 
                Cos[lat\ Degree]*Sin[dec\ Degree], 
              Cos[dec\ Degree]*Sin[hor\ Degree]]]; {azi/Degree, 
          alt/Degree}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(\(ecu2ecli[{t_, \[Alpha]rec_, dec_, dist_}] := 
      Module[{\[Lambda]cel, \[Beta]cel, \[Epsilon] = 23.4393}, \[Beta]cel = 
          N[ArcSin[\(-Sin[\[Epsilon]\ Degree]\)*Cos[dec\ Degree]*
                  Sin[15\ \[Alpha]rec\ Degree] + 
                Cos[\[Epsilon]\ Degree]*Sin[dec\ Degree]]]; \[Lambda]cel = 
          N[ArcTan[Cos\ [dec\ Degree]*Cos[15\ \[Alpha]rec\ Degree], 
              Cos[\[Epsilon]\ Degree]*Cos[dec\ Degree]*
                  Sin[15\ \[Alpha]rec\ Degree] + 
                Sin[\[Epsilon]\ Degree]*Sin[dec\ Degree]]]; {t, \[Lambda]cel/
            Degree, \[Beta]cel/Degree, dist}]\)\(\[IndentingNewLine]\)
    \)\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(\[Beta]cel\\)\\\" is similar to existing \
symbol \\\"\\!\\(\[Lambda]cel\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[BoxData[
    \(ecli2ecu[{t_, \[Lambda]cel_, \[Beta]cel_, dist_}] := 
      Module[{\[Alpha]rec, dec, \[Epsilon] = 23.4393}, 
        dec = N[ArcSin[
              Sin[\[Epsilon]\ Degree]*Cos[\[Beta]cel\ Degree]*
                  Sin[\[Lambda]cel\ Degree] + 
                Cos[\[Epsilon]\ Degree]*
                  Sin[\[Beta]cel\ Degree]]]; \[Alpha]rec = 
          N[ArcTan[Cos[\[Beta]cel\ Degree]*Cos[\[Lambda]cel\ Degree], 
              Cos[\[Epsilon]\ Degree]*Cos[\[Beta]cel\ Degree]*
                  Sin[\[Lambda]cel\ Degree] - 
                Sin[\[Epsilon]\ Degree]*Sin[\[Beta]cel\ Degree]]]; {t, 
          Mod[\[Alpha]rec/Degree, 360], dec/Degree, dist/ua}]\)], "Input"],

Cell[BoxData[
    \(correcluna[{t_, \[Alpha]rec_, dec_, dist_}] := 
      Module[{\[Lambda]\[Beta], \[Lambda]\[Beta]cor}, \[Lambda]\[Beta] = 
          ecu2ecli[{t, \[Alpha]rec, dec, 
              dist}]; \[Lambda]\[Beta]cor = \[Lambda]\[Beta] + {0, 
              0.5/3600, \(-0.25\)/3600, 0}; 
        ecli2ecu[\[Lambda]\[Beta]cor]]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Transformaci\[OAcute]n coordenadas del plano fundamental", \
"Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\[Xi]\[Eta]fun[t_] := 
      Module[{utfun, relit}, 
        utfun = u /. 
            FindRoot[
              peley[t] - preliphor[t]*Sin[u] - 
                  1/preliphor[t]*Tan[u]*\((pelex[t] - Cos[u])\) \[Equal] 
                0, {u, ArcTan[pelex[t], peley[t]]}]; 
        relit = preliphor[t]; {Cos[utfun], relit*Sin[utfun]}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(peley\\)\\\" is similar to existing symbol \
\\\"\\!\\(peled\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pelex\\)\\\" is similar to existing symbols \
\\!\\({peled, peley}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \( (*\[Xi]\[Eta]par2xyz[t_] := 
        cambcoorcart[{\(\[Xi]\[Eta]fun[t]\)[\([1]\)] 
              Cos[ArcTan[peleip[t]]], \(\[Xi]\[Eta]fun[t]\)[\([2]\)] 
              Cos[ArcTan[peleip[t]]], \(-Sin[ArcTan[peleip[t]]]\), 
            t}]*) \)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]par2xyz[t_] := \[Xi]\[Eta]fun2xyz[t]\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]fun2xyz[t_] := 
      cambcoorcart[{\(\[Xi]\[Eta]fun[t]\)[\([1]\)], \(\[Xi]\[Eta]fun[
              t]\)[\([2]\)], 0, t}]\)], "Input"],

Cell[BoxData[
    \( (*\[Xi]\[Eta]tot2xyz[t_] := 
        cambcoorcart[{\(\[Xi]\[Eta]fun[t]\)[\([1]\)] 
              Cos[ArcTan[peleis[t]]], \(\[Xi]\[Eta]fun[t]\)[\([2]\)] 
              Cos[ArcTan[peleis[t]]], \(-Sign[pelels[t]]\)*
              Sin[ArcTan[peleis[t]]], t}]*) \)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]tot2xyz[t_] := \[Xi]\[Eta]fun2xyz[t]\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]par2ecu[t_] := cart2ecu[\[Xi]\[Eta]par2xyz[t]]\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]fun2ecu[t_] := cart2ecu[\[Xi]\[Eta]fun2xyz[t]]\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]tot2ecu[t_] := cart2ecu[\[Xi]\[Eta]tot2xyz[t]]\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]par2lonlat[
        t_] := {grad2gm[cormerefe[\(\[Xi]\[Eta]par2ecu[t]\)[\([1]\)]]], 
        grad2gm[latgeocen2latgeode[\(\[Xi]\[Eta]par2ecu[
                t]\)[\([2]\)]]]}\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]fun2lonlat[
        t_] := {grad2gm[cormerefe[\(\[Xi]\[Eta]fun2ecu[t]\)[\([1]\)]]], 
        grad2gm[latgeocen2latgeode[\(\[Xi]\[Eta]fun2ecu[
                t]\)[\([2]\)]]]}\)], "Input"],

Cell[BoxData[
    \(\[Xi]\[Eta]tot2lonlat[
        t_] := {grad2gm[cormerefe[\(\[Xi]\[Eta]tot2ecu[t]\)[\([1]\)]]], 
        grad2gm[latgeocen2latgeode[\(\[Xi]\[Eta]tot2ecu[
                t]\)[\([2]\)]]]}\)], "Input"],

Cell[BoxData[
    \(cormerefe[lon_] := 
      lon + 1.00273790935*\[CapitalDelta]t*15\/3600\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Transformaci\[OAcute]n coordenadas del elipsoide al plano fundamental\
\>", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(coramerefe[lon_] := 
      lon - 1.00273790935*\[CapitalDelta]t*15\/3600\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(coramerefe\\)\\\" is similar to existing \
symbol \\\"\\!\\(cormerefe\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(lonlatt2xyz[lon_, lat_, t_] := 
      Module[{lonc, latc, r}, lonc = coramerefe[gm2grad[lon]]; 
        latc = First[geodes2geocen[{gm2grad[lat], 0}]]; 
        r = Last[geodes2geocen[{gm2grad[lat], 0}]]; \(1\/6378.14\) 
          ecu2cart[{lonc, latc, r}]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(lonc\\)\\\" is similar to existing symbols \
\\!\\({lon, long}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(latc\\)\\\" is similar to existing symbol \\\
\"\\!\\(lat\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\
\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(lonlatth2xyz[lon_, lat_, h_, t_] := 
      Module[{lonc, latc, r}, lonc = coramerefe[gm2grad[lon]]; 
        latc = First[geodes2geocen[{gm2grad[lat], h/1000}]]; 
        r = Last[geodes2geocen[{gm2grad[lat], h/1000}]]; \(1\/6378.14\) 
          ecu2cart[{lonc, latc, r}]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(lonlatth2xyz\\)\\\" is similar to existing \
symbol \\\"\\!\\(lonlatt2xyz\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(lonlatt2\[Xi]\[Eta]\[Zeta][lon_, lat_, t_] := 
      Inverse[matcambcoor[t]] . lonlatt2xyz[lon, lat, t]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(lonlatth2\[Xi]\[Eta]\[Zeta][lon_, lat_, h_, t_] := 
      Inverse[matcambcoor[t]] . lonlatth2xyz[lon, lat, h, t]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(lonlatth2\[Xi]\[Eta]\[Zeta]\\)\\\" is \
similar to existing symbol \\\"\\!\\(lonlatt2\[Xi]\[Eta]\[Zeta]\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones geom\[EAcute]tricas del elipsoide", "Subsubsection"],

Cell[BoxData[
    \(radeliphor[d_] := 
      Module[{a, f, \[Phi], u, x, z, r}, a = 1; 
        f = 1\/298.257; \[Phi] = \((90 - d)\) Degree; 
        u = ArcTan[\((1 - f)\) Cos[\[Phi]], Sin[\[Phi]]]; x = a*Cos[u]; 
        z = a*\((1 - f)\)*Sin[u]; r = \@\(x\^2 + z\^2\)]\)], "Input"],

Cell[BoxData[
    \(disEjeElip[{x_, y_, b_, u_}] := 
      Sign[Abs[y] - Abs[b\ Sin[u]]] 
        Sqrt[\((y - b\ Sin[u])\)^2 + \((x - Cos[u])\)^2]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones corte eje de sombra con el elipsoide y duraci\[OAcute]n totalidad \
en eje.\
\>", "Subsubsection"],

Cell[BoxData[
    \(corteejeelip2\[Xi]\[Eta]\[Zeta][{elex_, eley_, eled_, ele\[Mu]_}] := 
      Select[{x, y, z} /. 
          NSolve[{x == elex, 
              y \[Equal] 
                eley, \((\((Matcambcoor[eled, ele\[Mu]] . {x, y, \
z})\)[\([1]\)])\)\^2 + \((\((Matcambcoor[eled, ele\[Mu]] . {x, y, z})\)[\([2]\
\)])\)\^2 + \(1\/\((1 - 1\/298.257)\)\^2\) \((\((Matcambcoor[eled, ele\[Mu]] \
. {x, y, z})\)[\([3]\)])\)\^2 \[Equal] 1}, {x, y, z}], 
        Positive[#[\([3]\)]] &]\)], "Input"],

Cell[BoxData[
    \(\(\(corteejeelip2xyz[{elex_, eley_, eled_, ele\[Mu]_}] := 
      Module[{corte = 
            corteejeelip2\[Xi]\[Eta]\[Zeta][{elex, eley, eled, 
                ele\[Mu]}]}, \[IndentingNewLine]If[
          corte \[Equal] {}, "\<Error\>", 
          Matcambcoor[eled, ele\[Mu]] . corte[\([1]\)]]]\)\(\n\)
    \)\)], "Input"],

Cell[BoxData[
    \(corteejeelip2lonlat[{elex_, eley_, eled_, ele\[Mu]_, t_}] := 
      Module[{corte = 
            corteejeelip2xyz[{elex, eley, eled, 
                ele\[Mu]}]}, \[IndentingNewLine]If[
          corte === "\<Error\>", "\<Error\>", {grad2gm[
              cormerefe[\(cart2ecu[corte]\)[\([1]\)]]], 
            grad2gm[latgeocen2latgeode[\(cart2ecu[corte]\)[\([2]\)]]], 
            t}]]\)], "Input"],

Cell[BoxData[
    \(corteejeelip[t_] := 
      corteejeelip2lonlat[{pelex[t], peley[t], peled[t], pele\[Mu][t], 
          t}]\)], "Input"],

Cell[BoxData[
    \(datoreal[d_] := Select[d, Head[#] \[Equal] List\  &]\)], "Input"],

Cell[BoxData[
    \(listat[t_] := t + Range[\(-1\)/6, 1/6, 1/60]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(deltamenosL[{lon_, lat_, t_}] := 
      Module[{delta, L}, 
        delta = Sqrt[\((pelex[t] - First[lonlatt2\[Xi]\[Eta]\[Zeta][lon, lat, \
t]])\)\^2 + \((peley[t] - Part[lonlatt2\[Xi]\[Eta]\[Zeta][lon, lat, t], 2])\)\
\^2]; L = 
          pelels[t] - 
            Last[lonlatt2\[Xi]\[Eta]\[Zeta][lon, lat, t]]*peleis[t]; 
        delta - Abs[L]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(peleis\\)\\\" is similar to existing symbol \
\\\"\\!\\(pelels\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(deltamenosLt[{lon_, lat_, t_}] := 
      Map[deltamenosL[{lon, lat, #}] &, listat[t]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(deltamenosLt\\)\\\" is similar to existing \
symbol \\\"\\!\\(deltamenosL\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(duraciontoteje[{lon_, lat_, t_}] := 
      Module[{pdeltamenosL, t1, t2}, 
        pdeltamenosL = 
          Interpolation[Transpose[{listat[t], deltamenosLt[{lon, lat, t}]}]]; 
        t1 = n /. FindRoot[pdeltamenosL[n] \[Equal] 0, {n, t - 9/60}]; 
        t2 = n /. FindRoot[pdeltamenosL[n] \[Equal] 0, {n, t + 9/60}]; 
        h2ms[\((t2 - t1)\)]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdeltamenosL\\)\\\" is similar to existing \
symbol \\\"\\!\\(deltamenosL\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(puntoejedur[{lon_, lat_, t_}] := {h2hms[
          t + \((First[fech] - IntegerPart[First[fech]] - 
                  0.5)\)*24 - \[CapitalDelta]t/3600], lon, lat, 
        duraciontoteje[{lon, lat, t}]}\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones corte cono de penumbra con plano fundamental (horizonte terrestre). \
\
\>", "Subsubsection"],

Cell[BoxData[
    \(cortehor[{reli_, elex_, eley_, elel_, eled_, ele\[Mu]_}] := 
      Select[{x, y} /. 
          NSolve[{y\^2\/reli\^2 + x\^2 \[Equal] 
                1, \((y - eley)\)\^2 + \((x - elex)\)\^2 \[Equal] 
                elel\^2}, {x, y}], 
        Head[#[\([1]\)]] \[Equal] Real \[And] 
            Head[#[\([2]\)]] \[Equal] Real &]\)], "Input"],

Cell[BoxData[
    \(\(\(cortehor2xyz[{reli_, elex_, eley_, elel_, eled_, ele\[Mu]_}] := 
      Module[{corte = 
            cortehor[{reli, elex, eley, elel, eled, 
                ele\[Mu]}]}, \[IndentingNewLine]If[
          corte \[Equal] {}, "\<Error\>", 
          Map[Matcambcoor[eled, ele\[Mu]] . {#[\([1]\)], #[\([2]\)], 0} &, 
            corte]]]\)\(\n\)
    \)\)], "Input"],

Cell[BoxData[
    \(\(\(cortehor2lonlat[{reli_, elex_, eley_, elel_, eled_, ele\[Mu]_}] := 
      Module[{corte = 
            cortehor2xyz[{reli, elex, eley, elel, eled, 
                ele\[Mu]}]}, \[IndentingNewLine]If[
          corte === "\<Error\>", "\<Error\>", 
          Map[{grad2gm[cormerefe[\(cart2ecu[#]\)[\([1]\)]]], 
                grad2gm[latgeocen2latgeode[\(cart2ecu[#]\)[\([2]\)]]]} &, 
            corte]]]\)\(\[IndentingNewLine]\)
    \)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(cortehor2lonlatt[
        t_] := {h2hms[
          Mod[t + \((First[fech] - IntegerPart[First[fech]] - 
                    0.5)\)*24 - \[CapitalDelta]t/3600, 24]], 
        cortehor2lonlat[{preliphor[t], pelex[t], peley[t], pelelp[t], 
            peled[t], pele\[Mu][t]}]}\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(cortehor2lonlatt\\)\\\" is similar to \
existing symbol \\\"\\!\\(cortehor2lonlat\\)\\\". \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pelelp\\)\\\" is similar to existing symbol \
\\\"\\!\\(pelels\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones corte cono de penumbra con el elipsoide. ", "Subsubsection"],

Cell[BoxData[
    \(\(lista\[Zeta] = 0.02*Range[1, 50];\)\)], "Input"],

Cell[BoxData[
    \(corteconopelip2\[Xi]\[Eta]\[Zeta][{elex_, eley_, eled_, ele\[Mu]_, 
          elelp_, eleip_}] := 
      Map[Select[\(({x, y, z} /. 
                NSolve[{z \[Equal] #, \((x - elex)\)\^2 + \((y - eley)\)\^2 \
\[Equal] \((elelp - #*eleip)\)\^2, \((\((Matcambcoor[eled, ele\[Mu]] . {x, y, \
z})\)[\([1]\)])\)\^2 + \((\((Matcambcoor[eled, ele\[Mu]] . {x, y, z})\)[\([2]\
\)])\)\^2 + \(1\/\((1 - 1\/298.257)\)\^2\) \((\((Matcambcoor[eled, ele\[Mu]] \
. {x, y, z})\)[\([3]\)])\)\^2 \[Equal] 1}, {x, y, z}])\), 
            Function[v, Head[v[\([1]\)]] \[Equal] Real]] &, 
        lista\[Zeta]]\)], "Input"],

Cell[BoxData[
    \(\(\(corteconopelip2xyz[{elex_, eley_, eled_, ele\[Mu]_, elelp_, 
          eleip_}] := 
      Module[{corte = 
            corteconopelip2\[Xi]\[Eta]\[Zeta][{elex, eley, eled, ele\[Mu], 
                elelp, eleip}]}, \[IndentingNewLine]If[
          corte \[Equal] {}, "\<Error\>", 
          Map[Matcambcoor[eled, 
                  ele\[Mu]] . {#[\([1]\)], #[\([2]\)], #[\([3]\)]} &, 
            corte, {2}]]]\)\(\n\)
    \)\)], "Input"],

Cell[BoxData[
    \(\(\(corteconopelip2lonlat[{elex_, eley_, eled_, ele\[Mu]_, elelp_, 
          eleip_}] := 
      Module[{corte = 
            corteconopelip2xyz[{elex, eley, eled, ele\[Mu], elelp, 
                eleip}]}, \[IndentingNewLine]If[
          corte === "\<Error\>", "\<Error\>", 
          Map[{grad2gm[cormerefe[\(cart2ecu[#]\)[\([1]\)]]], 
                grad2gm[latgeocen2latgeode[\(cart2ecu[#]\)[\([2]\)]]]} &, 
            corte, {2}]]]\)\(\[IndentingNewLine]\)
    \)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(corteconopelip[t_] := 
      corteconopelip2lonlat[{pelex[t], peley[t], peled[t], pele\[Mu][t], 
          pelelp[t], peleip[t]}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(peleip\\)\\\" is similar to existing symbols \
\\!\\({eleip, peleis, pelelp}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones curvas l\[IAcute]mite Norte y Sur. ", "Subsubsection"],

Cell[BoxData[
    \(elxelylpipd\[Mu]2\[Zeta]Q[{elex_, delex_, eley_, deley_, elelp_, 
          delelp_, eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_}] := 
      Module[{\[Zeta], Q}, 
        Select[{\[Zeta], Q} /. 
            NSolve[{\[Zeta] == 
                  1/\((\((1 + 
                              eleip\^2)\)*\((\((dele\[Mu]\ Degree)\)*
                                Cos[eled\ Degree]*
                                Sin[Q] - \((deled\ Degree)\)*
                                Cos[Q])\))\) \((\(-delelp\) + \((deled\ \
Degree)\)*eley*eleip - \((dele\[Mu]\ Degree)\)*elex*Cos[eled\ Degree]*eleip + 
                        Cos[Q]*\((deley - \((dele\[Mu]\ Degree)\)*elex*
                                Sin[eled\ Degree] - \((deled\ Degree)\)*elelp*
                                eleip)\) + 
                        Sin[Q]*\((delex + \((dele\[Mu]\ Degree)\)*eley*
                                Sin[eled\ Degree] + 
                              elelp*\((dele\[Mu]\ Degree)\)*Cos[eled\ Degree]*
                                eleip)\))\), \((\((Matcambcoor[eled, \
ele\[Mu]] . {elex - \((elelp - \[Zeta]*eleip)\)*Sin[Q], eley - \((elelp - \
\[Zeta]*eleip)\)*Cos[Q], \[Zeta]})\)[\([1]\)])\)\^2 + \((\((Matcambcoor[eled, \
ele\[Mu]] . {elex - \((elelp - \[Zeta]*eleip)\)*Sin[Q], eley - \((elelp - \
\[Zeta]*eleip)\)*Cos[Q], \[Zeta]})\)[\([2]\)])\)\^2 + \(1\/\((1 - 1\/298.257)\
\)\^2\) \((\((Matcambcoor[eled, ele\[Mu]] . {elex - \((elelp - \[Zeta]*eleip)\
\)*Sin[Q], eley - \((elelp - \[Zeta]*eleip)\)*Cos[Q], \[Zeta]})\)[\([3]\)])\)\
\^2 \[Equal] 1}, {\[Zeta], Q}], Positive[#[\([1]\)]] &]]\)], "Input"],

Cell[BoxData[
    \(elxelylpipd\[Mu]2xyz[{elex_, delex_, eley_, deley_, elelp_, delelp_, 
          eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_}] := 
      Module[{corte = 
            elxelylpipd\[Mu]2\[Zeta]Q[{elex, delex, eley, deley, elelp, 
                delelp, eleip, eled, deled, ele\[Mu], dele\[Mu]}]}, 
        Map[Matcambcoor[eled, 
                ele\[Mu]] . {elex - \((elelp - #[\([1]\)]*eleip)\)*
                    Sin[#[\([2]\)]], 
                eley - \((elelp - #[\([1]\)]*eleip)\)*
                    Cos[#[\([2]\)]], #[\([1]\)]} &, corte]]\)], "Input"],

Cell[BoxData[
    \(elxelylpipd\[Mu]2lonlat[{elex_, delex_, eley_, deley_, elelp_, delelp_, 
          eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_}] := 
      Module[{corte = 
            elxelylpipd\[Mu]2xyz[{elex, delex, eley, deley, elelp, delelp, 
                eleip, eled, deled, ele\[Mu], dele\[Mu]}]}, 
        Map[{grad2gm[cormerefe[\(cart2ecu[#]\)[\([1]\)]]], 
              grad2gm[latgeocen2latgeode[\(cart2ecu[#]\)[\([2]\)]]]} &, 
          corte]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(puntoslimitep[
        t_] := {h2hms[
          Mod[t + \((First[fech] - IntegerPart[First[fech]] - 
                    0.5)\)*24 - \[CapitalDelta]t/3600, 24]], 
        elxelylpipd\[Mu]2lonlat[{pelex[t], pdelex[t], peley[t], pdeley[t], 
            pelelp[t], pdelelp[t], peleip[t], peled[t], pdeled[t], 
            pele\[Mu][t], pdele\[Mu][t]}]}\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdelex\\)\\\" is similar to existing symbols \
\\!\\({delex, pelex}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdeley\\)\\\" is similar to existing symbols \
\\!\\({deley, pdelex, peley}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdelelp\\)\\\" is similar to existing \
symbols \\!\\({delelp, pelelp}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(General :: \\\"spell\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(puntoslimites[
        t_] := {h2hms[
          Mod[t + \((First[fech] - IntegerPart[First[fech]] - 
                    0.5)\)*24 - \[CapitalDelta]t/3600, 24]], 
        elxelylpipd\[Mu]2lonlat[{pelex[t], pdelex[t], peley[t], pdeley[t], 
            pelels[t], pdelels[t], peleis[t], peled[t], pdeled[t], 
            pele\[Mu][t], pdele\[Mu][t]}]}\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(puntoslimites\\)\\\" is similar to existing \
symbol \\\"\\!\\(puntoslimitep\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\
\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdelels\\)\\\" is similar to existing \
symbols \\!\\({pdelelp, pelels}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones curvas de m\[AAcute]ximo de eclipse al orto/ocaso. ", \
"Subsubsection"],

Cell[BoxData[
    \( (*maxhor2\[Xi]\[Eta]\[Zeta][{elex_, delex_, eley_, deley_, elelp_, 
            delelp_, eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_, 
            reliphor_}] := \(Select[{\[Xi], \[Eta], \[Zeta]} /. 
                NSolve[{\[Zeta] \[Equal] 
                      0, \[Xi]\^2 + \[Eta]\^2\/reliphor\^2 \[Equal] 
                      1, \((eley - \[Eta])\)\ \((\((deled\ Degree)\) \[Zeta] \
+ deley - \((dele\[Mu]\ Degree)\)\ \[Xi]\ Sin[
                                  eled\ Degree])\) + \ \((elex - \[Xi])\)\ \
\((delex - \((dele\[Mu]\ Degree)\)\ \((\[Zeta]\ Cos[
                                        eled\ Degree] - \[Eta]\ Sin[
                                        eled\ Degree])\))\) == \ \((elelp - \
\[Zeta]\ eleip)\)\ \((delelp - \((\((deled\ Degree)\)\ \[Eta] - \((dele\[Mu]\ \
Degree)\)\ \[Xi]\ Cos[eled\ Degree])\) eleip)\)}, {\[Xi], \[Eta], \[Zeta]}], 
              Head[#[\([1]\)]] \[Equal] 
                    Real \[And] \ \@\(\((elex - #[\([1]\)])\)\^2 + \((eley - \
#[\([2]\)])\)\^2\) \[LessEqual] 
                    elelp\  &]\ esta\ es\ con\ \[CapitalDelta]\^2 = 
          L\^2\)\ *) \)], "Input"],

Cell[BoxData[
    \(maxhor2\[Xi]\[Eta]\[Zeta][{elex_, delex_, eley_, deley_, elelp_, 
          delelp_, eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Select[{\[Xi], \[Eta], \[Zeta]} /. 
          NSolve[{\[Zeta] \[Equal] 
                0, \[Xi]\^2 + \[Eta]\^2\/reliphor\^2 \[Equal] 
                1, \(-delelp\) + \((2*\((elex - \[Xi])\) \((delex + \[Eta]\ \
\((dele\[Mu]\ Degree)\)\ Sin[eled\ Degree])\) + 
                        2 \((\(-\[Eta]\) + 
                              eley)\) \((deley - \((dele\[Mu]\ Degree)\)\ \
\[Xi]\ Sin[
                                  eled\ Degree])\))\)/\((2\ \@\(\((elex - \
\[Xi])\)\^2 + \((eley - \[Eta])\)\^2\))\) + \((\((deled\ Degree)\)\ \[Eta]\  \
- \((dele\[Mu]\ Degree)\)\ \[Xi]\ Cos[eled\ Degree])\) eleip \[Equal] 
                0}, {\[Xi], \[Eta], \[Zeta]}], 
        Head[#[\([1]\)]] \[Equal] 
              Real \[And] \ \@\(\((elex - #[\([1]\)])\)\^2 + \((eley - \
#[\([2]\)])\)\^2\) \[LessEqual] elelp\  &]\)], "Input"],

Cell[BoxData[
    \(maxhor2xyz[{elex_, delex_, eley_, deley_, elelp_, delelp_, eleip_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Map[Matcambcoor[eled, 
              ele\[Mu]] . {#[\([1]\)], #[\([2]\)], #[\([3]\)]} &, 
        maxhor2\[Xi]\[Eta]\[Zeta][{elex, delex, eley, deley, elelp, delelp, 
            eleip, eled, deled, ele\[Mu], dele\[Mu], reliphor}]]\)], "Input"],

Cell[BoxData[
    \(maxhor2lonlat[{elex_, delex_, eley_, deley_, elelp_, delelp_, eleip_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Module[{puntos = 
            maxhor2xyz[{elex, delex, eley, deley, elelp, delelp, eleip, eled, 
                deled, ele\[Mu], dele\[Mu], reliphor}]}, 
        Map[{grad2gm[cormerefe[\(cart2ecu[#]\)[\([1]\)]]], 
              grad2gm[latgeocen2latgeode[\(cart2ecu[#]\)[\([2]\)]]]} &, 
          puntos]]\)], "Input"],

Cell[BoxData[
    \(maxhor[
        t_] := {h2hms[
          Mod[t + \((First[fech] - IntegerPart[First[fech]] - 
                    0.5)\)*24 - \[CapitalDelta]t/3600, 24]], 
        maxhor2lonlat[{pelex[t], pdelex[t], peley[t], pdeley[t], pelelp[t], 
            pdelelp[t], peleip[t], peled[t], pdeled[t], pele\[Mu][t], 
            pdele\[Mu][t], preliphor[t]}]}\)], "Input"],

Cell[BoxData[
    \(maxhorbis2\[Xi]\[Eta]\[Zeta][{elex_, delex_, eley_, deley_, elelp_, 
          delelp_, eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Select[{\[Xi], \[Eta], \[Zeta]} /. 
          NSolve[{\[Zeta] \[Equal] 
                0, \[Xi]\^2 + \[Eta]\^2\/reliphor\^2 \[Equal] 
                1, \(-delelp\) + \((2*\((elex - \[Xi])\) \((delex + \[Eta]\ \
\((dele\[Mu]\ Degree)\)\ Sin[eled\ Degree])\) + 
                        2 \((\(-\[Eta]\) + 
                              eley)\) \((deley - \((dele\[Mu]\ Degree)\)\ \
\[Xi]\ Sin[
                                  eled\ Degree])\))\)/\((2\ \@\(\((elex - \
\[Xi])\)\^2 + \((eley - \[Eta])\)\^2\))\) + \((\((deled\ Degree)\)\ \[Eta]\  \
- \((dele\[Mu]\ Degree)\)\ \[Xi]\ Cos[eled\ Degree])\) eleip \[Equal] 
                0}, {\[Xi], \[Eta], \[Zeta]}], 
        Head[#[\([1]\)]] \[Equal] Real\  &]\)], "Input"],

Cell[BoxData[
    \(maxhorbisselec\[Xi]\[Eta]\[Zeta][{elex_, delex_, eley_, deley_, elelp_, 
          delelp_, eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Module[{dismin}, 
        dismin = 
          dismaxconopsign[{elex, delex, eley, deley, elelp, delelp, eleip, 
              eled, deled, ele\[Mu], dele\[Mu], reliphor}]\ ; 
        Select[maxhorbis2\[Xi]\[Eta]\[Zeta][{elex, delex, eley, deley, elelp, 
              delelp, eleip, eled, deled, ele\[Mu], dele\[Mu], reliphor}], 
          Sqrt[\((#[\([1]\)] - elex)\)\^2 + \((#[\([2]\)] - eley)\)\^2] - 
                elelp \[Equal] dismin &]]\)], "Input"],

Cell[BoxData[
    \(maxhorbis2xyz[{elex_, delex_, eley_, deley_, elelp_, delelp_, eleip_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Map[Matcambcoor[eled, 
              ele\[Mu]] . {#[\([1]\)], #[\([2]\)], #[\([3]\)]} &, 
        maxhorbisselec\[Xi]\[Eta]\[Zeta][{elex, delex, eley, deley, elelp, 
            delelp, eleip, eled, deled, ele\[Mu], dele\[Mu], 
            reliphor}]]\)], "Input"],

Cell[BoxData[
    \(maxhorbis2lonlat[{elex_, delex_, eley_, deley_, elelp_, delelp_, 
          eleip_, eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Module[{puntos = 
            maxhorbis2xyz[{elex, delex, eley, deley, elelp, delelp, eleip, 
                eled, deled, ele\[Mu], dele\[Mu], reliphor}]}, 
        Map[{grad2gm[cormerefe[\(cart2ecu[#]\)[\([1]\)]]], 
              grad2gm[latgeocen2latgeode[\(cart2ecu[#]\)[\([2]\)]]]} &, 
          puntos]]\)], "Input"],

Cell[BoxData[
    \(maxhorbis[
        t_] := {h2hms[
          Mod[t + \((First[fech] - IntegerPart[First[fech]] - 
                    0.5)\)*24 - \[CapitalDelta]t/3600, 24]], 
        maxhorbis2lonlat[{pelex[t], pdelex[t], peley[t], pdeley[t], 
            pelelp[t], pdelelp[t], peleip[t], peled[t], pdeled[t], 
            pele\[Mu][t], pdele\[Mu][t], preliphor[t]}]}\)], "Input"],

Cell[BoxData[
    \(dismaxconop[{elex_, delex_, eley_, deley_, elelp_, delelp_, eleip_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Map[Sqrt[\((#[\([1]\)] - elex)\)\^2 + \((#[\([2]\)] - eley)\)\^2] - 
            elelp &, 
        maxhorbis2\[Xi]\[Eta]\[Zeta][{elex, delex, eley, deley, elelp, 
            delelp, eleip, eled, deled, ele\[Mu], dele\[Mu], 
            reliphor}]]\)], "Input"],

Cell[BoxData[
    \(minabsconsign[l_] := 
      Module[{min = Min[Abs[l]]}, 
        Select[l, Abs[#] \[Equal] min &]]\)], "Input"],

Cell[BoxData[
    \(dismaxconopsign[{elex_, delex_, eley_, deley_, elelp_, delelp_, eleip_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Module[{aux}, 
        aux = minabsconsign[
            dismaxconop[{elex, delex, eley, deley, elelp, delelp, eleip, 
                eled, deled, ele\[Mu], dele\[Mu], 
                reliphor}]]; \[IndentingNewLine]If[aux \[Equal] {}, {}, 
          aux[\([1]\)]]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(dismaxconos[{elex_, delex_, eley_, deley_, elels_, delels_, eleis_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Map[Sqrt[\((#[\([1]\)] - elex)\)\^2 + \((#[\([2]\)] - eley)\)\^2] - 
            Abs[elels] &, 
        maxhorbis2\[Xi]\[Eta]\[Zeta][{elex, delex, eley, deley, elels, 
            delels, eleis, eled, deled, ele\[Mu], dele\[Mu], 
            reliphor}]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(dismaxconos\\)\\\" is similar to existing \
symbol \\\"\\!\\(dismaxconop\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\
\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(dismaxconossign[{elex_, delex_, eley_, deley_, elels_, delels_, eleis_, 
          eled_, deled_, ele\[Mu]_, dele\[Mu]_, reliphor_}] := 
      Module[{aux}, 
        aux = minabsconsign[
            dismaxconos[{elex, delex, eley, deley, elels, delels, eleis, 
                eled, deled, ele\[Mu], dele\[Mu], 
                reliphor}]]; \[IndentingNewLine]If[aux \[Equal] {}, {}, 
          aux[\([1]\)]]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(dismaxconossign\\)\\\" is similar to \
existing symbol \\\"\\!\\(dismaxconopsign\\)\\\". \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones gr\[AAcute]fico de eclipse. ", "Subsubsection"],

Cell[BoxData[
    \(grafpos[{cs1_, cs2_, sds_, cl1_, cl2_, sdl_, t_}] := 
      Show[Graphics[{{CMYKColor[0, 0, 1, 0], 
              Disk[{cs1, cs2}, sds]}, {CMYKColor[0, 0, 0, 0], 
              Disk[{cs1 + \((cl1 - cs1)\)*Cos[cs2\ Degree], cl2}, 
                sdl]}, {Thickness[ .01], 
              Line[{{cs1 - 2  sds, 0}, {cs1 + 2  sds, 0}}]}, 
            Text[Horizonte, {cs1, \(-0.05\)}, {0, 0}]}, Axes \[Rule] True, 
          AspectRatio \[Rule] Automatic, AxesOrigin \[Rule] {cs1, cs2}, 
          AxesLabel -> {altura : cs2, azimut : cs1}, Ticks \[Rule] None, 
          PlotRange \[Rule] {{cs1 - 2  sds, cs1 + 2  sds}, {cs2 - 2  sds, 
                cs2 + 2  sds}}, Background \[Rule] CMYKColor[1, 0, 0, 0], 
          PlotLabel \[Rule] Hora : t]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(pos2graf[{\[Lambda]_, \[Phi]_, h_, TS_, \[Alpha]recs_, decs_, 
          rs_, \[Alpha]recl_, decl_, rl_, t_}] := 
      Module[{\[Alpha]rects, dects, rts, \[Alpha]rectl, dectl, rtl, hors, 
          horl, \[Phi]cen = \(geodes2geocen[{\[Phi], h}]\)[\([1]\)], cs1, 
          cs2, sds, cl1, cl2, sdl, 
          H}, \[Alpha]rects = \(geo2topo[{\[Lambda], \[Phi], h, 
                TS, \[Alpha]recs, decs, rs}]\)[\([1]\)]; 
        dects = \(geo2topo[{\[Lambda], \[Phi], h, TS, \[Alpha]recs, decs, 
                rs}]\)[\([2]\)]; 
        rts = \(geo2topo[{\[Lambda], \[Phi], h, TS, \[Alpha]recs, decs, 
                rs}]\)[\([3]\)]; \[Alpha]rectl = \(geo2topo[{\[Lambda], \
\[Phi], h, TS, \[Alpha]recl, decl, rl}]\)[\([1]\)]; 
        dectl = \(geo2topo[{\[Lambda], \[Phi], h, TS, \[Alpha]recl, decl, 
                rl}]\)[\([2]\)]; 
        rtl = \(geo2topo[{\[Lambda], \[Phi], h, TS, \[Alpha]recl, decl, 
                rl}]\)[\([3]\)]; hors = TS + \[Lambda] - \[Alpha]rects; 
        horl = TS + \[Lambda] - \[Alpha]rectl; 
        cs1 = \(eh2ho[{\[Phi]cen, hors, dects}]\)[\([1]\)]; 
        cs2 = \(eh2ho[{\[Phi]cen, hors, dects}]\)[\([2]\)]; 
        sds = ArcSin[radioS/\ rts]/Degree; 
        cl1 = \(eh2ho[{\[Phi]cen, horl, dectl}]\)[\([1]\)]; 
        cl2 = \(eh2ho[{\[Phi]cen, horl, dectl}]\)[\([2]\)]; 
        sdl = ArcSin[radioL/rtl]/Degree; 
        H = h2hms[
            Mod[t + \((First[fech] - IntegerPart[First[fech]] - 
                      0.5)\)*24 - \[CapitalDelta]t/3600, 24]]; {cs1, cs2, 
          sds, cl1, cl2, sdl, H}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(\[Alpha]rects\\)\\\" is similar to existing \
symbols \\!\\({\[Alpha]recs, \[Alpha]rect}\\). \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(dects\\)\\\" is similar to existing symbols \
\\!\\({decs, dect}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(\[Alpha]rectl\\)\\\" is similar to existing \
symbols \\!\\({\[Alpha]recl, \[Alpha]rect, \[Alpha]rects}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(General :: \\\"spell\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(radioL\\)\\\" is similar to existing symbol \
\\\"\\!\\(radioS\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constantes y par\[AAcute]metros.", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(\[CapitalDelta]t = 66;\)\), "\[IndentingNewLine]", 
    \(\(ua = 
        1.49597870691\ 10^8;\)\[IndentingNewLine] (*\(ua = 
          1.4959787550\ 10^8;\)*) \), "\[IndentingNewLine]", 
    \(\(radioS2 = 695950\/ua;\)\), "\[IndentingNewLine]", 
    \(\(radioS = 
        ArcSin[\((15/60 + 59.64/3600)\) 
            Degree];\)\[IndentingNewLine] (*\(radioecT = 
          6378.1366\/ua;\)*) \), "\[IndentingNewLine]", 
    \(\(radioecT = 6378.14\/ua;\)\), "\[IndentingNewLine]", 
    \(\(radioL = 0.2725076*radioecT;\)\), "\[IndentingNewLine]", 
    \(\(radioL2 = 1738.3\/ua;\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(radioL2\\)\\\" is similar to existing symbol \
\\\"\\!\\(radioS2\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Lectura de datos", "Subsection"],

Cell["\<\
Fichero Sol: tiempo en DJ, AR en horas, dec en \.ba, distancia en ua
Fichero Luna: tiempo en DJ, AR en horas, dec en \.ba, distancia en km\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(fichS = "\<D:\\Documents and Settings\\ESCUELA1\\Escritorio\\Eclipses\
\\Sol090126.dat\>";\)\), "\[IndentingNewLine]", 
    \(\(fichL = "\<D:\\Documents and Settings\\ESCUELA1\\Escritorio\\Eclipses\
\\Luna090126.dat\>";\)\), "\[IndentingNewLine]", 
    \(\(\(fichTS = "\<D:\\Documents and \
Settings\\ESCUELA1\\Escritorio\\Eclipses\\TS090126.dat\>";\)\(\
\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\(datsol = ReadList[fichS, Array[Number &, 4]];\)\), "\n", 
    \(\(datlun = 
        ReadList[fichL, Array[Number &, 4]];\)\), "\[IndentingNewLine]", 
    \(\(\(datTS = 
        ReadList[fichTS, Array[Number &, 10]];\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\(\(sol = 
        Map[\((#\ {1, 15, 1, 1})\) &, datsol];\)\(\[IndentingNewLine]\)
    \) (*luna = Map[\((#\ {1, 15, 1, 1/ua})\) &, datlun]; 
      sin\ corregir\ por\ \[CapitalDelta]\[Lambda]\ y\ \[CapitalDelta]\[Beta]\
\ *) \), "\n", 
    \(\(luna = Map[correcluna, datlun];\)\), "\[IndentingNewLine]", 
    \(\(\(TS = 
        15*Map[hms2h, 
            Transpose[\(Transpose[
                  datTS]\)[\([{2, 3, 5}]\)]]];\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\({fech, \[Alpha]recS, decS, distS} = Transpose[sol];\)\), "\n", 
    \(\({fech, \[Alpha]recL, decL, distL} = 
        Transpose[
          luna];\)\[IndentingNewLine]\[IndentingNewLine] (*\(horas = \((fech \
- Min[fech])\) 24;\)*) \), "\[IndentingNewLine]", 
    \(\(horas = \(1\/60\) Range[0, Length[fech] - 1];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(fichL\\)\\\" is similar to existing symbol \
\\\"\\!\\(fichS\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(fichTS\\)\\\" is similar to existing symbol \
\\\"\\!\\(fichS\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(\[Alpha]recS\\)\\\" is similar to existing \
symbols \\!\\({\[Alpha]rec, \[Alpha]recs}\\). \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(decS\\)\\\" is similar to existing symbols \
\\!\\({dec, decs}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(distS\\)\\\" is similar to existing symbol \
\\\"\\!\\(dist\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(\[Alpha]recL\\)\\\" is similar to existing \
symbols \\!\\({\[Alpha]rec, \[Alpha]recl, \[Alpha]recS}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(decL\\)\\\" is similar to existing symbols \
\\!\\({dec, decl, decS}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(distL\\)\\\" is similar to existing symbols \
\\!\\({dist, distS}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(General :: \\\"spell\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(horas\\)\\\" is similar to existing symbols \
\\!\\({hora, hors}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones Interpolantes de ascensi\[OAcute]n recta, declinaci\[OAcute]n y \
distancia.\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(p\[Alpha]recS = 
        Interpolation[
          Transpose[{horas, \[Alpha]recS}]];\)\), "\[IndentingNewLine]", 
    \(\(pdecS = 
        Interpolation[Transpose[{horas, decS}]];\)\), "\[IndentingNewLine]", 
    \(\(pdistS = 
        Interpolation[
          Transpose[{horas, distS}]];\)\), "\[IndentingNewLine]", 
    \(\(p\[Alpha]recL = 
        Interpolation[Transpose[{horas, \[Alpha]recL}]];\)\), "\n", 
    \(\(pdecL = Interpolation[Transpose[{horas, decL}]];\)\), "\n", 
    \(\(pdistL = 
        Interpolation[
          Transpose[{horas, distL}]];\)\), "\[IndentingNewLine]", 
    \(\(pTS = Interpolation[Transpose[{horas, TS}]];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdecS\\)\\\" is similar to existing symbol \
\\\"\\!\\(decS\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdistS\\)\\\" is similar to existing symbol \
\\\"\\!\\(distS\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(p\[Alpha]recL\\)\\\" is similar to existing \
symbol \\\"\\!\\(p\[Alpha]recS\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\
\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdecL\\)\\\" is similar to existing symbols \
\\!\\({decL, pdecS}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdistL\\)\\\" is similar to existing symbols \
\\!\\({distL, pdistS}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Conjunci\[OAcute]n en AR. Obtenci\[OAcute]n de ascensi\[OAcute]n recta, \
declinaciones, paralajes horizontales ecuatoriales y semidi\[AAcute]metros \
verdaderos de Sol y Luna para esa hora. \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(hcon = \((t /. 
            FindRoot[
              p\[Alpha]recS[t] - p\[Alpha]recL[t] \[Equal] 0, {t, 
                0}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[hcon + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 
        24]]\[IndentingNewLine] (*hcon = 
        hms2h[{2, 46, 14.756}] + 74/3600*) \), "\[IndentingNewLine]", 
    \(p\[Alpha]recS[hcon]/15 // h2hms\), "\n", 
    \(pdecS[hcon] // h2hms\), "\n", 
    \(ArcSin[radioecT/\ pdistS[hcon]]/Degree // h2hms\), "\n", 
    \(ArcSin[radioS/\ pdistS[hcon]]/Degree // h2hms\), "\n", 
    \(p\[Alpha]recL[hcon]/15 // h2hms\), "\n", 
    \(pdecL[hcon] // h2hms\), "\n", 
    \(ArcSin[radioecT/pdistL[hcon]]/Degree // h2hms\), "\n", 
    \(ArcSin[radioL/pdistL[hcon]]/Degree // h2hms\)}], "Input"],

Cell[BoxData[
    \({7, 46, 22.962355672901282`}\)], "Output"],

Cell[BoxData[
    \({20, 35, 30.683083144486865`}\)], "Output"],

Cell[BoxData[
    \({\(-18\), \(-39\), \(-2.750552342083301`\)}\)], "Output"],

Cell[BoxData[
    \({0, 0, 8.93137061618137`}\)], "Output"],

Cell[BoxData[
    \({0, 16, 14.621229413132353`}\)], "Output"],

Cell[BoxData[
    \({20, 35, 30.683083144486865`}\)], "Output"],

Cell[BoxData[
    \({\(-18\), \(-55\), \(-23.67016536755684`\)}\)], "Output"],

Cell[BoxData[
    \({0, 54, 32.03598163147055`}\)], "Output"],

Cell[BoxData[
    \({0, 14, 51.62005316281639`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo elementos Besselianos: elementos x, y, z, ls, lp (en unidad \
de radio ecuatorial terrestre), a,d, \[Mu] (en grados sexagesimales), is e \
ip.\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(CartSol = 
        ecu2cart[{\[Alpha]recS, decS, distS}];\)\), "\[IndentingNewLine]", 
    \(\(CartLuna = 
        ecu2cart[{\[Alpha]recL, decL, distL}];\)\), "\[IndentingNewLine]", 
    \(\(CartLunaSol = CartSol - CartLuna;\)\), "\[IndentingNewLine]", 
    \(\(\(EcuLunaSol = cart2ecu[CartLunaSol];\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\(elementoa = EcuLunaSol[\([1]\)];\)\), "\n", 
    \(\(elementod = EcuLunaSol[\([2]\)];\)\), "\n", 
    \(\(elementox = \(1\/radioecT\) distL*Cos[decL\ Degree]*
          Sin[\((\[Alpha]recL - elementoa)\) Degree];\)\), "\n", 
    \(\(elementoy = \(1\/radioecT\) 
          distL*\((Sin[decL\ Degree]*Cos[elementod\ Degree] - 
              Cos[decL\ Degree]*Sin[elementod\ Degree]*
                Cos[\((\[Alpha]recL - elementoa)\) Degree])\);\)\), "\n", 
    \(\(elementoz = \(1\/radioecT\) 
          distL*\((Sin[decL\ Degree]*Sin[elementod\ Degree] + 
              Cos[decL\ Degree]*Cos[elementod\ Degree]*
                Cos[\((\[Alpha]recL - elementoa)\) Degree])\);\)\), "\n", 
    \(\(elementois = 
        Tan[ArcSin[\(radioS - radioL\)\/EcuLunaSol[\([3]\)]]];\)\), "\n", 
    \(\(\(elementoip = 
        Tan[ArcSin[\(radioS + radioL\)\/EcuLunaSol[\([3]\)]]];\)\(\
\[IndentingNewLine]\)
    \)\), "\n", 
    \(\(elementols = 
        elementoz*elementois - 
          radioL\/radioecT*
            Sec[ArcSin[\(radioS - radioL\)\/EcuLunaSol[\([3]\)]]];\)\), "\n", \

    \(\(elementolp = 
        elementoz*elementoip + 
          radioL\/radioecT*
            Sec[ArcSin[\(radioS + radioL\)\/EcuLunaSol[\([3]\)]]];\)\), "\n", \

    \(\(elemento\[Mu] = TS - elementoa;\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementod\\)\\\" is similar to existing \
symbol \\\"\\!\\(elementoa\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementox\\)\\\" is similar to existing \
symbols \\!\\({elementoa, elementod}\\). \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementoy\\)\\\" is similar to existing \
symbols \\!\\({elementoa, elementod, elementox}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementoz\\)\\\" is similar to existing \
symbols \\!\\({elementoa, elementod, elementox, elementoy}\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementoip\\)\\\" is similar to existing \
symbol \\\"\\!\\(elementois\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementols\\)\\\" is similar to existing \
symbol \\\"\\!\\(elementois\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(elementolp\\)\\\" is similar to existing \
symbols \\!\\({elementoip, elementols}\\). \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de funciones interpolantes de los elementos Besselianos y de \
sus derivadas.\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(pelex = 
        Interpolation[
          Transpose[{horas, elementox}]];\)\), "\[IndentingNewLine]", 
    \(\(pdelex = \(Derivative[1]\)[pelex];\)\), "\n", 
    \(\(peley = 
        Interpolation[
          Transpose[{horas, elementoy}]];\)\), "\[IndentingNewLine]", 
    \(\(pdeley = \(Derivative[1]\)[peley];\)\), "\[IndentingNewLine]", 
    \(\(pelez = 
        Interpolation[
          Transpose[{horas, elementoz}]];\)\), "\[IndentingNewLine]", 
    \(\(pdelez = \(Derivative[1]\)[pelez];\)\), "\[IndentingNewLine]", 
    \(\(peled = Interpolation[Transpose[{horas, elementod}]];\)\), "\n", 
    \(\(pdeled = \(Derivative[1]\)[peled];\)\), "\[IndentingNewLine]", 
    \(\(pele\[Mu] = 
        Interpolation[Transpose[{horas, elemento\[Mu]}]];\)\), "\n", 
    \(\(pdele\[Mu] = \(Derivative[1]\)[
          pele\[Mu]];\)\), "\[IndentingNewLine]", 
    \(\(pelels = Interpolation[Transpose[{horas, elementols}]];\)\), "\n", 
    \(\(pdelels = \(Derivative[1]\)[pelels];\)\), "\[IndentingNewLine]", 
    \(\(pelelp = Interpolation[Transpose[{horas, elementolp}]];\)\), "\n", 
    \(\(pdelelp = \(Derivative[1]\)[pelelp];\)\), "\[IndentingNewLine]", 
    \(\(peleis = 
        Interpolation[
          Transpose[{horas, elementois}]];\)\), "\[IndentingNewLine]", 
    \(\(peleip = Interpolation[Transpose[{horas, elementoip}]];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pelez\\)\\\" is similar to existing symbols \
\\!\\({peled, pelex, peley}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdelez\\)\\\" is similar to existing symbols \
\\!\\({pdeled, pdelex, pdeley, pelez}\\). \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo del eje menor en la elipse del plano fundamental (reliphor) y \
calculo de la distancia del eje de sombra a dicha elipse (disejeelip). \
\>", "Subsection"],

Cell[BoxData[{
    \(\(reliphor = Map[radeliphor, elementod];\)\), "\[IndentingNewLine]", 
    \(\(lisEcu = 
        elementoy - reliphor*Sin[u] - 
          1/reliphor*Tan[u]*\((elementox - Cos[u])\);\)\), "\n", 
    \(\(lisVI = 
        Map[ArcTan @@ # &, Transpose[{elementox, elementoy}]];\)\), "\n", 
    \(\(listaU = 
        u /. Map[FindRoot[#[\([1]\)] \[Equal] 0, {u, #[\([2]\)]}] &, 
            Transpose[{lisEcu, lisVI}]];\)\), "\[IndentingNewLine]", 
    \(\(disejeelip = 
        disEjeElip[{elementox, elementoy, reliphor, 
            listaU}];\)\), "\[IndentingNewLine]", 
    \(\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(preliphor = 
        Interpolation[
          Transpose[{horas, reliphor}]];\)\), "\[IndentingNewLine]", 
    \(\(pdisejeelip = 
        Interpolation[
          Transpose[{horas, disejeelip}]];\)\), "\[IndentingNewLine]", 
    \(\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(pdisejeelip\\)\\\" is similar to existing \
symbol \\\"\\!\\(disejeelip\\)\\\". \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de principio y fin del eclipse parcial igualando \
la distancia eje de sombra-elipse fundamental (pdisejeelip) al radio del cono \
de penumbra en el plano fundamental (plp). \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(tinipar = \((t /. 
            FindRoot[
              pelelp[t] + \((Sec[ArcTan[peleip[t]]] - 1)\) - 
                  pdisejeelip[t] \[Equal] 0, {t, 
                First[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tinipar + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 
        24]]\), "\[IndentingNewLine]", 
    \(\(tfinpar = \((t /. 
            FindRoot[
              pelelp[t] + \((Sec[ArcTan[peleip[t]]] - 1)\) - 
                  pdisejeelip[t] \[Equal] 0, {t, 
                Last[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tfinpar + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 
        24]]\), "\[IndentingNewLine]", 
    \(\(intervalosminuto = 
        Select[horas, \((# > \((tinipar\  - \ 
                      1/20)\)\  && \ # < \((tfinpar\  + \ 
                      1/20)\))\)\  &];\)\)}], "Input"],

Cell[BoxData[
    \({4, 56, 35.685493061120695`}\)], "Output"],

Cell[BoxData[
    \({11, 0, 39.89661576037307`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de contactos interiores del cono de penumbra. \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(t2par = \((t /. 
            FindRoot[
              pelelp[t] + \((Sec[ArcTan[peleip[t]]] - 1)\) + 
                  pdisejeelip[t] \[Equal] 0, {t, 
                First[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[t2par + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 
        24]]\), "\[IndentingNewLine]", 
    \(\(t3par = \((t /. 
            FindRoot[
              pelelp[t] + \((Sec[ArcTan[peleip[t]]] - 1)\) + 
                  pdisejeelip[t] \[Equal] 0, {t, 
                Last[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[t3par + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 24]]\)}], "Input"],

Cell[BoxData[
    \({7, 21, 5.2892205848154905`}\)], "Output"],

Cell[BoxData[
    \({8, 36, 28.88205070317462`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de principio y fin del eclipse total/anular \
igualando la distancia eje de sombra-elipse fundamental (pdisejeelip) al \
radio del cono de sombra en el plano fundamental (pls)\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(tinitot = \((t /. 
            FindRoot[
              pelels[t] + Sign[pelels[t]] \((Sec[ArcTan[peleis[t]]] - 1)\) - 
                  pdisejeelip[t] \[Equal] 0, {t, 
                First[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tinitot + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 
        24]]\), "\[IndentingNewLine]", 
    \(\(tfintot = \((t /. 
            FindRoot[
              pelels[t] + Sign[pelels[t]] \((Sec[ArcTan[peleis[t]]] - 1)\) - 
                  pdisejeelip[t] \[Equal] 0, {t, 
                Last[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tfintot + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 24]]\)}], "Input"],

Cell[BoxData[
    \({6, 2, 39.28092018002609`}\)], "Output"],

Cell[BoxData[
    \({9, 54, 40.85542562809983`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de contactos interiores del cono de sombra.\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(t2tot = \((t /. 
            FindRoot[
              pelels[t] + Sign[pelels[t]] \((Sec[ArcTan[peleis[t]]] - 1)\) + 
                  pdisejeelip[t] \[Equal] 0, {t, 
                First[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[t2tot + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 
        24]]\), "\[IndentingNewLine]", 
    \(\(t3tot = \((t /. 
            FindRoot[
              pelels[t] + Sign[pelels[t]] \((Sec[ArcTan[peleis[t]]] - 1)\) + 
                  pdisejeelip[t] \[Equal] 0, {t, 
                Last[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[t3tot + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 24]]\)}], "Input"],

Cell[BoxData[
    \({6, 8, 55.64543109298484`}\)], "Output"],

Cell[BoxData[
    \({9, 48, 28.784287145640786`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de principio y fin de la curva central del eclipse \
haciendo nula la distancia eje de sombra-elipse fundamental (pdisejeelip). \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(tinicen = \((t /. 
            FindRoot[
              pdisejeelip[t] \[Equal] 0, {t, 
                First[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tinicen + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 
        24]]\), "\[IndentingNewLine]", 
    \(\(tfincen = \((t /. 
            FindRoot[
              pdisejeelip[t] \[Equal] 0, {t, 
                Last[horas]}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tfincen + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 24]]\)}], "Input"],

Cell[BoxData[
    \({6, 5, 47.26205864023429`}\)], "Output"],

Cell[BoxData[
    \({9, 51, 35.06544382721608`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Determinaci\[OAcute]n de punto local: longitud y latitud geod\[EAcute]sicas \
en formato {grad, minutos}, y altura sobre elipsoide en metros. \
\>", "Subsection"],

Cell[BoxData[{
    \(\(\[Lambda] = {\ 8, 13.5};\)\), "\[IndentingNewLine]", 
    \(\(\[Phi] = {\(-28\), \(-54.7\)};\)\), "\[IndentingNewLine]", 
    \(\(h = 0;\)\)}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de funciones interpolantes de coordenadas \[Xi], \[Eta] y \
\[Zeta] en plano fundamental y de sus derivadas.\
\>", "Subsection"],

Cell[BoxData[{
    \(\(p\[Xi] = 
        Interpolation[
          Transpose[{horas, 
              First[Transpose[
                  Map[lonlatth2\[Xi]\[Eta]\[Zeta][\[Lambda], \[Phi], h, #] &, 
                    horas]]]}]];\)\), "\[IndentingNewLine]", 
    \(\(pd\[Xi] = \(Derivative[1]\)[p\[Xi]];\)\), "\[IndentingNewLine]", 
    \(\(p\[Eta] = 
        Interpolation[
          Transpose[{horas, 
              Part[Transpose[
                  Map[lonlatth2\[Xi]\[Eta]\[Zeta][\[Lambda], \[Phi], h, #] &, 
                    horas]], 2]}]];\)\), "\[IndentingNewLine]", 
    \(\(pd\[Eta] = \(Derivative[1]\)[p\[Eta]];\)\), "\[IndentingNewLine]", 
    \(\(p\[Zeta] = 
        Interpolation[
          Transpose[{horas, 
              Last[Transpose[
                  Map[lonlatth2\[Xi]\[Eta]\[Zeta][\[Lambda], \[Phi], h, #] &, 
                    horas]]]}]];\)\), "\[IndentingNewLine]", 
    \(\(pd\[Zeta] = \(Derivative[1]\)[p\[Zeta]];\)\)}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo en funci\[OAcute]n del tiempo de los radios de sombra y de \
penumbra en el plano del observador, as\[IAcute] como la distancia del punto \
local al eje de sombra ysu derivada.\
\>", "Subsection"],

Cell[BoxData[{
    \(\(pLp[t_] := 
        pelelp[t] - p\[Zeta][t]*peleip[t];\)\), "\[IndentingNewLine]", 
    \(\(pLs[t_] := 
        pelels[t] - p\[Zeta][t]*peleis[t];\)\), "\[IndentingNewLine]", 
    \(\(pdispuntoloceje[t_] := 
        Sqrt[\((pelex[t] - p\[Xi][t])\)\^2 + \((peley[t] - p\[Eta][t])\)\^2];\
\)\), "\[IndentingNewLine]", 
    \(\(pddispuntoloceje[
          t_] := \((pelex[t] - p\[Xi][t])\)*\((pdelex[t] - 
                pd\[Xi][t])\) + \((peley[t] - p\[Eta][t])\)*\((pdeley[t] - 
                pd\[Eta][t])\);\)\), "\[IndentingNewLine]", 
    \(\)}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de principio y fin del eclipse parcial igualando \
la distancia eje de sombra punto local (pdispuntoloceje) al radio del cono de \
penumbra en el plano del observador (pLp), y del eclipse central igualando la \
distancia eje de sombra punto local (pdispuntoloceje) al radio del cono de \
sombra en el plano del observador (pLs). \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(tinilocpar = \((t /. 
            FindRoot[
              pLp[t] - pdispuntoloceje[t] \[Equal] 0, {t, 
                tinipar}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tinilocpar + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 
        24]]\), "\[IndentingNewLine]", 
    \(\(tfinlocpar = \((t /. 
            FindRoot[
              pLp[t] - pdispuntoloceje[t] \[Equal] 0, {t, 
                tfinpar}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tfinlocpar + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 
        24]]\), "\[IndentingNewLine]", 
    \(\(tiniloctot = \((t /. 
            FindRoot[
              Abs[pLs[t]] - pdispuntoloceje[t] \[Equal] 0, {t, 
                tinitot}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tiniloctot + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 
        24]]\), "\[IndentingNewLine]", 
    \(\(tfinloctot = \((t /. 
            FindRoot[
              Abs[pLs[t]] - pdispuntoloceje[t] \[Equal] 0, {t, 
                tfintot}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tfinloctot + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 24]]\)}], "Input"],

Cell[BoxData[
    \({4, 56, 35.73647016698524`}\)], "Output"],

Cell[BoxData[
    \({7, 17, 35.20723343885588`}\)], "Output"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({\\(-10.891067772862383`\\)}\\) lies outside the range of data in \
the interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\
\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, \
ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({\\(-10.891067772862383`\\)}\\) lies outside the range of data in \
the interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\
\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, \
ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({\\(-10.891067772862383`\\)}\\) lies outside the range of data in \
the interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\
\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, \
ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(InterpolatingFunction :: \\\"dmval\\\"\\) will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\
\"RefGuideLinkText\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\
\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(FindRoot::"lstol"\), \(\(:\)\(\ \)\), "\<\"The line search \
decreased the step size to within tolerance specified by AccuracyGoal and \
PrecisionGoal but was unable to find a sufficient decrease in the merit \
function.  You may need more than \\!\\(MachinePrecision\\) digits of working \
precision to meet these tolerances. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"FindRoot::lstol\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \({6, 2, 0.14561091784763558`}\)], "Output"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({\\(-1.3422898168716348`\\)}\\) lies outside the range of data in \
the interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\
\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, \
ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({\\(-1.3422898168716348`\\)}\\) lies outside the range of data in \
the interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\
\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, \
ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(InterpolatingFunction::"dmval"\), \(\(:\)\(\ \)\), "\<\"Input \
value \\!\\({\\(-1.3422898168716348`\\)}\\) lies outside the range of data in \
the interpolating function. Extrapolation will be used. \\!\\(\\*ButtonBox[\\\
\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, \
ButtonData:>\\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(InterpolatingFunction :: \\\"dmval\\\"\\) will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\
\"RefGuideLinkText\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\
\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(FindRoot::"lstol"\), \(\(:\)\(\ \)\), "\<\"The line search \
decreased the step size to within tolerance specified by AccuracyGoal and \
PrecisionGoal but was unable to find a sufficient decrease in the merit \
function.  You may need more than \\!\\(MachinePrecision\\) digits of working \
precision to meet these tolerances. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"FindRoot::lstol\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \({6, 2, 0.14524570578864082`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de m\[AAcute]ximo de eclipse local.\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(tmaxecloc = \((t /. 
            FindRoot[
              pddispuntoloceje[t] \[Equal] 0, {t, 
                tinilocpar}])\);\)\), "\[IndentingNewLine]", 
    \(h2hms[
      Mod[tmaxecloc + \((First[fech] - IntegerPart[First[fech]] - 
                0.5)\)*24 - \[CapitalDelta]t/3600, 24]]\)}], "Input"],

Cell[BoxData[
    \({6, 2, 3.3642552890323447`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Determinaci\[OAcute]n tipo de eclipse local en funci\[OAcute]n de los valores \
de disitancia al eje de sombra, Lp y Ls para el m\[AAcute]ximo del eclipse \
local.\
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(pdispuntoloceje[tmaxecloc]\), "\[IndentingNewLine]", 
    \(pLp[tmaxecloc]\), "\[IndentingNewLine]", 
    \(pLs[tmaxecloc]\)}], "Input"],

Cell[BoxData[
    \(0.1832415821523911`\)], "Output"],

Cell[BoxData[
    \(0.5709147415959673`\)], "Output"],

Cell[BoxData[
    \(0.024406722493777185`\)], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Gr\[AAcute]fico evoluci\[OAcute]n del eclipse local.\
\>", "Subsection"],

Cell[BoxData[{
    \(\(cuadro = 
        Transpose[{tabla*gm2grad[\[Lambda]], tabla*gm2grad[\[Phi]], tabla*h, 
            Map[pTS, horas], \[IndentingNewLine]Map[p\[Alpha]recS, 
              horas], \[IndentingNewLine]Map[pdecS, 
              horas], \[IndentingNewLine]Map[pdistS, 
              horas], \[IndentingNewLine]Map[p\[Alpha]recL, 
              horas], \[IndentingNewLine]Map[pdecL, 
              horas], \[IndentingNewLine]Map[pdistL, 
              horas], \[IndentingNewLine]horas}];\)\), "\[IndentingNewLine]", \

    \(\(Map[grafpos[pos2graf[#]] &, cuadro];\)\), "\[IndentingNewLine]", 
    \(\)}], "Input"]
}, Open  ]]
},
FrontEndVersion->"5.0 for Microsoft Windows",
ScreenRectangle->{{0, 1024}, {0, 685}},
WindowSize->{563, 627},
WindowMargins->{{Automatic, 42}, {Automatic, -29}}
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{
Cell[1754, 51, 35, 1, 30, "Input"],

Cell[CellGroupData[{
Cell[1814, 56, 43, 0, 38, "Subsection"],

Cell[CellGroupData[{
Cell[1882, 60, 61, 0, 29, "Subsubsection"],
Cell[1946, 62, 107, 2, 70, "Input"],
Cell[2056, 66, 195, 4, 70, "Input"],
Cell[2254, 72, 112, 2, 70, "Input"],

Cell[CellGroupData[{
Cell[2391, 78, 266, 5, 70, "Input"],
Cell[2660, 85, 354, 5, 70, "Message"],
Cell[3017, 92, 354, 5, 70, "Message"]
}, Open  ]],
Cell[3386, 100, 152, 3, 70, "Input"],

Cell[CellGroupData[{
Cell[3563, 107, 130, 3, 70, "Input"],
Cell[3696, 112, 362, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[4095, 122, 282, 5, 70, "Input"],
Cell[4380, 129, 362, 5, 70, "Message"]
}, Open  ]],
Cell[4757, 137, 71, 1, 70, "Input"],
Cell[4831, 140, 71, 1, 70, "Input"],
Cell[4905, 143, 81, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[5011, 148, 140, 3, 70, "Input"],
Cell[5154, 153, 357, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[5560, 164, 41, 0, 23, "Subsubsection"],
Cell[5604, 166, 243, 5, 70, "Input"],

Cell[CellGroupData[{
Cell[5872, 175, 426, 7, 70, "Input"],
Cell[6301, 184, 355, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[6705, 195, 59, 0, 23, "Subsubsection"],
Cell[6767, 197, 254, 4, 90, "Input"],
Cell[7024, 203, 244, 4, 107, "Input"],
Cell[7271, 209, 765, 18, 163, "Input"],
Cell[8039, 229, 87, 1, 30, "Input"],

Cell[CellGroupData[{
Cell[8151, 234, 87, 1, 30, "Input"],
Cell[8241, 237, 370, 5, 52, "Message"]
}, Open  ]],
Cell[8626, 245, 93, 1, 30, "Input"],
Cell[8722, 248, 383, 7, 176, "Input"],
Cell[9108, 257, 154, 3, 61, "Input"],

Cell[CellGroupData[{
Cell[9287, 264, 812, 13, 250, "Input"],
Cell[10102, 279, 371, 5, 37, "Message"],
Cell[10476, 286, 355, 5, 37, "Message"]
}, Open  ]],
Cell[10846, 294, 466, 10, 210, "Input"],

Cell[CellGroupData[{
Cell[11337, 308, 682, 11, 230, "Input"],
Cell[12022, 321, 372, 6, 37, "Message"]
}, Open  ]],
Cell[12409, 330, 692, 12, 190, "Input"],
Cell[13104, 344, 348, 6, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[13489, 355, 83, 1, 23, "Subsubsection"],

Cell[CellGroupData[{
Cell[13597, 360, 367, 8, 170, "Input"],
Cell[13967, 370, 358, 5, 70, "Message"],
Cell[14328, 377, 358, 5, 70, "Message"]
}, Open  ]],
Cell[14701, 385, 273, 5, 90, "Input"],
Cell[14977, 392, 80, 1, 30, "Input"],
Cell[15060, 395, 165, 3, 50, "Input"],
Cell[15228, 400, 291, 5, 90, "Input"],
Cell[15522, 407, 80, 1, 30, "Input"],
Cell[15605, 410, 90, 1, 30, "Input"],
Cell[15698, 413, 90, 1, 30, "Input"],
Cell[15791, 416, 90, 1, 30, "Input"],
Cell[15884, 419, 218, 4, 50, "Input"],
Cell[16105, 425, 218, 4, 50, "Input"],
Cell[16326, 431, 218, 4, 50, "Input"],
Cell[16547, 437, 104, 2, 42, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[16688, 444, 102, 2, 23, "Subsubsection"],

Cell[CellGroupData[{
Cell[16815, 450, 105, 2, 42, "Input"],
Cell[16923, 454, 369, 6, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[17329, 465, 290, 5, 124, "Input"],
Cell[17622, 472, 354, 5, 70, "Message"],
Cell[17979, 479, 355, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[18371, 489, 305, 5, 124, "Input"],
Cell[18679, 496, 371, 5, 70, "Message"]
}, Open  ]],
Cell[19065, 504, 136, 2, 50, "Input"],

Cell[CellGroupData[{
Cell[19226, 510, 145, 2, 50, "Input"],
Cell[19374, 514, 403, 6, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[19826, 526, 68, 0, 23, "Subsubsection"],
Cell[19897, 528, 285, 5, 70, "Input"],
Cell[20185, 535, 159, 3, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[20381, 543, 118, 3, 23, "Subsubsection"],
Cell[20502, 548, 498, 9, 220, "Input"],
Cell[21003, 559, 345, 7, 90, "Input"],
Cell[21351, 568, 420, 8, 110, "Input"],
Cell[21774, 578, 139, 3, 70, "Input"],
Cell[21916, 583, 85, 1, 30, "Input"],
Cell[22004, 586, 77, 1, 30, "Input"],

Cell[CellGroupData[{
Cell[22106, 591, 379, 8, 134, "Input"],
Cell[22488, 601, 360, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[22885, 611, 118, 2, 50, "Input"],
Cell[23006, 615, 371, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[23414, 625, 383, 7, 170, "Input"],
Cell[23800, 634, 371, 5, 70, "Message"]
}, Open  ]],
Cell[24186, 642, 236, 4, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[24459, 651, 113, 3, 23, "Subsubsection"],
Cell[24575, 656, 362, 7, 109, "Input"],
Cell[24940, 665, 384, 8, 110, "Input"],
Cell[25327, 675, 473, 9, 170, "Input"],

Cell[CellGroupData[{
Cell[25825, 688, 307, 6, 130, "Input"],
Cell[26135, 696, 379, 5, 52, "Message"],
Cell[26517, 703, 360, 5, 37, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[26926, 714, 76, 0, 23, "Subsubsection"],
Cell[27005, 716, 70, 1, 30, "Input"],
Cell[27078, 719, 623, 10, 319, "Input"],
Cell[27704, 731, 463, 10, 190, "Input"],
Cell[28170, 743, 505, 10, 210, "Input"],

Cell[CellGroupData[{
Cell[28700, 757, 162, 3, 90, "Input"],
Cell[28865, 762, 368, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[29282, 773, 70, 0, 23, "Subsubsection"],
Cell[29355, 775, 1623, 25, 564, "Input"],
Cell[30981, 802, 580, 10, 230, "Input"],
Cell[31564, 814, 477, 8, 170, "Input"],

Cell[CellGroupData[{
Cell[32066, 826, 382, 7, 150, "Input"],
Cell[32451, 835, 359, 5, 37, "Message"],
Cell[32813, 842, 367, 5, 52, "Message"],
Cell[33183, 849, 364, 6, 52, "Message"],
Cell[33550, 857, 332, 5, 37, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[33919, 867, 382, 7, 150, "Input"],
Cell[34304, 876, 374, 5, 52, "Message"],
Cell[34681, 883, 365, 6, 52, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[35095, 895, 88, 1, 23, "Subsubsection"],
Cell[35186, 898, 1150, 18, 350, "Input"],
Cell[36339, 918, 1004, 17, 334, "Input"],
Cell[37346, 937, 402, 6, 110, "Input"],
Cell[37751, 945, 480, 8, 150, "Input"],
Cell[38234, 955, 379, 7, 150, "Input"],
Cell[38616, 964, 900, 15, 286, "Input"],
Cell[39519, 981, 639, 10, 193, "Input"],
Cell[40161, 993, 425, 7, 110, "Input"],
Cell[40589, 1002, 486, 8, 170, "Input"],
Cell[41078, 1012, 385, 7, 150, "Input"],
Cell[41466, 1021, 420, 7, 112, "Input"],
Cell[41889, 1030, 131, 3, 50, "Input"],
Cell[42023, 1035, 442, 8, 150, "Input"],

Cell[CellGroupData[{
Cell[42490, 1047, 425, 7, 112, "Input"],
Cell[42918, 1056, 370, 5, 52, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[43325, 1066, 442, 8, 150, "Input"],
Cell[43770, 1076, 378, 5, 52, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[44197, 1087, 63, 0, 23, "Subsubsection"],
Cell[44263, 1089, 778, 12, 210, "Input"],

Cell[CellGroupData[{
Cell[45066, 1105, 1590, 27, 450, "Input"],
Cell[46659, 1134, 380, 5, 37, "Message"],
Cell[47042, 1141, 356, 5, 37, "Message"],
Cell[47401, 1148, 397, 6, 52, "Message"],
Cell[47801, 1156, 332, 5, 37, "Message"],
Cell[48136, 1163, 360, 5, 37, "Message"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{
Cell[48557, 1175, 54, 0, 38, "Subsection"],

Cell[CellGroupData[{
Cell[48636, 1179, 616, 12, 235, "Input"],
Cell[49255, 1193, 362, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[49666, 1204, 38, 0, 30, "Subsection"],
Cell[49707, 1206, 162, 3, 52, "Text"],

Cell[CellGroupData[{
Cell[49894, 1213, 1544, 31, 463, "Input"],
Cell[51441, 1246, 358, 5, 37, "Message"],
Cell[51802, 1253, 359, 5, 37, "Message"],
Cell[52164, 1260, 378, 5, 37, "Message"],
Cell[52545, 1267, 354, 5, 37, "Message"],
Cell[52902, 1274, 357, 5, 37, "Message"],
Cell[53262, 1281, 394, 6, 52, "Message"],
Cell[53659, 1289, 360, 5, 52, "Message"],
Cell[54022, 1296, 357, 5, 37, "Message"],
Cell[54382, 1303, 332, 5, 37, "Message"],
Cell[54717, 1310, 356, 5, 37, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[55122, 1321, 116, 3, 48, "Subsection"],

Cell[CellGroupData[{
Cell[55263, 1328, 679, 15, 150, "Input"],
Cell[55945, 1345, 357, 5, 37, "Message"],
Cell[56305, 1352, 359, 5, 37, "Message"],
Cell[56667, 1359, 374, 5, 37, "Message"],
Cell[57044, 1366, 357, 5, 37, "Message"],
Cell[57404, 1373, 360, 5, 37, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[57813, 1384, 221, 4, 66, "Subsection"],

Cell[CellGroupData[{
Cell[58059, 1392, 842, 17, 270, "Input"],
Cell[58904, 1411, 62, 1, 29, "Output"],
Cell[58969, 1414, 63, 1, 29, "Output"],
Cell[59035, 1417, 77, 1, 29, "Output"],
Cell[59115, 1420, 59, 1, 29, "Output"],
Cell[59177, 1423, 62, 1, 29, "Output"],
Cell[59242, 1426, 63, 1, 29, "Output"],
Cell[59308, 1429, 77, 1, 29, "Output"],
Cell[59388, 1432, 61, 1, 29, "Output"],
Cell[59452, 1435, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[59562, 1442, 188, 4, 66, "Subsection"],

Cell[CellGroupData[{
Cell[59775, 1450, 1686, 36, 616, "Input"],
Cell[61464, 1488, 368, 6, 70, "Message"],
Cell[61835, 1496, 370, 5, 70, "Message"],
Cell[62208, 1503, 383, 6, 70, "Message"],
Cell[62594, 1511, 394, 6, 70, "Message"],
Cell[62991, 1519, 370, 6, 70, "Message"],
Cell[63364, 1527, 370, 6, 70, "Message"],
Cell[63737, 1535, 373, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[64159, 1546, 123, 3, 48, "Subsection"],

Cell[CellGroupData[{
Cell[64307, 1553, 1367, 26, 330, "Input"],
Cell[65677, 1581, 365, 5, 70, "Message"],
Cell[66045, 1588, 376, 5, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[66470, 1599, 181, 3, 66, "Subsection"],
Cell[66654, 1604, 610, 13, 70, "Input"],

Cell[CellGroupData[{
Cell[67289, 1621, 267, 7, 70, "Input"],
Cell[67559, 1630, 371, 6, 70, "Message"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[67979, 1642, 231, 4, 66, "Subsection"],

Cell[CellGroupData[{
Cell[68235, 1650, 992, 22, 350, "Input"],
Cell[69230, 1674, 62, 1, 29, "Output"],
Cell[69295, 1677, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[69405, 1684, 103, 2, 30, "Subsection"],

Cell[CellGroupData[{
Cell[69533, 1690, 773, 17, 290, "Input"],
Cell[70309, 1709, 62, 1, 29, "Output"],
Cell[70374, 1712, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[70484, 1719, 232, 4, 84, "Subsection"],

Cell[CellGroupData[{
Cell[70741, 1727, 813, 17, 330, "Input"],
Cell[71557, 1746, 60, 1, 29, "Output"],
Cell[71620, 1749, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[71730, 1756, 100, 2, 30, "Subsection"],

Cell[CellGroupData[{
Cell[71855, 1762, 805, 17, 330, "Input"],
Cell[72663, 1781, 60, 1, 29, "Output"],
Cell[72726, 1784, 62, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[72837, 1791, 185, 3, 66, "Subsection"],

Cell[CellGroupData[{
Cell[73047, 1798, 649, 15, 170, "Input"],
Cell[73699, 1815, 60, 1, 29, "Output"],
Cell[73762, 1818, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[73872, 1825, 172, 3, 48, "Subsection"],
Cell[74047, 1830, 175, 3, 70, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[74259, 1838, 154, 3, 56, "Subsection"],
Cell[74416, 1843, 959, 21, 310, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[75412, 1869, 222, 4, 66, "Subsection"],
Cell[75637, 1875, 583, 12, 171, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[76257, 1892, 386, 6, 128, "Subsection"],

Cell[CellGroupData[{
Cell[76668, 1902, 1374, 31, 450, "Input"],
Cell[78045, 1935, 61, 1, 29, "Output"],
Cell[78109, 1938, 61, 1, 29, "Output"],
Cell[78173, 1941, 408, 6, 52, "Message"],
Cell[78584, 1949, 408, 6, 52, "Message"],
Cell[78995, 1957, 408, 6, 52, "Message"],
Cell[79406, 1965, 346, 5, 37, "Message"],
Cell[79755, 1972, 522, 8, 97, "Message"],
Cell[80280, 1982, 62, 1, 29, "Output"],
Cell[80345, 1985, 408, 6, 52, "Message"],
Cell[80756, 1993, 408, 6, 52, "Message"],
Cell[81167, 2001, 408, 6, 52, "Message"],
Cell[81578, 2009, 346, 5, 37, "Message"],
Cell[81927, 2016, 522, 8, 97, "Message"],
Cell[82452, 2026, 62, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[82563, 2033, 92, 2, 30, "Subsection"],

Cell[CellGroupData[{
Cell[82680, 2039, 328, 7, 110, "Input"],
Cell[83011, 2048, 61, 1, 29, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[83121, 2055, 193, 4, 66, "Subsection"],

Cell[CellGroupData[{
Cell[83339, 2063, 157, 3, 70, "Input"],
Cell[83499, 2068, 53, 1, 29, "Output"],
Cell[83555, 2071, 53, 1, 29, "Output"],
Cell[83611, 2074, 55, 1, 29, "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[83715, 2081, 82, 2, 38, "Subsection"],
Cell[83800, 2085, 629, 12, 230, "Input"]
}, Open  ]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

