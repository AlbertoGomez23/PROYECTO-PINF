\documentclass[11pt, a4paper,twosides]{book}
%\textwidth14cm
%\textheight23cm
\parskip1.3ex
\usepackage[spanish]{babel}            %paquete para acentos forma estandar en espa\~{n}ol.
\usepackage[ansinew]{inputenc}         %paquete solo para Windows para reconocer acentos.
\usepackage{graphicx,color}            %paquete para manejar figuras y color de las mismas (incluye letras).
\usepackage{lscape}
%\usepackage{subfigure}
\usepackage{amsmath,amsfonts,amssymb}  %paquete de simbolos matem\'{a}ticos American Mathematical Socety
\usepackage{latexsym}                  % Paquete que ofrece adicional simbolos matem\'{a}ticos
\usepackage{times}
\usepackage{mathptmx}
\usepackage{wasysym}
\usepackage{geometry}
\geometry{margin=3cm, bottom=3cm}

\def\sen{\mathop{\rm sen}\nolimits}
\def\arcsen{\mathop{\rm arcsen}\nolimits}
\newcommand{\Grad}{\mbox{${}^\circ$}}
\newcommand{\Gradp}{\mbox{.\kern-2.3pt{${}^\circ$}}}
\newcommand{\Min}{\mbox{${}'$}}
\newcommand{\Minp}{\mbox{.\kern-2pt{${}'$}}}
\newcommand{\Seg}{\mbox{${}''$}}
\newcommand{\Segp}{\mbox{.\kern-3pt{${}''$}}}
\newcommand{\Dia}{\mbox{${}^{\rm d}$}}
\newcommand{\Diap}{\mbox{.\kern-3.3pt{${}^{\rm d}$}}}
\newcommand{\Hora}{\mbox{${}^{\rm h}$}}
\newcommand{\Horap}{\mbox{.\kern-3.3pt{${}^{\rm h}$}}}
\newcommand{\Mint}{\mbox{${}^{\rm m}$}}
\newcommand{\Mintbf}{\mbox{${}^{\rm\bf m}$}}
\newcommand{\Mintp}{\mbox{.\kern-2pt{${}^{\rm m}$}}}
\newcommand{\Segt}{\mbox{${}^{\rm s}$}}
\newcommand{\Segtp}{\mbox{.\kern-3.3pt{${}^{\rm s}$}}}
\newcommand{\Abs}[1]{\mbox{\left|#1\right|}}
\newcommand{\Frac}[2]{\mbox{$\displaystyle\frac{#1}{#2}$}}
\def\Deg{\Grad}
\renewcommand{\thesection}{\arabic{section}}
%\usepackage[latin1]{inputenc}          %paquete solo para Unix para reconocer acentos.

%**********************************************************************************************************
% Trabajo F\'{\i}n de M\'{a}ster. M\'{a}ster en Modelizaci\'{o}n Matem\'{a}tica, Estad\'{\i}stica
% y Computaci\'{o}n. Curso 2009-2010.
%**********************************************************************************************************

%\title{\textbf{TRABAJO F\'{I}N DE M\'{A}STER: OBTENCI\'{O}N Y DIBUJO DE CURVAS REPRESENTATIVAS DE UN ECLIPSE SOLAR}}
%\author{Federico Baeza Richer}
%\date{XX de junio de 2010}
\title{\textbf{C\'alculo y representaci\'on de eclipses de Sol}}
\author{Federico Baeza Richer}
\date{M\'aster en Modelizaci\'{o}n Matem\'{a}tica, Estad\'{\i}stica
 y Computaci\'{o}n (2009--2010).}
%\emph{baezafede@gmail.com} colocar correo electr\'{o}nico.
\pagestyle{myheadings}
\markboth{C\'alculo y representaci\'on de eclipses de Sol}{F. Baeza Richer}
%\markright{C\'alculo y representaci\'on de eclipses de Sol}
\begin{document}
\begin{titlepage}
\maketitle
\end{titlepage}
%
%\begin{abstract}
%Se presenta el trabajo fin de m\'{a}ster de t\'{\i}tulo Obtenci\'{o}n y dibujo de las curvas representativas de un eclipse solar, correspondiente al M\'{a}ster en Modelizaci\'{o}n Matem\'{a}tica, Estad\'{\i}stica y Computaci\'{o}n (curso 2009-2010). El trabajo, como su nombre indica, consiste en la obtenci\'{o}n de todos los par\'{a}metros y elementos caracter\'{\i}sticos de un eclipse solar, y del posterior dibujo sobre la esfera terrestre, de todas las curvas representativas.  El trabajo fue codirigido por Teodoro L\'{o}pez Moratalla (Jefe de la Secci\'{o}n de Efem\'{e}rides del Real Instituto y Observatorio de la Armada) y por Alberto Abad (Profesor de Astrodin\'{a}mica de la Universidad de Zaragoza).
%\end{abstract}
%
\tableofcontents
\clearpage
\listoffigures

\cleardoublepage
\section{Introducci\'{o}n}
Se presenta el trabajo fin de m\'{a}ster titulado ``C\'{a}lculo y representaci\'{o}n de eclipses de Sol'', correspondiente al M\'{a}ster en Modelizaci\'{o}n Matem\'{a}tica, Estad\'{\i}stica y Computaci\'{o}n (curso 2009-2010). El trabajo, consiste en el c\'{a}lculo de todos los par\'{a}metros y elementos caracter\'{\i}sticos de un eclipse solar, y de la posterior representaci\'on del mapa correspondiente, con todas las curvas significativas.
\par
El punto de partida de este trabajo es el conocimiento de la existencia de un eclipse en una fecha determinada. Queda para un an\'{a}lisis posterior la determinaci\'{o}n de los d\'{\i}as de cada a\~{n}o en que esto ocurrir\'{a}.
\par
Desde tiempos remotos el hombre se ha sentido atra\'{\i}do por los fen\'{o}menos astron\'{o}micos, siendo el del eclipse de Sol el que probablemente m\'{a}s impresi\'{o}n, asombro, supersticiones, etc., ha generado a lo largo de la historia. La observaci\'{o}n de este fen\'{o}meno va m\'{a}s all\'{a} de la simple contemplaci\'{o}n, ya que las conclusiones obtenidas de su observaci\'on, han servido a veces para descubrir, y otras para corroborar, conocimientos claves en la comprensi\'{o}n del sistema solar. Es por ello que a lo largo de la historia y conforme los conocimientos de las civilizaciones avanzaban, se ha intentado conocer, cada vez con m\'{a}s precisi\'{o}n, el cu\'{a}ndo, en qu\'{e} circunstancias y desde d\'{o}nde, se pod\'{\i}an observar estos acontecimientos.
\par
Desde finales del siglo XIX, ya se ten\'{\i}an conocimientos y herramientas suficientes para predecir, con bastante precisi\'{o}n, la ocurrencia de eclipses. Sin embargo los m\'{e}todos tradicionales no son en absoluto sencillos. Se han utilizado m\'etodos anal\'{\i}ticos que resuelven parte del problema; estos m\'etodos se basan en una serie de transformaciones de variables, que, adem\'{a}s de introducir simplificaciones que implican p\'erdida de precisi\'{o}n, hacen perder la noci\'{o}n geom\'{e}trica de qu\'{e} se est\'a calculando. Pero los procedimientos num\'ericos han sido desde siempre los empleados en el c\'alculo de eclipses. Basados en algoritmos de iteraci\'on, permiten calcular los distintos elementos de un eclipse partiendo de un dato aproximado, que se refina en pocas iteraciones; como datos iniciales sol\'{\i}an tomarse una hora aproximada, calculada adem\'as para una Tierra esf\'erica, hora que se hac\'{\i}a converger a la real, introduciendo en algunos casos el achatamiento terrestre. La aparici\'{o}n de las computadoras automatiz\'{o} completamente estos procedimientos, desarroll\'{a}ndose inmediatamente programas (sobre todo en FORTRAN) que realizaban esta tarea.

La aparici\'{o}n relativamente reciente de los procesadores simb\'{o}licos de gran capacidad (como el \verb"Mathematica" aqu\'{\i} utilizado), invita a plantear y resolver las ecuaciones que determinan los par\'{a}metros caracter\'{\i}sticos de los eclipses de una forma mucho m\'{a}s sencilla y clara que hasta ahora. Si bien la precisi\'{o}n obtenida no mejora las que ya se tienen, y las propias funciones internas lleven un mecanismo parecido en cuanto a iteraciones etc, a los programas ya existentes, el hecho de poder plantear la resoluci\'{o}n de los distintos problemas mediante sencillas y elegantes f\'{o}rmulas, supone una novedoso enfoque del problema.
\par

El Real Instituto y Observatorio de la Armada (ROA) publica desde 1791 las \textit{Efem\'{e}rides Astron\'{o}micas}, siendo esta publicaci\'on el cuarto de los almanaques de car\'acter nacional que aparecieron en el mundo; desde entonces, las efem\'erides se han publicado anualmente sin interrupci\'on, con las t\'ecnicas disponibles en cada momento, incluso durante los per\'{\i}odos m\'as oscuros de la historia de Espa\~na. Aunque, como hemos dicho, los c\'{a}lculos realizados con estos programas no van a aportar mayor precisi\'{o}n a los datos que actualmente se publican, s\'{\i} servir\'an para cotejar los resultados obtenidos mediante los medios actuales, para automatizar m\'{a}s la representaci\'{o}n de los mapas de eclipses, y, por \'{u}ltimo, para auxiliar a la docencia, facilitando la explicaci\'{o}n sencilla y elegante de este fen\'{o}meno.
\par

Por \'ultimo, durante la realizaci\'on del trabajo, nos hemos encontrado con algunos eclipses que presentan unas peculiaridades especiales en su desarrollo en las proximidades de los polos terrestres. Tales peculiaridades no las hemos encontrado explicadas en la bibliograf\'{\i}a consultada. Si bien la relevancia de este hecho es muy escasa desde el punto de vista pr\'actico,  consideramos que s\'{\i} es importante conceptualmente para la total comprensi\'on del fen\'omeno en estas zonas.  La interpretaci\'on correcta de estos casos la presentamos en la secci\'on \ref{climite}.


\par
En el ap\'{e}ndice \ref{glosario} se ha incluido un glosario de los t\'{e}rminos astron\'{o}micos utilizados en este trabajo, al que acudir en caso necesario.

Este trabajo ha sido codirigido por los doctores Teodoro L\'{o}pez Moratalla (Jefe de la Secci\'{o}n de Efem\'{e}rides del ROA) y Alberto Abad Medina (Profesor de Astrodin\'{a}mica de la Universidad de Zaragoza).


\section{Generalidades sobre eclipses}
El t\'{e}rmino eclipse se aplica indistintamente a dos fen\'{o}menos
provocados por las posiciones relativas de tres astros: el Sol
(emisor luminoso), la Tierra y la Luna (cuerpos opacos que
interceptan la luz solar).

\par
Un eclipse de Sol se produce cuando este astro es ocultado, total o parcialmente,
por el disco de la Luna, que se interpone entre la Tierra y el
Sol. Un eclipse de Sol tiene lugar siempre en Luna Nueva,
siendo \'{e}sta una condici\'{o}n necesaria pero no suficiente para
que se produzca el fen\'{o}meno.

\par
La condici\'{o}n de Luna Nueva ser\'{\i}a suficiente si las \'{o}rbitas del Sol y de la Luna fueran coplanarias. Pero esto no ocurre al ser su inclinaci\'{o}n relativa pr\'{o}xima a los $5^\circ$, por lo tanto la Luna se encuentra en la mayor\'{\i}a de las ocasiones por debajo o por encima de la ecl\'{\i}ptica (plano del movimiento Tierra-Sol).

\par
Para que se produzca un eclipse de Sol, la Luna debe hallarse en
el plano de la ecl\'{\i}ptica, o muy cerca de \'el, y en fase de Luna
Nueva. Es decir la Luna debe encontrarse en las proximidades de un
nodo.

\par
Los eclipses de Luna est\'{a}n determinados por
el paso de nuestro sat\'{e}lite por la sombra de la Tierra y siempre
suceden en fase de Luna Llena, y al igual que en los eclipses
solares, cuando la Luna se encuentra en el nodo o en sus
proximidades.

Mientras que los eclipses de Luna son visibles para todos los puntos de la superficie terrestre que tengan en ese momento a la Luna por encima del horizonte, los de Sol s\'olo ser\'an visibles para algunos puntos de la Tierra.

\section{Tipos de Eclipses de Sol}
Se llama \textit{cono de sombra} al cono formado por las tangentes exteriores del Sol y la Luna y \textit{cono de penumbra} al formado por las tangentes interiores. El eje com\'{u}n a ambos conos, materializado por la l\'{\i}nea que une los centros del Sol y de la Luna, se denomina \textit{eje de la sombra} (ver figura \ref{f:tipos}).
\begin{figure}[t]
\centering
\includegraphics[width=14cm]{./Figuras/Tipos.pdf}
\caption[Tipos de eclipses de Sol]{Tipos de eclipses de Sol: parcial (arriba), total (centro) y anular (abajo). Las dimensiones se han deformado para mayor claridad.}\label{f:tipos}
\end{figure}

\par
Un eclipse de Sol se produce cuando el cono de penumbra alcanza alg\'{u}n punto de la superficie terrestre. Seg\'{u}n la posici\'on de la Tierra respecto a los conos de sombra y de penumbra, podemos dividir los eclipses de Sol en  parciales, totales y anulares.

\par
Eclipses Parciales son aquellos en los que el cono de sombra no corta en ning\'un momento la superficie terrestre. En estos eclipses el disco del Sol s\'olo se oculta parcialmente.

\par
Si el cono de sombra alcanza alg\'un punto de la superficie terrestre, se producir\'a un eclipse total o anular. La diferencia entre ambos tipos de eclipse se debe a que el di\'ametro aparente de la Luna puede ser mayor o menor que el del Sol, en funci\'on de las distancias a la Tierra de estos astros.

\par
Cuando el di\'ametro de la Luna es mayor que el del Sol, el disco de \'este quedar\'a totalmente oculto para aquellos puntos de la Tierra inmersos en el cono de sombra, que observar\'an un eclipse total. Cuando el di\'ametro es menor,  desde los puntos de la superficie terrestre dentro del cono de sombra, ser\'a visible un anillo del disco solar; de ah\'{\i} el nombre de eclipse anular. En ocasiones ocurre que un mismo eclipse se observa como total en algunos puntos de la Tierra y como anular en otros; entonces el eclipse se denomina total-anular o mixto.
El mecanismo de los tres tipos de eclipses se ha esquematizado en la figura \ref{f:tipos}.
\begin{figure}[t]
\centering
\includegraphics[width=\textwidth]{./Figuras/Sombras.pdf}
\caption[Conos de sombra y penumbra respecto a la Tierra, seg\'un el tipo de eclipse]{Posiciones de los conos de sombra y de penumbra respecto a la Tierra, en el momento de m\'aximo acercamiento del eje de la sombra al centro de la Tierra, en un eclipse: parcial (arriba, izquierda), no central (arriba, derecha), central con una curva de totalidad (abajo, izquierda), central con una curva de parcialidad (abajo, centro) y central con dos curvas de parcialidad (abajo, derecha).}\label {f:sombras}
\end{figure}
Los eclipses totales y anulares pueden ser centrales y no centrales, dependiendo de si el eje de sombra corta o no la superficie terrestre en alg\'un momento. Adem\'as, en los eclipses centrales puede ocurrir que en alg\'un instante del eclipse, los dos conos queden totalmente inmersos en la superficie de la Tierra, que s\'olo lo haga el cono de sombra o que no lo haga ninguno de ellos.

\par
En resumen, en este trabajo distinguiremos los siguientes tipos de eclipses:
\begin{itemize}
\item Parcial
\item Total, anular, total-anular:
\begin{itemize}
\item No central
\item Central:
\begin{itemize}
\item Central con una sola curva de totalidad
\item Central con una sola curva de parcialidad
\item Central con las dos curvas de parcialidad
\end{itemize}
\end{itemize}
\end{itemize}
La subdivisi\'on  de los eclipses centrales que hemos realizado no es habitual. Sin ser un extremo de especial relevancia, en el \'ambito de este trabajo es importante para la sistematizaci\'on de los c\'alculos que se desarrollan en los siguientes apartados. Adem\'as, est\'a justificada por las trazas que los conos de sombra y de penumbra dejar\'an sobre la superficie terrestre en cada caso. Los distintos tipos de eclipse se ilustran en la figura \ref{f:sombras}.

%
\section{Par\'{a}metros y curvas caracter\'{\i}sticas de los eclipses solares}
Como ya se ha comentado, los eclipses de Sol son visibles \'unicamente desde determinadas zonas de la superficie terrestre, variando su desarrollo de una localizaci\'on a otra. Por tanto, es necesario dar la informaci\'on suficiente para que los usuarios puedan conocer, no s\'olo la fecha y el tipo de eclipse, sino en qu\'e lugares y en qu\'e condiciones se desarrollar\'a \'este. Tradicionalmente, esta informaci\'on consta de lo siguiente:
\begin{itemize}
\item Datos del Sol y la Luna en el instante de la conjunci\'on en ascensi\'on recta.
\item Circunstancias generales del eclipse
\item Mapa de visibilidad
\item Elementos besselianos
\end{itemize}

\subsection{Conjunci\'{o}n en Ascensi\'{o}n Recta}
Los eclipse de Sol ocurren aproximadamente cuando el Sol y la Luna tienen la misma ascensi\'on recta. Esta hora se toma como referencia para facilitar al usuario los datos que necesita para calcular c\'omo se desarrollar\'a el eclipse en una localizaci\'on concreta, es decir, las circunstancias locales del eclipse. Aunque actualmente el c\'alculo de las circunstancias locales se realiza mediante los elementos besselianos, las publicaciones especializadas siguen incluyendo los siguientes datos en el instante de la conjunci\'on en ascensi\'on recta:
\begin{itemize}
  \item Hora de la conjunci\'{o}n.
  \item Declinaci\'{o}n de Sol y Luna.
  \item Movimiento horario en declinaci\'on y en ascensi\'on recta de Sol y Luna.
  \item Paralaje horizontal ecuatorial de Sol y Luna.
  \item Semidi\'{a}metro verdadero de Sol y Luna.
\end{itemize}

\subsection{Circunstancias generales del eclipse}
Est\'{a}n constitu\'{\i}das por los datos siguientes, aunque no todos suelen facilitarse a los usuarios, ni todos ocurren en todos los eclipses.
\begin{itemize}
  \item \textit{Principio y fin del eclipse}.
  El eclipse comienza cuando el cono de penumbra es tangente a la Tierra. Adem\'{a}s de la hora en que esto ocurre, tambi\'{e}n se facilitan las coordenadas geogr\'{a}ficas del punto de tangencia: este punto ser\'{a} el primero de la Tierra desde el que los limbos del Sol y la Luna son tangentes exteriores. An\'{a}logamente para el fin del eclipse.

  Estos puntos existen en todos los eclipses.

  \item \textit{Principio y fin del eclipse total/anular}. An\'{a}logo al anterior, pero con el cono de sombra en lugar del de penumbra. Los puntos correspondientes de la Tierra son el primero y el \'{u}ltimo que ven los limbos del Sol y la Luna tangentes interiores.

  Estos puntos s\'olo existen en los eclipses \textit{totales}, \textit{anulares} y \textit{totales-anulares}.

  \item \textit{Principio y fin de la curva central del eclipse}. Son los dos puntos de tangencia del eje de la sombra con el elipsoide terrestre.

    Estos puntos s\'olo existen en los eclipses \textit{centrales}.

  \item \textit{Contactos interiores del cono de sombra}. Son los puntos de tangencia interior del cono de sombra con el elipsoide. Corresponden al primer y \'{u}ltimo momento en que el corte del cono de sombra con el elipsoide dibuja una curva cerrada.

    Estos puntos s\'olo existen en los eclipses \textit{centrales con una o dos curvas de parcialidad}, pero no en los \textit{centrales con una sola curva de totalidad}.

  \item \textit{Contactos interiores del cono de penumbra}. An\'{a}logo al anterior, pero con el cono de penumbra en lugar del de sombra.

      Estos puntos s\'olo existen en los eclipses \textit{centrales con las dos curvas de parcialidad}.

  \item \textit{M\'{a}ximo del eclipse}. Es el instante de m\'{a}xima proximidad del eje de la sombra al centro de la Tierra. Para un eclipse central el punto de m\'{a}ximo es el de corte del eje con la Tierra en ese instante. Para un eclipse no central es el punto de la Tierra m\'{a}s cercano al eje en ese instante.

  \item \textit{Eclipse central al mediod\'{\i}a local}. Punto de la curva central para el que el \textit{m\'{a}ximo del eclipse local} (m\'{\i}nima distancia angular aparente entre los centros de los discos solar y lunar) se produce al paso por el meridiano y por ello a mayor altura sobre el horizonte.

  Estos puntos suelen existir para la mayor\'{\i}a de los eclipses centrales.

  \item \textit{Coincidencia de las curvas de m\'{a}ximo en el horizonte con las curvas l\'{\i}mite Norte/Sur sombra/penumbra}. Son los puntos pertenecientes a la vez a las curvas mencionadas, cuyas caracter\'{\i}sticas se describen en el apartado siguiente.

 \item \textit{Magnitud del eclipse}. Se mide en el m\'aximo del eclipse. En los parciales y anulares es la fracci\'on del di\'ametro solar oculto por la Luna. Para los eclipses totales es la distancia entre el borde del Sol m\'as pr\'oximo al centro de la Luna y el borde de la Luna m\'as pr\'oximo al centro del Sol, dividido por el di\'ametro solar.
\end{itemize}

\subsection{Mapa del eclipse}
Las distintas fases del desarrollo de un eclipse se suelen representar en mapas, en los que se delimitan las zonas donde el eclipse es visible, y cuya interpretaci\'on permite conocer c\'omo se ver\'a desde cualquier punto de la Tierra. Los puntos y curvas caracter\'{\i}sticas que habitualmente se dibujan son los que se describen a continuaci\'on. En las figuras \ref{ejemploanular} y \ref{ejemploparcial} se presentan ejemplos de los mapas de un eclipse central y uno parcial, respectivamente.
\begin{figure}[p]
\centering
\includegraphics[height=\textwidth,angle=90]{./Figuras/EjemploMapaAnular.pdf}
\caption{Ejemplo de mapa de eclipse anular}\label{ejemploanular}
\end{figure}
\begin{figure}[p]
\centering
\includegraphics[width=\textwidth]{./Figuras/EjemploMapaParcial2.pdf}
\caption{Ejemplo de mapa de eclipse parcial}\label{ejemploparcial}
\end{figure}
\begin{description}
\item[Primer y \'ultimo contactos] Son el primer y el \'ultimo punto de la Tierra en observar el eclipse. Corresponden a los instantes de principio y fin del eclipse descritos en el apartado anterior.

\item[Curvas de contacto en el horizonte.]
Estas curvas corresponden a los lugares de la Tierra para los que el eclipse comienza o finaliza al orto o al ocaso. Son las cuatro curvas siguientes:
\begin{itemize}
  \item \textit{Principio del eclipse al orto}: La tangencia inicial de los limbos de Sol y Luna se observa justo en el horizonte. Es el l\'{\i}mite occidental de los puntos que pueden ver todo el eclipse por encima del horizonte; sobre ella se encuentra el primer contacto.

  \item \textit{Fin del eclipse al orto}: Para los puntos de esta curva el eclipse finalizar\'a coincidiendo con la salida del Sol. Es el l\'{\i}mite occidental del eclipse.

  \item \textit{Principio del eclipse al ocaso}: Para los puntos de esta curva el eclipse comienza coincidiendo con la puesta del Sol. Es el l\'{\i}mite oriental del eclipse.

  \item \textit{Fin del eclipse al ocaso}: La \'{u}ltima tangencia de ambos limbos se produce en el horizonte, mientras se pone el Sol. Es el l\'{\i}mite oriental de los puntos que pueden ver todo el eclipse por encima del horizonte; sobre ella se encuentra el \'ultimo contacto.
\end{itemize}

\item[Curvas de m\'{a}ximo del eclipse en el horizonte.]
Conjunto de puntos sobre la superficie para los que el instante de m\'{a}ximo del eclipse local se produce cuando el Sol est\'{a} en el horizonte. L\'{o}gicamente hay dos curvas:
\begin{itemize}
  \item \textit{Curva de m\'{a}ximo al orto}: Al orto es el m\'{a}ximo del eclipse y, conforme sale el Sol, \'este va disminuyendo. Esta curva se encuentra comprendida entre las de principio y fin del eclipse al orto.
  \item \textit{Curva de m\'{a}ximo al ocaso}: El eclipse aumenta conforme la altura del Sol disminuye, hasta llegar al m\'{a}ximo justo al ocaso. De forma an\'{a}loga a la anterior, esta curva se encuentra comprendida entre las de principio y fin del eclipse al ocaso.
\end{itemize}

\item[Curvas l\'{\i}mite Norte y Sur de la penumbra.]
Curvas l\'{\i}mite superior e inferior (esencialmente Norte y Sur) sobre la Tierra, de los puntos desde donde se puede ver el eclipse.

\item[Curvas l\'{\i}mite Norte y Sur de la sombra.]
Curvas l\'{\i}mite superior e inferior de los puntos desde donde se puede ver el eclipse como total/anular.

\item[Curva de la centralidad.] Es el lugar geom\'{e}trico de los puntos de corte del eje de la sombra con la Tierra. Cuando existe, est\'a flanqueada por las curvas l\'{\i}mite norte y sur de la sombra (en caso de existir ambas).

\item[Curvas de simultaneidad de principio y fin del eclipse.]
Corresponden con el corte del cono de penumbra con la Tierra en un instante determinado, que se suele proporcionar a horas exactas. Para los puntos de estas curvas el eclipse comienza o finaliza a la hora en cuesti\'on.

% L\'{o}gicamente s\'{o}lo se considera el primer corte de cada generatriz del cono con el elipsoide ya que desde los puntos del segundo corte no es visible el eclipse al encontrarse por debajo del horizonte.
%
\end{description}



\section{Sistema fundamental de coordenadas y elementos besselianos}

Definimos el \textit{Sistema Fundamental de Coordenadas} (figura \ref{SF}) como un sistema de referencia geoc\'{e}ntrico, tal que: el eje $z$ es paralelo al eje de sombra, positivo en el sentido Tierra-Luna; el eje $x$ es la intersecci\'{o}n del ecuador con el plano perpendicular a $z$, positivo hacia el Este; y el eje $y$ forma un triedro directo con los otros dos. Evidentemente, este sistema no es ni fijo en el espacio ni solidario a la Tierra, sino que var\'{\i}a respecto a \'esta conforme se desarrolla el eclipse.

\par
El plano $xy$ se denomina \textit{plano fundamental} y su corte con el elipsoide terrestre lo denominaremos \textit{elipse fundamental}, cuyos semiejes mayor y menor se encuentran en los ejes $x$ e $y$ respectivamente. Se llama \textit{plano del observador} al plano paralelo al fundamental que pasa por la situaci\'{o}n del observador. Las coordenadas de un punto de la superficie terrestre en este sistema de referencia las denotaremos por $\xi$, $\eta$ y $\zeta$.
\begin{figure}
\centering
\includegraphics[width=13cm]{./Figuras/Sistemas.pdf}
\caption{Sistema fundamental de coordenadas}\label{SF}
\end{figure}

Los elementos besselianos son un conjunto de funciones dependientes del tiempo que describen la geometr\'{\i}a del eclipse y facilitan su c\'alculo. Estas funciones son:
\begin{itemize}
  \item \emph{x, y}: Coordenadas, en el sistema fundamental, de la intersecci\'{o}n del eje de la sombra con el plano fundamental. Se dan en unidades del radio ecuatorial terrestre.

  \item \emph{d, $\mu$}: Declinaci\'{o}n y \'{a}ngulo horario en Greenwich del eje $z$. Se dan en grados sexagesimales. Tambi\'en es habitual proporcionar el $\sen d$ y el $\cos d$, en lugar de $d$.

  \item \emph{$l_{p}, l_{s}$}: Radios, en unidades del radio ecuatorial terrestre, de las respectivas intersecciones de los conos de penumbra  y sombra con el plano fundamental. Por convenio, estos radios tienen el mismo signo que la coordenada $z$ del v\'{e}rtice del cono correspondiente. Por tanto, $l_{p}$ es siempre positivo, mientras que $l_{s}$ puede ser positivo (eclipse anular en el plano fundamental), negativo (eclipse total en plano fundamental) o nulo (v\'{e}rtice de cono de sombra en plano fundamental).

  \item \emph{$i_{p}, i_{s}$}: Tangentes de la semiapertura del cono de penumbra y de sombra respectivamente.
\end{itemize}

Los elementos $x$, $y$, $l_{p}$, $l_{s}$, $i_{p}$ e $i_{s}$ determinan las dimensiones de los conos y su situaci\'on con respecto al plano fundamental, mientras que los elementos $\mu$ y $d$ relacionan el plano fundamental con la Tierra en rotaci\'{o}n.

De esta forma, y gracias a los elementos besselianos, es sencillo relacionar las coordenadas geogr\'{a}ficas de los puntos de la Tierra, con las del sistema fundamental. Esto es muy \'{u}til ya que es mucho m\'{a}s sencillo estudiar la geometr\'{\i}a del eclipse en el sistema fundamental y luego transformar las coordenadas, que no hacerlo directamente.

\subsubsection{Coordenadas del observador en el sistema fundamental}\label{coorfun}
Consideramos un sistema geogr\'{a}fico geoc\'{e}ntrico, cuyo eje $Z$ coincide con el eje polar, el plano $X,Y$ el Ecuador, el eje $X$ en la direcci\'{o}n del meridiano origen de longitudes y el eje $Y$ de manera que formen un triedro directo.

La posici\'on geogr\'afica de un observador viene dada por su longitud $\lambda$, su latitud geod\'esica $\varphi$, definidas de la forma habitual, y su altura $H$ sobre el elipsoide de referencia. Para calcular sus coordenadas geogr\'aficas cartesianas, es necesario calcular la latitud geoc\'entrica $\phi$, cuya relaci\'on con la geod\'esica viene dada por:
\[
\begin{array}{r@{{}={}}l}
\rho  \cos\phi & (C + H) \cos\varphi, \\[1ex]
\rho  \sen\phi & (S + H) \sen\varphi,
\end{array}
\]
en donde $\rho$ es la distancia geoc\'{e}ntrica del observador, y las cantidades $C$ y $S$ son
\[
C = \Frac{1}{\sqrt{\cos^2\phi + (1 - f)^2 \sen^2\phi}}, \qquad S = C (1 - f)^2,
\]
con $f$ el factor de aplanamiento terrestre. Tanto $\rho$ como $H$ deben expresarse en unidades del radio ecuatorial terrestre.

Las coordenadas geogr\'{a}ficas cartesianas son:
\[
\begin{array}{r@{{}={}}l}
X & \rho\cos\phi\cos \lambda,\\
Y & \rho\cos\phi\sen \lambda,\\
Z & \rho\sen\phi.
\end{array}
\]

Para pasar del sistema fundamental de coordenadas al geoc\'{e}ntrico, es preciso realizar un giro de $(d-90)$ grados en torno al eje $x$, llevando el eje $z$ sobre el $Z$, y de $(\mu-90)$ grados en torno al eje $Z$. Los cambios de coordenadas cartesianas de un sistema a otro quedan definidos por las siguientes relaciones matriciales:
\[
\left (
\begin{array}{c}
  X \\
  Y \\
  Z
\end{array}
\right )=
{\cal R}
\left (
\begin{array}{c}
  \xi \\
  \eta \\
  \zeta
\end{array}
\right ),\qquad
\left (
\begin{array}{c}
  \xi \\
  \eta \\
  \zeta
\end{array}
\right )=
{\cal R}^{\rm{T}}
\left (
\begin{array}{c}
  X \\
  Y \\
  Z
\end{array}
\right ),
\]
donde $\cal R$ es la matriz
\[
{\cal R}=
\left (
\begin{array}{ccc}
  \sen\mu  & -\sen d\,\cos\mu & \phantom{-}\cos d\,\cos\mu \\
  \cos\mu & \phantom{-}\sen d\,\sen\mu & -\cos d\, \sen\mu \\
  0                & \cos d                 & \sen d                  \\
\end{array}
\right )
\]
y ${\cal R}^{\rm{T}}$ su transpuesta.


Las coordenadas en el sistema fundamental $(\xi,\eta,\zeta)$, de un punto de coordenadas geogr\'{a}ficas $(\lambda,\phi)$, ser\'an:
\[
\begin{array}{r@{{}={}}l}
\xi   & \rho \cos\phi \sen h, \\
\eta  & \rho \sen\phi \cos d - \rho \cos\phi\sen d \cos h, \\
\zeta & \rho \sen\phi \sen d + \rho \cos\phi\cos d \cos h,
\end{array}
\]
donde $h=\mu + \lambda$  es el horario local del eje de la sombra.

\par

Derivando con respecto al tiempo, y tras las oportunas manipulaciones, se obtienen las derivadas temporales de las coordenadas del observador en el sistema fundamental:
\[
\begin{array}{r@{{}={}}l}
\xi' & \mu'(\zeta\cos d-\eta\sen d),\\
\eta' & -\zeta d'+\mu'\xi\sen d,\\
\zeta' & \eta d'-\eta'\xi\cos d.
\end{array}
\]

Para un observador de coordenadas $(\xi,\eta,\zeta)$, el radio del cono de penumbra en el plano del observador ($L_p$), del de sombra ($L_s$), as\'{\i} como la distancia ($\Delta$) al eje de la sombra, est\'an definidos por:
\begin{equation}\label{LpLsD}
\begin{array}{r@{{}={}}l}
L_{p} & l_{p}-\zeta i_{p},\\[1ex]
L_{s} & l_{s}-\zeta i_{s},\\[1ex]
\Delta & \sqrt{(x-\xi)^2+(y-\eta)^2}.
\end{array}
\end{equation}



\section{Restricciones del modelo}
Son las que habitualmente toman los distintos observatorios y agencias para la promulgaci\'{o}n de datos generales de eclipses en almanaques y efem\'{e}rides, y son las siguientes:
\begin{itemize}
  \item Forma de la Tierra elipsoide de revoluci\'{o}n con par\'{a}metros definidos por IAU (1976).
  \item Formas de Sol y Luna esferas con radio definido por IAU (1976).
  \item Centros geom\'{e}tricos de Sol y Tierra coincidiendo con el centro de masas. Desviaci\'{o}n de centro geom\'{e}trico de la Luna respecto de su centro de masas el indicado por IAU (1976).
  \item Se considera que el eclipse est\'{a} en el horizonte, es decir que se est\'{a} produciendo al orto o al ocaso, cuando el punto de observaci\'{o}n tiene nula su componente $\zeta$ en coordenadas fundamentales. Suponen despreciar la refracci\'{o}n atmosf\'{e}rica y considerar para estos puntos el cono como un cilindro con la misma base. Si se quisiese ser m\'{a}s preciso habr\'{\i}a que estudiar las circunstancias locales del eclipse.
\end{itemize}


\section{Datos iniciales}
Los datos necesarios para el c\'alculo de eclipses son las coordenadas ecuatoriales geoc\'entricas de Sol (\astrosun) y Luna (\leftmoon): distancia ($r$), ascensi\'{o}n recta ($\alpha$) y declinaci\'{o}n ($\delta$). Extraemos estos datos de las efem\'erides b\'asicas DE405/LE405, del Jet Propulsion Laboratory\cite{de405}, que proporcionan las coordenadas rectangulares ecuatoriales baric\'entricas para el per\'{\i}odo 1600//2201, del Sol, la Luna, los planetas y el baricentro Tierra-Luna, as\'{\i} como la nutaci\'on en longitud y oblicuidad.

A partir de estas efem\'erides se prepara una peque\~na base de datos que cubre el per\'{\i}odo de desarrollo del eclipse. En concreto, se generan dos ficheros (una para el Sol y otro para la Luna) que contienen las coordenadas requeridas, tabuladas a intervalos regulares de Tiempo Terrestre (TT).

El tiempo que se utiliza para calcular y presentar las circunstancias de un eclipse es, l\'ogicamente, el Tiempo Universal (UT). Como es bien conocido, \'esta no es una escala uniforme, sino que est\'a ligada a  la rotaci\'on terrestre y, por tanto, afectada de todas sus irregularidades. A efectos de c\'alculo, se trabaja con una estimaci\'on de $\Delta T = \mbox{TT}-\mbox{UT}$, diferencia entre el Tiempo Terrestre y  el Tiempo Universal. Una vez que se conozca con precisi\'on el valor de $\Delta T$, es necesario corregir los tiempos UT y las longitudes calculadas en las circunstancias del eclipse.

La relaci\'on entre las ascensiones rectas y los horarios, que forzosamente intervienen en los c\'alulos, es el Tiempo Sid\'ereo aparente (TS). \'Este se calcula a partir del UT y de la ecuaci\'on de equinoccios, en la que intervienen la nutaci\'on en longitud y oblicuidad, la longitud del nodo ascendente de la Luna, y una serie de t\'erminos en los que aparecen argumentos relacionados con la rotaci\'on terrestre. Por razones de simplicidad de c\'alculo, tambi\'en generamos un fichero con los tiempos sid\'ereos aparentes correspondientes a las horas UT en cuesti\'on.

\section{Implementaci\'on}

\subsection{C\'{a}lculo de elementos besselianos}
Sean $\vec{r}_{\astrosun}$ y $\vec{r}_{\leftmoon}$ los vectores de posici\'on geoc\'entricos del Sol y la Luna, dados por:
\[
\begin{array}{r@{{}={}}l}
\vec{r}_{\astrosun} & r_{\astrosun}(\cos\alpha_{\astrosun}\,\cos \delta_{\astrosun},\sen\alpha_{\astrosun}\,\cos \delta_{\astrosun},\sen \delta_{\astrosun}),\\[1ex]
\vec{r}_{\leftmoon} & r_{\leftmoon}(\cos\alpha_{\leftmoon}\,\cos \delta_{\leftmoon},\sen\alpha_{\leftmoon}\,\cos \delta_{\leftmoon},\sen \delta_{\leftmoon}).
\end{array}
\]

La direcci\'on del eje $z$ est\'a definida por el vector de posici\'on del Sol respecto a la Luna $\vec{r}_{\leftmoon\kern-.5ex\hbox{-\astrosun}} = \vec{r}_{\astrosun}-\vec{r}_{\leftmoon}$, cuyas componentes son:
\[
\vec{r}_{\leftmoon\kern-.5ex\hbox{-\astrosun}} = r_{\leftmoon\kern-.5ex\hbox{-\astrosun}}(\cos a\,\cos d,\sen a\,\cos d,\sen d),
\]
donde $d$ ya es uno de los elementos besselianos y $a$ es la ascensi\'on recta del eje $z$. Estos dos argumentos fijan la orientaci\'on del sistema fundamental respecto al ecuador y equinoccio verdaderos de la fecha.

Los elementos besselianos $x$ e $y$ se calculan hallando las coordenadas de la Luna en el sistema fundamental:
\[
\begin{array}{r@{{}={}}l}
x = x_{\leftmoon} & r_{\leftmoon}\cos \delta_{\leftmoon} \sen\left(\alpha_{\leftmoon}-a\right),\\[1.5ex]
y = y_{\leftmoon}& r_{\leftmoon}\left[\sen \delta_{\leftmoon} \cos d - \cos \delta_{\leftmoon} \sen d \cos\left(\alpha_{\leftmoon}-a\right)\right],\\[1.5ex]
z_{\leftmoon} & r_{\leftmoon}\left[\sen \delta_{\leftmoon} \sen d + \cos \delta_{\leftmoon} \cos d \cos\left(\alpha_{\leftmoon}-a\right)\right].
\end{array}
\]

En cuanto a los elementos $i_{p}$ e $i_{s}$, se obtienen de:
\[
\begin{array}{r@{{}={}}l}
i_{s} & \tan\left[\arcsen\left(\Frac{R_{\astrosun}-R_{\leftmoon}}{r_{\leftmoon\kern-.5ex\hbox{-\astrosun}}}\right)\right],\\[3ex]
i_{p} & \tan\left[\arcsen\left(\Frac{R_{\astrosun}+R_{\leftmoon}}{r_{\leftmoon\kern-.5ex\hbox{-\astrosun}}}\right)\right],
\end{array}
\]
donde $R_{\astrosun}$ y $R_{\leftmoon}$ son los radios del Sol y la Luna, respectivamente.

Los valores de los elementos \emph{$l_{s}$} y $l_{p}$ son:
\[
\begin{array}{r@{{}={}}l}
l_{s} & z_{\leftmoon}\,i_{s}-R_{\leftmoon}\sqrt{1+{i_s}^2},\\[1ex]
l_{p} & z_{\leftmoon}\,i_{p}+R_{\leftmoon}\sqrt{1+{i_p}^2}.
\end{array}
\]

Por \'{u}ltimo el elemento \emph{$\mu$} es
\[
\mu=\mbox{TS} - a.
\]

Con las f\'ormulas anteriores se calculan todos los elementos besselianos, para los instantes tabulados en los datos iniciales.

\subsection{C\'{a}lculo de funciones interpolantes de elementos besselianos y de sus derivadas}
Con los valores discretos de los elementos besselianos a lo largo de todo el per\'{\i}odo, mediante  las funciones \verb"Interpolation" y \verb"Derivative" de \texttt{Mathematica}, se crean funciones interpolantes y sus derivadas, que ser\'{a}n utilizadas a lo largo de todo el programa.

\subsection{C\'{a}lculo de la distancia $q$ del eje de la sombra a la elipse fundamental}
El semieje menor $b$ de la elipse fundamental se calcula a partir del elemento $d$, para cada instante tabulado, mediante la expresi\'on:
\begin{equation}\label{b}
b = \sqrt{a^2\left[\cos^2 u+(1-f)^2\sen^2 u\right]},
\end{equation}
donde $u$ es la latitud reducida correspondiente a una latitud geoc\'entrica $90\Deg-d$, dada por:
\[
\tan u =\Frac{\cos d}{(1-f)\sen d}.
\]

Situada la elipse y conocidas las coordenadas $(x,y)$ del corte del eje de la sombra con el plano fundamental, se calcula la posici\'{o}n del punto de la elipse m\'{a}s cercano al eje de sombra, como el punto de la elipse cuya perpendicular contenida en el plano fundamental, pasa por el eje. La distancia  entre el punto as\'{\i} calculado y el $(x,y)$ es la distancia $q$ buscada, que tomaremos negativa o positiva seg\'{u}n el eje de sombra pase o no por el interior de la elipse fundamental.

\par
Tanto del semieje menor de la elipse fundamental, como de la distancia $q$, se hallan funciones interpolantes.


\subsection{Determinaci\'{o}n del tipo de eclipse}
Para que se produzca un eclipse, el radio del cono de penumbra en el plano fundamental (elemento $l_{p}$) debe ser en alg\'un instante mayor que la distancia $q$ del eje de la sombra a la elipse fundamental.
Mediante la funci\'{o}n \verb"FindMinimun", se halla el valor m\'{\i}nimo de la funci\'{o}n $q-l_{p}$. Si este valor es positivo no hay eclipse, y en caso contrario al menos hay eclipse parcial.
%Adem\'{a}s se le da el valor 1 a una variable auxiliar \'{o} 0 en caso contrario.

Si $\min(q-l_p)<0$, se calcula el valor de $\min(q-l_s)$. Si \'este es $>0$, el eclipse es \textit{parcial}, y en caso contrario, es total/anular; la discusi\'on de si es total, anular o mixto se realiza en el apartado \ref{s:tipoanular}. En \'este \'ultimo caso, si $\min(q)>0$ el eclipse es \textit{no central}, siendo central en caso contrario.

Cuando el eclipse es central, ser\'a del tipo \textit{central con una sola curva de totalidad} cuando $\min(q+l_s)>0$, y tendr\'a dos curvas de totalidad en caso contrario.

Para estos \'ultimos, el eclipse ser\'a \textit{central con una sola curva de parcialidad} si $\min(q+l_p)>0$, y \textit{central con las dos curvas de parcialidad} cuando $\min(q+l_p)<0$.

Las condiciones descritas para los distintos tipos de eclipse se visualizan f\'acilmente en la figura \ref{f:sombras}. El cumplimiento o no de cada una de las condiciones se almacena en variables auxiliares l\'ogicas, cuyo valor determinar\'a si un c\'alculo concreto tiene sentido o no, seg\'un el tipo de eclipse.

\subsection{Obtenci\'{o}n de par\'{a}metros para la conjunci\'{o}n en ascensi\'{o}n recta}
En primer lugar, se obtienen las funciones interpolantes de todos los datos iniciales: ascensi\'{o}n recta, declinaci\'{o}n y distancia de Sol y Luna y tiempo sid\'ereo.


El instante de conjunci\'on en ascensi\'on recta se obtiene mediante la funci\'{o}n \verb"FindRoot", calculando el cero de la diferencia entre las ascensiones rectas de Sol y Luna. Con esta hora se calculan la declinaci\'{o}n de ambos astros, as\'{\i} como su paralaje horizontal ecuatorial $(PHE)$ y semidi\'{a}metro $(SD)$, dados por:
\[
PHE_{\astrosun}=\arcsen\left(\frac{R_{\oplus}}{r_{\astrosun}}\right),\qquad
SD_{\astrosun}=\arcsen\left(\frac{R_{\astrosun}}{r_{\astrosun}}\right),
\]
\[
PHE_{\leftmoon}=\arcsen\left(\frac{R_{\oplus}}{r_{\leftmoon}}\right),\qquad
SD_{\leftmoon}=\arcsen\left(\frac{R_{\leftmoon}}{r_{\leftmoon}}\right),
\]
donde $R_\oplus$ es el radio ecuatorial de la Tierra.


\subsection{C\'{a}lculo de las circunstancias generales}
A continuaci\'on se describe el c\'alculo de las circunstancias generales de un eclipse, aunque, como ya se indic\'o anterioremente, no todas tienen sentido en todos los eclipses. Gracias a las variables l\'ogicas auxiliares definidas al determinar el tipo de eclipse, el programa calcula \'unicamente aquellas circunstacias que sean procedentes.

\subsubsection{Principio y fin de las distintas fases}
Utilizando la funci\'on \verb"FindRoot" el principio y fin de cada fase se obtiene calculando las horas para las que se anulan las siguientes funciones:
\begin{center}
\begin{tabular}{ll}
\hphantom{Contactos interiores del cono de penumbra olao}\\[-2ex]
Principio y fin del eclipse parcial:\dotfill & $q - l_p$\\[1ex]
Principio y fin del eclipse total/anular:\dotfill & $q - l_s$\\[1ex]
Principio y fin del eclipse central:\dotfill & $q$\\[1ex]
Contactos interiores del cono de sombra:\dotfill & $q + l_s$\\[1ex]
Contactos interiores del cono de penumbra:\dotfill & $q + l_p$
\end{tabular}
\end{center}

Adem\'{a}s, para cada instante calculado, y mediante el m\'etodo ya descrito para la obtenci\'on de $q$, se calcula el punto de la elipse fundamental m\'{a}s cercano al eje de sombra. Estos puntos se obtienen en coordenadas fundamentales, a partir de la cuales se calculan las geogr\'{a}ficas.

Los instantes de principio y fin de cada fase acotan los intervalos de tiempo que se utilizar\'an en los c\'alculos que siguen.

%Gracias a los dos instantes obtenidos, se crean intervalos de tiempo acotados por ellos, y espaciados cada minuto, cinco minutos o una hora.

\subsubsection{C\'{a}lculo del m\'{a}ximo del eclipse}
La distancia del eje de la sombra al centro de la Tierra es $\sqrt{x^2+y^2}$. El instante en que esta distancia es m\'inima lo obtenemos mediante la funci\'{o}n \verb"FindRoot" aplicada a la derivada de dicha funci\'{o}n.

Para obtener el punto de m\'{a}ximo del eclipse hemos distinguido dos casos, seg\'{u}n el eclipse sea central o no.

En un eclipse central hay que hallar el punto de corte del elipsoide y el eje de sombra, en el instante de m\'aximo. \'Este se calcula resolviendo, mediante la funci\'{o}n \verb"NSolve", el sistema de ecuaciones:
\[
\begin{array}{r@{{}={}}l}
\xi & x,\\
\eta & y,\\
X^2+Y^2+\dfrac{Z^2}{(1-f)^2} & 1,
\end{array}
\]
donde $x$ e $y$ son los valores correspondientes al instante de m\'aximo, y $(X, Y,Z)$ deben expresarse en coordenadas fundamentales ($\xi,\eta,\zeta$) mediante el cambio de coordenadas descrito en la secci\'{o}n \ref{coorfun}. De las dos soluciones obtenidas, l\'ogicamente s\'{o}lo interesa la de $\zeta>0$, que se transforma a coordenadas geogr\'{a}ficas.

Cuando el eclipse es \textit{no central}, se calcula para el instante de m\'aximo el punto de la elipse fundamental m\'{a}s cercano al eje de sombra, que es el punto de m\'{a}ximo.

\subsubsection{Determinaci\'{o}n del tipo de eclipse total, anular o mixto}\label{s:tipoanular}
%Para los eclipses parciales, l\'ogicamente, lo que sigue no es de aplicaci\'on. Calculamos los radios del cono de sombra en el plano del observador ($L_{s}$), correspondientes a los puntos de principio y fin del eclipse total/anular, as\'{\i} como al de m\'{a}ximo del eclipse. Si todos ellos son mayores que cero, el eclipse es anular, si son menores que cero, es total, y si hay cambio de signo es mixto.

%\subsubsection{Determinaci\'{o}n bis del tipo de eclipse total, anular o mixto}%\label{s:tipoanular}
Para los eclipses parciales, l\'ogicamente, lo que sigue no es de aplicaci\'on.
\par
Para que el eclipse se vea como total desde alg\'{u}n punto, hace falta que \'{e}ste se encuentre inmerso en el cono de sombra, y que su coordenada $\zeta$ sea superior a la del v\'{e}rtice del cono, cuyo valor es $l_{s}/i_{s}$. Si bien la coordenada $z$ del v\'{e}rtice (distancia de \'este al plano fundamental) no es constante a lo largo del eclipse, su variaci\'{o}n es muy peque\~{n}a en comparaci\'{o}n con la variaci\'{o}n de la coordenada $\zeta$ de los puntos de la superficie terrestre interiores al cono de sombra. El momento m\'{a}s id\'{o}neo para estar en la ``parte alta''  del cono de sombra es en el instante de m\'{a}ximo de eclipse, ya que es cuando los puntos de mayor $\zeta$ est\'{a}n m\'{a}s pr\'{o}ximos al eje. Se puede concluir que, si en este instante ninguno de los puntos ve el eclipse como total, entonces el eclipse ser\'{a} anular.
\par
Para comprobar lo anterior se calculan las coordenadas del eje de sombra para el instante de m\'{a}ximo. Si resultaran ser exactamente ($0,0$), se calcular\'{\i}a la coordenada $\zeta$ del punto de m\'{a}ximo y, en funci\'{o}n de su valor, se ver\'{\i}a si el eclipse tiene o no alg\'{u}n punto de totalidad. En el caso general en que el eje de sombra no pase exactamente por el centro de la Tierra, se determinar\'{a} la generatriz del cono que pasa por la vertical del centro de la Tierra en el instante de m\'{a}ximo, ya que \'esta define la parte del cono m\'{a}s pr\'{o}xima a la Tierra. Esta generatriz es una recta que pasa por el v\'{e}rtice $V$, de coordenadas $(x,y,\l_s/i_s)$ y tiene la direcci\'{o}n $\vec{g}$, de componentes
\[
(g_{x},g_{y},g_{z})=\dfrac{1}{\sqrt{1+{i_s}^2}}\left(-\dfrac{x\,i_s}{\sqrt{x^2+y^2}},-\dfrac{y\,i_s}{\sqrt{x^2+y^2}},1\right).
\]
Para que haya eclipse total, el corte de esta generatriz con el elipsoide tiene que tener al menos una soluci\'on real, con $\zeta\geq\l_s/i_s $. El corte, en este caso, se calcula aplicando la funci\'{o}n \verb"NSolve" al siguiente sistema:
\[
\begin{array}{r@{{}={}}l}
g_{z}(\eta-y) & g_{y}(\zeta- l_s/i_s), \\[1ex]
g_{z}(\xi-x) & g_{x}(\zeta- l_s/i_s), \\
X^2+Y^2+\dfrac{Z^2}{(1-f)^2} & 1.
\end{array}
\]

Si resultara que s\'{\i} hay puntos que ven el eclipse como total, faltar\'{\i}a determinar si alg\'{u}n punto lo ve o no como anular, para clasificar el eclipse como mixto o como total. Los puntos id\'{o}neos para calcular esto son los de primer y \'{u}ltimo contacto del cono de sombra. Esto es debido a que, de entre todos los puntos que durante el eclipse est\'{a}n inmersos en el cono de sombra y que tienen $\zeta=0$, el v\'{e}rtice del cono de sombra tendr\'a su mayor $z$ en uno de estos dos instantes. Para determinar si existe anularidad o no, basta pues hallar el valor de $l_{s}$ en estos dos instantes. Si ambos son negativos el eclipse es total, y si alguno es positivo el eclipse es mixto.


\subsubsection{C\'alculo de la magnitud del eclipse}
La magnitud $M$ del eclipse viene dada por la siguiente f\'{o}rmula, calculada para el m\'aximo del eclipse:
\[
M=\frac{L_{p}-\Theta}{L_{p}-L_{s}},
\]
donde $\Theta=L_{s}$ para los eclipses anulares y $\Theta=\Delta$ para los eclipses parciales y totales.


\subsection{Obtenci\'{o}n de la curva central del eclipse y de la duraci\'{o}n de la totalidad en sus puntos}
Se calcula para distintos instantes, el punto de corte del eje de sombra con el elipsoide. Para ello se procede de la misma forma que para obtener el punto de m\'{a}ximo de eclipse cuando exist\'{\i}a corte entre el eje de sombra y el elipsoide terrestre. De nuevo s\'{o}lo interesa el valor para el que $\zeta>0$.

Para determinar el principio y fin del eclipse total en cada uno de los puntos calculados, determinamos mediante \verb"FindRoot" los ceros de la funci\'on $\Delta - L_s$, cuya diferencia ser\'a la duraci\'on de la totalidad.

\subsection{C\'{a}lculo del eclipse central al mediod\'{\i}a local}
Es el punto de la curva central que se encuentra sobre el plano $x=0$. De los puntos calculados de la curva central, se obtienen los distintos valores de su coordenada $\xi$. Si \'esta cambia de signo a lo largo de la curva, se obtiene una funci\'{o}n interpolante con dicho valor y mediante \verb"FindRoot" se halla el instante para el que se anula. Para dicho instante se calcula de nuevo el punto de corte del eje con el elipsoide y dicho punto corresponde al del eclipse central al mediod\'{\i}a local.


\subsection{Obtenci\'{o}n de las curvas de contacto en el horizonte}
Las conforman, para cada instante, los puntos de la elipse fundamental, para los cuales la distancia al eje de sombra coincide con el radio del cono de penumbra en el plano fundamental. Para obtenerlos, se resuelve mediante la funci\'{o}n \verb"NSolve" el siguiente sistema de ecuaciones, del que se desechan las soluciones no reales:
\[
\begin{array}{r@{{}={}}l}
\zeta & 0, \\
\dfrac{\eta^2}{b^2}+\xi^2 & 1,\\
\Delta & l_{p},
\end{array}
\]
donde $b$ es el semieje menor de la elipse fundamental dado por (\ref{b}).

\subsection{Obtenci\'{o}n de las curvas de m\'{a}ximo de eclipse en el horizonte}
Las conforman, para cada instante, los puntos de la elipse fundamental que se encuentran a su m\'{\i}nima distancia del eje de la sombra. Para ellos pues, la funci\'{o}n $\Delta$ tiene un m\'{\i}nimo. Para obtenerlos, se resuelve mediante la funci\'{o}n \verb"NSolve" el siguiente sistema de ecuaciones, del que se mantienen exclusivamente los puntos reales y que cumplan adem\'{a}s $l_{p}-\Delta\geq0$, ya que de no ser as\'{\i}, se econtrar\'{\i}an fuera del cono de penumbra y por lo tanto no ver\'{\i}an el eclipse en ese instante.
\[
\begin{array}{r@{{}={}}l}
\zeta & 0, \\
\dfrac{\eta^2}{b^2}+\xi^2 & 1,\\
\dfrac{d(\Delta)}{dt} & 0.
\end{array}
\]

\subsection{Obtenci\'{o}n de las curvas l\'{\i}mite Norte y Sur}\label{climite}
Se distinguen dos tipos de curvas completamente distintas. El primer tipo, es de las curvas formadas por los puntos de coordenada $\zeta\geq0$, para los que el eclipse se reduce a una \'{u}nica tangencia de los discos del Sol y de la Luna. Si la tangencia es exterior, para esos puntos el eclipse ser\'a parcial, y conforman las curvas l\'{\i}mite de la penumbra. Si, por contra, la tangencia es interior, el eclipse ser\'a total o anular y los puntos conforman las curvas l\'{\i}mite de la sombra.

Estos puntos verifican la condici\'on de que pertenecen a la vez al elipsoide y al cono. Adem\'{a}s, para ellos la funci\'{o}n $L-\Delta$ (donde $L$ ser\'{a} $L_{s}$ o $L_{p}$ seg\'{u}n se trate del cono de sombra o de penumbra) se anula y tiene un m\'{a}ximo, ya que \'{e}sta toma siempre valor negativo excepto en ese preciso instante. Para facilitar el c\'{a}lculo, y por ser equivalente en este caso, se maximiza la funci\'{o}n $L^2-\Delta^2$. Se resuelve mediante la funci\'{o}n \verb"NSolve", como en casos anteriores, el siguiente sistema de ecuaciones, del que se eliminan las soluciones imaginarias y las que dan un valor de $\zeta<0$.
\[
\begin{array}{r@{{}={}}l}
\dfrac{d(L^2-\Delta^2)}{dt} & 0, \\[1.5ex]
L-\Delta & 0, \\[1.5ex]
X^2+Y^2+\dfrac{Z^2}{(1-f)^2} & 1;
\end{array}
\]
recordando de nuevo que las coordenadas $(X,Y,Z)$ se han de expresar en coordenadas fundamentales ($\xi,\eta,\zeta$).

\par
La condici\'{o}n anterior es la que aparece en toda la bibliograf\'{\i}a consultada cuando se refieren a curvas l\'{\i}mite Norte y Sur. En estas fuentes, para todos los eclipses, excepto para los \emph{centrales con las dos curvas de parcialidad}, s\'olo existe una curva l\'{\i}mite Norte o Sur, quedando el resto del eclipse limitado por las curvas de contacto en el horizonte, que aparecen unidas formado un ``ocho'' caracter\'{\i}stico.

De los mapas est\'andar de algunos eclipses, puede interpretarse que no hay eclipse en puntos pr\'oximos a la uni\'{o}n de las curvas de contacto en el horizonte, situados fuera de ellas. Sin embargo, si se calculan las circunstancias locales del eclipse para esos puntos, se comprueba que s\'{\i} ven el eclipse, lo que lleva obligatoriamente a la existencia, para estos eclipses, de otro tipo de curva l\'{\i}mite (ver figura \ref{nuevacurva}). Esta curva es la formada por los puntos que, estando inmersos en el cono de penumbra, tienen siempre el eclipse por debajo del horizonte ($\zeta<0$), excepto en un instante en el que se hace $\zeta=0$.
\begin{figure}[p]
\centering
\includegraphics[width=14cm]{./Figuras/ccritico.pdf}
\caption[Descripci\'{o}n nueva curva l\'{\i}mite]{Eclipse parcial de 25 de diciembre de 2000: Mapa completo (arriba), ampliaci\'{o}n de la zona de uni\'{o}n de las curvas de contacto en el horizonte sin curva nueva (abajo, izquierda) y con la curva nueva en rojo (abajo, derecha).}\label{nuevacurva}
\end{figure}

\par

Esta nueva curva se calcula hallando los puntos que maximizan y anulan a la vez la funci\'{o}n $\zeta$. Se conservan s\'{o}lo las soluciones reales y para las que $l_{p}-\Delta\geq0$. Son la soluci\'{o}n del siguiente sistema:
\[
\begin{array}{r@{{}={}}l}
\zeta & 0, \\[1.5ex]
\dfrac{\eta^2}{b^2}+\xi^2 & 1,\\[2ex]
\dfrac{d(\zeta)}{dt} & 0.
\end{array}
\]

\subsection{C\'{a}lculo de los puntos de coincidencia de las curvas de m\'{a}ximo en el horizonte con las curvas  l\'{\i}mite  Norte/Sur sombra/penumbra}
Estos puntos son de gran inter\'es para el dibujo de los mapas de los eclipses. En este caso, las curvas l\'{\i}mite Norte y Sur son las del primer tipo mencionado en el apartado anterior.
\par
El modo de proceder es utilizar los puntos obtenidos en las curvas de m\'{a}ximo en el horizonte e ir comprobando su distancia (con signo) al borde del cono de penumbra/sombra para los distintos instantes. Con estos valores se hace una funci\'{o}n interpolante, cuyos ceros, calculados mediante \verb"FindRoot", ser\'{a}n los instantes de coincidencia de ambas curvas. Para estos instantes se obtienen los puntos de la curva de m\'{a}ximo en el horizonte, que ser\'{a}n los buscados.

\subsection{Obtenci\'{o}n de las curvas de simultaneidad de principio y fin del eclipse}
Son los puntos, para cada instante, de corte del cono de penumbra con el elipsoide terrestre. El m\'{e}todo que se aplica es ir calculando puntos de estas curvas en distintos planos $\zeta={\rm cte.}$, para valores $0\leq\zeta\leq1$. Los puntos que se obtienen son los de corte de una circunferencia y una elipse, que son las figuras geom\'{e}tricas que forman el cono y el elipsoide, respectivamente, en cada plano. Para obtenerlos se resuelve, utilizando la funci\'{o}n \verb"NSolve", el siguiente sistema de ecuaciones, del que se desechan las soluciones no reales.
\[
\begin{array}{r@{{}={}}l}
\zeta & {\rm cte.}, \\[1ex]
\Delta & L_{p},\\[1.5ex]
X^2+Y^2+\dfrac{Z^2}{(1-f)^2} & 1.
\end{array}
\]


\section{Dibujo del Mapa}

De los algoritmos utilizados para el c\'{a}lculo de cada tipo de curvas, se obtienen en cada instante, un punto aislado o una pareja de puntos. En este segundo caso pueden pertenecer a una misma curva, debiendo aparecer ordenados, o a dos curvas distintas, debi\'{e}ndose entonces distribuir correctamente. Para ello se utilizan criterios basados en la proximidad entre puntos (minimizar distancias) y en la continuidad (minimizar \'{a}ngulo). Con los puntos ya ordenados y diferenciados en sus respectivas curvas, se obtiene la curva en s\'{\i} mediante la funci\'{o}n \verb"BSpline".

Una vez obtenidas todas las curvas, \'{e}stas se muestran, junto con la ret\'{\i}cula de paralelos y meridianos y el contorno de los continentes (ambos de una librer\'{\i}a), mediante una representaci\'{o}n estereogr\'{a}fica tangente. En este tipo de  representaci\'{o}n el plano de proyecci\'{o}n es tangente a una esfera, y todos los puntos se proyectan desde un foco que es el punto de la esfera opuesto al de tangencia. Cuenta con la propiedad de la isogonalidad, es decir mantiene los \'{a}ngulos. Las distancias sin embargo aumentan conforme se alejan del punto de tangencia.

Como punto de tangencia se escoge el punto de m\'{a}ximo de eclipse y se fijan unos par\'{a}metros que definen la cantidad de superficie que se representa. L\'{o}gicamente estos par\'{a}metros se pueden variar para encuadrar mejor el eclipse en el dibujo.

\section{Conclusiones}

La utilidad de poder calcular todos los elementos de un eclipse y de representar las curvas caracter\'{\i}sticas mediante un procesador simb\'{o}lico ha quedado manifiesta. La sencillez y elegancia de las ecuaciones presentadas contrasta con la complejidad de los c\'{a}lculos basados en iteraciones.
\par
Adem\'{a}s, la resoluci\'{o}n de las ecuaciones mediante procesadores simb\'{o}licos permite obtener resultados que las iteraciones no consiguen alcanzar. Muestra de ello es el c\'{a}lculo de los puntos de coincidencia de las curvas de m\'{a}ximo en el horizonte con las de l\'{\i}mite Norte/Sur. De otra forma, es necesario ir disminuyendo asint\'oticamente el intervalo de tiempos para el c\'alculo de puntos, para obtener una determinaci\'on aceptable de estos puntos de coincidencia, lo que sin duda complica el proceso, cuando no lo hace imposible.
\par
Los procesadores simb\'olicos, especialmente \texttt{Mathematica}, son una gran herramienta a la hora de dibujar los mapas de los eclipses.
\par
Debemos destacar el estudio detallado del desarrollo del eclipse en zonas cr\'{\i}ticas, que ha conlu\'{\i}do en el descubrimiento de una nueva curva l\'{\i}mite, de cuya existencia no se tiene constancia en la bibliograf\'{\i}a consultada. La utilidad de esta nueva curva es muy cuestionable desde el punto de vista pr\'{a}ctico. \'{E}sta aparece en regiones polares, donde la presencia humana es escasa y adem\'{a}s su situaci\'{o}n difiere muy poco de las curvas pr\'{o}ximas. A todo esto hay que a\~{n}adir el hecho de que el eclipse en esos puntos se ve en el horizonte, con las imprecisiones que ello conlleva debido a la refracci\'{o}n atmosf\'{e}rica. Sin embargo, desde el punto de vista conceptual y acad\'emico s\'{\i} es importante, ya que permite comprender la geometr\'{\i}a del eclipse en esas zonas cr\'{\i}ticas.


Los programas desarrollados se utilizar\'an en la Secci\'on de Efem\'erides del ROA, como complemento de los ya existentes.



\appendix
\renewcommand{\thesection}{\Alph{section}}
\section{Funciones auxiliares utilizadas}
Son el conjunto de funciones creadas en \texttt{Mathematica} para la ejecuci\'{o}n de todos los algoritmos necesarios.
\paragraph{Formatos de horas, grados y radianes}
\begin{itemize}
  \item {\tt hms2h}: Paso de horas, minutos y segundos a horas.
  \item {\tt h2hms}: Paso de horas a horas, minutos y segundos.
  \item {\tt h2hm}: Paso de horas a horas y minutos.
  \item {\tt gms2rad}: Paso de grados, minutos y segundos a radianes.
  \item {\tt rad2gms}: Paso de radianes a grados, minutos y segundos.
  \item {\tt grad2gm}: Paso de grados a grados y minutos.
  \item {\tt hms2rad}: Paso de horas, minutos y segundos a radianes.
  \item {\tt rad2hms}: Paso de radianes a horas, minutos y segundos.
  \item {\tt hms2gms}: Paso de horas, minutos y segundos a grados, minutos y segundos.
  \item {\tt gms2hms}: Paso de grados, minutos y segundos a horas, minutos y segundos.
  \item {\tt gm2grad}: Paso de grados y minutos a grados.
  \item {\tt h2ms}: Paso de horas a minutos y segundos.
  \item {\tt h2s}: Paso de horas a segundos.
\end{itemize}
\paragraph{Fechas y tiempos}
\begin{itemize}
  \item {\tt diajuliano}: A partir del d\'{\i}a, mes y a\~{n}o se obtiene el d\'{\i}a juliano.
  \item {\tt tsidmedloc}: Da el tiempo sid\'{e}reo medio local, a partir del d\'{\i}a, mes, a\~{n}o, hora UT y longitud.
  \item {\tt cormerefe, coramerefe}: Correcci\'{o}n en grados de longitud debido a la diferencia entre el Tiempo Terrestre (en el que figuran los datos) y el Tiempo Universal (ligado a la rotaci\'{o}n terrestre).
\end{itemize}
\paragraph{Transformaci\'{o}n de coordenadas}
\begin{itemize}
  \item {\tt ecu2cart}: Paso de coordenadas polares a cartesianas.
  \item {\tt cart2ecu}: Paso de coordenadas cartesianas a polares.
  \item {\tt Rx}: Rotaci\'{o}n en torno al eje $x$.
  \item {\tt Ry}: Rotaci\'{o}n en torno al eje $y$.
  \item {\tt Rz}: Rotaci\'{o}n en torno al eje $z$.
  \item {\tt Matcambcoor}: Matriz de cambio de coordenadas del sistema fundamental al geogr\'{a}fico dados los elementos besselianos $d$ y $\mu$.
  \item {\tt matcambcoor}: Matriz de cambio de coordenadas del sistema fundamental al geogr\'{a}fico para un instante determinado.
  \item {\tt cambcoorcart}: Paso de coordenadas cartesianas del sistema fundamental al geogr\'{a}fico para un instante determinado.
  \item {\tt geodes2geocen}: Paso de latitud geod\'{e}sica y altura a latitud geoc\'{e}ntrica y distancia radial.
  \item {\tt latgeocen2latgeode}: Paso de latitud geoc\'{e}ntrica a geod\'{e}sica.
  \item {\tt ecu2ecli}: Paso de coordenadas polares del sistema ecuatorial al ecl\'{\i}ptico.
  \item {\tt ecli2ecu}: Paso de coordenadas polares del sistema ecl\'{\i}ptico al ecuatorial.
  \item {\tt correcluna}: Correcci\'{o}n de coordenadas de la Luna por diferencia entre centro de masas y centro geom\'{e}trico.
\end{itemize}
\paragraph{Funciones geom\'{e}tricas del elipsoide}
\begin{itemize}
  \item {\tt radeliphor}: Valor del semieje menor de la elipse fundamental para cada valor del elemento $d$.
  \item {\tt disEjeElip}: Distancia con signo (positiva exterior, negativa interior) de un punto a una elipse.
\end{itemize}
\paragraph{Coordenadas en cada instante del punto de la elipse fundamental m\'{a}s pr\'{o}ximo al eje de sombra}
\begin{itemize}
  \item $\xi \eta${\tt fun}: Coordenadas fundamentales de dicho punto.
  \item $\xi \eta${\tt fun2xyz}: Coordenadas cartesianas de ese punto en el sistema geogr\'{a}fico.
  \item $\xi \eta${\tt fun2ecu}: Coordenadas polares de dicho punto en el sistema geogr\'{a}fico.
  \item $\xi \eta${\tt fun2lonlat}: Coordenadas geogr\'{a}ficas del referido punto.
\end{itemize}
\paragraph{Coordenadas en sistema fundamental en cada instante, de cualquier punto del elipsoide}
\begin{itemize}
  \item {\tt lonlatt2xyz, lonlatth2xyz}: Coordenadas cartesianas en el sistema geogr\'{a}fico, de cualquier punto terrestre (sin o con elevaci\'{o}n respecto a la superficie) para un instante determinado.
  \item {\tt lonlatt2}$\xi \eta \zeta$, {\tt lonlatth2}$\xi \eta \zeta$: Idem pero ya en coordenadas fundamentales.
\end{itemize}
\paragraph{Funciones de corte del eje de sombra con el elipsoide y duraci\'{o}n de la totalidad en el eje}
\begin{itemize}
  \item {\tt corteejeelip2}$\xi \eta \zeta$: Coordenadas en el sistema fundamental del punto de corte del eje de sombra con el elipsoide, dados los elementos besselianos.
  \item {\tt corteejeelip2xyz}: Coordenadas cartesianas en el sistema geogr\'{a}fico del punto de corte.
  \item {\tt corteejeelip2lonlat}: Coordenadas geogr\'{a}ficas del punto de corte.
  \item {\tt corteejeelip}: Coordenadas geogr\'{a}ficas del punto de corte para un instante determinado.
\end{itemize}
\paragraph{Funciones de duraci\'{o}n de la totalidad en el eje}
\begin{itemize}
  \item {\tt deltamenosL}: Da la distancia de un punto al borde del cono de sombra para un instante determinado.
  \item {\tt deltamenosLt}: Igual que la anterior pero los distintos valores para un intervalo de tiempo en torno al instante actual.
  \item {\tt duraciontoteje}: Da el tiempo (en minutos y segundos) de la totalidad para un punto del eje.
  \item {\tt puntoejedur}: Igual que el anterior pero devolviendo adem\'{a}s la hora y la posici\'{o}n.
\end{itemize}
\paragraph{Funciones de corte del cono de penumbra con la elipse fundamental}
\begin{itemize}
 \item {\tt cortehor}: Coordenadas en el sistema fundamental de los puntos de corte del cono de penumbra con la elipse fundamental dados los elementos besselianos.
  \item {\tt cortehor2xyz}: Idem pero en cartesianas en el sistema geogr\'{a}fico.
  \item {\tt cortehor2lonlat}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt cortehor2lonlatt}: Coordenadas geogr\'{a}ficas de los puntos de corte para un instante determinado.
\end{itemize}
\paragraph{Funciones de corte del cono de penumbra con el elipsoide}
\begin{itemize}
  \item {\tt corteconopelip2}$\xi \eta \zeta$: Coordenadas en el sistema fundamental de los puntos de corte del cono de penumbra con el elipsoide, dados los elementos besselianos.
  \item {\tt corteconopelip2xyz}: Idem pero en cartesianas en el sistema geogr\'{a}fico.
  \item {\tt corteconopelip2lonlat}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt corteconopelip}: Coordenadas geogr\'{a}ficas de puntos de corte de cono y elipsoide para un instante determinado.
\end{itemize}
\paragraph{Funciones de c\'{a}lculo de curvas l\'{\i}mite Norte y Sur por tangencia de cono y elipsoide}
\begin{itemize}
  \item {\tt elxelylpipd}$\mu 2\zeta Q$: Coordenadas en el sistema fundamental de los puntos de la curva l\'{\i}mite dados los elementos besselianos.
  \item {\tt elxelylpipd}$\mu${\tt 2xyz}: Idem pero en cartesianas en el sistema geogr\'{a}fico.
  \item {\tt elxelylpipd}$\mu2${\tt lonlat}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt puntoslimitep}: Coordenadas geogr\'{a}ficas de los puntos l\'{\i}mite del cono de penumbra para un instante determinado.
  \item {\tt puntoslimites}: Coordenadas geogr\'{a}ficas de los puntos l\'{\i}mite del cono de sombra para un instante determinado.
\end{itemize}
\paragraph{Funciones de c\'{a}lculo de curvas l\'{\i}mite Norte y Sur por estar el eclipse bajo el horizonte}
\begin{itemize}
  \item {\tt climite2}$\xi \eta \zeta$: Coordenadas en el sistema fundamental de los puntos de la curva l\'{\i}mite dados los elementos besselianos.
  \item {\tt climite2xyz}: Idem pero en cartesianas en el sistema geogr\'{a}fico.
  \item {\tt climite2lonlat}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt climite}: Coordenadas geogr\'{a}ficas de los puntos l\'{\i}mite para un instante determinado.
\end{itemize}
\paragraph{Funciones de c\'{a}lculo de curvas de m\'{a}ximo de eclipse al orto/ocaso}
\begin{itemize}
  \item {\tt maxhor2}$\xi \eta \zeta$: Coordenadas en el sistema fundamental de los puntos de m\'{a}ximo en el horizonte dados los elementos besselianos.
  \item {\tt maxhor2xyz}: Idem pero en cartesianas en el sistema geogr\'{a}fico.
  \item {\tt maxhor2lonlat}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt maxhor}: Coordenadas geogr\'{a}ficas de los puntos de m\'{a}ximo en el horizonte para un instante determinado.
\end{itemize}
\paragraph{Funciones para hallar los puntos de corte de las curvas de m\'{a}ximo en el horizonte con las l\'{\i}mite Norte y Sur de conos de penumbra y de sombra}
\begin{itemize}
  \item {\tt maxhorbis2}$\xi \eta \zeta$: Coordenadas en el sistema fundamental de los puntos de la elipse fundamental de m\'{a}xima cercan\'{\i}a al eje de sombra, est\'{e}n dentro o no del cono. Los par\'{a}metros son los elementos besselianos.
  \item {\tt dismaxcono}: Devuelve la distancia de los puntos anteriores al borde del cono siendo positiva si est\'{a}n fuera del cono y negativa si est\'{a}n dentro.
  \item {\tt dismaxconosign}: Devuelve la distancia (con signo) del punto de los calculados por {\tt maxhorbis2}$\xi \eta \zeta$ que est\'{a} m\'{a}s cerca del borde del cono.
  \item {\tt maxhorbisselec}$\xi \eta \zeta$: Devuelve las coordenadas fundamentales del punto, de los hallados por {\tt maxhorbis2}$\xi \eta \zeta$ que se encuentra m\'{a}s cerca del borde del cono.
  \item {\tt maxhorbis2xyz}: Idem pero en cartesianas en el sistema geogr\'{a}fico.
  \item {\tt maxhorbis2lonlat}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt maxhorbisp}: Coordenadas geogr\'{a}ficas del punto de la elipse fundamental cuya distancia al eje de sombra alcanza un m\'{\i}nimo y que se encuentra m\'{a}s cerca del borde del cono de penumbra, para cada instante.
   \item {\tt maxhorbiss}: Igual que el anterior pero para el cono de sombra.
\end{itemize}
\paragraph{Funciones para ordenado de puntos de curvas}
\begin{itemize}
  \item {\tt NormsinSalto}: Calcula distancia entre dos puntos dados en coordenadas geogr\'{a}ficas.
  \item {\tt ordenaLobulo}: Ordena los puntos de inicio/fin del eclipse en el horizonte, ya sean uno o dos l\'{o}bulos.
  \item {\tt ordenaCurvCen}: Ordena los puntos de la curva central.
  \item {\tt ordenaCurva1Lim}: Ordena puntos l\'{\i}mite Norte/Sur cuando s\'{o}lo hay una curva de totalidad o parcialidad.
  \item {\tt ordenaCurva2Lim}: Idem que la anterior pero cuando existen las dos curvas.
  \item {\tt ordenaCurvamaxhor}: Ordena los puntos de m\'{a}ximo de eclipse en el horizonte.
  \item {\tt ordenaCortehoras}: Ordena los puntos de los cortes horarios del cono de penumbra al elipsoide.
  \item {\tt incluyePunto}: Incluye puntos intermedios a una curva.
\end{itemize}

\paragraph{Funciones para dibujo de continentes y ret\'{\i}cula}
\begin{itemize}
  \item {\tt ejes}: Define la orientaci\'{o}n el mapa.
  \item {\tt coor}: Permite el paso de coordenadas geogr\'{a}ficas a las coordenadas planas del mapa.
  \item {\tt par}: Define los paralelos.
  \item {\tt mer}: Define los meridianos.
  \item {\tt reticula}: Define la ret\'{\i}cula de meridianos y paralelos.
  \item {\tt continentes}: Define el contorno de los continentes.
\end{itemize}


\newpage

\section{Glosario}\label{glosario}
\begin{description}
\item{\bf altura}: distancia esf\'erica del {\bf horizonte} al astro. Se mide
sobre el {\bf vertical} del astro y es positiva cuando el astro est\'a por encima
del horizonte y negativa en caso contrario. Su valor absoluto es menor
o igual que $90\Deg$. La altura es el complemento de la {\bf distancia cenital}.

%\item{\bf altura aparente}: es la {\bf altura observada} corregida por {\bf
%depresi\'on del horizonte} para referirla al horizonte verdadero.
%
%\item{\bf altura observada}: es la altura resultante de la observaci\'on, medida
%desde el {\bf horizonte de la mar} y una vez aplicadas las correcciones
%instrumentales.
%
%\item{\bf altura verdadera}: es la altura del centro del astro medida desde el
%centro de la Tierra y considerando que no existe atm\'osfera. Se obtiene a
%partir de la {\bf altura aparente} corrigiendo por {\bf semidi\'ametro}, {\bf
%refracci\'on} y {\bf paralaje}.

\item{\bf \'angulo horario}: distancia angular medida  hacia el W sobre el {\bf
ecuador celeste}, desde el {\bf meridiano superior del lugar} hasta el {\bf
c\'{\i}rculo horario} del astro.

\item{\bf \'angulo sid\'ereo}: distancia angular medida  hacia el W sobre el
{\bf ecuador celeste}, desde {\bf Aries} hasta el {\bf c\'{\i}rculo
horario} del astro.

%\item{\bf a\~no}: per\'{\i}odo de tiempo basado en la revoluci\'on de la Tierra
%alrededor del Sol. El {\bf calendario} es una aproximaci\'on del {\bf a\~no
%tr\'opico}.
%
%\item{\bf a\~no sid\'ereo}: intervalo de tiempo transcurrido entre dos pasos
%consecutivos del Sol por un punto fijo de la {\bf ecl\'{\i}ptica}.
%
%\item{\bf a\~no tr\'opico}: intervalo de tiempo transcurrido entre dos pasos
%consecutivos del Sol por {\bf Aries}. Debido al movimiento retr\'ogrado de Aries
%el a\~no tr\'opico es m\'as corto que {\bf a\~no sid\'ereo}.

\item{\bf aplanamiento}: ver {\bf factor de aplanamiento}.


\item{\bf Aries}: es el {\bf equinoccio} en el cual el Sol pasa del hemisferio
celeste sur al hemisferio celeste norte. Debido a la {\bf precesi\'on}, Aries
retrograda sobre la ecl\'{\i}ptica $50\Segp 29$ por a\~no.

%\item{\bf \'aureo n\'umero}: n\'umero que corresponde en el {\bf ciclo de
%Met\'on} al a\~no considerado. Al primer a\~no de nuestra era le corresponde el
%\'aureo n\'umero 2.

\item{\bf azimut}: distancia angular medida sobre el {\bf horizonte} desde un
punto de referencia (ge\-ne\-ral\-mente el norte o el sur) hasta el {\bf
vertical} del astro.

%\item{\bf calendario}: sistema de medida del tiempo en el cual los {\bf
%d\'{\i}as} se enumeran de acuerdo con su posici\'on en ciertas estructuras que se
%repiten peri\'odicamente.

\item{\bf cenit}: corte de la prolongaci\'on de la l\'{\i}nea de la
plomada con el hemisferio visible de la {\bf esfera celeste}.

%\item{\bf ciclo de Met\'on} per\'{\i}odo de 19 a\~nos, en el que las {\bf fases
%de la Luna} vuelven a sucederse en los mismos d\'{\i}as del a\~no, con
%diferencia de hora y media aproximadamente. Equivale a 235 {\bf lunaciones}.

\item{\bf c\'{\i}rculo horario}: c\'{\i}rculo m\'aximo de la {\bf esfera celeste} que
pasa por los {\bf polos celestes}.

%\item{\bf constelaci\'on}: grupo de estrellas que sirve para identificar una
%zona de la {\bf esfera celeste}. Las constelaciones suelen distinguirse con
%nombres mitol\'ogicos, de animales u objetos.
%
%\item{\bf crep\'usculo}: intervalo de tiempo que precede a la {\bf salida} de
%Sol (matutino) y sigue a la {\bf puesta} (vespertino). El crep\'usculo civil
%comprende el intervalo en el cual la {\bf distancia cenital} del centro del
%disco solar var\'{\i}a entre $90\Deg\,50\Min$ y $96\Deg$. El crep\'usculo
%n\'autico comprende el intervalo desde $96\Deg$ hasta $102\Deg$.

%\item{\bf d\'{\i}a}: intervalo de $86\,400$ {\bf segundos}.

\item{\bf declinaci\'on}: distancia esf\'erica del {\bf ecuador celeste} al
astro. Se mide sobre un {\bf c\'{\i}rculo horario} y es positiva cuando el astro
est\'a al norte del ecuador y negativa en caso contrario. Su valor absoluto
es menor o igual que $90\Deg$.

%\item{\bf depresi\'on del horizonte}: \'angulo formado por el {\bf horizonte
%verdadero} y el {\bf horizonte de la mar}.
%
%\item{\bf distancia cenital}: distancia esf\'erica del {\bf cenit} al astro. Se
%mide sobre el {\bf vertical} del astro y es el complemento de la {\bf altura}.

\item{\bf eclipse}: paso de un cuerpo frente a otro ocultando su luz.

\item{\bf eclipse anular}: un {\bf eclipse solar} en el cual el disco solar
nunca se oculta completamente y en el m\'aximo del eclipse se ve como un
anillo.

\item{\bf eclipse lunar}: aqu\'el que se produce cuando la Luna pasa a trav\'es
de la sombra que proyecta la Tierra. Puede ser total, parcial y penumbral.

\item{\bf eclipse solar}: aqu\'el que se produce cuando la Luna se
sit\'ua entre el Sol y la Tierra, tapando la luz del primero. Puede ser total,
parcial y {\bf anular}.

\item{\bf ecl\'{\i}ptica}: trayectoria aparente del Sol sobre la {\bf esfera
celeste}.

\item{\bf ecuador celeste}: c\'{\i}rculo m\'aximo de la {\bf esfera celeste}
perpendicular a la l\'{\i}nea que une los {\bf polos celestes}.

%\item{\bf edad}: n\'umero de d\'{\i}as y fracci\'on de d\'{\i}a transcurridos
%desde la \'ultima luna nueva (ver {\bf fases de la Luna}). Var\'{\i}a de 0 a 29.5
%que es la duraci\'on de una {\bf lunaci\'on}.

\item{\bf efem\'erides}: secuencia ordenada para un n\'umero de fechas de las
posiciones de los objetos celestes. Normalmente se presentan en tablas.

%\item{\bf epacta}: es la {\bf edad} de la Luna el d\'{\i}a 1 de Enero.

\item{\bf equinoccio}: cada uno de los puntos de corte de la {\bf
ecl\'{\i}ptica} con el {\bf ecuador celeste}.

\item{\bf esfera celeste}: esfera imaginaria de radio arbitrario y centro en
el observador, sobre la que se proyectan los astros para estudiar sus
posiciones relativas.

\item{\bf factor de aplanamiento}: par\'ametro de un planeta dado por
la relaci\'on $(a - b)/a$, donde $a$ es el radio ecuatorial y $b$ el radio
polar. Indica el grado de aproximaci\'on entre una esfera y la figura del
planeta.

\item{\bf fases de la Luna}: diversos aspectos de la Luna que se suceden
c\'{\i}clicamente.

\item{\bf geoc\'entrico}: con referencia al centro de la Tierra.

\item{\bf horizonte (verdadero)}: plano que contiene al observador y es ortogonal
a la l\'{\i}nea {\bf cenit}-{\bf nadir}. La intersecci\'on de dicho plano con la
{\bf esfera celeste} es un c\'{\i}rculo m\'aximo tambi\'en denominado horizonte.

%\item{\bf horizonte de la mar}: c\'{\i}rculo menor determinado por el corte de
%la {\bf esfera celeste} con las visuales desde el observador a la superficie de
%la Tierra. Divide la esfera celeste en los hemisferios visible e invisible y
%depende de la elevaci\'on del observador y de la {\bf refracci\'on}.

\item{\bf limbo}: borde aparente del Sol, la Luna o un planeta con disco
apreciable.

\item{\bf lunaci\'on}: per\'{\i}odo entre dos lunas nuevas consecutivas (ver
{\bf fases de la Luna}). Su duraci\'on es aproximadamente 29.5 d\'{\i}as.

%\item{\bf magnitud estelar}: medida del brillo de un objeto celeste considerado
%como un foco puntual. Se utiliza una escala logar\'{\i}tmica donde los
%menores valores corresponden a los astros m\'as brillantes. Com\'unmente se
%conocen como astros de {\em primera magnitud} aquellos cuya magnitud estelar
%es menor que 1.5, de {\em segunda magnitud} entre 1.6 y 2.5, de {\em tercera
%magnitud} entre 2.6 y 3.5, y as\'{\i} sucesivamente.

\item{\bf meridiano del lugar}: c\'{\i}rculo m\'aximo que pasa por los {\bf polos
celestes} y contiene al {\bf cenit} y {\bf nadir}. El meridiano del lugar
tambi\'en es un {\bf vertical}.

\item{\bf meridiano superior del lugar}: semic\'{\i}rculo en que la l\'{\i}nea
de los polos divide al {\bf meri\-dia\-no del lugar} y que contiene el {\bf
cenit}.

\item{\bf movimiento del polo}: movimiento variable irregular del polo de
rotaci\'on de la Tierra con respecto a la corteza terrestre.

%\item{\bf movimiento propio}: proyecci\'on sobre la {\bf esfera celeste} del
%movimiento espacial de una estrella con respecto al sistema solar.

\item{\bf nadir}: punto de la {\bf esfera celeste} diametralmente opuesto al
{\bf cenit}.

\item{\bf nutaci\'on}: oscilaciones de corto per\'{\i}odo en el movimiento del
polo debidas al par producido por fuerzas gravitacionales externas. Este efecto
se debe principalmente a la influencia de la Luna y el Sol.

\item{\bf oblicuidad de la ecl\'{\i}ptica}: \'angulo que forma el plano que
contiene a la {\bf ecl\'{\i}ptica} con el plano que contiene al {\bf ecuador
celeste}.

\item{\bf ocaso}: instante en el que un astro corta al {\bf horizonte} pasando
del hemisferio visible al invisible.

\item{\bf orto}: instante en el que un astro corta al {\bf horizonte} pasando
del hemisferio invisible al visible.

\item{\bf paralaje}: diferencia entre las posiciones {\bf topoc\'entrica} y {\bf
geoc\'entrica} de un objeto, es decir, el \'angulo subtendido desde el objeto
por el radio terrestre del observador.

\item{\bf paralaje horizontal}: es la {\bf paralaje} de un objeto que se
encuentra en el {\bf horizonte}.

%\item{\bf per\'{\i}odo juliano}: intervalo de tiempo en {\bf d\'{\i}as} y
%fracci\'on de d\'{\i}a transcurrido desde el mediod\'{\i}a en Greenwich del
%d\'{\i}a 1 de Enero del a\~no 4713 antes de Cristo.


\item{\bf polos celestes}: puntos de corte con la {\bf esfera celeste} de la
prolongaci\'on del eje de rotaci\'on de la Tierra.

\item{\bf precesi\'on}: movimiento uniforme de largo per\'{\i}odo a que
est\'a sometido el eje de rotaci\'on terrestre debido a la atracci\'on
gravitacional del Sol, la Luna y los planetas sobre la Tierra.


\item{\bf puesta}: instante en el cual se oculta tras el {\bf horizonte} un astro
con {\bf limbo} observable. En el caso del Sol, la puesta ocurre cuando el punto
central del disco tiene {\bf distancia cenital} de $90\Deg\;50'$. Esta cantidad
se obtiene suponiendo unos valores est\'andar para la {\bf refracci\'on} en el
horizonte de $34'$ y para el {\bf semidi\'ametro} de $16'$. En el caso de
la Luna la {\bf distancia cenital} correspondiente es de $90\Deg\;34'+s-\pi$,
donde $s$ es el {\bf semidi\'ametro} de la Luna y $\pi$ es la {\bf paralaje
horizontal}.


\item{\bf refracci\'on}: \'angulo que forman las direcciones verdadera y
observada de un objeto celeste debido al cambio de direcci\'on en la trayectoria
que sigue un rayo de luz al pasar oblicuamente a trav\'es de la atm\'osfera.


\item{\bf salida}: instante en el cual comienza a aparecer sobre el
{\bf horizonte} un astro con limbo observable. En el caso del Sol, la salida
ocurre cuando el punto central del disco tiene {\bf distancia cenital} de
$90\Deg\;50'$. Esta cantidad se obtiene de suponer unos valores est\'andar para
la {\bf refracci\'on} en el horizonte de $34'$ y para el {\bf
semidi\'ametro} de
$16'$. En el caso de la Luna la {\bf distancia cenital} correspondiente es de
$90\Deg\;34'+s-\pi$, donde $s$ es el {\bf semidi\'ametro} de la Luna y $\pi$ es
la {\bf paralaje horizontal}.

\item{\bf segundo del Sistema Internacional}: duraci\'on de $9\,192\,631\,770$
per\'{\i}odos de la radiaci\'on correspondiente a la transici\'on entre los dos
niveles hiperfinos del estado fundamental del \'atomo de Cesio 133.

\item{\bf segundo intercalar}: un segundo que en ocasiones es necesario
a\~nadir al {\bf Tiempo Universal Coordinado} para que la diferencia con el
{\bf Tiempo Universal} se mantenga inferior a 0.9 segundos. Convencionalmente,
de ser necesaria esta correcci\'on se efectuar\'a a finales de Junio o Diciembre.

\item{\bf semidi\'ametro}: \'angulo desde el observador subtendido por el radio
ecuatorial de un astro con disco observable.


\item{\bf solsticio}: cada uno de los puntos de la {\bf ecl\'{\i}ptica}
apartados $90\Deg$ de los {\bf equinoccios}.

\item{\bf Tiempo At\'omico Internacional (TAI)}: escala internacional de
referencia proporcionada por la Oficina Internacional de Pesas y Medidas a
partir de los relojes at\'omicos que mantienen los laboratorios de tiempo de
varios pa\'{\i}ses. La unidad fundamental del TAI es el {\bf segundo del Sistema
Internacional}.

%\item{\bf tiempo de luz}: tiempo necesario para que la luz viaje desde un
%objeto celeste hasta la Tierra.

\item{\bf tiempo sid\'ereo}: {\bf \'angulo horario} de {\bf Aries}. Es una
medida de la rotaci\'on de la Tierra con respecto a las estrellas.

%\item{\bf tiempo medio}:

\item{\bf Tiempo Universal (UT)}: medida del tiempo que se ajusta al movimiento
diurno medio del Sol y cuyo valor se deduce del {\bf tiempo sid\'ereo} mediante
una f\'ormula matem\'atica. Es el argumento habitual de las efem\'erides y se deduce de
la observaci\'on de las estrellas. La escala obtenida directamente de tales
observaciones corregida de las peque\~nas desigualdades que introduce el
desplazamiento del polo terrestre y que dependen de las coordenadas del
observador se designa UT1. Debido a la irregularidad de la velocidad de
rotaci\'on de la Tierra no es una escala uniforme, por lo que para datar
acontecimientos cient\'{\i}ficos se utiliza el {\bf Tiempo At\'omico
Internacional}.


\item{\bf Tiempo Universal Coordinado (UTC)}: escala de tiempo que se emite por
radiodifusi\'on a trav\'es de las se\~nales horarias. Se basa en el {\bf Tiempo
At\'omico Internacional}. La vida diaria est\'a regulada por el movimiento del
Sol, al cual se ajusta el {\bf Tiempo Universal (UT)}. Mediante la
introducci\'on, cuando corresponda, de un {\bf segundo intercalar} en el UTC,
la diferencia con la escala UT se mantiene inferior a 0.9 segundos.

\item{\bf topoc\'entrico}: con referencia a un punto de la superficie de la
Tierra.

\item{\bf unidad astron\'omica de distancia}: constante definida por
la Uni\'on Astron\'omica Internacional y que corresponde a
$1.495\,978\,10\times10^{11}$ metros. Aproximadamente coincide con un
valor promediado de la distancia de la Tierra al Sol.

\item{\bf vertical}: c\'{\i}rculo m\'aximo de la {\bf esfera celeste} que
pasa por el {\bf cenit} y el {\bf nadir}.
\end{description}





\begin{thebibliography}{99}
\bibitem{de405} Standish, E. M., ``JPL Planetary and Lunar Ephmerides, DE405/LE404'', \textit{JPL Interoffice Memorandum, IOM 312.f-98-048}, 1998.
\bibitem{} Smart, W. M., \textit{Textbook on Spherical Astronomy} (1977).
\bibitem{} Gil Chica, F. J., \textit{Teor\'{\i}a de eclipses, ocultaciones y tr\'{a}nsitos} (1996).
\bibitem{} Seidelman, P. K., Edit, \textit{Explanatory Supplement to the Astronomical Almanach} (1992).
\bibitem{} Orus, J. J., Catal\'{a}, M. A., N\'{u}\~{n}ez de Murga, J., \textit{Astronom\'{\i}a esf\'{e}rica y Mec\'{a}nica Celeste} (2007).
%\bibitem{} F. ESPENAK, (1997): Total Solar Eclipse of 1999 August 11. ed.
%NASA (RP1398).
\bibitem{} Salazar de la Cruz, A., Lopez Moratalla, T. \textit{Eclipses de Sol 2000-2010 (Bolet\'{\i}n ROA 7/99)}.
\bibitem{} Lopez Moratalla, T., Lara Coira, M., Salazar de la Cruz, A., \textit{El eclipse total de Sol del 11 de agosto de 1999 (Bolet\'{\i}n ROA 10/98)}.
\bibitem{} Casado, J. C., Serra-Ricart, M., \textit{Unidad Did\'{a}ctica de Eclipses} (2003).
http://www.fecyt.es/semanadelaciencia2003/eclipse/pdf/UDE.pdf

\end{thebibliography}

\end{document}
