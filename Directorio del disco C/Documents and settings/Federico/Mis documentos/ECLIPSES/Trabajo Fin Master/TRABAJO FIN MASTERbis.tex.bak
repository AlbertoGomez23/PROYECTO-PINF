\documentclass[10pt, a4paper]{article}
\parskip1.3ex
\usepackage{geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{a4paper, left = 3.5cm, right=3cm, top = 3cm, bottom=2.5cm}
\usepackage[spanish]{babel}            %paquete para acentos forma estandar en espa\~{n}ol.
\usepackage[ansinew]{inputenc}         %paquete solo para Windows para reconocer acentos.
\usepackage{graphicx,color}            %paquete para manejar figuras y color de las mismas (incluye letras).
\usepackage{lscape}
%\usepackage{subfigure}
\usepackage{amsmath,amsfonts,amssymb}  %paquete de simbolos matem\'{a}ticos American Mathematical Socety
\usepackage{latexsym}                  % Paquete que ofrece adicional simbolos matem\'{a}ticos

%\usepackage[latin1]{inputenc}          %paquete solo para Unix para reconocer acentos.

%**********************************************************************************************************
% Trabajo de Programaci\'{o}n No Lineal. Master Modelizaci\'{o}n Matem\'{a}tica, Estad\'{\i}stica
% y Computaci\'{o}n. Periodo 2009-2010.
%**********************************************************************************************************

%\title{\textbf{TRABAJO F\'{I}N DE M\'{A}STER: OBTENCI\'{O}N Y DIBUJO DE CURVAS REPRESENTATIVAS DE UN ECLIPSE SOLAR}}
%\author{Federico Baeza Richer}
%\date{XX de junio de 2010}
\title{\textbf{C\'{a}lculo y representaci\'{o}n de eclipses de Sol}}
\author{Federico Baeza Richer}
\date{M\'{a}ster Modelizaci\'{o}n Matem\'{a}tica, Estad\'{\i}stica
 y Computaci\'{o}n. (2009--2010)}
%\emph{baezafede@gmail.com} colocar correo electr\'{o}nico.

\begin{document}
\begin{titlepage}
\maketitle
\end{titlepage}
%
%\begin{abstract}
%Se presenta el trabajo fin de m\'{a}ster de t\'{\i}tulo Obtenci\'{o}n y dibujo de las curvas representativas de un eclipse solar, correspondiente al M\'{a}ster en Modelizaci\'{o}n Matem\'{a}tica, Estad\'{\i}stica y Computaci\'{o}n (curso 2009-2010). El trabajo, como su nombre indica, consiste en la obtenci\'{o}n de todos los par\'{a}metros y elementos caracter\'{\i}sticos de un eclipse solar, y del posterior dibujo sobre la esfera terrestre, de todas las curvas representativas.  El trabajo fue codirigido por Teodoro L\'{o}pez Moratalla (Jefe de la Secci\'{o}n de Efem\'{e}rides del Real Instituto y Observatorio de la Armada) y por Alberto Abad (Profesor de Astrodin\'{a}mica de la Universidad de Zaragoza).
%\end{abstract}
%
\tableofcontents
\clearpage
\listoffigures

\cleardoublepage
\section{Introducci\'{o}n}
Se presenta el trabajo fin de m\'{a}ster de t\'{\i}tulo C\'{a}lculo y representaci\'{o}n de eclipses de Sol, correspondiente al M\'{a}ster en Modelizaci\'{o}n Matem\'{a}tica, Estad\'{\i}stica y Computaci\'{o}n (curso 2009-2010). El trabajo, como su nombre indica, consiste en el c\'{a}lculo de todos los par\'{a}metros y elementos caracter\'{\i}sticos de un eclipse solar, y del posterior dibujo sobre la esfera terrestre, de todas las curvas representativas.
\par
El punto de partida de este trabajo es el conocimiento de la existencia de un eclipse en una fecha determinada. Queda para un an\'{a}lisis posterior la determinaci\'{o}n de los d\'{\i}as de cada a\~{n}o en que esto ocurrir\'{a}. 
\par
Desde tiempo remotos el hombre se ha sentido atra\'{\i}do por los fen\'{o}menos astron\'{o}micos, siendo el del eclipse de Sol el que probablemente m\'{a}s impresi\'{o}n, asombro, supersticiones etc ha generado a lo largo de la historia. La observaci\'{o}n de este fen\'{o}meno va m\'{a}s all\'{a} de la simple contemplaci\'{o}n, ya que gracias las observaciones realizadas durante el desarrollo del mismo, han servido para a veces descubrir, otras corroborar, conocimientos claves en la comprensi\'{o}n del sistema solar. Es por ello que a lo largo de la historia y conforme los conocimientos de las civilizaciones avanzaban, se ha intentado conocer, cada vez con m\'{a}s precisi\'{o}n, el cu\'{a}ndo, en qu\'{e} circunstancias y desde d\'{o}nde, se podr\'{a}n observar estos acontecimientos.
\par
Desde finales del siglo $XIX$, ya se ten\'{\i}an conocimientos y herramientas suficientes para predecir, con bastante precisi\'{o}n la ocurrencia de eclipses. Sin embargo los m\'{e}todos tradicionales no son en absoluto sencillos. Los anal\'{\i}ticos no eran f\'{a}ciles de comprender, ya que se basaban en una serie de transformaciones de variables, que adem\'{a}s de introducir simplificaciones que hac\'{\i}an perder precisi\'{o}n, hac\'{\i}an perder toda la noci\'{o}n geom\'{e}trica de qu\'{e} se estaba calculando. En cuanto a los m\'{e}todos num\'{e}ricos, la aparici\'{o}n de las computadoras automatiz\'{o} completamente el c\'{a}lculo, desarroll\'{a}ndose inmediatamente programas (sobre todo en Fortran) que realizaban esta tarea. Sin embargo los algoritmos utilizados est\'{a}n basados en una serie de iteraciones (inicialmente consideran la Tierra esf\'{e}rica para luego llegar al elipsoide etc), para ir finalmente convergiendo a los resultados deseados, estos s\'{\i} con la precisi\'{o}n deseada. La aparici\'{o}n de procesadores simb\'{o}licos de gran capacidad (como el \verb"Mathematica" aqu\'{\i} utilizado), invita a plantear y resolver las ecuaciones que determinan los par\'{a}metros caracter\'{\i}sticos de los eclipses de una forma mucho m\'{a}s sencilla y clara que hasta ahora. Si bien la precisi\'{o}n obtenida no mejora las que ya se tienen, y las propias funciones resolutoras lleven un mecanismo intr\'{\i}nseco parecido en cuanto a iteraciones etc, a los programas ya existentes, el hecho de poder plantear la resoluci\'{o}n de los distintos problemas mediante sencillas y elegantes f\'{o}rmulas, suponen un avance importante.
\par

El Real Instituto y Observatorio de la Armada (ROA) es el encargado en Espa\~{n}a de la publicaci\'{o}n de las efem\'{e}rides astron\'{o}micas, haci\'{e}ndolo desde el S$XVIII$ hasta nuestros d\'{\i}as, con las tecnolog\'{\i}as de que se ha dispuesto en cada momento. Si bien l\'{o}gicamente los c\'{a}lculos obtenidos con estos programas no van a aportar datos ni precisi\'{o}n nueva a la que ya se dispone, s\'{\i} que tiene su importancia. En primer lugar sirve para cotejar los resultados obtenidos mediante los medios tradicionales, hecho que se realiza con los datos de otros observatorios, en segundo sirve para automatizar m\'{a}s la representaci\'{o}n de los datos en las curvas mediante su dibujo, y por \'{u}ltimo auxilia a sus labores de docencia, facilitando la explicaci\'{o}n sencilla y elegante de este fen\'{o}meno.
\par 

En el ap\'{e}ndice \ref{glosario} se ha incluido un glosario de los t\'{e}rminos astron\'{o}micos utilizados en este trabajo, al que acudir en caso necesario.

Este trabajo ha sido codirigido por los doctores Teodoro L\'{o}pez Moratalla (Jefe de la Secci\'{o}n de Efem\'{e}rides del ROA) y Alberto Abad Medina (Profesor de Astrodin\'{a}mica de la Universidad de Zaragoza).


\section{Generalidades sobre eclipses}
El t\'{e}rmino eclipse se aplica indistintamente a dos fen\'{o}menos
provocados por las posiciones relativas de tres astros: el Sol
(emisor luminoso), la Tierra y la Luna (cuerpos opacos que
interceptan la luz solar).

\par
Un eclipse de Sol se produce cuando este astro es ocultado, total o parcialmente,
por el disco de la Luna, que se interpone entre la Tierra y el
Sol. Un eclipse de Sol tiene lugar siempre en Luna Nueva,
siendo \'{e}sta una condici\'{o}n necesaria pero no suficiente para
que se produzca el fen\'{o}meno.

\par
La condici\'{o}n de Luna Nueva ser\'{\i}a suficiente si las \'{o}rbitas del Sol y de la Luna fueran coplanarias. Pero esto no ocurre al ser su inclinaci\'{o}n relativa pr\'{o}xima a los $5^\circ$, por lo tanto la Luna se encuentra en la mayor\'{\i}a de las ocasiones por debajo o por encima de la ecl\'{\i}ptica (plano del movimiento Tierra-Sol).

\par
Para que se produzca un eclipse de Sol, la Luna debe hallarse en
el plano de la ecl\'{\i}ptica, o muy cerca de \'el, y en fase de Luna
Nueva. Es decir, la Luna debe encontrarse en las proximidades de un
nodo.

\par
Los eclipses de Luna est\'{a}n determinados por
el paso de nuestro sat\'{e}lite por la sombra de la Tierra y siempre
suceden en fase de Luna Llena y al igual que en los eclipses
solares cuando la Luna se encuentra en el nodo o en sus
proximidades.

Mientras que los eclipses de Luna son visibles para todos los puntos de la superficie terrestre que tengan en ese momento a la Luna por encima del horizonte, los de Sol s\'{o}lo ser\'{a}n visibles para algunos puntos de la Tierra.


\section{Tipos de Eclipses de Sol}
Se llama \textit{cono de sombra} al cono formado por las tangentes exteriores del Sol y la Luna y \textit{cono de penumbra} al formado por las tangentes interiores. El eje com\'{u}n a ambos conos, materializado por la l\'{\i}nea que une los centros del Sol y de la Luna, se denomina \textit{eje de la sombra} (ver figura \ref{f:tipos}).
\begin{figure}[t]
\centering
\includegraphics[width=14cm]{./Figuras/Tipos.pdf}
\caption[Tipos de eclipses de Sol]{Tipos de eclipses de Sol: parcial (arriba), total (centro) y anular (abajo). Las dimensiones se han deformado para mayor claridad.}\label{f:tipos}
\end{figure}

\par
Un eclipse de Sol se produce cuando el cono de penumbra alcanza alg\'{u}n punto de la superficie terrestre. Seg\'{u}n la posici\'on de la Tierra respecto a los conos de sombra y de penumbra, podemos dividir los eclipses de Sol en  parciales, totales y anulares.

\par
Eclipses Parciales son aquellos en los que el cono de sombra no corta en ning\'un momento la superficie terrestre. En estos eclipses el disco del Sol s\'olo se oculta parcialmente.

\par
Si el cono de sombra alcanza alg\'un punto de la superficie terrestre, se producir\'a un eclipse total o anular. La diferencia entre ambos tipos de eclipse se debe a que el di\'ametro aparente de la Luna puede ser mayor o menor que el del Sol, en funci\'on de las distancias a la Tierra de estos astros.

\par
Cuando el di\'ametro de la Luna es mayor que el del Sol, el disco de \'este quedar\'a totalmente oculto para aquellos puntos de la Tierra inmersos en el cono de sombra, que observar\'an un eclipse total. Cuando el di\'ametro es menor,  desde los puntos de la superficie terrestre dentro del cono de sombra, ser\'a visible un anillo del disco solar; de ah\'{\i} el nombre de eclipse anular. En ocasiones ocurre que un mismo eclipse se observa como total en algunos puntos de la Tierra y como anular en otros; entonces el eclipse se denomina total-anular o mixto.
El mecanismo de los tres tipos de eclipses se ha esquematizado en la figura \ref{f:tipos}.
\begin{figure}[t]
\centering
\includegraphics[width=\textwidth]{./Figuras/Sombras.pdf}
\caption[Conos de sombra y penumbra respecto a la Tierra, seg\'un el tipo de eclipse]{Posiciones de los conos de sombra y de penumbra respecto a la Tierra, en el momento de m\'aximo acercamiento del eje de la sombra al centro de la Tierra, en un eclipse: parcial (arriba, izquierda), no central (arriba, derecha), central con una curva de totalidad (abajo, izquierda), central con una curva de parcialidad (abajo, centro) y central con dos curvas de parcialidad (abajo, derecha).}\label {f:sombras}
\end{figure}
Los eclipses totales y anulares pueden ser centrales y no centrales, dependiendo de si el eje de sombra corta o no la superficie terrestre en alg\'un momento. Adem\'as, en los eclipses centrales puede ocurrir que en alg\'un instante del eclipse, los dos conos queden totalmente inmersos en la superficie de la Tierra, que s\'olo lo haga el cono de sombra o que no lo haga ninguno de ellos.

\par
En resumen, en este trabajo distinguiremos los siguientes tipos de eclipses:
\begin{itemize}
\item Parcial
\item Total, anular, total-anular:
\begin{itemize}
\item No central
\item Central:
\begin{itemize}
\item Central con una sola curva de totalidad
\item Central con una sola curva de parcialidad
\item Central con las dos curvas de parcialidad
\end{itemize}
\end{itemize}
\end{itemize}
La subdivisi\'{o}n  de los eclipses centrales que hemos realizado no es habitual. Sin ser un extremo de especial relevancia, en el \'{a}mbito de este trabajo es importante para la sistematizaci\'{o}n de los c\'{a}lculos que se desarrollan en los siguientes apartados. Adem\'{a}s, est\'{a} justificada por las trazas que los conos de sombra y de penumbra dejar\'{a}n sobre la superficie terrestre en cada caso. Los distintos tipos de eclipse se ilustran en la figura \ref{f:sombras}.

\section{Par\'{a}metros y curvas caracter\'{\i}sticas de los eclipses solares}
Como ya se ha comentado, los eclipses de Sol son visibles \'{u}nicamente desde determinadas zonas de la superficie terrestre, variando su desarrollo de una localizaci\'{o}n a a otra. Por tanto, es necesario dar la informaci\'{o}n suficiente para que los usuarios puedan conocer, no s\'{o}lo la fecha y el tipo de eclipse, sino en qu\'{e} lugares y en qu\'{e} condiciones se desarrollar\'{a} \'{e}ste. Tradicionalmente, esta informaci\'{o}n consta de lo siguiente:
\begin{itemize}
\item Datos del Sol y la Luna en el instante de la conjunci\'{o}n en ascensi\'{o}n recta.
\item Circunstancias generales del eclipse
\item Elementos besselianos
\item Mapa de visibilidad
\end{itemize}

\subsection{Conjunci\'{o}n en Ascensi\'{o}n Recta}
Los eclipse de Sol ocurren aproximadamente cuando el Sol y la Luna tienen la misma ascensi\'{o}n recta. Esta hora se toma como referencia para facilitar al usuario los datos que necesita para calcular c\'{o}mo se desarrollar\'{a} el eclipse en una localizaci\'{o}n concreta, es decir, las circunstancias locales del eclipse. Aunque actualmente el c\'{a}lculo de las circunstancias locales se realiza mediante los elementos besselianos, las publicaciones especializadas siguen incluyendo los siguientes datos a la hora de la conjunci\'{o}n en ascensi\'{o}n recta:
\begin{itemize}
  \item Hora de la conjunci\'{o}n.
  \item Declinaci\'{o}n de Sol y Luna.
  \item Movimiento horario en declinaci\'{o}n y en ascensi\'{o}n recta del Sol y de la Luna.
  \item Paralaje horizontal ecuatorial de Sol y Luna.
  \item Semidi\'{a}metro verdadero de Sol y Luna.
\end{itemize}

\subsection{Circunstancias generales del eclipse}
Est\'{a}n constitu\'{\i}das por los datos siguientes, aunque no todos suelen facilitarse a los usuarios.
\begin{itemize}
  \item \textit{Principio y fin del eclipse}.
  El eclipse comienza cuando el cono de penumbra tangentea la Tierra. Adem\'{a}s de la hora en que esto ocurre, tambi\'{e}n se facilitan las coordenadas geogr\'{a}ficas del punto de tangencia: este punto ser\'{a} el primero de la Tierra desde el que los limbos del Sol y la Luna son tangentes exteriores. An\'{a}logamente para el fin del eclipse.

  \item \textit{Principio y fin del eclipse total/anular}. An\'{a}logo al anterior, pero con el cono de sombra en lugar del de penumbra. Los puntos correspondientes de la Tierra son el primero y el \'{u}ltimo que ven los limbos del Sol y la Luna tangentes interiores.

  \item \textit{Principio y fin de la curva central del eclipse}. Son los dos puntos de tangencia del eje de la sombra con el elipsoide terrestre. 
  \item \textit{Contactos interiores del cono de sombra}. Son los puntos de tangencia interior del cono de sombra con el elipsoide. Son el primer y \'{u}ltimo momento en que el corte del cono de sombra con el elipsoide dibuja una curva cerrada.
  \item \textit{Contactos interiores del cono de penumbra}. An\'{a}logo al anterior, pero con el cono de penumbra en lugar del de sombra.
  \item \textit{M\'{a}ximo del eclipse}. Es el instante de m\'{a}xima proximidad del eje de la sombra al centro de la Tierra. Para un eclipse central el punto de m\'{a}ximo es el de corte del eje con la Tierra en ese instante. Para un eclipse no central es el punto de la Tierra m\'{a}s cercano al eje en ese instante.
  \item \textit{Eclipse central al mediod\'{\i}a}. Punto de la curva central que tiene el m\'{a}ximo del eclipse local al Norte o al Sur y por ello a mayor altura sobre el horizonte.
  \item \textit{Coincidencia de las curvas de m\'{a}ximo en el horizonte con las curvas l\'{\i}mite Norte/Sur sombra/penumbra}. Son los puntos pertenecientes a la vez a las curvas mencionadas, cuyas caracter\'{\i}sticas se describen en el apartado siguiente.
\end{itemize}




\subsection{Mapa del eclipse}
\begin{figure}[p]
\centering
\includegraphics[height=\textwidth,angle=90]{./Figuras/EjemploMapaAnular.pdf}
\caption{Ejemplo de mapa de eclipse anular}
\end{figure}
\begin{figure}[p]
\centering
\includegraphics[width=\textwidth]{./Figuras/EjemploMapaParcial.pdf}
\caption{Ejemplo de mapa de eclipse parcial}
\end{figure}

\paragraph{Curva de eclipse central}
Es el lugar geom\'{e}trico de los puntos de corte del eje de la sombra con la Tierra.

\paragraph{Curvas de contacto en el horizonte}
Son las cuatro curvas siguientes, formadas por los puntos a los que les ocurre lo que se explica a continuaci\'{o}n:
\begin{itemize}
  \item Fin del eclipse al orto: En el momento en que aparece el Sol por el horizonte finaliza el eclipse. Es el l\'{\i}mite occidental del eclipse.
  \item Inicio del eclipse al orto: En el momento en que aparece el Sol por el horizonte comienza el eclipse. Es el l\'{\i}mite occidental de los puntos que pueden ver todo el eclipse por encima del horizonte.
  \item Fin del eclipse al ocaso: Coincide el ocaso con el fin del eclipse. Es el l\'{\i}mite oriental de los puntos que pueden ver todo el eclipse por encima del horizonte.
  \item Inicio del eclipse ocaso: En el momento del ocaso ocurre el inicio del eclipse. Es el l\'{\i}mite oriental de visualizaci\'{o}n del eclipse.
\end{itemize}

\paragraph{Curvas de m\'{a}ximo de eclipse en el horizonte}
Conjunto de puntos sobre la superficie para los que el instante de m\'{a}ximo del eclipse local (m\'{a}xima ocultaci\'{o}n del disco solar por parte de la Luna), se produce cuando el Sol est\'{a} en el horizonte. L\'{o}gicamente hay dos curvas:
\begin{itemize}
  \item Curva de m\'{a}ximo al orto: Al orto es el m\'{a}ximo del eclipse y conforme sale el Sol va disminuyendo el eclipse. Esta curva se encuentra comprendida entre las de inicio y fin del eclipse al orto.
  \item Curva de m\'{a}ximo al ocaso: Comienza el eclipse sobre el horizonte y va aumentando conforme va bajando el Sol. El momento del m\'{a}ximo se produce al ocaso. De forma an\'{a}loga a la anterior, esta curva se encuentra comprendida entre las de inicio y fin del eclipse al ocaso.
\end{itemize}

\paragraph{Curvas l\'{\i}mite Norte y Sur sombra/penumbra}
Puntos de la Tierra m\'{a}s al norte y m\'{a}s al sur desde donde se puede ver el eclipse ya sea como parcial o como total/anular.

\paragraph{Curvas instant\'{a}neas del eclipse}
Cortes del cono de penumbra con la Tierra para un instante determinado. Incluye l\'{o}gicamente los puntos para los que empieza el eclipse en ese momento, para los que termina, as\'{\i} como los l\'{\i}mites Norte y Sur para los que el eclipse consiste en un solo instante de tangencia de discos solar y lunar.

\subsection{Sistema fundamental de coordenadas y elementos besselianos}

Definimos el \textit{Sistema Fundamental de Coordenadas} (figura \ref{SF}) como un sistema de referencia geoc\'{e}ntrico, tal que: el eje $z$ es paralelo al eje de sombra, positivo en el sentido Tierra-Luna; el eje $x$ es la intersecci\'{o}n del ecuador con el plano perpendicular a $z$, positivo hacia el Este; y el eje $y$ forma un triedro directo con los otros dos. El plano $xy$ se denomina \textit{plano fundamental}. Se llama \textit{plano del observador} al plano paralelo al fundamental que pasa por la situaci\'{o}n del observador. Las coordenadas de los puntos en este sistema de referencia se denotar\'{a}n por $\xi$, $\eta$ y $\zeta$.
\begin{figure}
\centering
\includegraphics[width=13cm]{./Figuras/Sistemas.pdf}
\caption{Sistema fundamental de coordenadas}\label{SF}
\end{figure}

Los elementos besselianos son un conjunto de funciones dependientes del tiempo que describen la geometr\'{\i}a del eclipse. Estas funciones son:
\begin{itemize}
  \item \emph{x, y}: Coordenadas, en el sistema fundamental, de la intersecci\'{o}n del eje de la sombra con el plano fundamental. Se dan en unidades de radio ecuatorial terrestre.

  \item \emph{d, $\mu$}: Declinaci\'{o}n y \'{a}ngulo horario en Greenwich, del eje de la sombra (y por lo tanto del eje $z$). Se dan en grados sexagesimales, aunque tambi\'en es habitual proporcionar el $\sen d$ y el $\cos d$, en lugar de $d$.

  \item \emph{$l_{p}, l_{s}$}: Radios, en unidades del radio ecuatorial terrestre, de las respectivas intersecciones de los conos de sombra y penumbra con el plano fundamental. Por convenio, estos radios tienen el mismo signo que la coordenada $z$ del v\'{e}rtice del cono correspondiente. As\'{\i}, $l_{p}$ es siempre positivo, mientras que $l_{s}$ puede ser positivo (eclipse anular), negativo (eclipse total) o nulo (eclipse mixto, normalmente).

  \item \emph{$i_{p}, i_{s}$}: Tangentes de la semiapertura del cono de penumbra y de sombra respectivamente.
\end{itemize}

Los elementos $i_{p}$ e $i_{s}$ determinan la amplitud de los conos de penumbra y sombra. Los elementos $x$, $y$, $l_{p}$ y $l_{s}$ su situaci\'{o}n con respecto al plano fundamental. Por \'{u}ltimo $\mu$ y $d$ relacionan el plano fundamental con la Tierra en rotaci\'{o}n.

De esta forma, y gracias a los elementos besselianos, es sencillo relacionar las coordenadas geogr\'{a}ficas de los puntos de la Tierra, con las del sistema fundamental. Esto es muy \'{u}til ya que es mucho m\'{a}s sencillo estudiar la geometr\'{\i}a del eclipse en el sistema fundamental y luego transformar las coordenadas, que no hacerlo directamente.

\subsubsection{Coordenadas del observador en el sistema fundamental}
Consideremos un observador cuya posici\'on viene definida por su longitud geogr\'afica $l$, su latitud geod\'esica $\varphi$ y su altura $H$ sobre el elipsoide. La situaci\'on geod\'esica est\'a relacionada con la geoc\'entrica mediante:
\[
\begin{array}{r@{{}={}}l}
\rho  \cos\phi' & (C + H) \cos\phi, \\[1ex]
\rho  \sen\phi' & (S + H) \sen\phi,
\end{array}
\]
en las que $\phi'$ y $\rho$ son respectivamente la latitud  y la distancia geoc\'entricas, las
cantidades $C$ y $S$ son

%\[
%C = \Frac{1}{\sqrt{\cos^2\phi + (1 - f)^2 \sen^2\phi}}, \qquad S = C (1 - f)^2,
%\]


donde $f$ es el factor de
achatamiento terrestre, cuyo valor en el Sistema de Constantes Astron\'omicas UAI (1976) es
$1/298.257$; $C$ y $S$ tambi\'en pueden obtenerse de la Tabla de la p\'agina 375 de las {\it
Efem\'erides Astron\'omicas}. La altura $H$ debe expresarse en unidades del radio ecuatorial
terrestre.

Las coordenadas en el sistema ecuatorial referido a Greenwhich $(x,y,z)$, de un punto de coordenadas geogr\'{a}ficas $(l,\phi)$, sabiendo que la latitud geogr\'{a}fica $\phi$ implica una latitud geoc\'{e}ntrica $\varphi$ y una distancia al centro del elipsoide $\rho$. Son las siguientes:
\[
\begin{array}{r@{{}={}}l}
x & \rho\cos\varphi\cos l\\
y & \rho\cos\varphi\sin l\\
z & \rho\sin\varphi
\end{array}
\]

Las coordenadas del observador en el sistema fundamental $(\xi,\eta,\zeta)$, son:
\[
\begin{array}{r@{{}={}}l}
\xi & \rho\cos\varphi\sin(\mu+l)\\
\eta & \rho\left[\sin\varphi\cos d-\cos\varphi\sin d \cos(\mu+l)\right]\\
\zeta & \rho\left[\sin\varphi\sin d+\cos\varphi\cos d \cos(\mu+l)\right]
\end{array}
\]
El horario local $h$ del eje de la sombra es
\begin{equation}\label{horario}
h = \mu + \lambda.
\end{equation}

Una vez calculados $\rho  \cos\phi'$, $\rho  \sen\phi'$ y $h$, las coordenadas del observador en el
sistema fundamental son
\begin{equation}\label{xietazeta}
\begin{array}{r@{{}={}}l}
\xi   & \rho \cos\phi' \sen h, \\
\eta  & \rho \sen\phi' \cos d - \rho \cos\phi'\sen d \cos h, \\
\zeta & \rho \sen\phi' \sen d + \rho \cos\phi'\cos d \cos h.
\end{array}
\end{equation}


Tambi\'{e}n son \'{u}tiles las derivadas de estas expresiones. Utilizando de nuevo los elementos besselianos y sus derivadas, quedan as\'{\i}:
\[
\begin{array}{r@{{}={}}l}
\xi' & \mu'(\zeta\cos d-\eta\sin d)\\
\eta' & -\zeta d'+\mu'\xi\sin d\\
\zeta' & \eta d'-\eta'\xi\cos d
\end{array}
\]


\section{M\'{e}todos cl\'{a}sicos frente a m\'{e}todo utilizado}

\newpage

\section{Datos utilizados para los eclipses y su lectura}
Datos del JPL


\newpage
\section{Simplificaciones utilizadas}
\begin{itemize}
  \item Forma de La Tierra elipsoide de revoluci\'{o}n con par\'{a}metros definidos por IAU (1976).
  \item Formas Sol y Luna esferas con radio definido por IAU (1976).
  \item Se considera que el eclipse est\'{a} en el horizonte, es decir que se est\'{a} produciendo al orto o al ocaso, cuando el punto de observaci\'{o}n tiene nula su componente $\zeta$ en coordenadas fundamentales. El error m\'{a}ximo geom\'{e}trico de considerarlo as\'{\i} es, en el pero de los casos aproximadamente $16'$ de arco (semiapertura del cono de penumbra). Tampoco se considera la refracci\'{o}n atmosf\'{e}rica, que en el horizonte puede alcanzar los $32'$ de arco y que es muy dif\'{\i}cil de modelizar. Si se quisiese ser m\'{a}s preciso habr\'{\i}a que estudiar las condiciones locales del eclipse.
  \item
  \item
  \item
  \item
  \item
  \item
  \item
  \item
  \item
  \item
  \item
  \item
\end{itemize}

\section{Iniciaci\'{o}n del programa y algoritmos utilizados}
\paragraph{Introducci\'{o}n de direcciones y par\'{a}metros}
Los datos que se han de introducir son los siguientes:
\begin{itemize}
  \item Direcci\'{o}n de los archivos que contienen los datos del Sol, Luna y Tiempo Sid\'{e}reo.
  \item Intervalo de tiempo en que se dan los datos.
  \item Valor de $\Delta t$ (diferencia entre el tiempo terrestre y el universal).
\end{itemize}

\paragraph{Extracci\'{o}n de datos}
\texttt{Mathematica} extrae los datos de la forma adecuada seg\'{u}n el formato en que vengan dados. Adem\'{a}s evitar\'{a} los saltos de escala al pasar de \'{a}ngulos de 359º a 0º \'{o} de -179º a 180º.

Tambi\'{e}n se crea una escala de tiempo con inicio en el primer dato. Gracias a ella se conforman listas, cuyos elementos est\'{a}n referidos a esa escala de tiempos y que corresponden a minutos exactos de hora UT, a cinco minutos exactos de hora UT y a horas exactas de hora UT.

\paragraph{C\'{a}lculo de elementos besselianos}
%Sean $\vec{r}_{\astrosun}$ y $\vec{r}_{leftmoon}$ los vectores geoc\'entricos de posici\'on del Sol y la Luna. Sus componentes en el ITRF? ser\'an:
%
%
%De los datos ($\alpha_{\astrosun}$, $\delta_{\astrosun}$, $r_{\astrosun}$) y ($\alpha_{\leftmoon}$, $\delta_{\leftmoon}$, $r_{\leftmoon}$) se tienen los vectores de posici\'{o}n de Sol y Luna en el sistema ecuatorial. Restando ambos se tiene el vector de posici\'{o}n del Sol respecto a la Luna, lo que da la direcci\'{o}n del eje de sombra. Si representamos este vector en coordenadas esf\'{e}ricas, tenemos que el \'{a}ngulo vertical es el \emph{elemento d} y al \'{a}ngulo horizontal lo llamaremos $a$. La longitud $r$ es evidentemente la distancia Luna-Sol.
%
%Con ello y mediante trigonometr\'{\i}a esf\'{e}rica, podemos calcular las coordenadas cartesianas de la Luna en el sistema fundamental $(x,y,z)$, coincidiendo las dos primeras con los elementos $x$ e $y$.
%\[
%\begin{array}{r@{{}={}}l}
%x & r_{\leftmoon}\cos \delta_{\leftmoon} \sin\left(\alpha_{\leftmoon}-a\right)\\[1.5ex]
%y & r_{\leftmoon}\left[\sin \delta_{\leftmoon} \cos d - \cos \delta_{\leftmoon} \sin d \cos\left(\alpha_{\leftmoon}-a\right)\right]\\[1.5ex]
%z & r_{\leftmoon}\left[\sin \delta_{\leftmoon} \sin d + \cos \delta_{\leftmoon} \cos d \cos\left(\alpha_{\leftmoon}-a\right)\right]
%\end{array}
%\]
%
%En cuanto a los elementos $i_{p}$ e $i_{s}$, se obtiene por trigonometr\'{\i}a:
%\[
%\begin{array}{r@{{}={}}l}
%i_{s} & \tan\left[\arcsin\left(\Frac{radio_{\astrosun}-radio_{\leftmoon}}{r}\right)\right]\\[3ex]
%i_{p} & \tan\left[\arcsin\left(\Frac{radio_{\astrosun}+radio_{\leftmoon}}{r}\right)\right]
%\end{array}
%\]
%
%Tambi\'{e}n por trigonometr\'{\i}a se obtienen los valores de los \emph{elementos $l_{s}$} y $l_{p}$:
%\[
%\begin{array}{r@{{}={}}l}
%l_{s} & zi_{s}-radio_{\leftmoon}\sec[\arcsin(\frac{radio_{\astrosun}-radio_{\leftmoon}}{r})]\\
%l_{p} & zi_{p}+radio_{\leftmoon}\sec[\arcsin(\frac{radio_{\astrosun}+radio_{\leftmoon}}{r})]
%\end{array}
%\]
%
%Por \'{u}ltimo se obtiene el valor del \emph{elemento $\mu$}, que es simplemente
%$$\mu=tiempo sidereo - a$$

\paragraph{C\'{a}lculo de funciones interpolantes de elementos besselianos y de sus derivadas}
Con los valores obtenidos de los elementos besselianos, en los distintos instantes de de tiempo en que ven\'{\i}an los datos, se crean las funciones interpolantes y sus derivadas gracias a las funciones \verb"Interpolation" y \verb"Derivative" de \texttt{Mathematica}, que ser\'{a}n las utilizadas a lo largo de todo el programa para estos efectos.
\paragraph{C\'{a}lculo de la distancias del eje de sombra a la elipse fundamental}
Para cada instante y gracias al \emph{elemento d}, se obtiene el tama\~{n}o del eje menor de la elipse fundamental, que se sit\'{u}a en el eje $y$ del plano fundamental. Situada la elipse y conociendo la coordenadas $(\xi,\eta)$ del corte del eje de sombra con el plano fundamental, se calcula la posici\'{o}n del punto m\'{a}s cercano de la elipse al eje de sombra, como el punto de la elipse cuya perpendicular pasa por el eje. Adem\'{a}s, la distancia se toma negativa o positiva seg\'{u}n el eje de sombra pase o no por el interior de la elipse fundamental.

Tanto del tama\~{n}o del eje menor de la elipse fundamental, como de la distancia del eje a la elipse, se obtienen funciones interpolantes.


\paragraph{Determinaci\'{o}n del tipo de eclipse}
Mediante la funci\'{o}n \verb"FindMinimun", se halla el valor m\'{\i}nimo de la funci\'{o}n resta de las funciones interpolantes de la distancia del eje a la elipse fundamental y del \emph{elemento $l_{p}$}. Si este valor es negativo, supone que al menos hay eclipse parcial. Adem\'{a}s se le da el valor 1 a una variable auxiliar \'{o} 0 en caso contrario.

Se procede de modo an\'{a}logo sustituyendo la funci\'{o}n interpolante del \emph{elemento $l_{p}$} por la de \emph{elemento $l_{s}$}, 0, -\emph{elemento $l_{s}$} y -\emph{elemento $l_{p}$}, para verificar si el eclipse llega a ser no central, central con una sola curva de totalidad, central con una sola curva de parcialidad o central con ambas curvas de parcialidad. Tambi\'{e}n se generan las respectivas variables auxiliares.

A partir de este momento, para todos los c\'{a}lculo que se pidan al programa se verificar\'{a} primero que tanga sentido lo que se pide, seg\'{u}n el tipo de eclipse, mediante la comprobaci\'{o}n que la variable auxiliar que proceda tenga valor 1.


\paragraph{Obtenci\'{o}n de funciones interpolantes de ascensi\'{o}n recta, declinaci\'{o}n, distancia y tiempo sid\'{e}reo}
Se obtienen las funciones interpolantes de dichos datos tanto del Sol como de la Luna.

\paragraph{Obtenci\'{o}n de par\'{a}metros para la conjunci\'{o}n en ascensi\'{o}n recta}
Mediante la funci\'{o}n \verb"FindRoot", se obtiene el valor que anula la resta de las funciones interpolantes de las ascensiones rectas de Sol y Luna.

Se da la hora de ese instante y para esa hora, la declinaci\'{o}n de ambos astros, as\'{\i} como el paralaje horizontal ecuatorial $(PHE)$ y el semidi\'{a}metro $(SD)$ mediante las f\'{o}rmulas respectivas:

$$PHE=\arcsin[\frac{radio_{ecuatorialterrestre}}{distacia_{astro-Tierra}}]$$
$$SD=\arcsin[\frac{radio_{astro}}{distacia_{astro-Tierra}}]$$

\paragraph{C\'{a}lculo de la hora y situaci\'{o}n del principio y fin del eclipse parcial}
Mediante \verb"FindRoot" se calculan los instantes para los que se anula la resta entre las funciones interpolantes de la distancia del eje a la elipse fundamental y la del \emph{elemento $l_{p}$}. Adem\'{a}s, para dichos instantes se calcula el punto de la elipse fundamental m\'{a}s cercano al eje de sombra y a trav\'{e}s de sus coordenadas fundamentales se obtienen las geogr\'{a}ficas.

Adem\'{a}s, gracias a los dos instantes obtenidos, se crean intervalos de tiempo acotados por ellos, y espaciados cada minuto, cinco minutos o una hora.

\paragraph{C\'{a}lculo de la hora y situaci\'{o}n del principio y fin del eclipse total/anular}
Igual que el apartado anterior pero la funci\'{o}n que resta pasa a ser la del \emph{elemento $l_{s}$}.

\paragraph{C\'{a}lculo de la hora y situaci\'{o}n del principio y fin de la curva central del eclipse}
En este caso se procede de igual forma pero no existe la funci\'{o}n a la que se le busca el cero es la de la distancia del eje a la elipse fundamental, sin restarle ninguna otra funci\'{o}n.

\paragraph{C\'{a}lculo de la hora y situaci\'{o}n de los contactos interiores del cono de sombra}
Aqu\'{\i} en vez de restarle una funci\'{o}n se le suma la del \emph{elemento $l_{s}$}.

\paragraph{C\'{a}lculo de la hora y situaci\'{o}n de los contactos interiores del cono de penumbra}
En este apartado la funci\'{o}n que se suma es la del \emph{elemento $l_{p}$}.

\paragraph{C\'{a}lculo del punto de m\'{a}ximo eclipse}
Mediante la funci\'{o}n \verb"FindRoot" aplicada a la derivada de la funci\'{o}n que determina la distancia del eje al centro de la Tierra $\sqrt{elementox^2+elementoy^2}$, se obtiene el instante de m\'{a}xima proximidad.

Para obtener el punto de m\'{a}ximo eclipse se distinguen dos casos seg\'{u}n el eje de sombra corte o no el elipsoide en dicho instante. Si no lo hace, se trata de hallar para dicho instante el punto de la elipse fundamental m\'{a}s cercano al eje de sombra. Si lo hace, hay que hallar el punto de corte entre elipsoide y eje de sombra. El punto de corte se calcula resolviendo, en coordenadas fundamentales y mediante la funci\'{o}n \verb"NSolve", el siguiente sistema de ecuaciones:
$$\xi=elemento x$$
$$\eta=elemento y$$
$$x^2+y^2+\frac{z^2}{(1-f)^2}=1$$
donde $f$ es el factor de aplanamiento terrestre y $(x,y,z)$ se han de expresar en coordenadas fundamentales ($\xi,\eta,\zeta$) mediante la matriz de cambio de coordenadas. Se obtienen dos valores de los cuales s\'{o}lo interesa evidentemente el de $\zeta>0$, y se transforman a coordenadas geogr\'{a}ficas.


\paragraph{Determinaci\'{o}n del tipo de eclipse total/anular y de la magnitud y oscurecimiento}
Para los eclipses parciales obviamente no tiene sentido determinar si es total o anular. El procedimiento es el siguiente, para los puntos de principio y fin del eclipse total/anular, as\'{\i} como para el de m\'{a}ximo de eclipse, se calcula el valor del radio del cono de sombra siendo este valor $l_{s}-\zeta i_{s}$. Si en todos ellos es mayor que cero, el eclipse es anular, si es menor que cero, es total, y si cambia de signo es total-anular.

Sean $(\xi,\eta,\zeta)$ las coordenadas en el sistema fundamental de un punto cualquiera, se definen los siguientes par\'{a}metros para dicho punto en cada instante:
\begin{itemize}
  \item $L_{p}=l_{p}-\zeta i_{p}$, al valor del radio del cono penumbra
  \item $L_{s}=l_{s}-\zeta i_{s}$, al valor del radio del cono de sombra
  \item $\Delta=\sqrt{(elementox-\xi)^2+(elementoy-\eta)^2}$, a la distancia del punto al eje de sombra
\end{itemize}

Calculando dichos par\'{a}metros para el punto de m\'{a}ximo de eclipse, la magnitud del eclipse viene dada por la siguiente f\'{o}rmula:

$$M=\frac{L_{p}-\Theta}{L_{p}-L_{s}}$$

donde $\Theta=L_{s}$ para los eclipses anulares y $\Theta=\Delta$ para los eclipses parciales y totales.

En cuanto al oscurecimiento ($O$), si el eclipse es total en el punto de m\'{a}ximo de eclipse, toma el valor del $100\%$, si es anular toma el valor de $O=100M^2$\%, y si es parcial toma la siguiente expresi\'{o}n

$$O=\frac{100}{\pi}[\beta+(\pi-\beta-\gamma)s^2-s\sin\gamma]\%$$

siendo $s=\frac{L_{p}-L_{s}}{L_{p}+L_{s}}$, $\cos\beta=\frac{L_{p}L_{s}+\Delta^2}{\Delta(L_{p}+L_{s})}$ y $\cos\gamma=\frac{L_{p}^2+L_{s}^2-2\Delta^2}{L_{p}^2-L_{s}^2}$



\paragraph{Obtenci\'{o}n de la Curva central del Eclipse y de la duraci\'{o}n de la totalidad en sus puntos}
Se calcula para distintos instantes, el punto de corte del eje de sombra con el elipsoide. Para ello se procede de la misma forma que para obtener el punto de m\'{a}ximo de eclipse cuando exist\'{\i}a corte entre el eje de sombra y el elipsoide terrestre. De nuevo s\'{o}lo interesan el valor para el que $seta>0$.

Una vez obtenidos los puntos de la curva central, para un intervalo de tiempo suficiente anterior y posterior, se calcula la distancia del punto al borde del cono de sombra con signo positivo si se encuentra fuera de \'{e}l y negativo si se encuentra en el interior. Se crea una funci\'{o}n interpolante con estos valores, funci\'{o}n que tendr\'{a} dos ceros que se obtendr\'{a}n mediante \verb"FindRoot" y cuya diferencia es la duraci\'{o}n de la totalidad.

\paragraph{C\'{a}lculo del eclipse central al medio d\'{\i}a}
De los puntos que componen la curva central se obtienen los distintos valores de su coordenada $\xi$. Si esta cambia de signo a lo largo de la curva, se obtiene una funci\'{o}n interpolante con dicho valor y mediante \verb"FindRoot" se halla el instante para el que se anula $\xi$. Para dicho instante se calcula de nuevo el punto de corte del eje con el elipsoide y dicho punto es el del eclipse central al medio d\'{\i}a.



\paragraph{Obtenci\'{o}n de las curvas de contacto en el horizonte}
Las conforman, para cada instante, los puntos de la elipse fundamental, para los cuales la distancia al eje de sombra coincide con el radio del cono de penumbra en el plano fundamental. Para ello se resuelve mediante la funci\'{o}n \verb"NSolve" el siguiente sistema de ecuaciones, del que se desechan las soluciones no reales.

$$\zeta=0$$
$$\frac{\eta^2}{r_{semieje}^2}+\xi^2=1$$
$$\Delta=elementol_{p}$$

siendo $r_{semieje}$ el tama\~{n}o del semieje menor de la elipse fundamental para cada instante.

\paragraph{Obtenci\'{o}n de las curvas de m\'{a}ximo de eclipse en el horizonte}
Las conforman, para cada instante, los puntos de la elipse fundamental que se encuentran en dicho instante en su momento m\'{a}s cercano al eje de sombra. Para ellos pues, la funci\'{o}n $\Delta$ tiene un m\'{\i}nimo. Para obtenerlos se resuelve mediante la funci\'{o}n \verb"NSolve" el siguiente sistema de ecuaciones, del que se mantienen exclusivamente los puntos reales y que adem\'{a}s $l_{p}-\Delta\geq0$, ya que si no no ver\'{\i}an el eclipse en ese instante.

$$\zeta=0$$
$$\frac{\eta^2}{r_{semieje}^2}+\xi^2=1$$
$$\frac{d(\Delta)}{dt}=0$$

\paragraph{Obtenci\'{o}n de las curvas l\'{\i}mite Norte y Sur}
Se distinguen dos casos completamente distintos. Por un lado los puntos, que estando sobre el horizonte, s\'{o}lo alcanzan a ver la tangencia de los discos del Sol y Luna, ya sean tangencias interiores o exteriores seg\'{u}n sean curvas l\'{\i}mite de sombra o penumbra. Por otro, los puntos que estando inmersos en el cono de sombra/penumbra, tienen el eclipse por debajo del horizonte y para los que el m\'{a}ximo valor que alcanza $\zeta$ durante este periodo es 0.

Los primeros son puntos a la vez del elipsoide y del cono (sombra o penumbra seg\'{u}n el caso, para los cuales adem\'{a}s la funci\'{o}n $L-\Delta$ tiene un m\'{a}ximo, ya que \'{e}sta toma siempre valor positivo excepto en ese preciso instante en que se anula. Por facilidad computacional y por ser equivalente en este caso, se maximiza la funci\'{o}n $L^2-\Delta^2$. Se resuelve, como en casos anteriores mediante la funci\'{o}n \verb"NSolve", el siguiente sistema de ecuaciones del que se eliminan las soluciones imaginarias y las que dan un valor de $\zeta<0$.

$$\frac{d(L^2-\Delta^2)}{dt}=0$$
$$x^2+y^2+\frac{z^2}{(1-f)^2}=1$$

recordando de nuevo que las coordenadas $(x,y,z)$ se han de expresar en coordenadas fundamentales ($\xi,\eta,\zeta$) mediante la matriz de cambio de coordenadas.


Para el segundo caso se calculan los puntos que maximizan la funci\'{o}n $\zeta$ y que la anulan. Se mantienen s\'{o}lo las soluciones reales y para las que $L-\Delta>0$. Son la resoluci\'{o}n del siguiente sistema:

$$\zeta=0$$
$$\frac{\eta^2}{r_{semieje}^2}+\xi^2=1$$
$$\frac{d(\zeta)}{dt}=0$$

\paragraph{C\'{a}lculo de los puntos de coincidencia de curva de m\'{a}ximo en el horizonte con las curvas de m\'{a}ximo Norte/Sur sombra/penumbra}
En este caso las curvas de m\'{a}ximo Norte y Sur son las del primer tipo mencionado en el apartado anterior.
El modo de proceder es utilizar los puntos obtenidos en las curvas de m\'{a}ximo en el horizonte e ir comprobando su distancia (con signo) al borde del cono de penumbra/sombra para los distintos instantes. Con estos valores se hace una funci\'{o}n interpolante, cuyos ceros mediante \verb"FindRoot" ser\'{a}n los instantes de coincidencia de ambas curvas. Para estos instantes se obtienen los puntos de la curva de m\'{a}ximo en el horizonte que son los buscados.

\paragraph{Obtenci\'{o}n de las curvas instant\'{a}neas del eclipse}
Son los puntos, para cada instante, de corte del cono de penumbra con el elipsoide terrestre. Lo que se hace es ir calculando puntos en distintos planos de $\zeta=cte$, para valores de $0<\zeta<1$. Son los puntos de corte de la circunferencia y la elipse, que forman el cono y el elipsoide respectivamente en dicho plano. Se mantienen s\'{o}lo las soluciones reales. Para obtenerlos se resuelve, utilizando de nuevo la funci\'{o}n \verb"NSolve", el siguiente sistema de ecuaciones del que se desechan las soluciones no reales.

$$\zeta=cte$$
$$\Delta=L_{p}$$
$$x^2+y^2+\frac{z^2}{(1-f)^2}=1$$

\section{Dibujo en Planisferio}
Para la representaci\'{o}n de los puntos y curvas en la superficie terrestre se ha utilizado la representaci\'{o}n estereogr\'{a}fica tangente. Recordemos que es una representaci\'{o}n:
\begin{itemize}
  \item \emph{azimutal}: Todos los puntos se proyectan desde uno fijo.
  \item \emph{estereogr\'{a}fica}: El foco de proyecci\'{o}n se encuentra en una esfera.
  \item \emph{tangente}: El plano de representaci\'{o}n es el punto de la esfera opuesto al de tangencia.
\end{itemize}
Este tipo de representaci\'{o}n cuenta con la propiedad de la isogonalidad, es decir mantiene los \'{a}ngulos. Las distancias sin embargo aumentan conforme se aleja del punto de tangencia.

Como punto de tangencia se escoge el punto de m\'{a}ximo de eclipse y unos par\'{a}metros que definen la cantidad de superficie que se representa. L\'{o}gicamente estos par\'{a}metros se pueden variar para encuadrar mejor el eclipse en el dibujo.

Los datos que se pasan son la latitud y longitud de los puntos en grados sexagesimales y d\'{e}cimas de grado. Los puntos de las curvas obtenidos en los algoritmos hay distribuirlos en cada curva cuando son dos, y ordenarlos respectivamente en su curva. Para ello se utilizan criterios basados en la proximidad entre puntos (minimizar distancias) y en la continuidad (minimizar \'{a}ngulo). Con los puntos ya ordenados y diferenciados en sus respectivas curvas, se obtiene la curva en s\'{\i} mediante la funci\'{o}n \verb"BSpline".

Una vez obtenidas todas las curvas, \'{e}stas se muestran, junto con la ret\'{\i}cula de paralelos y meridianos y los puntos de los continentes (ambos de una librer\'{\i}a), en pantalla seg\'{u}n la representaci\'{o}n ya descrita.


\section{Conclusiones}

Utilidad para el ROA

C\'alculo directo frente a iteraciones

Localizaci\'on de puntos extremos para los mapas

Curva nueva

\appendix
\section{Funciones auxiliares utilizadas}
Conjunto de funciones creadas en \texttt{Mathematica} para la ejecuci\'{o}n de todos los algoritmos necesarios.
\paragraph{Formatos de horas, grados y radianes}
\begin{itemize}
  \item {\tt hms2h}: Paso de horas, minutos y segundos a horas.
  \item {\tt h2hms}: Paso de horas a horas, minutos y segundos.
  \item {\tt h2hm}: Paso de horas a horas y minutos.
  \item {\tt gms2rad}: Paso de grados, minutos y segundos a radianes.
  \item {\tt rad2gms}: Paso de radianes a grados, minutos y segundos.
  \item {\tt grad2gm}: Paso de grados a grados y minutos.
  \item {\tt hms2rad}: Paso de horas, minutos y segundos a radianes.
  \item {\tt rad2hms}: Paso de radianes a horas, minutos y segundos.
  \item {\tt hms2gms}: Paso de horas, minutos y segundos a grados, minutos y segundos.
  \item {\tt gms2hms}: Paso de grados, minutos y segundos a horas, minutos y segundos.
  \item {\tt gm2grad}: Paso de grados y minutos a grados.
  \item {\tt h2ms}: Paso de horas a minutos y segundos.
  \item {\tt h2s}: Paso de horas a segundos.
\end{itemize}
\paragraph{Fechas y tiempos}
\begin{itemize}
  \item {\tt diajuliano}: A partir del d\'{\i}a, mes y a\~{n}o se obtiene el d\'{\i}a juliano.
  \item {\tt tsidmedloc}: Da el tiempo sid\'{e}reo medio local, a partir del d\'{\i}a, mes, a\~{n}o, hora UT y longitud.
  \item {\tt cormerefe, coramerefe}: Correcci\'{o}n en grados de longitud debido a la diferencia entre el Tiempo Terrestre (en el que figuran los datos) y el Tiempo Universal Coordinado (por el que nos regimos).
\end{itemize}
\paragraph{Transformaci\'{o}n de coordenadas}
\begin{itemize}
  \item {\tt ecu2cart}: Paso de coordenadas polares a cartesianas.
  \item {\tt cart2ecu}: Paso de coordenadas cartesianas a polares.
  \item {\tt Rx}: Rotaci\'{o}n en torno al eje $x$.
  \item {\tt Ry}: Rotaci\'{o}n en torno al eje $y$.
  \item {\tt Rz}: Rotaci\'{o}n en torno al eje $z$.
  \item {\tt Matcambcoor}: Matriz de cambio de coordenadas del sistema fundamental al ecuatorial referido a Greenwich dados los elementos besselianos $d$ y $\mu$.
  \item {\tt matcambcoor}: Matriz de cambio de coordenadas del sistema fundamental al ecuatorial referido a Greenwich para un instante determinado.
  \item {\tt cambcoorcart}: Paso de coordenadas cartesianas del sistema fundamental al ecuatorial referido a Greenwich para un instante determinado.
  \item {\tt geodes2geocen}: Paso latitud geod\'{e}sica y altura a latitud geoc\'{e}ntrica y distancia radial.
  \item {\tt latgeocen2latgeode}: Paso de latitud geoc\'{e}ntrica a geod\'{e}sica.
  \item {\tt ecu2ecli}: Paso de coordenadas polares del sistema ecuatorial al ecl\'{\i}ptico.
  \item {\tt ecli2ecu}: Paso de coordenadas polares del sistema ecl\'{\i}ptico al ecuatorial.
  \item {\tt correcluna}: Correcci\'{o}n de coordenadas de la Luna por diferencia entre centro de masas y centro geom\'{e}trico.
\end{itemize}
\paragraph{Funciones geom\'{e}tricas del elipsoide}
\begin{itemize}
  \item {\tt radeliphor}: Valor del semieje menor de la elipse fundamental (corte de plano fundamental con elipsoide terrestre) para cada valor del {\tt elemento d}.
  \item {\tt disEjeElip}: Distancia con signo (positiva exterior, negativa interior) de un punto a una elipse.
\end{itemize}
\paragraph{Coordenadas en cada instante del punto de la elipse fundamental m\'{a}s pr\'{o}ximo al eje de sombra}
\begin{itemize}
  \item $\xi \eta fun$: Coordenadas fundamentales de dicho punto.
  \item $\xi \eta fun2xyz$: Coordenadas cartesianas de ese punto en el sistema ecuatorial referido a Greenwich.
  \item $\xi \eta fun2ecu$: Coordenadas polares de dicho punto en el sistema ecuatorial referido a Greenwich.
  \item $\xi \eta fun2lonlat$: Coordenadas geogr\'{a}ficas del referido punto.
\end{itemize}
\paragraph{Coordenadas en sistema fundamental en cada instante, de cualquier punto del elipsoide}
\begin{itemize}
  \item {\tt lonlatt2xyz, lonlatth2xyz}: Coordenadas cartesianas en el sistema ecuatorial referido a Greenwich, de cualquier punto terrestre (sin o con elevaci\'{o}n respecto a la superficie) para un instante determinado.
  \item $lonlatt2\xi \eta \zeta, lonlatth2\xi \eta \zeta$: Idem pero ya en coordenadas fundamentales.
\end{itemize}
\paragraph{Funciones de corte del eje de sombra con el elipsoide y duraci\'{o}n de la totalidad en el eje}
\begin{itemize}
  \item $corteejeelip2\xi \eta \zeta$: Coordenadas en el sistema fundamental del punto de corte del eje de sombra con el elipsoide, dados los elementos besselianos.
  \item {\tt corteejeelip2xyz}: Coordenadas en el sistema ecuatorial referido a Greenwich del punto de corte.
  \item {\tt corteejeelip2lonlat}: Coordenadas geogr\'{a}ficas del punto de corte.
  \item {\tt corteejeelip}: Coordenadas geogr\'{a}ficas del punto de corte para un instante determinado.
\end{itemize}
\paragraph{Funciones de duraci\'{o}n de la totalidad en el eje}
\begin{itemize}
  \item {\tt deltamenosL}: Da la distancia de un punto al borde del cono de sombra para un instante determinado.
  \item {\tt deltamenosLt}: Igual que la anterior pero los distintos valores para un intervalo de tiempo en torno al instante actual.
  \item {\tt duraciontoteje}: Da el tiempo (en minutos y segundos) de totalidad de un punto del eje.
  \item {\tt puntoejedur}: Igual que el anterior pero devolviendo adem\'{a}s la hora y la posici\'{o}n.
\end{itemize}
\paragraph{Funciones corte del cono de penumbra con la elipse fundamental}
\begin{itemize}
 \item {\tt cortehor}: Coordenadas en el sistema fundamental de los puntos de corte del cono de penumbra con la elipse fundamental dados los elementos besselianos.
  \item {\tt cortehor2xyz}: Idem pero en el sistema ecuatorial referido a Greenwich.
  \item {\tt cortehor2lonlat}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt cortehor2lonlatt}: Coordenadas geogr\'{a}ficas de los puntos de corte para un instante determinado.
\end{itemize}
\paragraph{Funciones de corte del cono de penumbra con el elipsoide}
\begin{itemize}
  \item $corteconopelip2\xi \eta \zeta$: Coordenadas en el sistema fundamental de los puntos de corte del cono de penumbra con elipsoide, dados los elementos besselianos.
  \item {\tt corteconopelip2xyz}: Idem pero en el sistema ecuatorial referido a Greenwich.
  \item {\tt corteconopelip2lonlat}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt corteconopelip}: Coordenadas geogr\'{a}ficas de puntos de corte para un instante determinado.
\end{itemize}
\paragraph{Funciones curvas l\'{\i}mite Norte y Sur por tangentear cono}
\begin{itemize}
  \item $elxelylpipd\mu 2\zeta Q$: Coordenadas en el sistema fundamental de los puntos de la curva l\'{\i}mite dados los elementos besselianos.
  \item $elxelylpipd\mu2xyz$: Idem pero en el sistema ecuatorial referido a Greenwich.
  \item $elxelylpipd\mu2lonlat$: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt puntoslimitep}: Coordenadas geogr\'{a}ficas de los puntos l\'{\i}mite del cono de penumbra para un instante determinado.
  \item {\tt puntoslimites}: Coordenadas geogr\'{a}ficas de los puntos l\'{\i}mite del cono de sombra para un instante determinado.
\end{itemize}
\paragraph{Funciones curvas l\'{\i}mite Norte y Sur por estar el eclipse bajo el horizonte}
\begin{itemize}
  \item $climite2\xi \eta \zeta$: Coordenadas en el sistema fundamental de los puntos de la curva l\'{\i}mite dados los elementos besselianos.
  \item {\tt climite2xyz}: Idem pero en el sistema ecuatorial referido a Greenwich.
  \item {\tt climite2lonlat}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt climite}: Coordenadas geogr\'{a}ficas de los puntos l\'{\i}mite para un instante determinado.
\end{itemize}
\paragraph{Funciones curvas de m\'{a}ximo de eclipse al orto/ocaso}
\begin{itemize}
  \item $maxhor2\xi \eta \zeta$: Coordenadas en el sistema fundamental de los puntos de m\'{a}ximo en el horizonte dados los elementos besselianos.
  \item {\tt maxhor2xyz}: Idem pero en el sistema ecuatorial referido a Greenwich.
  \item {\tt maxhor2lonlat}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt maxhor}: Coordenadas geogr\'{a}ficas de los puntos de m\'{a}ximo en el horizonte para un instante determinado.
\end{itemize}
\paragraph{Funciones para hallar los puntos de corte de las curvas de m\'{a}ximo en el horizonte con las l\'{\i}mites Norte y Sur de conos de penumbra y de sombra}
\begin{itemize}
  \item $maxhorbis2\xi \eta \zeta$: Coordenadas en el sistema fundamental de los puntos de elipse fundamental de m\'{a}xima cercan\'{\i}a al eje de sombra, est\'{e}n dentro o no del cono. Los par\'{a}metros son los elementos besselianos.
  \item {\tt dismaxcono}: Devuelve la distancia de los puntos anteriores al borde del cono siendo positiva si est\'{a}n fuera del cono y negativa si est\'{a} dentro.
  \item {\tt dismaxconosign}: Devuelve la distancia (con signo) del punto de los calculados por $maxhorbis2\xi \eta \zeta$ que est\'{a} m\'{a}s cerca del borde del cono.
  \item $maxhorbisselec\xi \eta \zeta$: Devuelve las coordenadas fundamentales del punto, de los hallados por $maxhorbis2\xi \eta \zeta$ que se encuentra m\'{a}s cerca del borde del cono.
  \item {\tt maxhorbis2xyz}: Idem pero en coordenadas ecuatoriales referidas a Greenwhich.
  \item {\tt maxhorbis2xyz}: Idem pero en coordenadas geogr\'{a}ficas.
  \item {\tt maxhorbisp}: Coordenadas geogr\'{a}ficas del punto de la elipse fundamental cuya distancia al eje de sombra alcanza un m\'{\i}nimo y que se encuentra m\'{a}s cerca del borde del cono de penumbra, para cada instante.
   \item {\tt maxhorbiss}: Igual que el anterior pero para el cono de sombra.
\end{itemize}
\paragraph{Funciones para ordenado de puntos de curvas}
\begin{itemize}
  \item {\tt NormsinSalto}: Calcula distancia entre dos puntos dados en coordenadas geogr\'{a}ficas.
  \item {\tt ordenaLobulo}: Ordena los puntos de inicio/fin eclipse del eclipse en el horizonte, ya sean uno o dos l\'{o}bulos.
  \item {\tt ordenaCurvCen}: Or
  \item {\tt ordenaCurva1Lim}: Ordena puntos l\'{\i}mite Norte/Sur cuando s\'{o}lo hay una curva de totalidad o parcialidad.
  \item {\tt ordenaCurva2Lim}: Idem que la anterior pero cuando existen las dos curvas.
  \item {\tt ordenaCurvamaxhor}: Ordena los puntos de m\'{a}ximo de eclipse en el horizonte.
  \item {\tt ordenaCortehoras}: Ordena los puntos de los cortes horarios del cono de penumbra al elipsoide.
  \item {\tt incluyePunto}: Incluye puntos intermedios a una curva.
\end{itemize}

\paragraph{Funciones para dibujo de continentes y ret\'{\i}cula}
\begin{itemize}
  \item {\tt ejes}
  \item {\tt coor}
  \item {\tt par}
  \item {\tt mer}
  \item {\tt reticula}
  \item {\tt continentes}
\end{itemize}




\section{Glosario}\label{glosario}
\begin{description}
\item t\'{e}rminos del glosario
\end{description}





\begin{thebibliography}{99}
\bibitem{} W. M. SMART, (1977): Textbook on Spherical Astronomy.
\bibitem{} F. JAVIER GIL CHICA (1996): Teor\'{\i}a de eclipses, ocultaciones y tr\'{a}nsitos.
\bibitem{} JEAN MEEUS, (1989): Elements of Solar Eclipses 1951-2200.
\bibitem{} ORUS, J.J., CATALA, M.A., (1987)Apuntes de Astronom\'{\i}a Tomo I.
\bibitem{} F. ESPENAK, (1997): Total Solar Eclipse of 1999 August 11. ed.
NASA (RP1398).
\bibitem{} JUAN CARLOS C., MIQUEL S.-R.(2003): Unidad Did\'{a}ctica Eclipses.
http://www.fecyt.es/semanadelaciencia2003/eclipse/pdf/UDE.pdf

\end{thebibliography}

\end{document}

