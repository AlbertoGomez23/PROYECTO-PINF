(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     17732,        448]
NotebookOptionsPosition[     17376,        431]
NotebookOutlinePosition[     17721,        446]
CellTagsIndexPosition[     17678,        443]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"sunrad", "=", "0.8"}], ";", "\[IndentingNewLine]", 
    RowBox[{"moonrad", "=", ".5"}], ";", "\[IndentingNewLine]", 
    RowBox[{"earthrad", "=", "1.2"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nsunpenumbraln", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "earthrad"}], "-", "sunrad"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"7", "-", "0"}], ")"}]}], " ", "x"}], "+", "sunrad"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nsunumbraln", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"earthrad", "-", "sunrad"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"7", "-", "0"}], ")"}]}], " ", "x"}], "+", "sunrad"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ssunpenumbraln", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"earthrad", "+", "sunrad"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"7", "-", "0"}], ")"}]}], " ", "x"}], "-", "sunrad"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ssunumbraln", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "earthrad"}], "+", "sunrad"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"7", "-", "0"}], ")"}]}], " ", "x"}], "-", "sunrad"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nmoonpenumbraln", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"moonorb", " ", 
           RowBox[{"Sin", "[", "t", "]"}]}], "-", "moonrad", "-", "sunrad"}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"moonorb", " ", 
           RowBox[{"Cos", "[", "t", "]"}]}], "+", "7", "-", "0"}], ")"}]}], 
       " ", "x"}], "+", "sunrad"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nmoonumbraln", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"moonorb", " ", 
           RowBox[{"Sin", "[", "t", "]"}]}], "+", "moonrad", "-", "sunrad"}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"moonorb", " ", 
           RowBox[{"Cos", "[", "t", "]"}]}], "+", "7", "-", "0"}], ")"}]}], 
       " ", "x"}], "+", "sunrad"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"smoonpenumbraln", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"moonorb", " ", 
           RowBox[{"Sin", "[", "t", "]"}]}], "+", "moonrad", "+", "sunrad"}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"moonorb", " ", 
           RowBox[{"Cos", "[", "t", "]"}]}], "+", "7", "-", "0"}], ")"}]}], 
       " ", "x"}], "-", "sunrad"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"smoonumbraln", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"moonorb", " ", 
           RowBox[{"Sin", "[", "t", "]"}]}], "-", "moonrad", "+", "sunrad"}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"moonorb", " ", 
           RowBox[{"Cos", "[", "t", "]"}]}], "+", "7", "-", "0"}], ")"}]}], 
       " ", "x"}], "-", "sunrad"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ejecono", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"moonorb", " ", 
         RowBox[{"Sin", "[", "t", "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"7", "+", 
         RowBox[{"moonorb", " ", 
          RowBox[{"Cos", "[", "t", "]"}]}]}], ")"}]}], "*", "x"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{".3", ",", ".4", ",", "1"}], "]"}], ",", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"7", ",", "0"}], "}"}], ",", "earthrad"}], "]"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Gray", ",", 
            RowBox[{"Circle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"7", ",", "0"}], "}"}], ",", "moonorb"}], "]"}], ","}],
            "*)"}], "White", ",", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"moonorb", " ", 
                RowBox[{"Cos", "[", "t", "]"}]}], "+", "7"}], ",", 
              RowBox[{"moonorb", " ", 
               RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}], ",", "moonrad"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"478", ",", "400"}], "}"}]}], ",", 
        RowBox[{"Background", "\[Rule]", 
         RowBox[{"RGBColor", "[", 
          RowBox[{".1", ",", ".1", ",", ".1"}], "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}]}], "]"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nsunpenumbraln", "[", "x", "]"}], ",", 
            RowBox[{"ssunpenumbraln", "[", "x", "]"}], ",", 
            RowBox[{"nsunumbraln", "[", "x", "]"}], ",", 
            RowBox[{"ssunumbraln", "[", "x", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "7", ",", "10"}], "}"}], ",", 
          RowBox[{"FillingStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"GrayLevel", "[", ".3", "]"}], ",", 
               RowBox[{"Opacity", "[", ".3", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"Opacity", "[", ".3", "]"}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "\[Rule]", 
              RowBox[{"{", "2", "}"}]}], ",", 
             RowBox[{"3", "\[Rule]", 
              RowBox[{"{", "4", "}"}]}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ","}], "*)"}], 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nmoonpenumbraln", "[", "x", "]"}], ",", 
          RowBox[{"smoonpenumbraln", "[", "x", "]"}], ",", 
          RowBox[{"nmoonumbraln", "[", "x", "]"}], ",", 
          RowBox[{"smoonumbraln", "[", "x", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"7", "+", 
           RowBox[{"moonorb", " ", 
            RowBox[{"Cos", "[", "t", "]"}]}]}], ",", "10"}], "}"}], ",", 
        RowBox[{"FillingStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"GrayLevel", "[", ".3", "]"}], ",", 
             RowBox[{"Opacity", "[", ".3", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"Opacity", "[", ".3", "]"}]}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Filling", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "\[Rule]", 
            RowBox[{"{", "2", "}"}]}], ",", 
           RowBox[{"3", "\[Rule]", 
            RowBox[{"{", "4", "}"}]}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"ejecono", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"7", "+", 
           RowBox[{"moonorb", " ", 
            RowBox[{"Cos", "[", "t", "]"}]}]}], ",", "10"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "White"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"1", ",", ".7", ",", ".1"}], "]"}], ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "sunrad"}], "]"}]}], "}"}], 
       "]"}]}], "]"}]}], ",", 
   RowBox[{"\"\<XCyclic\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "\"\<Moon position\>\""}], "}"}], ",", "0",
       ",", 
      RowBox[{"2", " ", "\[Pi]"}]}], "}"}]}], ",", 
   RowBox[{"\"\<Y\>\"", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"moonorb", ",", "2", ",", "\"\<Moon distance\>\""}], "}"}], 
      ",", "1.5", ",", "3.5"}], "}"}]}], ",", 
   RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{"t", ",", "moonorb"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.356737195125*^9, {3.35677672628693*^9, 3.35677676714631*^9}, {
   3.35677792758381*^9, 3.35677812059943*^9}, {3.35677832288068*^9, 
   3.35677832372443*^9}, {3.3570343251659*^9, 3.35703433875973*^9}, {
   3.3582949671875*^9, 3.35829498589063*^9}, {3.36063297626563*^9, 
   3.36063299359375*^9}, {3.36277813192188*^9, 3.3627781551875*^9}, {
   3.36346896478125*^9, 3.36346896484375*^9}, 3.36490162687533*^9, {
   3.36490249116667*^9, 3.36490261394713*^9}, {3.3886065266875*^9, 
   3.388606529453125*^9}, {3.48073981721875*^9, 3.480739826734375*^9}, {
   3.480740086046875*^9, 3.48074010396875*^9}, {3.4807404005625*^9, 
   3.480740410546875*^9}, {3.480740465515625*^9, 3.48074051703125*^9}, {
   3.480740685109375*^9, 3.480740694328125*^9}, {3.48074073459375*^9, 
   3.480740739203125*^9}, {3.480741046859375*^9, 3.480741049953125*^9}, {
   3.480741542703125*^9, 3.480741548109375*^9}, {3.480741656*^9, 
   3.480741702734375*^9}, {3.480741781453125*^9, 3.4807418615625*^9}, {
   3.48074219640625*^9, 3.480742197015625*^9}, {3.480742382875*^9, 
   3.480742383359375*^9}, {3.48074246521875*^9, 3.48074248371875*^9}, {
   3.480742571015625*^9, 3.480742593578125*^9}, {3.480742824015625*^9, 
   3.48074283015625*^9}, {3.480742915375*^9, 3.48074292740625*^9}, {
   3.4807429621875*^9, 3.480742962546875*^9}, {3.480743366203125*^9, 
   3.480743417765625*^9}, {3.480743489796875*^9, 3.48074351725*^9}, {
   3.4807435684375*^9, 3.480743590953125*^9}, {3.48074380678125*^9, 
   3.4807438121875*^9}, {3.48074384465625*^9, 3.480743875359375*^9}, 
   3.480743923953125*^9, {3.480743956828125*^9, 3.480743972890625*^9}, {
   3.480744057671875*^9, 3.48074407490625*^9}, {3.480744628296875*^9, 
   3.480744675125*^9}},
 CellID->1496021318],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`moonorb$$ = 3.5, $CellContext`t$$ = 
    3.1541590242041524`, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`t$$], 0, "Moon position"}, 0, 2 Pi}, {{
       Hold[$CellContext`moonorb$$], 2, "Moon distance"}, 1.5, 3.5}}, 
    Typeset`size$$ = {478., {198., 202.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$56990$$ = 0, $CellContext`moonorb$56991$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`moonorb$$ = 2, $CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$56990$$, 0], 
        Hold[$CellContext`moonorb$$, $CellContext`moonorb$56991$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`sunrad = 0.8; $CellContext`moonrad = 
        0.5; $CellContext`earthrad = 1.2; $CellContext`nsunpenumbraln[
          Pattern[$CellContext`x, 
           Blank[]]] := ((-$CellContext`earthrad - $CellContext`sunrad)/(7 + 
           0)) $CellContext`x + $CellContext`sunrad; $CellContext`nsunumbraln[
          Pattern[$CellContext`x, 
           Blank[]]] := (($CellContext`earthrad - $CellContext`sunrad)/(7 + 
           0)) $CellContext`x + $CellContext`sunrad; \
$CellContext`ssunpenumbraln[
          Pattern[$CellContext`x, 
           Blank[]]] := (($CellContext`earthrad + $CellContext`sunrad)/(7 + 
           0)) $CellContext`x - $CellContext`sunrad; $CellContext`ssunumbraln[
          Pattern[$CellContext`x, 
           Blank[]]] := ((-$CellContext`earthrad + $CellContext`sunrad)/(7 + 
           0)) $CellContext`x - $CellContext`sunrad; \
$CellContext`nmoonpenumbraln[
          Pattern[$CellContext`x$, 
           
           Blank[]]] := (($CellContext`moonorb$$ 
             Sin[$CellContext`t$$] - $CellContext`moonrad - \
$CellContext`sunrad)/($CellContext`moonorb$$ Cos[$CellContext`t$$] + 7 + 
           0)) $CellContext`x$ + $CellContext`sunrad; \
$CellContext`nmoonumbraln[
          Pattern[$CellContext`x$, 
           
           Blank[]]] := (($CellContext`moonorb$$ 
             Sin[$CellContext`t$$] + $CellContext`moonrad - \
$CellContext`sunrad)/($CellContext`moonorb$$ Cos[$CellContext`t$$] + 7 + 
           0)) $CellContext`x$ + $CellContext`sunrad; \
$CellContext`smoonpenumbraln[
          Pattern[$CellContext`x$, 
           
           Blank[]]] := (($CellContext`moonorb$$ 
             Sin[$CellContext`t$$] + $CellContext`moonrad + \
$CellContext`sunrad)/($CellContext`moonorb$$ Cos[$CellContext`t$$] + 7 + 
           0)) $CellContext`x$ - $CellContext`sunrad; \
$CellContext`smoonumbraln[
          Pattern[$CellContext`x$, 
           
           Blank[]]] := (($CellContext`moonorb$$ 
             Sin[$CellContext`t$$] - $CellContext`moonrad + \
$CellContext`sunrad)/($CellContext`moonorb$$ Cos[$CellContext`t$$] + 7 + 
           0)) $CellContext`x$ - $CellContext`sunrad; $CellContext`ejecono[
          Pattern[$CellContext`x$, 
           Blank[]]] := (($CellContext`moonorb$$ Sin[$CellContext`t$$])/(
          7 + $CellContext`moonorb$$ Cos[$CellContext`t$$])) $CellContext`x$; 
       Show[
         Graphics[{
           RGBColor[0.3, 0.4, 1], 
           Disk[{7, 0}, $CellContext`earthrad], White, 
           
           Disk[{$CellContext`moonorb$$ Cos[$CellContext`t$$] + 
             7, $CellContext`moonorb$$ 
             Sin[$CellContext`t$$]}, $CellContext`moonrad]}, 
          ImageSize -> {478, 400}, Background -> RGBColor[0.1, 0.1, 0.1], 
          PlotRange -> {{-2, 10}, {-5, 5}}], 
         Plot[{
           $CellContext`nmoonpenumbraln[$CellContext`x], 
           $CellContext`smoonpenumbraln[$CellContext`x], 
           $CellContext`nmoonumbraln[$CellContext`x], 
           $CellContext`smoonumbraln[$CellContext`x]}, {$CellContext`x, 
           7 + $CellContext`moonorb$$ Cos[$CellContext`t$$], 10}, 
          FillingStyle -> {{
             GrayLevel[0.3], 
             Opacity[0.3]}, {Black, 
             Opacity[0.3]}}, Filling -> {1 -> {2}, 3 -> {4}}, PlotStyle -> 
          Gray], 
         Plot[
          $CellContext`ejecono[$CellContext`x], {$CellContext`x, 
           7 + $CellContext`moonorb$$ Cos[$CellContext`t$$], 10}, PlotStyle -> 
          White], 
         Graphics[{
           RGBColor[1, 0.7, 0.1], 
           Disk[{0, 0}, $CellContext`sunrad]}]]), 
      "Specifications" :> {
       "XCyclic" -> {{$CellContext`t$$, 0, "Moon position"}, 0, 2 Pi}, 
        "Y" -> {{$CellContext`moonorb$$, 2, "Moon distance"}, 1.5, 3.5}}, 
      "Options" :> {
       TrackedSymbols :> {$CellContext`t$$, $CellContext`moonorb$$}}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{525., {257., 262.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.480743878140625*^9, 3.4807439250625*^9, 3.480743974109375*^9, 
   3.480744076234375*^9, {3.480744661296875*^9, 3.480744677890625*^9}}]
}, Open  ]]
},
WindowSize->{615, 527},
WindowMargins->{{82, Automatic}, {Automatic, 56}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 11143, 289, 692, "Input",
 CellID->1496021318],
Cell[11713, 313, 5647, 115, 536, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
