(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    446152,      12881]
NotebookOptionsPosition[    434546,      12541]
NotebookOutlinePosition[    434892,      12556]
CellTagsIndexPosition[    434849,      12553]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Funciones auxiliares.", "Subsection"],

Cell[CellGroupData[{

Cell["Formatos de horas, grados y radianes", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hms2h", "[", "hora_", "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"First", "[", "hora", "]"}], "+", 
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{"hora", ",", "2"}], "]"}], "/", "60"}], "+", 
    RowBox[{
     RowBox[{"Last", "[", "hora", "]"}], "/", "3600"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"h2hms", "[", "hora_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", ",", "m", ",", "s"}], "}"}], ",", 
    RowBox[{
     RowBox[{"h", "=", 
      RowBox[{"IntegerPart", "[", "hora", "]"}]}], ";", "\n", 
     RowBox[{"m", "=", 
      RowBox[{"IntegerPart", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"hora", "-", "h"}], ")"}], "*", "60"}], "]"}]}], ";", 
     RowBox[{"s", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"hora", "-", "h", "-", 
         RowBox[{"m", "/", "60"}]}], ")"}], "*", "3600"}]}], ";", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m", ",", 
       RowBox[{"Chop", "[", "s", "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.477327225640625*^9, 3.4773272454375*^9}, {
  3.477327291171875*^9, 3.477327295484375*^9}, {3.47732767678125*^9, 
  3.477327680828125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h2hm", "[", "hora_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", ",", "m"}], "}"}], ",", 
    RowBox[{
     RowBox[{"h", "=", 
      RowBox[{"IntegerPart", "[", "hora", "]"}]}], ";", "\n", 
     RowBox[{"m", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"hora", "-", "h"}], ")"}], "*", "60"}]}], ";", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.477327225640625*^9, 3.4773272454375*^9}, {
  3.477327291171875*^9, 3.477327295484375*^9}, {3.47732767678125*^9, 
  3.477327680828125*^9}, {3.477372094953125*^9, 3.47737214184375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gms2rad", "[", "ang_", "]"}], ":=", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"First", "[", "ang", "]"}], "+", 
     RowBox[{
      RowBox[{"Part", "[", 
       RowBox[{"ang", ",", "2"}], "]"}], "/", "60"}], "+", 
     RowBox[{
      RowBox[{"Last", "[", "ang", "]"}], "/", "3600"}]}], "]"}], "*", 
   "Degree"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rad2gms", "[", "ang_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"grad", ",", "min", ",", "sec"}], "}"}], ",", 
    RowBox[{
     RowBox[{"grad", "=", 
      RowBox[{"IntegerPart", "[", 
       RowBox[{"ang", "/", "Degree"}], "]"}]}], ";", 
     RowBox[{"min", "=", 
      RowBox[{"IntegerPart", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ang", "/", "Degree"}], ")"}], "-", " ", "grad"}], ")"}], 
        "*", "60"}], "]"}]}], ";", 
     RowBox[{"sec", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ang", "/", "Degree"}], ")"}], "-", "grad", "-", 
         RowBox[{"min", "/", "60"}]}], ")"}], "*", "3600"}]}], ";", 
     RowBox[{"{", 
      RowBox[{"grad", ",", "min", ",", "sec"}], "}"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"grad2gm", "[", "ang_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"grad", ",", "min"}], "}"}], ",", 
    RowBox[{
     RowBox[{"grad", "=", 
      RowBox[{"IntegerPart", "[", "ang", "]"}]}], ";", 
     RowBox[{"min", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ang", "-", " ", "grad"}], ")"}], "*", "60"}]}], ";", 
     RowBox[{"{", 
      RowBox[{"grad", ",", "min"}], "}"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hms2rad", "[", "ang_", "]"}], ":=", 
  RowBox[{
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "[", "ang", "]"}], "*", "15"}], "+", 
     RowBox[{
      RowBox[{"Part", "[", 
       RowBox[{"ang", ",", "2"}], "]"}], "*", 
      RowBox[{"15", "/", "60"}]}], "+", 
     RowBox[{
      RowBox[{"Last", "[", "ang", "]"}], "*", 
      RowBox[{"15", "/", "3600"}]}]}], "]"}], "*", "Degree"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rad2hms", "[", "ang_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hor", ",", "min", ",", "sec"}], "}"}], ",", 
    RowBox[{
     RowBox[{"hor", "=", 
      RowBox[{"IntegerPart", "[", 
       RowBox[{
        RowBox[{"ang", "/", "Degree"}], "/", "15"}], "]"}]}], ";", 
     RowBox[{"min", "=", 
      RowBox[{"IntegerPart", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ang", "/", "Degree"}], "/", "15"}], ")"}], "-", " ", 
          "hor"}], ")"}], "*", "60"}], "]"}]}], ";", 
     RowBox[{"sec", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ang", "/", "Degree"}], "/", "15"}], ")"}], "-", "hor", 
         "-", 
         RowBox[{"min", "/", "60"}]}], ")"}], "*", "3600"}]}], ";", 
     RowBox[{"{", 
      RowBox[{"hor", ",", "min", ",", "sec"}], "}"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hms2gms", "[", "ang_", "]"}], ":=", 
  RowBox[{"rad2gms", "[", 
   RowBox[{"hms2rad", "[", "ang", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gms2hms", "[", "ang_", "]"}], ":=", 
  RowBox[{"rad2hms", "[", 
   RowBox[{"gms2rad", "[", "ang", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gm2grad", "[", "ang_", "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"First", "[", "ang", "]"}], "+", 
    RowBox[{
     RowBox[{"1", "/", "60"}], " ", 
     RowBox[{"Last", "[", "ang", "]"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"h2ms", "[", "hora_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "s"}], "}"}], ",", 
    RowBox[{
     RowBox[{"m", "=", 
      RowBox[{"IntegerPart", "[", 
       RowBox[{"hora", "*", "60"}], "]"}]}], ";", 
     RowBox[{"s", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"hora", "-", 
         RowBox[{"m", "/", "60"}]}], ")"}], "*", "3600"}]}], ";", 
     RowBox[{"{", 
      RowBox[{"m", ",", "s"}], "}"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"h2s", "[", "hora_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "s", "}"}], ",", 
    RowBox[{
     RowBox[{"s", "=", 
      RowBox[{"hora", "*", "3600"}]}], ";", 
     RowBox[{"{", "s", "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.47737221309375*^9, 3.477372293875*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fechas y tiempos", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"diajuliano", "[", 
   RowBox[{"dia_", ",", "mes_", ",", "a\[NTilde]o_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"367", "*", "a\[NTilde]o"}], "-", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{"7", "*", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"a\[NTilde]o", "+", 
        RowBox[{"IntegerPart", "[", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"mes", "+", "9"}], ")"}], "12"], "]"}]}], ")"}], "4"]}], 
    "]"}], "+", 
   RowBox[{"IntegerPart", "[", 
    FractionBox[
     RowBox[{"275", "*", "mes"}], "9"], "]"}], "+", "dia", "+", 
   "1721013.5"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tsidmedloc", "[", 
   RowBox[{
   "dia_", ",", "mes_", ",", "a\[NTilde]o_", ",", "ut_", ",", "long_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "ts", ",", "tsh", ",", "tslh", ",", "tshms"}], "}"}], 
    ",", 
    RowBox[{
     RowBox[{"t", "=", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"diajuliano", "[", 
          RowBox[{"dia", ",", "mes", ",", "a\[NTilde]o"}], "]"}], "-", 
         "2451545"}], ")"}], "36525"]}], ";", 
     RowBox[{"ts", "=", 
      RowBox[{"24110.54841", "+", 
       RowBox[{"8640184.812866", "*", "t"}], "+", 
       RowBox[{"0.093104", "*", 
        SuperscriptBox["t", "2"]}], "-", 
       RowBox[{"0.0000062", "*", 
        SuperscriptBox["t", "3"]}]}]}], ";", 
     RowBox[{"tsh", "=", 
      RowBox[{"ts", "+", 
       RowBox[{"1.00273790935", "*", "3600", "*", 
        RowBox[{"hms2h", "[", "ut", "]"}]}]}]}], ";", 
     RowBox[{"tslh", "=", 
      RowBox[{"tsh", "+", 
       RowBox[{"3600", "*", 
        RowBox[{"hms2h", "[", 
         RowBox[{"gms2hms", "[", "long", "]"}], "]"}]}]}]}], ";", 
     RowBox[{"tshms", "=", 
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         FractionBox["tslh", "3600"], ",", "24"}], "]"}], "]"}]}], ";", 
     "tshms"}]}], "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cormerefe", "[", "lon_", "]"}], ":=", 
  RowBox[{"lon", "+", 
   RowBox[{"1.00273790935", "*", "\[CapitalDelta]t", "*", 
    FractionBox["15", "3600"]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Correcci\[OAcute]n", " ", "en", " ", "grados", " ", "de", " ", "longitud",
     " ", "debido", " ", "al", " ", "\[CapitalDelta]t", " ", "que", " ", 
    "marca", " ", "la", " ", "diferencia", " ", "entre", " ", "el", " ", 
    "Tiempo", " ", "Terrestre", " ", 
    RowBox[{"(", 
     RowBox[{
     "en", " ", "el", " ", "que", " ", "figuran", " ", "los", " ", "datos"}], 
     ")"}], " ", "con", " ", "el", " ", "Tiempo", " ", "Universal", " ", 
    "Coordinado", " ", 
    RowBox[{"(", 
     RowBox[{"por", " ", "el", " ", "que", " ", "nos", " ", "regimos"}], 
     ")"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4771176154375*^9, 3.477117684015625*^9}, {
  3.477120679125*^9, 3.477120681875*^9}, {3.477121357078125*^9, 
  3.47712135840625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coramerefe", "[", "lon_", "]"}], ":=", 
  RowBox[{"lon", "-", 
   RowBox[{"1.00273790935", "*", "\[CapitalDelta]t", "*", 
    FractionBox["15", "3600"]}]}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Transformaci\[OAcute]n coordenadas", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Aqu\[IAcute]", " ", "la", " ", "ascensi\[OAcute]n", " ", "recta", " ", 
    "est\[AAcute]", " ", "y", " ", "se", " ", "devuelve", " ", "en", " ", 
    "grados"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ecu2cart", "[", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]rec_", ",", "dec_", ",", "dis_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"dis", "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Alpha]rec", " ", "Degree"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"dec", " ", "Degree"}], "]"}]}]}], ";", 
      RowBox[{"y", "=", 
       RowBox[{"dis", "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Alpha]rec", " ", "Degree"}], "]"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"dec", " ", "Degree"}], "]"}]}]}], ";", 
      RowBox[{"z", "=", 
       RowBox[{"dis", "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"dec", " ", "Degree"}], "]"}]}]}], ";", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.477053089375*^9, 3.477053100484375*^9}, {
  3.477053146953125*^9, 3.477053219171875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cart2ecu", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Alpha]rec", ",", "dec", ",", "dis"}], "}"}], ",", 
    RowBox[{
     RowBox[{"dis", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}], ";", 
     RowBox[{"dec", "=", 
      RowBox[{"N", "[", 
       RowBox[{"ArcSin", "[", 
        FractionBox["z", "dis"], "]"}], "]"}]}], ";", 
     RowBox[{"\[Alpha]rec", "=", 
      RowBox[{"N", "[", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]rec", "/", "Degree"}], ",", 
       RowBox[{"dec", "/", "Degree"}], ",", "dis"}], "}"}]}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Rx", "[", "ang_", "]"}], ":=", 
  RowBox[{"(", GridBox[{
     {"1", "0", "0"},
     {"0", 
      RowBox[{"Cos", "[", 
       RowBox[{"ang", " ", "Degree"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{"ang", " ", "Degree"}], "]"}]},
     {"0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"ang", " ", "Degree"}], "]"}]}], 
      RowBox[{"Cos", "[", 
       RowBox[{"ang", " ", "Degree"}], "]"}]}
    }], ")"}]}], "\n", 
 RowBox[{
  RowBox[{"Ry", "[", "ang_", "]"}], ":=", 
  RowBox[{"(", GridBox[{
     {
      RowBox[{"Cos", "[", 
       RowBox[{"ang", " ", "Degree"}], "]"}], "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"ang", " ", "Degree"}], "]"}]}]},
     {"0", "1", "0"},
     {
      RowBox[{"Sin", "[", 
       RowBox[{"ang", " ", "Degree"}], "]"}], "0", 
      RowBox[{"Cos", "[", 
       RowBox[{"ang", " ", "Degree"}], "]"}]}
    }], ")"}]}], "\n", 
 RowBox[{
  RowBox[{"Rz", "[", "ang_", "]"}], ":=", 
  RowBox[{"(", GridBox[{
     {
      RowBox[{"Cos", "[", 
       RowBox[{"ang", " ", "Degree"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{"ang", " ", "Degree"}], "]"}], "0"},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"ang", " ", "Degree"}], "]"}]}], 
      RowBox[{"Cos", "[", 
       RowBox[{"ang", " ", "Degree"}], "]"}], "0"},
     {"0", "0", "1"}
    }], ")"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Matcambcoor", "[", 
   RowBox[{"d_", ",", "\[Mu]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Rz", "[", 
    RowBox[{"\[Mu]", "-", "90"}], "]"}], ".", 
   RowBox[{"Rx", "[", 
    RowBox[{"d", "-", "90"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"matcambcoor", "[", "t_", "]"}], ":=", 
  RowBox[{"Matcambcoor", "[", 
   RowBox[{
    RowBox[{"peled", "[", "t", "]"}], ",", 
    RowBox[{"pele\[Mu]", "[", "t", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cambcoorcart", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_", ",", "z_", ",", "t_"}], "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"matcambcoor", "[", "t", "]"}], ".", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "\[Phi]", " ", "en", " ", "grados", " ", "y", " ", "h", " ", "en", " ", 
    "kil\[OAcute]metros"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"geodes2geocen", "[", 
    RowBox[{"{", 
     RowBox[{"\[Phi]_", ",", "h_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "f", ",", "C", ",", "S", ",", "x", ",", "z"}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "=", "6378.14"}], ";", 
      RowBox[{"f", "=", 
       RowBox[{"(", 
        FractionBox["1", "298.257"], ")"}]}], ";", 
      RowBox[{"C", "=", 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "f"}], "-", 
             SuperscriptBox["f", "2"]}], ")"}], "*", 
           SuperscriptBox[
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", " ", "Degree"}], "]"}], "2"]}]}]]]}], ";", 
      RowBox[{"S", "=", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "f"}], ")"}], "2"], "*", "C"}]}], ";", 
      RowBox[{"x", "=", 
       RowBox[{"a", "*", 
        RowBox[{"(", 
         RowBox[{"C", "+", 
          FractionBox["h", "a"]}], ")"}], "*", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]", " ", "Degree"}], "]"}]}]}], ";", 
      RowBox[{"z", "=", 
       RowBox[{"a", "*", 
        RowBox[{"(", 
         RowBox[{"S", "+", 
          FractionBox["h", "a"]}], ")"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Phi]", " ", "Degree"}], "]"}]}]}], ";", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", ",", "z"}], "]"}], "Degree"], ",", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["z", "2"]}]]}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.47712313221875*^9, 3.4771232145*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"latgeocen2latgeode", "[", "\[Phi]_", "]"}], ":=", 
  FractionBox[
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]", " ", "Degree"}], "]"}], ",", 
     FractionBox[
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", " ", "Degree"}], "]"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["1", "298.257"]}], ")"}], "2"]]}], "]"}], 
   "Degree"]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Aqu\[IAcute]", " ", "la", " ", "ascensi\[OAcute]n", " ", "recta", " ", 
    "se", " ", "toma", " ", "en", " ", "horas", " ", "y", " ", "se", " ", 
    "devuelve", " ", "en", " ", "grados"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ecu2ecli", "[", 
     RowBox[{"{", 
      RowBox[{"t_", ",", "\[Alpha]rec_", ",", "dec_", ",", "dist_"}], "}"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]cel", ",", "\[Beta]cel", ",", 
        RowBox[{"\[Epsilon]", "=", "23.4393"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"\[Beta]cel", "=", 
        RowBox[{"N", "[", 
         RowBox[{"ArcSin", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Epsilon]", " ", "Degree"}], "]"}]}], "*", 
            RowBox[{"Cos", "[", 
             RowBox[{"dec", " ", "Degree"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"15", " ", "\[Alpha]rec", " ", "Degree"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Epsilon]", " ", "Degree"}], "]"}], "*", 
            RowBox[{"Sin", "[", 
             RowBox[{"dec", " ", "Degree"}], "]"}]}]}], "]"}], "]"}]}], ";", 
       RowBox[{"\[Lambda]cel", "=", 
        RowBox[{"N", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", " ", "[", 
             RowBox[{"dec", " ", "Degree"}], "]"}], "*", 
            RowBox[{"Cos", "[", 
             RowBox[{"15", " ", "\[Alpha]rec", " ", "Degree"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Epsilon]", " ", "Degree"}], "]"}], "*", 
             RowBox[{"Cos", "[", 
              RowBox[{"dec", " ", "Degree"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"15", " ", "\[Alpha]rec", " ", "Degree"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"\[Epsilon]", " ", "Degree"}], "]"}], "*", 
             RowBox[{"Sin", "[", 
              RowBox[{"dec", " ", "Degree"}], "]"}]}]}]}], "]"}], "]"}]}], 
       ";", 
       RowBox[{"{", 
        RowBox[{"t", ",", 
         RowBox[{"\[Lambda]cel", "/", "Degree"}], ",", 
         RowBox[{"\[Beta]cel", "/", "Degree"}], ",", "dist"}], "}"}]}]}], 
     "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.4770532358125*^9, 3.477053262296875*^9}, {
  3.47712318684375*^9, 3.477123188796875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ecli2ecu", "[", 
   RowBox[{"{", 
    RowBox[{"t_", ",", "\[Lambda]cel_", ",", "\[Beta]cel_", ",", "dist_"}], 
    "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Alpha]rec", ",", "dec", ",", 
      RowBox[{"\[Epsilon]", "=", "23.4393"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"dec", "=", 
      RowBox[{"N", "[", 
       RowBox[{"ArcSin", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"\[Epsilon]", " ", "Degree"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Beta]cel", " ", "Degree"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Lambda]cel", " ", "Degree"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Epsilon]", " ", "Degree"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Beta]cel", " ", "Degree"}], "]"}]}]}], "]"}], "]"}]}], 
     ";", 
     RowBox[{"\[Alpha]rec", "=", 
      RowBox[{"N", "[", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Beta]cel", " ", "Degree"}], "]"}], "*", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Lambda]cel", " ", "Degree"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Epsilon]", " ", "Degree"}], "]"}], "*", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Beta]cel", " ", "Degree"}], "]"}], "*", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Lambda]cel", " ", "Degree"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Epsilon]", " ", "Degree"}], "]"}], "*", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Beta]cel", " ", "Degree"}], "]"}]}]}]}], "]"}], 
       "]"}]}], ";", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"\[Alpha]rec", "/", "Degree"}], ",", "360"}], "]"}], ",", 
       RowBox[{"dec", "/", "Degree"}], ",", 
       RowBox[{"dist", "/", "ua"}]}], "}"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"correcluna", "[", 
   RowBox[{"{", 
    RowBox[{"t_", ",", "\[Alpha]rec_", ",", "dec_", ",", "dist_"}], "}"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Lambda]\[Beta]", ",", "\[Lambda]\[Beta]cor"}], "}"}], ",", 
    RowBox[{
     RowBox[{"\[Lambda]\[Beta]", "=", 
      RowBox[{"ecu2ecli", "[", 
       RowBox[{"{", 
        RowBox[{"t", ",", "\[Alpha]rec", ",", "dec", ",", "dist"}], "}"}], 
       "]"}]}], ";", 
     RowBox[{"\[Lambda]\[Beta]cor", "=", 
      RowBox[{"\[Lambda]\[Beta]", "+", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"0.5", "/", "3600"}], ",", 
         RowBox[{
          RowBox[{"-", "0.25"}], "/", "3600"}], ",", "0"}], "}"}]}]}], ";", 
     RowBox[{"ecli2ecu", "[", "\[Lambda]\[Beta]cor", "]"}]}]}], 
   "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones geom\[EAcute]tricas del elipsoide\
\>", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"radeliphor", "[", "d_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "a", ",", "f", ",", "\[Phi]", ",", "u", ",", "x", ",", "z", ",", "r"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", "1"}], ";", 
     RowBox[{"f", "=", 
      FractionBox["1", "298.257"]}], ";", 
     RowBox[{"\[Phi]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"90", "-", "d"}], ")"}], "Degree"}]}], ";", 
     RowBox[{"u", "=", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "f"}], ")"}], 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "]"}]}], ";", 
     RowBox[{"x", "=", 
      RowBox[{"a", "*", 
       RowBox[{"Cos", "[", "u", "]"}]}]}], ";", 
     RowBox[{"z", "=", 
      RowBox[{"a", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "f"}], ")"}], "*", 
       RowBox[{"Sin", "[", "u", "]"}]}]}], ";", 
     RowBox[{"r", "=", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["z", "2"]}]]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "valor", " ", "del", " ", "semieje", " ", "menor", " ", "de", " ", "la", 
    " ", "elipse", " ", "fundamental", " ", 
    RowBox[{"(", 
     RowBox[{
     "corte", " ", "de", " ", "plano", " ", "fundamental", " ", "con", " ", 
      "elipsoide", " ", "terrestre"}], ")"}], " ", "para", " ", "cada", " ", 
    "valor", " ", "del", " ", "elemento", " ", "d"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.47706101609375*^9, 3.47706113153125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"disEjeElip", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_", ",", "b_", ",", "u_"}], "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Sign", "[", 
    RowBox[{
     RowBox[{"x", "^", "2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", "/", "b"}], ")"}], "^", "2"}], "-", "1"}], "]"}], 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", "-", 
        RowBox[{"b", " ", 
         RowBox[{"Sin", "[", "u", "]"}]}]}], ")"}], "^", "2"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", 
        RowBox[{"Cos", "[", "u", "]"}]}], ")"}], "^", "2"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"distancia", " ", "con", " ", "signo", " ", 
     RowBox[{"(", 
      RowBox[{"positiva", " ", 
       RowBox[{"exterior", "/", "negativa"}], " ", "interior"}], ")"}], " ", 
     "de", " ", "un", " ", "punto", " ", 
     RowBox[{"(", 
      RowBox[{"x", ",", "y"}], ")"}], " ", "al", " ", "punto", " ", "de", " ",
      "la", " ", "elipse", " ", "normal"}], ",", " ", 
    RowBox[{"de", " ", "semiejes", " ", 
     RowBox[{"(", 
      RowBox[{"1", ",", "b"}], ")"}], " ", "y", " ", "latitud", " ", 
     "reducida", " ", "u"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477061154796875*^9, 3.47706133075*^9}, {
  3.47706176134375*^9, 3.47706176621875*^9}, {3.477114456609375*^9, 
  3.47711450028125*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Obtenci\[OAcute]n en cada instante de coordenadas geogr\[AAcute]ficas de \
punto de plano fundamental m\[AAcute]s pr\[OAcute]ximo a eje de sombra\
\>", "Subsubsection",
 CellChangeTimes->{{3.477121431484375*^9, 3.477121486453125*^9}, 
   3.47712160553125*^9, {3.4771220051875*^9, 3.4771220059375*^9}, 
   3.477122535328125*^9, {3.47712290615625*^9, 3.477122914984375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Xi]\[Eta]fun", "[", "t_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"utfun", ",", "relit"}], "}"}], ",", 
    RowBox[{
     RowBox[{"utfun", "=", 
      RowBox[{"u", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"peley", "[", "t", "]"}], "-", 
           RowBox[{
            RowBox[{"preliphor", "[", "t", "]"}], "*", 
            RowBox[{"Sin", "[", "u", "]"}]}], "-", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"preliphor", "[", "t", "]"}]}], "*", 
            RowBox[{"Tan", "[", "u", "]"}], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pelex", "[", "t", "]"}], "-", 
              RowBox[{"Cos", "[", "u", "]"}]}], ")"}]}]}], "\[Equal]", "0"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"u", ",", 
           RowBox[{"ArcTan", "[", 
            RowBox[{
             RowBox[{"pelex", "[", "t", "]"}], ",", 
             RowBox[{"peley", "[", "t", "]"}]}], "]"}]}], "}"}]}], "]"}]}]}], 
     ";", 
     RowBox[{"relit", "=", 
      RowBox[{"preliphor", "[", "t", "]"}]}], ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "utfun", "]"}], ",", 
       RowBox[{"relit", "*", 
        RowBox[{"Sin", "[", "utfun", "]"}]}]}], "}"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Xi]\[Eta]par2xyz", "[", "t_", "]"}], ":=", 
   RowBox[{"\[Xi]\[Eta]fun2xyz", "[", "t", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.47712193046875*^9, 3.47712193359375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Xi]\[Eta]fun2xyz", "[", "t_", "]"}], ":=", 
  RowBox[{"cambcoorcart", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Xi]\[Eta]fun", "[", "t", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"\[Xi]\[Eta]fun", "[", "t", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", "t"}], "}"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Xi]\[Eta]tot2xyz", "[", "t_", "]"}], ":=", 
   RowBox[{"\[Xi]\[Eta]fun2xyz", "[", "t", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.477121937671875*^9, 3.477121940578125*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Xi]\[Eta]par2ecu", "[", "t_", "]"}], ":=", 
   RowBox[{"cart2ecu", "[", 
    RowBox[{"\[Xi]\[Eta]par2xyz", "[", "t", "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.47712194534375*^9, 3.4771219479375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Xi]\[Eta]fun2ecu", "[", "t_", "]"}], ":=", 
  RowBox[{"cart2ecu", "[", 
   RowBox[{"\[Xi]\[Eta]fun2xyz", "[", "t", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Xi]\[Eta]tot2ecu", "[", "t_", "]"}], ":=", 
   RowBox[{"cart2ecu", "[", 
    RowBox[{"\[Xi]\[Eta]tot2xyz", "[", "t", "]"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.477121951125*^9, 3.47712195421875*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Xi]\[Eta]par2lonlat", "[", "t_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"grad2gm", "[", 
      RowBox[{"cormerefe", "[", 
       RowBox[{
        RowBox[{"\[Xi]\[Eta]par2ecu", "[", "t", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"grad2gm", "[", 
      RowBox[{"latgeocen2latgeode", "[", 
       RowBox[{
        RowBox[{"\[Xi]\[Eta]par2ecu", "[", "t", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.477121957953125*^9, 3.477121971765625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "t_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"grad2gm", "[", 
     RowBox[{"cormerefe", "[", 
      RowBox[{
       RowBox[{"\[Xi]\[Eta]fun2ecu", "[", "t", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"grad2gm", "[", 
     RowBox[{"latgeocen2latgeode", "[", 
      RowBox[{
       RowBox[{"\[Xi]\[Eta]fun2ecu", "[", "t", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[Xi]\[Eta]tot2lonlat", "[", "t_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"grad2gm", "[", 
      RowBox[{"cormerefe", "[", 
       RowBox[{
        RowBox[{"\[Xi]\[Eta]tot2ecu", "[", "t", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"grad2gm", "[", 
      RowBox[{"latgeocen2latgeode", "[", 
       RowBox[{
        RowBox[{"\[Xi]\[Eta]tot2ecu", "[", "t", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.477121975546875*^9, 3.477121979109375*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Obtenci\[OAcute]n en cada instante de coordenadas en sistema fundamental de \
cualquier punto del elipsoide\
\>", "Subsubsection",
 CellChangeTimes->{{3.477122490609375*^9, 3.477122527640625*^9}, {
  3.47712301678125*^9, 3.477123017875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lonlatt2xyz", "[", 
   RowBox[{"lon_", ",", "lat_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lonc", ",", "latc", ",", "r"}], "}"}], ",", 
    RowBox[{
     RowBox[{"lonc", "=", 
      RowBox[{"coramerefe", "[", 
       RowBox[{"gm2grad", "[", "lon", "]"}], "]"}]}], ";", 
     RowBox[{"latc", "=", 
      RowBox[{"First", "[", 
       RowBox[{"geodes2geocen", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gm2grad", "[", "lat", "]"}], ",", "0"}], "}"}], "]"}], 
       "]"}]}], ";", 
     RowBox[{"r", "=", 
      RowBox[{"Last", "[", 
       RowBox[{"geodes2geocen", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"gm2grad", "[", "lat", "]"}], ",", "0"}], "}"}], "]"}], 
       "]"}]}], ";", 
     RowBox[{
      FractionBox["1", "6378.14"], 
      RowBox[{"ecu2cart", "[", 
       RowBox[{"{", 
        RowBox[{"lonc", ",", "latc", ",", "r"}], "}"}], "]"}]}]}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"h", " ", "en", " ", "metros"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"lonlatth2xyz", "[", 
    RowBox[{"lon_", ",", "lat_", ",", "h_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lonc", ",", "latc", ",", "r"}], "}"}], ",", 
     RowBox[{
      RowBox[{"lonc", "=", 
       RowBox[{"coramerefe", "[", 
        RowBox[{"gm2grad", "[", "lon", "]"}], "]"}]}], ";", 
      RowBox[{"latc", "=", 
       RowBox[{"First", "[", 
        RowBox[{"geodes2geocen", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"gm2grad", "[", "lat", "]"}], ",", 
           RowBox[{"h", "/", "1000"}]}], "}"}], "]"}], "]"}]}], ";", 
      RowBox[{"r", "=", 
       RowBox[{"Last", "[", 
        RowBox[{"geodes2geocen", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"gm2grad", "[", "lat", "]"}], ",", 
           RowBox[{"h", "/", "1000"}]}], "}"}], "]"}], "]"}]}], ";", 
      RowBox[{
       FractionBox["1", "6378.14"], 
       RowBox[{"ecu2cart", "[", 
        RowBox[{"{", 
         RowBox[{"lonc", ",", "latc", ",", "r"}], "}"}], "]"}]}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.477123244796875*^9, 3.477123253125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lonlatt2\[Xi]\[Eta]\[Zeta]", "[", 
   RowBox[{"lon_", ",", "lat_", ",", "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{"matcambcoor", "[", "t", "]"}], "]"}], ".", 
   RowBox[{"lonlatt2xyz", "[", 
    RowBox[{"lon", ",", "lat", ",", "t"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lonlatth2\[Xi]\[Eta]\[Zeta]", "[", 
   RowBox[{"lon_", ",", "lat_", ",", "h_", ",", "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Inverse", "[", 
    RowBox[{"matcambcoor", "[", "t", "]"}], "]"}], ".", 
   RowBox[{"lonlatth2xyz", "[", 
    RowBox[{"lon", ",", "lat", ",", "h", ",", "t"}], "]"}]}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones corte eje de sombra con elipsoide\
\>", "Subsubsection",
 CellChangeTimes->{{3.477127452890625*^9, 3.4771274703125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"corteejeelip2\[Xi]\[Eta]\[Zeta]", "[", 
   RowBox[{"{", 
    RowBox[{"elex_", ",", "eley_", ",", "eled_", ",", "ele\[Mu]_"}], "}"}], 
   "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}], "/.", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "==", "elex"}], ",", 
         RowBox[{"y", "\[Equal]", "eley"}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Matcambcoor", "[", 
                 RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ")"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Matcambcoor", "[", 
                 RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ")"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], ")"}], "2"], "+", 
           RowBox[{
            FractionBox["1", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                FractionBox["1", "298.257"]}], ")"}], "2"]], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Matcambcoor", "[", 
                  RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ")"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], ")"}], "2"]}]}], "\[Equal]", 
          "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"Positive", "[", 
      RowBox[{"#", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], "&"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"corteejeelip2xyz", "[", 
    RowBox[{"{", 
     RowBox[{"elex_", ",", "eley_", ",", "eled_", ",", "ele\[Mu]_"}], "}"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"corte", "=", 
       RowBox[{"corteejeelip2\[Xi]\[Eta]\[Zeta]", "[", 
        RowBox[{"{", 
         RowBox[{"elex", ",", "eley", ",", "eled", ",", "ele\[Mu]"}], "}"}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"corte", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\"\<Error\>\"", ",", 
       RowBox[{
        RowBox[{"Matcambcoor", "[", 
         RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
        RowBox[{"corte", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
  "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"corteejeelip2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "eley_", ",", "eled_", ",", "ele\[Mu]_", ",", "t_"}], "}"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"corte", "=", 
      RowBox[{"corteejeelip2xyz", "[", 
       RowBox[{"{", 
        RowBox[{"elex", ",", "eley", ",", "eled", ",", "ele\[Mu]"}], "}"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"corte", "===", "\"\<Error\>\""}], ",", 
      "\"\<No hay corte en ese instante\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"grad2gm", "[", 
         RowBox[{"cormerefe", "[", 
          RowBox[{
           RowBox[{"cart2ecu", "[", "corte", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"grad2gm", "[", 
         RowBox[{"latgeocen2latgeode", "[", 
          RowBox[{
           RowBox[{"cart2ecu", "[", "corte", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.47714214584375*^9, 3.47714215440625*^9}, {
  3.477235818578125*^9, 3.477235818984375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"corteejeelipt2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "eley_", ",", "eled_", ",", "ele\[Mu]_", ",", "t_"}], "}"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"corte", "=", 
      RowBox[{"corteejeelip2xyz", "[", 
       RowBox[{"{", 
        RowBox[{"elex", ",", "eley", ",", "eled", ",", "ele\[Mu]"}], "}"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"corte", "===", "\"\<Error\>\""}], ",", 
      "\"\<No hay corte en ese instante\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"grad2gm", "[", 
         RowBox[{"cormerefe", "[", 
          RowBox[{
           RowBox[{"cart2ecu", "[", "corte", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"grad2gm", "[", 
         RowBox[{"latgeocen2latgeode", "[", 
          RowBox[{
           RowBox[{"cart2ecu", "[", "corte", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", "t"}], "}"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.477235815265625*^9, 3.47723582959375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"corteejeelip", "[", "t_", "]"}], ":=", 
  RowBox[{"corteejeelip2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pelex", "[", "t", "]"}], ",", 
     RowBox[{"peley", "[", "t", "]"}], ",", 
     RowBox[{"peled", "[", "t", "]"}], ",", 
     RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", "t"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.477235774671875*^9, 3.477235781546875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"corteejeelipt", "[", "t_", "]"}], ":=", 
  RowBox[{"corteejeelipt2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pelex", "[", "t", "]"}], ",", 
     RowBox[{"peley", "[", "t", "]"}], ",", 
     RowBox[{"peled", "[", "t", "]"}], ",", 
     RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", "t"}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.477235834890625*^9, 3.4772358405*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones duraci\[OAcute]n totalidad en curva central\
\>", "Subsubsection",
 CellChangeTimes->{{3.477127285375*^9, 3.477127301171875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"datoreal", "[", "d_", "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{"d", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "#", "]"}], "\[Equal]", "List"}], " ", "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Elimina", " ", "los", " ", "valores", " ", "como", " ", "\"\<Error\>\""}],
    " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4772345303125*^9, 3.477234542484375*^9}, {
  3.47723529059375*^9, 3.47723529171875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listat", "[", "t_", "]"}], ":=", 
  RowBox[{"t", "+", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", "6"}], ",", 
     RowBox[{"1", "/", "6"}], ",", 
     RowBox[{"1", "/", "60"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Abarca", " ", "de", " ", "minuto", " ", "en", " ", "minuto", " ", "desde",
     " ", "10", " ", "minutos", " ", "antes", " ", "hasta", " ", "10", " ", 
    "minutos", " ", 
    RowBox[{"despu\[EAcute]s", ".", " ", "As\[IAcute]"}], " ", "hay", " ", 
    "margen", " ", "suficiente", " ", "para", " ", "cubrir", " ", "la", " ", 
    "fase", " ", "de", " ", "totalidad", " ", "de", " ", "los", " ", "puntos",
     " ", "de", " ", "la", " ", "curva", " ", "central"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4772345613125*^9, 3.47723459840625*^9}, {
  3.47723463103125*^9, 3.477234688*^9}, {3.477235293375*^9, 
  3.47723529521875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deltamenosL", "[", 
   RowBox[{"{", 
    RowBox[{"lon_", ",", "lat_", ",", "t_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"delta", ",", "L"}], "}"}], ",", 
    RowBox[{
     RowBox[{"delta", "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pelex", "[", "t", "]"}], "-", 
           RowBox[{"First", "[", 
            RowBox[{"lonlatt2\[Xi]\[Eta]\[Zeta]", "[", 
             RowBox[{"lon", ",", "lat", ",", "t"}], "]"}], "]"}]}], ")"}], 
         "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"peley", "[", "t", "]"}], "-", 
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{"lonlatt2\[Xi]\[Eta]\[Zeta]", "[", 
              RowBox[{"lon", ",", "lat", ",", "t"}], "]"}], ",", "2"}], 
            "]"}]}], ")"}], "2"]}], "]"}]}], ";", 
     RowBox[{"L", "=", 
      RowBox[{
       RowBox[{"pelels", "[", "t", "]"}], "-", 
       RowBox[{
        RowBox[{"Last", "[", 
         RowBox[{"lonlatt2\[Xi]\[Eta]\[Zeta]", "[", 
          RowBox[{"lon", ",", "lat", ",", "t"}], "]"}], "]"}], "*", 
        RowBox[{"peleis", "[", "t", "]"}]}]}]}], ";", 
     RowBox[{"delta", "-", 
      RowBox[{"Abs", "[", "L", "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Da", " ", "para", " ", "un", " ", "punto", " ", "geogr\[AAcute]fico", 
     " ", "en", " ", "un", " ", "instante", " ", "determinado"}], ",", " ", 
    RowBox[{
    "la", " ", "distancia", " ", "con", " ", "signo", " ", "al", " ", "borde",
      " ", "del", " ", "cono", " ", "de", " ", "sombra"}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.47723515325*^9, 3.47723524109375*^9}, {
  3.47723528778125*^9, 3.4772352985*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deltamenosLt", "[", 
   RowBox[{"{", 
    RowBox[{"lon_", ",", "lat_", ",", "t_"}], "}"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"deltamenosL", "[", 
      RowBox[{"{", 
       RowBox[{"lon", ",", "lat", ",", "#"}], "}"}], "]"}], "&"}], ",", 
    RowBox[{"listat", "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Una", " ", "lista", " ", "de", " ", "estas", " ", "distancias", " ", 
    "para", " ", "los", " ", "valores", " ", "de", " ", "la", " ", "lista"}], 
   " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477235258328125*^9, 3.477235285421875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"duraciontoteje", "[", 
   RowBox[{"{", 
    RowBox[{"lon_", ",", "lat_", ",", "t_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pdeltamenosL", ",", "t1", ",", "t2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"pdeltamenosL", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"listat", "[", "t", "]"}], ",", 
          RowBox[{"deltamenosLt", "[", 
           RowBox[{"{", 
            RowBox[{"lon", ",", "lat", ",", "t"}], "}"}], "]"}]}], "}"}], 
        "]"}], "]"}]}], ";", 
     RowBox[{"t1", "=", 
      RowBox[{"n", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pdeltamenosL", "[", "n", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"t", "-", 
            RowBox[{"9", "/", "60"}]}]}], "}"}]}], "]"}]}]}], ";", 
     RowBox[{"t2", "=", 
      RowBox[{"n", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pdeltamenosL", "[", "n", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"t", "+", 
            RowBox[{"9", "/", "60"}]}]}], "}"}]}], "]"}]}]}], ";", 
     RowBox[{"h2s", "[", 
      RowBox[{"(", 
       RowBox[{"t2", "-", "t1"}], ")"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Da", " ", "el", " ", "valor", " ", "entre", " ", "los", " ", "dos", " ", 
     "instantes", " ", "en", " ", "que", " ", "se", " ", "encuentra", " ", 
     "en", " ", "el", " ", "borde", " ", "del", " ", "cono", " ", "de", " ", 
     "sombra"}], ",", " ", 
    RowBox[{
    "es", " ", "decir", " ", "el", " ", "tiempo", " ", "de", " ", "totalidad",
      " ", "del", " ", "eclipse"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477235306125*^9, 3.47723538684375*^9}, {
   3.47723556265625*^9, 3.477235575390625*^9}, 3.47737243059375*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"puntoejedur", "[", 
   RowBox[{"{", 
    RowBox[{"lon_", ",", "lat_", ",", "t_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"h2hms", "[", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"t", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"First", "[", "fech", "]"}], "-", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}], 
         "*", "24"}], "-", 
        RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
     "]"}], ",", "lon", ",", "lat", ",", 
    RowBox[{"duraciontoteje", "[", 
     RowBox[{"{", 
      RowBox[{"lon", ",", "lat", ",", "t"}], "}"}], "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Devuelve", " ", "la", " ", "hora", " ", "longitud", " ", "y", " ", 
    "latitud", " ", "del", " ", "punto", " ", "y", " ", "la", " ", 
    "totalidad"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477235609765625*^9, 3.477235648328125*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones corte cono de penumbra con elipse fundamental ", \
"Subsubsection",
 CellChangeTimes->{{3.4771355380625*^9, 3.477135552234375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cortehor", "[", 
   RowBox[{"{", 
    RowBox[{
    "reli_", ",", "elex_", ",", "eley_", ",", "elel_", ",", "eled_", ",", 
     "ele\[Mu]_"}], "}"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], "/.", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox[
            SuperscriptBox["y", "2"], 
            SuperscriptBox["reli", "2"]], "+", 
           SuperscriptBox["x", "2"]}], "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y", "-", "eley"}], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", "elex"}], ")"}], "2"]}], "\[Equal]", 
          SuperscriptBox["elel", "2"]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "Real"}], 
      "\[And]", 
      RowBox[{
       RowBox[{"Head", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Equal]", "Real"}]}], 
     "&"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Corte", " ", "de", " ", "la", " ", "elipse", " ", "fundamental"}], ",", 
    RowBox[{
    "con", " ", "la", " ", "circunferencia", " ", "que", " ", "forma", " ", 
     "el", " ", "cono", " ", "en", " ", "el", " ", "plano", " ", 
     RowBox[{"fundamental", "."}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477137459359375*^9, 3.4771374650625*^9}, {
  3.47714538425*^9, 3.47714546928125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cortehor2xyz", "[", 
    RowBox[{"{", 
     RowBox[{
     "reli_", ",", "elex_", ",", "eley_", ",", "elel_", ",", "eled_", ",", 
      "ele\[Mu]_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"corte", "=", 
       RowBox[{"cortehor", "[", 
        RowBox[{"{", 
         RowBox[{
         "reli", ",", "elex", ",", "eley", ",", "elel", ",", "eled", ",", 
          "ele\[Mu]"}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"corte", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\"\<Error\>\"", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Matcambcoor", "[", 
            RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], "&"}], ",",
          "corte"}], "]"}]}], "]"}]}], "]"}]}], "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cortehor2lonlat", "[", 
    RowBox[{"{", 
     RowBox[{
     "reli_", ",", "elex_", ",", "eley_", ",", "elel_", ",", "eled_", ",", 
      "ele\[Mu]_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"corte", "=", 
       RowBox[{"cortehor2xyz", "[", 
        RowBox[{"{", 
         RowBox[{
         "reli", ",", "elex", ",", "eley", ",", "elel", ",", "eled", ",", 
          "ele\[Mu]"}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"corte", "===", "\"\<Error\>\""}], ",", 
       "\"\<No hay contacto en el horizonte en ese instante\>\"", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"grad2gm", "[", 
             RowBox[{"cormerefe", "[", 
              RowBox[{
               RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"grad2gm", "[", 
             RowBox[{"latgeocen2latgeode", "[", 
              RowBox[{
               RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], 
         ",", "corte"}], "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.477142173265625*^9, {3.4772074639375*^9, 3.477207469890625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cortehor2lonlatt", "[", "t_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"h2hms", "[", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"t", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"First", "[", "fech", "]"}], "-", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}], 
         "*", "24"}], "-", 
        RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
     "]"}], ",", 
    RowBox[{"cortehor2lonlat", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"preliphor", "[", "t", "]"}], ",", 
       RowBox[{"pelex", "[", "t", "]"}], ",", 
       RowBox[{"peley", "[", "t", "]"}], ",", 
       RowBox[{"pelelp", "[", "t", "]"}], ",", 
       RowBox[{"peled", "[", "t", "]"}], ",", 
       RowBox[{"pele\[Mu]", "[", "t", "]"}]}], "}"}], "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Si", " ", "adem\[AAcute]s", " ", "de", " ", "los", " ", "puntos", " ", 
    "queremos", " ", "saber", " ", "a", " ", "qu\[EAcute]", " ", "hora", " ", 
    "ocurren"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477137101953125*^9, 3.4771371219375*^9}, {
  3.4771422768125*^9, 3.477142280578125*^9}, {3.47737171475*^9, 
  3.477371717078125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"cortehor2lonlatt", "[", "t_", "]"}], ":=", 
    RowBox[{"cortehor2lonlat", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"preliphor", "[", "t", "]"}], ",", 
       RowBox[{"pelex", "[", "t", "]"}], ",", 
       RowBox[{"peley", "[", "t", "]"}], ",", 
       RowBox[{"pelelp", "[", "t", "]"}], ",", 
       RowBox[{"peled", "[", "t", "]"}], ",", 
       RowBox[{"pele\[Mu]", "[", "t", "]"}]}], "}"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Si", " ", "s\[OAcute]lo", " ", "queremos", " ", "los", " ", "puntos", " ",
     "y", " ", "no", " ", "las", " ", "horas", " ", "a", " ", "las", " ", 
    "que", " ", "ocurren"}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.4771369626875*^9, 3.477136967671875*^9}, {
  3.477137017578125*^9, 3.477137064*^9}, {3.477137095953125*^9, 
  3.4771370995625*^9}, {3.47714228409375*^9, 3.477142286765625*^9}, {
  3.477371706046875*^9, 3.477371709765625*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Funciones corte cono de penumbra con el elipsoide ", "Subsubsection",
 CellChangeTimes->{3.4771455204375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lista\[Zeta]", "=", 
   RowBox[{"0.04", "*", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "25"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.477372549515625*^9, 3.477372587734375*^9}, {
  3.477383779046875*^9, 3.477383785625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"corteconopelip2\[Xi]\[Eta]\[Zeta]", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "eley_", ",", "eled_", ",", "ele\[Mu]_", ",", "elelp_", ",",
      "eleip_"}], "}"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "/.", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"z", "\[Equal]", "#"}], ",", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x", "-", "elex"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y", "-", "eley"}], ")"}], "2"]}], "\[Equal]", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"elelp", "-", 
                 RowBox[{"#", "*", "eleip"}]}], ")"}], "2"]}], ",", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Matcambcoor", "[", 
                    RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ")"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Matcambcoor", "[", 
                    RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ")"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ")"}], "2"], "+", 
               RowBox[{
                FractionBox["1", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox["1", "298.257"]}], ")"}], "2"]], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Matcambcoor", "[", 
                    RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ")"}], "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ")"}], "2"]}]}], 
              "\[Equal]", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ")"}], ",", 
       RowBox[{"Function", "[", 
        RowBox[{"v", ",", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "Real"}]}], 
        "]"}]}], "]"}], "&"}], ",", "lista\[Zeta]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Para", " ", "cada", " ", "plano", " ", "paralelo", " ", "a", " ", 
     "\[Zeta]", " ", "se", " ", "va", " ", "hallando", " ", "el", " ", 
     "corte", " ", "de", " ", "la", " ", "circunferencia", " ", 
     RowBox[{"(", 
      RowBox[{"debido", " ", "al", " ", "cono"}], ")"}]}], ",", " ", 
    RowBox[{"con", " ", "el", " ", 
     RowBox[{"elipsoide", ".", " ", "Se"}], " ", "mantienen", " ", 
     "s\[OAcute]lo", " ", "las", " ", "soluciones", " ", 
     RowBox[{"reales", "."}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477145233671875*^9, 3.47714535903125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"corteconopelip2xyz", "[", 
     RowBox[{"{", 
      RowBox[{
      "elex_", ",", "eley_", ",", "eled_", ",", "ele\[Mu]_", ",", "elelp_", 
       ",", "eleip_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"corte", "=", 
        RowBox[{"corteconopelip2\[Xi]\[Eta]\[Zeta]", "[", 
         RowBox[{"{", 
          RowBox[{
          "elex", ",", "eley", ",", "eled", ",", "ele\[Mu]", ",", "elelp", 
           ",", "eleip"}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"corte", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "\"\<Error\>\"", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Matcambcoor", "[", 
             RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "&"}], ",", "corte",
           ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}], "*)"}], 
  "\n"}]], "Input",
 CellChangeTimes->{{3.4771419559375*^9, 3.477141961234375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"corteconopelip2xyz", "[", 
    RowBox[{"{", 
     RowBox[{
     "elex_", ",", "eley_", ",", "eled_", ",", "ele\[Mu]_", ",", "elelp_", 
      ",", "eleip_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"corte", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"corteconopelip2\[Xi]\[Eta]\[Zeta]", "[", 
          RowBox[{"{", 
           RowBox[{
           "elex", ",", "eley", ",", "eled", ",", "ele\[Mu]", ",", "elelp", 
            ",", "eleip"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], " ", "&"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"corte", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\"\<Error\>\"", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Matcambcoor", "[", 
            RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "&"}], ",", "corte", 
         ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\[CapitalEAcute]sta", " ", "evita", " ", "corchetes", " ", 
    "vac\[IAcute]os", " ", "de", " ", "los", " ", "planos", " ", "\[Zeta]", 
    " ", "que", " ", "no", " ", "den", " ", "corte"}], " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.477141797671875*^9, 3.4771418024375*^9}, {
  3.477141836609375*^9, 3.477141849640625*^9}, {3.477141969*^9, 
  3.477142005375*^9}, {3.4771422326875*^9, 3.477142245265625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"corteconopelip2lonlat", "[", 
    RowBox[{"{", 
     RowBox[{
     "elex_", ",", "eley_", ",", "eled_", ",", "ele\[Mu]_", ",", "elelp_", 
      ",", "eleip_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"corte", "=", 
       RowBox[{"corteconopelip2xyz", "[", 
        RowBox[{"{", 
         RowBox[{
         "elex", ",", "eley", ",", "eled", ",", "ele\[Mu]", ",", "elelp", ",",
           "eleip"}], "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"corte", "===", "\"\<Error\>\""}], ",", 
       "\"\<No hay corte con elipsoide en ese instante\>\"", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"grad2gm", "[", 
             RowBox[{"cormerefe", "[", 
              RowBox[{
               RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"grad2gm", "[", 
             RowBox[{"latgeocen2latgeode", "[", 
              RowBox[{
               RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], 
         ",", "corte", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.4771421955*^9, {3.477207480421875*^9, 3.47720748415625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"corteconopelip", "[", "t_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"h2hms", "[", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"t", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"First", "[", "fech", "]"}], "-", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}], 
         "*", "24"}], "-", 
        RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
     "]"}], ",", 
    RowBox[{"corteconopelip2lonlat", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pelex", "[", "t", "]"}], ",", 
       RowBox[{"peley", "[", "t", "]"}], ",", 
       RowBox[{"peled", "[", "t", "]"}], ",", 
       RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
       RowBox[{"pelelp", "[", "t", "]"}], ",", 
       RowBox[{"peleip", "[", "t", "]"}]}], "}"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{3.477383682609375*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones curvas l\[IAcute]mite Norte y Sur por tangentear cono. \
\>", "Subsubsection",
 CellChangeTimes->{{3.477232756046875*^9, 3.477232761015625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"elxelylpipd\[Mu]2\[Zeta]Q", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Zeta]", ",", "Q"}], "}"}], ",", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Zeta]", ",", "Q"}], "}"}], "/.", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Zeta]", "==", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  SuperscriptBox["eleip", "2"]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"eled", " ", "Degree"}], "]"}], "*", 
                   RowBox[{"Sin", "[", "Q", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"deled", " ", "Degree"}], ")"}], "*", 
                   RowBox[{"Cos", "[", "Q", "]"}]}]}], ")"}]}], ")"}]}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "delelp"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"deled", " ", "Degree"}], ")"}], "*", "eley", "*", 
                "eleip"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], "*", "elex", 
                "*", 
                RowBox[{"Cos", "[", 
                 RowBox[{"eled", " ", "Degree"}], "]"}], "*", "eleip"}], "+", 
               RowBox[{
                RowBox[{"Cos", "[", "Q", "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"deley", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], "*", "elex", 
                   "*", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"eled", " ", "Degree"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"deled", " ", "Degree"}], ")"}], "*", "elelp", 
                   "*", "eleip"}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", "Q", "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"delex", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], "*", "eley", 
                   "*", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"eled", " ", "Degree"}], "]"}]}], "+", 
                  RowBox[{"elelp", "*", 
                   RowBox[{"(", 
                    RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"eled", " ", "Degree"}], "]"}], "*", "eleip"}]}], 
                 ")"}]}]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Matcambcoor", "[", 
                   RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"elex", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{"\[Zeta]", "*", "eleip"}]}], ")"}], "*", 
                    RowBox[{"Sin", "[", "Q", "]"}]}]}], ",", 
                    RowBox[{"eley", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{"\[Zeta]", "*", "eleip"}]}], ")"}], "*", 
                    RowBox[{"Cos", "[", "Q", "]"}]}]}], ",", "\[Zeta]"}], 
                   "}"}]}], ")"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Matcambcoor", "[", 
                   RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"elex", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{"\[Zeta]", "*", "eleip"}]}], ")"}], "*", 
                    RowBox[{"Sin", "[", "Q", "]"}]}]}], ",", 
                    RowBox[{"eley", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{"\[Zeta]", "*", "eleip"}]}], ")"}], "*", 
                    RowBox[{"Cos", "[", "Q", "]"}]}]}], ",", "\[Zeta]"}], 
                   "}"}]}], ")"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ")"}], "2"], "+", 
             RowBox[{
              FractionBox["1", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  FractionBox["1", "298.257"]}], ")"}], "2"]], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Matcambcoor", "[", 
                    RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"elex", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{"\[Zeta]", "*", "eleip"}]}], ")"}], "*", 
                    RowBox[{"Sin", "[", "Q", "]"}]}]}], ",", 
                    RowBox[{"eley", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{"\[Zeta]", "*", "eleip"}]}], ")"}], "*", 
                    RowBox[{"Cos", "[", "Q", "]"}]}]}], ",", "\[Zeta]"}], 
                    "}"}]}], ")"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ")"}], "2"]}]}], "\[Equal]", 
            "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Zeta]", ",", "Q"}], "}"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Positive", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[And]", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Matcambcoor", "[", 
                RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"elex", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "eleip"}]}], ")"}], 
                   "*", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"eley", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "eleip"}]}], ")"}], 
                   "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ")"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Matcambcoor", "[", 
                RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"elex", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "eleip"}]}], ")"}], 
                   "*", 
                   RowBox[{"Sin", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"eley", "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "eleip"}]}], ")"}], 
                   "*", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ")"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ")"}], "2"], "+", 
          RowBox[{
           FractionBox["1", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox["1", "298.257"]}], ")"}], "2"]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Matcambcoor", "[", 
                 RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"elex", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "eleip"}]}], ")"}], 
                    "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ",", 
                  RowBox[{"eley", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"elelp", "-", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", "eleip"}]}], ")"}], 
                    "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ")"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], ")"}], "2"]}]}], "\[Equal]", 
         "1"}]}], "&"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Utilizando", " ", "las", " ", "cuatro", " ", "condiciones", " ", 
      RowBox[{"siguientes", ":", "\[IndentingNewLine]", 
       RowBox[{
       "1", "\.ba", " ", "Est\[AAcute]n", " ", "en", " ", "el", " ", "cono", 
        " ", "luego", " ", "\[Xi]"}]}]}], "=", 
     RowBox[{
      RowBox[{"elex", "-", 
       RowBox[{"EleSin", "[", "Q", "]"}]}], "=", 
      RowBox[{
       RowBox[{"elex", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"elelp", "-", "\[Zeta]eleip"}], ")"}], 
         RowBox[{"Sin", "[", "Q", "]"}], " ", "y", " ", "\[Eta]"}]}], "=", 
       RowBox[{
        RowBox[{"eley", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"elelp", "-", "\[Zeta]eleip"}], ")"}], 
          RowBox[{"Cos", "[", "Q", "]"}], " ", "\[IndentingNewLine]", "2", 
          "\.ba", " ", 
          RowBox[{"maximizar", " ", "[", 
           RowBox[{
            RowBox[{"\[CapitalDelta]", "^", "2"}], "-", 
            RowBox[{"Ele", "^", "2"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "la", " ", "derivada", " ", "igualada", " ", "a", " ", "cero", 
             " ", "es", " ", "la", " ", "1", "\.aaecuaci\[OAcute]n"}], ",", 
            " ", 
            RowBox[{
             RowBox[{
             "que", " ", "es", " ", "m\[AAcute]s", " ", "sencilla", " ", 
              "que", " ", 
              RowBox[{"maximizar", " ", "[", 
               RowBox[{"\[CapitalDelta]", "-", "Ele"}], "]"}], " ", "y", " ", 
              "adem\[AAcute]s", " ", "es", " ", "v\[AAcute]lida", " ", "para",
               " ", "Ele"}], "<", "0"}]}], ")"}], " ", "\[IndentingNewLine]", 
          " ", "3", "\.ba", " ", "Est\[AAcute]n", " ", "en", " ", "el", " ", 
          "elipsoide", " ", "terrestre", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "\.aa", " ", "ecuaci\[OAcute]n"}], ")"}], ".", 
           "\[IndentingNewLine]", "4"}], "\.ba", " ", "\[Zeta]", " ", "por", 
          " ", "supuesto", " ", "positivo", " ", "y", " ", "vuelvo", " ", "a",
           " ", "hacer", " ", "que", " ", "este", " ", "sobre", " ", "el", 
          " ", "elpsoide", " ", "por", " ", "que", " ", "si", " ", "no", " ", 
          "da", " ", "una", " ", "solucion", " ", "falsa", 
          "\[IndentingNewLine]", "Tambi\[EAcute]n", " ", "se", " ", "utiliza",
           " ", "que", " ", 
          RowBox[{"Dt", "[", 
           RowBox[{"\[Xi]", ",", "t"}], "]"}]}]}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Zeta]Cos", "[", 
            RowBox[{"eled", " ", "Degree"}], "]"}], "-", 
           RowBox[{"\[Eta]Sin", "[", 
            RowBox[{"eled", " ", "Degree"}], "]"}]}], ")"}]}]}]}]}]}], ",", 
    " ", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"\[Eta]", ",", "t"}], "]"}], "=", 
     RowBox[{
      RowBox[{"\[Xi]", 
       RowBox[{"(", 
        RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"eled", " ", "Degree"}], "]"}]}], "-", 
      RowBox[{"\[Zeta]", 
       RowBox[{"(", 
        RowBox[{"deled", " ", "Degree"}], ")"}]}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"\[Zeta]", ",", "t"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Xi]"}], 
       RowBox[{"(", 
        RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"eled", " ", "Degree"}], "]"}]}], "+", 
      RowBox[{"\[Eta]", 
       RowBox[{"(", 
        RowBox[{"deled", " ", "Degree"}], ")"}]}]}]}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477200237171875*^9, 3.4772002400625*^9}, {
   3.477200365484375*^9, 3.477200452453125*^9}, {3.477200503640625*^9, 
   3.477200752046875*^9}, {3.477200798125*^9, 3.477200846265625*^9}, {
   3.477200887484375*^9, 3.477201161140625*^9}, {3.477201275765625*^9, 
   3.47720129753125*^9}, {3.47720706984375*^9, 3.47720724321875*^9}, {
   3.4772087359375*^9, 3.477208817828125*^9}, {3.47766353759375*^9, 
   3.477663563140625*^9}, {3.477663593453125*^9, 3.4776635971875*^9}, {
   3.477663629171875*^9, 3.477663630640625*^9}, {3.47766385603125*^9, 
   3.4776638733125*^9}, {3.47766407428125*^9, 3.477664117859375*^9}, 
   3.477664170375*^9, {3.477665091921875*^9, 3.47766510034375*^9}, {
   3.477665460046875*^9, 3.477665461734375*^9}, {3.47766617646875*^9, 
   3.47766618209375*^9}, {3.4776676045*^9, 3.4776677274375*^9}, {
   3.477668502203125*^9, 3.477668548046875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"elxelylpipd\[Mu]2xyz", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"puntos", "=", 
      RowBox[{"elxelylpipd\[Mu]2\[Zeta]Q", "[", 
       RowBox[{"{", 
        RowBox[{
        "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
         "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
         ",", "dele\[Mu]"}], "}"}], "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"puntos", "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", "\"\<Error\>\"", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Matcambcoor", "[", 
           RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"elex", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"elelp", "-", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", "eleip"}]}], ")"}], 
              "*", 
              RowBox[{"Sin", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"eley", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"elelp", "-", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", "eleip"}]}], ")"}], 
              "*", 
              RowBox[{"Cos", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "&"}], ",", 
        "puntos"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.477202724125*^9, 3.477202731625*^9}, {
  3.477209797453125*^9, 3.477209811421875*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"elxelylpipd\[Mu]2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"puntos", "=", 
      RowBox[{"elxelylpipd\[Mu]2xyz", "[", 
       RowBox[{"{", 
        RowBox[{
        "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
         "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
         ",", "dele\[Mu]"}], "}"}], "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"puntos", "===", "\"\<Error\>\""}], ",", 
      "\"\<No hay punto l\[IAcute]mite en ese instante\>\"", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"grad2gm", "[", 
            RowBox[{"cormerefe", "[", 
             RowBox[{
              RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"grad2gm", "[", 
            RowBox[{"latgeocen2latgeode", "[", 
             RowBox[{
              RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], 
        ",", "puntos"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4772027865625*^9, 3.47720279084375*^9}, {
  3.47720751128125*^9, 3.4772075189375*^9}, {3.477209823828125*^9, 
  3.477209831234375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"puntoslimitep", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"t", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}], ",", 
      RowBox[{"elxelylpipd\[Mu]2lonlat", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pelex", "[", "t", "]"}], ",", 
         RowBox[{"pdelex", "[", "t", "]"}], ",", 
         RowBox[{"peley", "[", "t", "]"}], ",", 
         RowBox[{"pdeley", "[", "t", "]"}], ",", 
         RowBox[{"pelelp", "[", "t", "]"}], ",", 
         RowBox[{"pdelelp", "[", "t", "]"}], ",", 
         RowBox[{"peleip", "[", "t", "]"}], ",", 
         RowBox[{"peled", "[", "t", "]"}], ",", 
         RowBox[{"pdeled", "[", "t", "]"}], ",", 
         RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
         RowBox[{"pdele\[Mu]", "[", "t", "]"}]}], "}"}], "]"}]}], "}"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Si", " ", "adem\[AAcute]s", " ", "de", " ", "los", " ", "puntos", " ", 
    "queremos", " ", "saber", " ", "a", " ", "qu\[EAcute]", " ", "hora", " ", 
    "ocurren"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.477202905296875*^9, 3.477202909015625*^9}, {
  3.4772030265*^9, 3.4772030321875*^9}, {3.477660288328125*^9, 
  3.477660290859375*^9}, {3.477746205234375*^9, 3.47774620878125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"puntoslimitep", "[", "t_", "]"}], ":=", 
   RowBox[{"elxelylpipd\[Mu]2lonlat", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pelex", "[", "t", "]"}], ",", 
      RowBox[{"pdelex", "[", "t", "]"}], ",", 
      RowBox[{"peley", "[", "t", "]"}], ",", 
      RowBox[{"pdeley", "[", "t", "]"}], ",", 
      RowBox[{"pelelp", "[", "t", "]"}], ",", 
      RowBox[{"pdelelp", "[", "t", "]"}], ",", 
      RowBox[{"peleip", "[", "t", "]"}], ",", 
      RowBox[{"peled", "[", "t", "]"}], ",", 
      RowBox[{"pdeled", "[", "t", "]"}], ",", 
      RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
      RowBox[{"pdele\[Mu]", "[", "t", "]"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Si", " ", "s\[OAcute]lo", " ", "queremos", " ", "los", " ", "puntos", " ",
     "y", " ", "no", " ", "las", " ", "horas", " ", "a", " ", "las", " ", 
    "que", " ", "ocurren"}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.4771369626875*^9, 3.477136967671875*^9}, {
   3.477137017578125*^9, 3.477137064*^9}, {3.477137095953125*^9, 
   3.4771370995625*^9}, {3.47714228409375*^9, 3.477142286765625*^9}, 
   3.4772029431875*^9, {3.477203019890625*^9, 3.477203022828125*^9}, {
   3.477660279734375*^9, 3.477660282953125*^9}, {3.47774621175*^9, 
   3.477746214375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"puntoslimites", "[", "t_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"h2hms", "[", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"t", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"First", "[", "fech", "]"}], "-", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}], 
         "*", "24"}], "-", 
        RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
     "]"}], ",", 
    RowBox[{"elxelylpipd\[Mu]2lonlat", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pelex", "[", "t", "]"}], ",", 
       RowBox[{"pdelex", "[", "t", "]"}], ",", 
       RowBox[{"peley", "[", "t", "]"}], ",", 
       RowBox[{"pdeley", "[", "t", "]"}], ",", 
       RowBox[{"pelels", "[", "t", "]"}], ",", 
       RowBox[{"pdelels", "[", "t", "]"}], ",", 
       RowBox[{"peleis", "[", "t", "]"}], ",", 
       RowBox[{"peled", "[", "t", "]"}], ",", 
       RowBox[{"pdeled", "[", "t", "]"}], ",", 
       RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
       RowBox[{"pdele\[Mu]", "[", "t", "]"}]}], "}"}], "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Si", " ", "adem\[AAcute]s", " ", "de", " ", "los", " ", "puntos", " ", 
    "queremos", " ", "saber", " ", "a", " ", "qu\[EAcute]", " ", "hora", " ", 
    "ocurren"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.47720305915625*^9, 3.4772030621875*^9}, {
  3.477203197390625*^9, 3.47720320340625*^9}, {3.47766825584375*^9, 
  3.477668260828125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"puntoslimites", "[", "t_", "]"}], ":=", 
    RowBox[{"elxelylpipd\[Mu]2lonlat", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pelex", "[", "t", "]"}], ",", 
       RowBox[{"pdelex", "[", "t", "]"}], ",", 
       RowBox[{"peley", "[", "t", "]"}], ",", 
       RowBox[{"pdeley", "[", "t", "]"}], ",", 
       RowBox[{"pelels", "[", "t", "]"}], ",", 
       RowBox[{"pdelels", "[", "t", "]"}], ",", 
       RowBox[{"peleis", "[", "t", "]"}], ",", 
       RowBox[{"peled", "[", "t", "]"}], ",", 
       RowBox[{"pdeled", "[", "t", "]"}], ",", 
       RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
       RowBox[{"pdele\[Mu]", "[", "t", "]"}]}], "}"}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Si", " ", "s\[OAcute]lo", " ", "queremos", " ", "los", " ", "puntos", " ",
     "y", " ", "no", " ", "las", " ", "horas", " ", "a", " ", "las", " ", 
    "que", " ", "ocurren"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.47720305915625*^9, 3.4772030621875*^9}, {
  3.477203177515625*^9, 3.477203191359375*^9}, {3.477668264203125*^9, 
  3.4776682676875*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones curvas l\[IAcute]mite Norte y Sur debido a estar el eclipse por \
debajo del horizonte. \
\>", "Subsubsection",
 CellChangeTimes->{{3.4772323120625*^9, 3.477232372484375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"climite2\[Xi]\[Eta]\[Zeta]", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}], "/.", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Zeta]", "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Xi]", "2"], "+", 
           FractionBox[
            SuperscriptBox["\[Eta]", "2"], 
            SuperscriptBox["reliphor", "2"]]}], "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"deled", " ", "Degree"}], ")"}], " ", "\[Eta]"}], " ", 
            "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], " ", "\[Xi]", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"eled", " ", "Degree"}], "]"}]}]}], ")"}], "\[Equal]", 
          "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}]}], "]"}]}], 
    ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "Real"}], 
      "\[And]", " ", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"elex", "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"eley", "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"]}]], "\[LessEqual]",
        "elelp"}]}], " ", "&"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Utilizando", " ", "las", " ", "tres", " ", "condiciones", " ", 
     RowBox[{"siguientes", ":", "\[IndentingNewLine]", "  ", 
      RowBox[{
      "1", "\.ba", " ", "Est\[AAcute]n", " ", "en", " ", "el", " ", 
       "horizonte"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"luego", " ", "\[Zeta]"}], "=", 
     RowBox[{"0", " ", "y", " ", "\[Xi]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "\[Eta]", " ", "est\[AAcute]n", " ", "relacionadas", " ", "por", " ", 
       "la", " ", "elipse", " ", "fundamental", " ", 
       RowBox[{"(", 
        RowBox[{"1", "\.aa", " ", "ecuaci\[OAcute]n"}], ")"}], 
       "\[IndentingNewLine]", "   ", "2", "\.ba", " ", 
       RowBox[{"maximizar", " ", "[", "\[Zeta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
        "la", " ", "derivada", " ", "igualada", " ", "a", " ", "cero", " ", 
         "es", " ", "la", " ", "2", "\.aaecuaci\[OAcute]n"}], ")"}], " ", 
       "\[IndentingNewLine]", "3", "\.ba", " ", "Est\[AAcute]n", " ", 
       "dentro", " ", "del", " ", "cono", " ", "por", " ", "eso", " ", "son", 
       " ", "puntos", " ", "reales", " ", "y", " ", "\[CapitalDelta]"}], "<=", 
      RowBox[{
       RowBox[{"elelp", ".", " ", "\[IndentingNewLine]", "Se"}], " ", 
       "utiliza", " ", "que", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"\[Zeta]", ",", "t"}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Xi]"}], 
       RowBox[{"(", 
        RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"eled", " ", "Degree"}], "]"}]}], "+", 
      RowBox[{"\[Eta]", 
       RowBox[{"(", 
        RowBox[{"deled", " ", "Degree"}], ")"}]}]}]}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.47720822240625*^9, 3.47720823446875*^9}, {
   3.477208472484375*^9, 3.47720857590625*^9}, {3.477208612859375*^9, 
   3.47720870334375*^9}, {3.47720879059375*^9, 3.477208796359375*^9}, 
   3.4772088309375*^9, {3.477232527140625*^9, 3.4772325926875*^9}, {
   3.477232623921875*^9, 3.477232660578125*^9}, 3.477233076953125*^9, {
   3.47723312415625*^9, 3.477233148828125*^9}, 3.477233199484375*^9, {
   3.47723323440625*^9, 3.47723323915625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"climite2xyz", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"puntos", "=", 
      RowBox[{"climite2\[Xi]\[Eta]\[Zeta]", "[", 
       RowBox[{"{", 
        RowBox[{
        "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
         "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
         ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"puntos", "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", "\"\<Error\>\"", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Matcambcoor", "[", 
           RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "&"}], ",", 
        "puntos"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.477209282390625*^9, {3.477209322796875*^9, 3.477209387546875*^9}, {
   3.47720964296875*^9, 3.47720966065625*^9}, {3.477233488875*^9, 
   3.477233500015625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"climite2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"puntos", "=", 
      RowBox[{"climite2xyz", "[", 
       RowBox[{"{", 
        RowBox[{
        "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
         "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
         ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"puntos", "===", "\"\<Error\>\""}], ",", 
      "\"\<No hay puntos limite en ese instante\>\"", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"grad2gm", "[", 
            RowBox[{"cormerefe", "[", 
             RowBox[{
              RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"grad2gm", "[", 
            RowBox[{"latgeocen2latgeode", "[", 
             RowBox[{
              RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], 
        ",", "puntos"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.477209698765625*^9, 3.47720974465625*^9}, {
  3.477233522796875*^9, 3.47723356409375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"climite", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"t", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}], ",", 
      RowBox[{"climite2lonlat", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pelex", "[", "t", "]"}], ",", 
         RowBox[{"pdelex", "[", "t", "]"}], ",", 
         RowBox[{"peley", "[", "t", "]"}], ",", 
         RowBox[{"pdeley", "[", "t", "]"}], ",", 
         RowBox[{"pelelp", "[", "t", "]"}], ",", 
         RowBox[{"pdelelp", "[", "t", "]"}], ",", 
         RowBox[{"peleip", "[", "t", "]"}], ",", 
         RowBox[{"peled", "[", "t", "]"}], ",", 
         RowBox[{"pdeled", "[", "t", "]"}], ",", 
         RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
         RowBox[{"pdele\[Mu]", "[", "t", "]"}], ",", 
         RowBox[{"preliphor", "[", "t", "]"}]}], "}"}], "]"}]}], "}"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Si", " ", "adem\[AAcute]s", " ", "de", " ", "los", " ", "puntos", " ", 
    "queremos", " ", "saber", " ", "a", " ", "qu\[EAcute]", " ", "hora", " ", 
    "ocurren"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.477209879828125*^9, 3.477209891484375*^9}, {
  3.477233604953125*^9, 3.477233627390625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"climite", "[", "t_", "]"}], ":=", 
  RowBox[{"climite2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pelex", "[", "t", "]"}], ",", 
     RowBox[{"pdelex", "[", "t", "]"}], ",", 
     RowBox[{"peley", "[", "t", "]"}], ",", 
     RowBox[{"pdeley", "[", "t", "]"}], ",", 
     RowBox[{"pelelp", "[", "t", "]"}], ",", 
     RowBox[{"pdelelp", "[", "t", "]"}], ",", 
     RowBox[{"peleip", "[", "t", "]"}], ",", 
     RowBox[{"peled", "[", "t", "]"}], ",", 
     RowBox[{"pdeled", "[", "t", "]"}], ",", 
     RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
     RowBox[{"pdele\[Mu]", "[", "t", "]"}], ",", 
     RowBox[{"preliphor", "[", "t", "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Si", " ", "s\[OAcute]lo", " ", "queremos", " ", "los", " ", "puntos", " ",
     "y", " ", "no", " ", "las", " ", "horas", " ", "a", " ", "las", " ", 
    "que", " ", "ocurren"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477209911640625*^9, 3.47720993346875*^9}, {
  3.47723361703125*^9, 3.47723363284375*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.477232392625*^9, 3.477232395328125*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones curvas de m\[AAcute]ximo de eclipse al orto/ocaso. \
\>", "Subsubsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxhor2\[Xi]\[Eta]\[Zeta]", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}], "/.", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Zeta]", "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[Xi]", "2"], "+", 
           FractionBox[
            SuperscriptBox["\[Eta]", "2"], 
            SuperscriptBox["reliphor", "2"]]}], "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", 
              RowBox[{"(", 
               RowBox[{"elex", "-", "\[Xi]"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"delex", "+", 
                RowBox[{"\[Eta]", " ", 
                 RowBox[{"(", 
                  RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"eled", " ", "Degree"}], "]"}]}]}], ")"}]}], "+", 
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "\[Eta]"}], "+", "eley"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"deley", "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], " ", "\[Xi]", 
                 " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"eled", " ", "Degree"}], "]"}]}]}], ")"}]}]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"elex", "-", "\[Xi]"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"eley", "-", "\[Eta]"}], ")"}], "2"]}]]}], ")"}]}], 
          "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}]}], "]"}]}], 
    ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "Real"}], 
      "\[And]", " ", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"elex", "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"eley", "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"]}]], "\[LessEqual]",
        "elelp"}]}], " ", "&"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Utilizando", " ", "las", " ", "tres", " ", "condiciones", " ", 
     RowBox[{"siguientes", ":", "\[IndentingNewLine]", "  ", 
      RowBox[{
      "1", "\.ba", " ", "Est\[AAcute]n", " ", "en", " ", "el", " ", 
       "horizonte"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"luego", " ", "\[Zeta]"}], "=", 
     RowBox[{"0", " ", "y", " ", "\[Xi]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "\[Eta]", " ", "est\[AAcute]n", " ", "relacionadas", " ", "por", " ", 
       "la", " ", "elipse", " ", "fundamental", " ", 
       RowBox[{"(", 
        RowBox[{"1", "\.aa", " ", "ecuaci\[OAcute]n"}], ")"}], 
       "\[IndentingNewLine]", "   ", "2", "\.ba", " ", 
       RowBox[{"minimizar", " ", "[", "\[CapitalDelta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
        "la", " ", "derivada", " ", "igualada", " ", "a", " ", "cero", " ", 
         "es", " ", "la", " ", "2", "\.aaecuaci\[OAcute]n"}], ")"}], " ", 
       "\[IndentingNewLine]", "3", "\.ba", " ", "Est\[AAcute]n", " ", 
       "viendo", " ", "el", " ", "eclipse", " ", "por", " ", "eso", " ", 
       "son", " ", "puntos", " ", "reales", " ", "y", " ", 
       "\[CapitalDelta]"}], "<=", 
      RowBox[{
       RowBox[{"elelp", ".", " ", "\[IndentingNewLine]", "Tambi\[EAcute]n"}], 
       " ", "se", " ", "utiliza", " ", "que", " ", 
       RowBox[{"Dt", "[", 
        RowBox[{"\[Xi]", ",", "t"}], "]"}]}]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Zeta]Cos", "[", 
         RowBox[{"eled", " ", "Degree"}], "]"}], "-", 
        RowBox[{"\[Eta]Sin", "[", 
         RowBox[{"eled", " ", "Degree"}], "]"}]}], ")"}]}]}], ",", "     ", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"\[Eta]", ",", "t"}], "]"}], "=", 
     RowBox[{
      RowBox[{"\[Xi]", 
       RowBox[{"(", 
        RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], 
       RowBox[{"Sin", "[", 
        RowBox[{"eled", " ", "Degree"}], "]"}]}], "-", 
      RowBox[{"\[Zeta]", 
       RowBox[{"(", 
        RowBox[{"deled", " ", "Degree"}], ")"}]}]}]}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.47720822240625*^9, 3.47720823446875*^9}, {
   3.477208472484375*^9, 3.47720857590625*^9}, {3.477208612859375*^9, 
   3.47720870334375*^9}, {3.47720879059375*^9, 3.477208796359375*^9}, 
   3.4772088309375*^9, {3.477232910421875*^9, 3.47723292175*^9}, {
   3.477721043765625*^9, 3.477721051125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxhor2xyz", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"puntos", "=", 
      RowBox[{"maxhor2\[Xi]\[Eta]\[Zeta]", "[", 
       RowBox[{"{", 
        RowBox[{
        "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
         "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
         ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"puntos", "\[Equal]", 
       RowBox[{"{", "}"}]}], ",", "\"\<Error\>\"", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Matcambcoor", "[", 
           RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "&"}], ",", 
        "puntos"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.477209282390625*^9, {3.477209322796875*^9, 3.477209387546875*^9}, {
   3.47720964296875*^9, 3.47720966065625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxhor2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"puntos", "=", 
      RowBox[{"maxhor2xyz", "[", 
       RowBox[{"{", 
        RowBox[{
        "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
         "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
         ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"puntos", "===", "\"\<Error\>\""}], ",", 
      "\"\<No hay m\[AAcute]ximo en el horizonte en ese instante\>\"", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"grad2gm", "[", 
            RowBox[{"cormerefe", "[", 
             RowBox[{
              RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"grad2gm", "[", 
            RowBox[{"latgeocen2latgeode", "[", 
             RowBox[{
              RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], 
        ",", "puntos"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.477209698765625*^9, 3.47720974465625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"maxhor", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"t", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}], ",", 
      RowBox[{"maxhor2lonlat", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"pelex", "[", "t", "]"}], ",", 
         RowBox[{"pdelex", "[", "t", "]"}], ",", 
         RowBox[{"peley", "[", "t", "]"}], ",", 
         RowBox[{"pdeley", "[", "t", "]"}], ",", 
         RowBox[{"pelelp", "[", "t", "]"}], ",", 
         RowBox[{"pdelelp", "[", "t", "]"}], ",", 
         RowBox[{"peleip", "[", "t", "]"}], ",", 
         RowBox[{"peled", "[", "t", "]"}], ",", 
         RowBox[{"pdeled", "[", "t", "]"}], ",", 
         RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
         RowBox[{"pdele\[Mu]", "[", "t", "]"}], ",", 
         RowBox[{"preliphor", "[", "t", "]"}]}], "}"}], "]"}]}], "}"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Si", " ", "adem\[AAcute]s", " ", "de", " ", "los", " ", "puntos", " ", 
    "queremos", " ", "saber", " ", "a", " ", "qu\[EAcute]", " ", "hora", " ", 
    "ocurren"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.477209879828125*^9, 3.477209891484375*^9}, {
  3.47765712228125*^9, 3.477657125015625*^9}, {3.47774340528125*^9, 
  3.477743410109375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxhor", "[", "t_", "]"}], ":=", 
  RowBox[{"maxhor2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pelex", "[", "t", "]"}], ",", 
     RowBox[{"pdelex", "[", "t", "]"}], ",", 
     RowBox[{"peley", "[", "t", "]"}], ",", 
     RowBox[{"pdeley", "[", "t", "]"}], ",", 
     RowBox[{"pelelp", "[", "t", "]"}], ",", 
     RowBox[{"pdelelp", "[", "t", "]"}], ",", 
     RowBox[{"peleip", "[", "t", "]"}], ",", 
     RowBox[{"peled", "[", "t", "]"}], ",", 
     RowBox[{"pdeled", "[", "t", "]"}], ",", 
     RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
     RowBox[{"pdele\[Mu]", "[", "t", "]"}], ",", 
     RowBox[{"preliphor", "[", "t", "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Si", " ", "s\[OAcute]lo", " ", "queremos", " ", "los", " ", "puntos", " ",
     "y", " ", "no", " ", "las", " ", "horas", " ", "a", " ", "las", " ", 
    "que", " ", "ocurren"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477209911640625*^9, 3.47720993346875*^9}, {
  3.477657129671875*^9, 3.4776571348125*^9}, {3.477743413078125*^9, 
  3.477743421171875*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.47765715596875*^9, 3.477657156765625*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Funciones para hallar los puntos de corte de las curvas de m\[AAcute]ximo en \
el horizonte con las l\[IAcute]mites Norte y Sur de conos de penumbra y de \
sombra\
\>", "Subsubsection",
 CellChangeTimes->{{3.477231445515625*^9, 3.47723147709375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Para", " ", "ello", " ", "hallamos", " ", "los", " ", "puntos", " ", 
     "de", " ", "m\[AAcute]ximo", " ", "en", " ", "el", " ", "horizonte", " ",
      "para", " ", "los", " ", "que", " ", "adem\[AAcute]s", " ", 
     "\[CapitalDelta]"}], "=", 
    RowBox[{
     RowBox[{"Abs", "[", "elelp", "]"}], " ", "o", " ", 
     RowBox[{"Abs", "[", "elels", "]"}]}]}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"maxhorbis2\[Xi]\[Eta]\[Zeta]", "[", 
     RowBox[{"{", 
      RowBox[{
      "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",",
        "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", 
       "ele\[Mu]_", ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}], "/.", 
       RowBox[{"NSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Zeta]", "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[Xi]", "2"], "+", 
             FractionBox[
              SuperscriptBox["\[Eta]", "2"], 
              SuperscriptBox["reliphor", "2"]]}], "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", "*", 
                 RowBox[{"(", 
                  RowBox[{"elex", "-", "\[Xi]"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"delex", "+", 
                   RowBox[{"\[Eta]", " ", 
                    RowBox[{"(", 
                    RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"eled", " ", "Degree"}], "]"}]}]}], ")"}]}], "+", 
                RowBox[{"2", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "\[Eta]"}], "+", "eley"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"deley", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], " ", "\[Xi]",
                     " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"eled", " ", "Degree"}], "]"}]}]}], ")"}]}]}], 
               ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", 
                SqrtBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"elex", "-", "\[Xi]"}], ")"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"eley", "-", "\[Eta]"}], ")"}], "2"]}]]}], 
               ")"}]}], "+", 
             RowBox[{
              RowBox[{"Sign", "[", "elelp", "]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "delelp"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"deled", " ", "Degree"}], ")"}], " ", "\[Eta]"}], 
                   " ", "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], " ", "\[Xi]",
                     " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"eled", " ", "Degree"}], "]"}]}]}], ")"}], 
                 "eleip"}]}], ")"}]}]}], "\[Equal]", "0"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}]}], "]"}]}], 
      ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", "Real"}], " ", 
       "&"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Utilizando", " ", "las", " ", "tres", " ", "condiciones", " ", 
      RowBox[{"siguientes", ":", "\[IndentingNewLine]", "  ", 
       RowBox[{
       "1", "\.ba", " ", "Est\[AAcute]n", " ", "en", " ", "el", " ", 
        "horizonte"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"luego", " ", "\[Zeta]"}], "=", 
      RowBox[{"0", " ", "y", " ", "\[Xi]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "\[Eta]", " ", "est\[AAcute]n", " ", "relacionadas", " ", "por", " ", 
        "la", " ", "elipse", " ", "fundamental", " ", 
        RowBox[{"(", 
         RowBox[{"1", "\.aa", " ", "ecuaci\[OAcute]n"}], ")"}], 
        "\[IndentingNewLine]", "   ", "2", "\.ba", " ", 
        RowBox[{"minimizar", " ", "[", 
         RowBox[{"\[CapitalDelta]", "-", "ele"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
         "la", " ", "derivada", " ", "igualada", " ", "a", " ", "cero", " ", 
          "es", " ", "la", " ", "2", "\.aaecuaci\[OAcute]n"}], ")"}], " ", 
        "\[IndentingNewLine]", "3", "\.ba", " ", "Son", " ", "puntos", " ", 
        "reales", " ", "aunque", " ", "nos", " ", "quedamos", " ", "tanto", 
        " ", "con", " ", "los", " ", "\[CapitalDelta]"}], "<=", 
       RowBox[{
       "ele", " ", "como", " ", "con", " ", "los", " ", "\[CapitalDelta]"}], 
       ">", 
       RowBox[{
       "eley", "  ", "\[IndentingNewLine]", "Tambi\[EAcute]n", " ", "se", " ",
         "utiliza", " ", "que", " ", 
        RowBox[{"Dt", "[", 
         RowBox[{"\[Xi]", ",", "t"}], "]"}]}]}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]Cos", "[", 
          RowBox[{"eled", " ", "Degree"}], "]"}], "-", 
         RowBox[{"\[Eta]Sin", "[", 
          RowBox[{"eled", " ", "Degree"}], "]"}]}], ")"}]}]}], ",", "     ", 
     RowBox[{
      RowBox[{"Dt", "[", 
       RowBox[{"\[Eta]", ",", "t"}], "]"}], "=", 
      RowBox[{
       RowBox[{"\[Xi]", 
        RowBox[{"(", 
         RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], 
        RowBox[{"Sin", "[", 
         RowBox[{"eled", " ", "Degree"}], "]"}]}], "-", 
       RowBox[{"\[Zeta]", 
        RowBox[{"(", 
         RowBox[{"deled", " ", "Degree"}], ")"}]}]}]}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Dt", "[", 
       RowBox[{"\[Zeta]", ",", "t"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Xi]"}], 
        RowBox[{"(", 
         RowBox[{"dele\[Mu]", " ", "Degree"}], ")"}], 
        RowBox[{"Cos", "[", 
         RowBox[{"eled", " ", "Degree"}], "]"}]}], "+", 
       RowBox[{"\[Eta]", 
        RowBox[{"(", 
         RowBox[{"deled", " ", "Degree"}], ")"}], " ", "\[IndentingNewLine]", 
        "El", " ", 
        RowBox[{"Sign", "[", "]"}], " ", "lo", " ", "pongo", " ", "para", " ",
         "que", " ", "valga", " ", "tanto", " ", "para", " ", "elelp", " ", 
        "como", " ", "para", " ", "elels", " ", "que", " ", "puede", " ", 
        "ser", " ", "negativo"}]}]}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.47722230140625*^9, 3.477222316875*^9}, {
  3.477222349171875*^9, 3.477222513296875*^9}, {3.4772243584375*^9, 
  3.4772243613125*^9}, {3.477228644375*^9, 3.477228659453125*^9}, {
  3.47722983190625*^9, 3.477229867828125*^9}, {3.47722991759375*^9, 
  3.477229963625*^9}, {3.477230723046875*^9, 3.4772307481875*^9}, {
  3.47723148309375*^9, 3.477231483875*^9}, {3.477232896875*^9, 
  3.47723289934375*^9}, {3.4772329438125*^9, 3.4772330431875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dismaxcono", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", "elex"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", "eley"}], ")"}], "2"]}], 
       "]"}], "-", 
      RowBox[{"Abs", "[", "elelp", "]"}]}], "&"}], ",", 
    RowBox[{"maxhorbis2\[Xi]\[Eta]\[Zeta]", "[", 
     RowBox[{"{", 
      RowBox[{
      "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
       "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
       ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Devuelve", " ", "la", " ", "distancia", " ", "con", " ", "signo", " ", 
    "al", " ", "borde", " ", "del", " ", "cono", " ", "de", " ", "cada", " ", 
    "valor", " ", "obtenido", " ", "con", " ", 
    "maxhorbis2\[Xi]\[Eta]\[Zeta]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477222659390625*^9, 3.477222718140625*^9}, {
  3.47722288515625*^9, 3.47722288734375*^9}, {3.477223122515625*^9, 
  3.477223126046875*^9}, {3.47723045753125*^9, 3.47723046196875*^9}, {
  3.477230613734375*^9, 3.47723062115625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"minabssinsign", "[", "l_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"Min", "[", 
    RowBox[{"Abs", "[", "l", "]"}], "]"}], "}"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "funci\[OAcute]n", " ", "que", " ", "devuelve", " ", "el", " ", "menor", 
      " ", "valor"}], " ", "}"}], "absoluto", " ", "de", " ", "los", " ", 
    "elementos", " ", "de", " ", "la", " ", "lista"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.477222575109375*^9, 3.47722262509375*^9}, {
  3.47722644215625*^9, 3.4772264435625*^9}, {3.477720322265625*^9, 
  3.477720446734375*^9}, {3.4777234085*^9, 3.4777234166875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"minabsconsign", "[", "l_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"min", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Abs", "[", "l", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"Select", "[", 
     RowBox[{"l", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "#", "]"}], "\[Equal]", "min"}], "&"}]}], "]"}]}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "funci\[OAcute]n", " ", "que", " ", "devuelve", " ", "el", " ", 
     "elemento", " ", "de", " ", "la", " ", "lista", " ", "de", " ", "menor", 
     " ", "valor", " ", "absoluto"}], ",", " ", 
    RowBox[{"pero", " ", "con", " ", "su", " ", "signo"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477222575109375*^9, 3.47722262509375*^9}, {
  3.47722644215625*^9, 3.4772264435625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dismaxconosinsign", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "aux", "}"}], ",", 
    RowBox[{
     RowBox[{"aux", "=", 
      RowBox[{"minabssinsign", "[", 
       RowBox[{"dismaxcono", "[", 
        RowBox[{"{", 
         RowBox[{
         "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
          "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
          ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"aux", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "0.1", ",", 
       RowBox[{"aux", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Devuelve", " ", "la", " ", "distancia", " ", "del", " ", "elemento", " ", 
    "de", " ", "maxhorbis2\[Xi]\[Eta]\[Zeta]", " ", "que", " ", "tiene", " ", 
    "menor", " ", "distancia", " ", "al", " ", "borde", " ", "del", " ", 
    RowBox[{"cono", ".", " ", "Si"}], " ", "no", " ", "hab\[IAcute]a", " ", 
    "elemento", " ", "devuelve", " ", "una", " ", "d\[EAcute]cima", " ", "de",
     " ", "unidad", " ", "ecuatorial", " ", "de", " ", 
    RowBox[{"distancia", "."}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477222739359375*^9, 3.4772227419375*^9}, {
   3.477222774921875*^9, 3.47722283896875*^9}, {3.47722294840625*^9, 
   3.477222956125*^9}, {3.47722595509375*^9, 3.47722596434375*^9}, 
   3.477226812265625*^9, {3.47723062596875*^9, 3.477230636625*^9}, {
   3.477295631546875*^9, 3.477295656625*^9}, {3.47772063490625*^9, 
   3.477720643671875*^9}, {3.477720684484375*^9, 3.477720730328125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dismaxconosign", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "aux", "}"}], ",", 
    RowBox[{
     RowBox[{"aux", "=", 
      RowBox[{"minabsconsign", "[", 
       RowBox[{"dismaxcono", "[", 
        RowBox[{"{", 
         RowBox[{
         "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
          "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
          ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"aux", "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", "\"\<error\>\"", ",", 
       RowBox[{"aux", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Devuelve", " ", "la", " ", "distancia", " ", "con", " ", "signo"}], ",", 
    " ", 
    RowBox[{
    "del", " ", "elemento", " ", "de", " ", "maxhorbis2\[Xi]\[Eta]\[Zeta]", 
     " ", "que", " ", "tiene", " ", "menor", " ", "distancia", " ", "al", " ",
      "borde", " ", "del", " ", 
     RowBox[{"cono", ".", " ", "Si"}], " ", "no", " ", "hab\[IAcute]a", " ", 
     "elemento", " ", "devuelve", " ", "una", " ", "d\[EAcute]cima", " ", 
     "de", " ", "unidad", " ", "ecuatorial", " ", "de", " ", "distancia", " ",
      "en", " ", 
     RowBox[{"negativo", "."}]}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477222739359375*^9, 3.4772227419375*^9}, {
   3.477222774921875*^9, 3.47722283896875*^9}, {3.47722294840625*^9, 
   3.477222956125*^9}, {3.47722595509375*^9, 3.47722596434375*^9}, 
   3.477226812265625*^9, {3.47723062596875*^9, 3.477230636625*^9}, {
   3.477295631546875*^9, 3.477295656625*^9}, {3.477728719140625*^9, 
   3.477728726015625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"maxhorbisselec\[Xi]\[Eta]\[Zeta]", "[", 
    RowBox[{"{", 
     RowBox[{
     "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
      "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_",
       ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "dismin", "}"}], ",", 
     RowBox[{
      RowBox[{"dismin", "=", 
       RowBox[{"dismaxconosign", "[", 
        RowBox[{"{", 
         RowBox[{
         "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
          "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
          ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}]}], " ", ";", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"maxhorbis2\[Xi]\[Eta]\[Zeta]", "[", 
         RowBox[{"{", 
          RowBox[{
          "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
           "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]",
            ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "-", "elex"}], ")"}], "2"], 
             "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "eley"}], ")"}], "2"]}],
             "]"}], "-", 
           RowBox[{"Abs", "[", "elelp", "]"}]}], "\[Equal]", "dismin"}], 
         "&"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Se", " ", "queda", " ", "con", " ", "el", " ", "punto", " ", "que", " ", 
    "est\[AAcute]", " ", "m\[AAcute]s", " ", "cerca", " ", "al", " ", "borde",
     " ", "del", " ", "cono"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "No", " ", "pongo", " ", "condici\[OAcute]n", " ", "de", " ", "que", " ", 
     "exista", " ", "punto", " ", "ya", " ", "que", " ", "esta", " ", 
     "funci\[OAcute]n", " ", "s\[OAcute]lo", " ", "se", " ", "utiliza", " ", 
     "para", " ", "el", " ", "instante", " ", "del", " ", "punto", " ", 
     "extremo"}], ",", " ", 
    RowBox[{
    "y", " ", "ya", " ", "se", " ", "ha", " ", "constatado", " ", "que", " ", 
     "existe"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477227430921875*^9, 3.477227530515625*^9}, {
  3.477229023828125*^9, 3.4772290264375*^9}, {3.477230510078125*^9, 
  3.47723051425*^9}, {3.477230644890625*^9, 3.47723065415625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxhorbis2xyz", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Matcambcoor", "[", 
       RowBox[{"eled", ",", "ele\[Mu]"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "&"}], ",", 
    RowBox[{"maxhorbisselec\[Xi]\[Eta]\[Zeta]", "[", 
     RowBox[{"{", 
      RowBox[{
      "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
       "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
       ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxhorbis2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
    "elex_", ",", "delex_", ",", "eley_", ",", "deley_", ",", "elelp_", ",", 
     "delelp_", ",", "eleip_", ",", "eled_", ",", "deled_", ",", "ele\[Mu]_", 
     ",", "dele\[Mu]_", ",", "reliphor_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"puntos", "=", 
      RowBox[{"maxhorbis2xyz", "[", 
       RowBox[{"{", 
        RowBox[{
        "elex", ",", "delex", ",", "eley", ",", "deley", ",", "elelp", ",", 
         "delelp", ",", "eleip", ",", "eled", ",", "deled", ",", "ele\[Mu]", 
         ",", "dele\[Mu]", ",", "reliphor"}], "}"}], "]"}]}], "}"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"grad2gm", "[", 
          RowBox[{"cormerefe", "[", 
           RowBox[{
            RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"grad2gm", "[", 
          RowBox[{"latgeocen2latgeode", "[", 
           RowBox[{
            RowBox[{"cart2ecu", "[", "#", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], ",",
       "puntos"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxhorbisp", "[", "t_", "]"}], ":=", 
  RowBox[{"maxhorbis2lonlat", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pelex", "[", "t", "]"}], ",", 
     RowBox[{"pdelex", "[", "t", "]"}], ",", 
     RowBox[{"peley", "[", "t", "]"}], ",", 
     RowBox[{"pdeley", "[", "t", "]"}], ",", 
     RowBox[{"pelelp", "[", "t", "]"}], ",", 
     RowBox[{"pdelelp", "[", "t", "]"}], ",", 
     RowBox[{"peleip", "[", "t", "]"}], ",", 
     RowBox[{"peled", "[", "t", "]"}], ",", 
     RowBox[{"pdeled", "[", "t", "]"}], ",", 
     RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
     RowBox[{"pdele\[Mu]", "[", "t", "]"}], ",", 
     RowBox[{"preliphor", "[", "t", "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Para", " ", "la", " ", "penumbra", " ", "s\[OAcute]lo", " ", "queremos", 
    " ", "los", " ", "puntos", " ", "y", " ", "no", " ", "las", " ", "horas", 
    " ", "a", " ", "las", " ", "que", " ", "ocurren"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.47722609803125*^9, 3.477226124375*^9}, {
  3.477230690140625*^9, 3.477230696203125*^9}, {3.477231034859375*^9, 
  3.477231059984375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxhorbiss", "[", "t_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"h2hms", "[", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"t", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"First", "[", "fech", "]"}], "-", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}], 
         "*", "24"}], "-", 
        RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
     "]"}], ",", 
    RowBox[{"maxhorbis2lonlat", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pelex", "[", "t", "]"}], ",", 
       RowBox[{"pdelex", "[", "t", "]"}], ",", 
       RowBox[{"peley", "[", "t", "]"}], ",", 
       RowBox[{"pdeley", "[", "t", "]"}], ",", 
       RowBox[{"pelels", "[", "t", "]"}], ",", 
       RowBox[{"pdelels", "[", "t", "]"}], ",", 
       RowBox[{"peleip", "[", "t", "]"}], ",", 
       RowBox[{"peled", "[", "t", "]"}], ",", 
       RowBox[{"pdeled", "[", "t", "]"}], ",", 
       RowBox[{"pele\[Mu]", "[", "t", "]"}], ",", 
       RowBox[{"pdele\[Mu]", "[", "t", "]"}], ",", 
       RowBox[{"preliphor", "[", "t", "]"}]}], "}"}], "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Para", " ", "la", " ", "sombra", " ", "adem\[AAcute]s", " ", "de", " ", 
    "los", " ", "puntos", " ", "queremos", " ", "saber", " ", "a", " ", 
    "qu\[EAcute]", " ", "hora", " ", "ocurren"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477226057140625*^9, 3.477226061421875*^9}, {
  3.477226982359375*^9, 3.477226987125*^9}, {3.47723068284375*^9, 
  3.47723068696875*^9}, {3.47723107103125*^9, 3.4772310909375*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constantes y par\[AAcute]metros.", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"int", "=", "1"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "int", " ", "es", " ", "el", " ", "intervalo", " ", "de", " ", "tiempo", 
    " ", "en", " ", "minutos", " ", "entre", " ", "datos"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]t", "=", "65"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"IAU", " ", "1976"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ua", "=", 
    RowBox[{"1.49597870", " ", 
     RowBox[{"10", "^", "8"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radioS", "=", 
   FractionBox["696000", "ua"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radioecT", "=", 
   FractionBox["6378.14", "ua"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radioL", "=", 
   FractionBox["1738", "ua"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4770575414375*^9, 3.47705756390625*^9}, {
  3.477057656609375*^9, 3.477057688765625*^9}, {3.477059168421875*^9, 
  3.477059173125*^9}, {3.47705922003125*^9, 3.47705922071875*^9}, {
  3.477059276328125*^9, 3.477059284625*^9}, {3.47705969371875*^9, 
  3.47705973834375*^9}, {3.477309152765625*^9, 3.47730915403125*^9}, {
  3.477751137*^9, 3.477751138359375*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Lectura de datos", "Subsection"],

Cell["\<\
Fichero Sol: tiempo en DJ, AR en horas, dec en grados, distancia en ua
Fichero Luna: tiempo en DJ, AR en horas, dec en grados, distancia en km\
\>", "Text",
 CellChangeTimes->{{3.477057630171875*^9, 3.47705763603125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "fichS", "=", 
   "\"\<C:\\\\Documents and Settings\\\\FEDE\\\\Mis \
documentos\\\\ECLIPSES\\\\DATOS TS\\\\Sol001225.dat\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "fichL", "=", 
   "\"\<C:\\\\Documents and Settings\\\\FEDE\\\\Mis \
documentos\\\\ECLIPSES\\\\DATOS TS\\\\Luna001225.dat\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "fichTS", "=", 
    "\"\<C:\\\\Documents and Settings\\\\FEDE\\\\Mis documentos\\\\ECLIPSES\\\
\\DATOS TS\\\\TS001225.dat\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datsol", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"fichS", ",", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{"Number", "&"}], ",", "4"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"datlun", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"fichL", ",", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{"Number", "&"}], ",", "4"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"datTS", "=", 
    RowBox[{"ReadList", "[", 
     RowBox[{"fichTS", ",", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{"Number", "&"}], ",", "10"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "15", ",", "1", ",", "1"}], "}"}]}], ")"}], "&"}],
       ",", "datsol"}], "]"}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"luna", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "15", ",", "1", ",", 
            RowBox[{"1", "/", "ua"}]}], "}"}]}], ")"}], "&"}], ",", 
       "datlun"}], "]"}]}], ";", 
    RowBox[{
    "sin", " ", "corregir", " ", "por", " ", "\[CapitalDelta]\[Lambda]", " ", 
     "y", " ", "\[CapitalDelta]\[Beta]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"luna", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"correcluna", ",", "datlun"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TS", "=", 
    RowBox[{"15", "*", 
     RowBox[{"Map", "[", 
      RowBox[{"hms2h", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "datTS", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3", ",", "5"}], "}"}], "]"}], "]"}], "]"}]}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fech", ",", "\[Alpha]recS", ",", "decS", ",", "distS"}], "}"}], 
   "=", 
   RowBox[{"Transpose", "[", "sol", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fech", ",", "\[Alpha]recL", ",", "decL", ",", "distL"}], "}"}], 
    "=", 
    RowBox[{"Transpose", "[", "luna", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"horas", "=", 
    RowBox[{
     FractionBox["int", "60"], 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"Length", "[", "fech", "]"}], "-", "1"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "escala", " ", "el", " ", "tiempo", " ", "de", " ", "los", " ", "datos", 
    " ", "a", " ", "fracciones", " ", "de", " ", "horas", " ", "desde", " ", 
    "el", " ", "instante", " ", "del", " ", "primer", " ", "dato"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"horaspunt", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "60"}], "*", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"int", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "fech", "]"}], "-", "1"}], ")"}]}]}], 
       "]"}]}], "+", 
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{"\[CapitalDelta]t", ",", "60"}], "]"}], "/", "3600"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "escala", " ", "de", " ", "tiempo", " ", "en", " ", "fracciones", " ", 
     "de", " ", "hora"}], ",", " ", 
    RowBox[{
    "de", " ", "minuto", " ", "en", " ", "minuto", " ", "con", " ", "valores",
      " ", "exactos", " ", "al", " ", "minuto", " ", "en", " ", "hora", " ", 
     "UT"}]}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"min2cinco", "=", 
    RowBox[{"5", "-", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"Round", "[", 
        RowBox[{"Last", "[", 
         RowBox[{"h2hm", "[", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "horaspunt", "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "[", "fech", "]"}], "-", 
                RowBox[{"IntegerPart", "[", 
                 RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
               ")"}], "*", "24"}], "-", 
             RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
          "]"}], "]"}], "]"}], ",", "5"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "minutos", " ", "que", " ", "le", " ", "faltan", " ", "al", " ", "primer", 
    " ", "valor", " ", "de", " ", "horaspunt", " ", "para", " ", "que", " ", 
    "termine", " ", "en", " ", "cinco", " ", "o", " ", "en", " ", "cero"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"horas5punt", "=", 
    RowBox[{"Part", "[", 
     RowBox[{
      RowBox[{"horaspunt", "+", 
       RowBox[{"min2cinco", "/", "60"}]}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", 
        RowBox[{"Length", "[", "horaspunt", "]"}], ",", "5"}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "escala", " ", "de", " ", "tiempo", " ", "en", " ", "fracciones", " ", 
     "de", " ", "hora"}], ",", " ", 
    RowBox[{
    "de", " ", "5", " ", "minutos", " ", "en", " ", "5", " ", "minutos", " ", 
     "con", " ", "valores", " ", "exactos", " ", "a", " ", "los", " ", "5", 
     " ", "minutos", " ", "en", " ", "hora", " ", "UT"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"min2sesenta", "=", 
    RowBox[{"Round", "[", 
     RowBox[{"60", "-", 
      RowBox[{"Last", "[", 
       RowBox[{"h2hm", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "horaspunt", "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "minutos", " ", "que", " ", "le", " ", "faltan", " ", "al", " ", "primer", 
    " ", "valor", " ", "de", " ", "horaspunt", " ", "para", " ", "que", " ", 
    "termine", " ", "en", " ", "hora", " ", "exacta"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"horas60punt", "=", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"horaspunt", "+", 
      RowBox[{"min2sesenta", "/", "60"}]}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "horaspunt", "]"}], ",", "60"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "escala", " ", "de", " ", "tiempo", " ", "en", " ", "fracciones", " ", 
     "de", " ", "hora"}], ",", " ", 
    RowBox[{
    "de", " ", "hora", " ", "en", " ", "hora", " ", "con", " ", "valores", 
     " ", "exactos", " ", "a", " ", "la", " ", "hora", " ", "en", " ", "hora",
      " ", "UT"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4770576119375*^9, 3.477057615984375*^9}, {
   3.477059759625*^9, 3.477059768296875*^9}, {3.477059880859375*^9, 
   3.477059964796875*^9}, {3.47730903078125*^9, 3.47730913890625*^9}, {
   3.477328003984375*^9, 3.4773280870625*^9}, 3.477371806140625*^9, {
   3.477373413484375*^9, 3.4773734175625*^9}, {3.4773741524375*^9, 
   3.477374289*^9}, {3.477375757640625*^9, 3.47737580009375*^9}, {
   3.477375832328125*^9, 3.477375874390625*^9}, {3.477376029078125*^9, 
   3.477376030671875*^9}, {3.47737630071875*^9, 3.477376439265625*^9}, 
   3.47737651903125*^9, {3.477376616625*^9, 3.47737666578125*^9}, {
   3.477377299703125*^9, 3.4773773023125*^9}, 3.4773809546875*^9, {
   3.477381077546875*^9, 3.47738110875*^9}, {3.477381822625*^9, 
   3.4773818596875*^9}, {3.47738212240625*^9, 3.4773821799375*^9}, 
   3.4773822108125*^9, {3.477382260109375*^9, 3.4773822921875*^9}, {
   3.477382480609375*^9, 3.47738248665625*^9}, 3.477654821625*^9, {
   3.477751099078125*^9, 3.4777511130625*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo elementos Besselianos: elementos x, y, z, ls, lp (en unidad \
de radio ecuatorial terrestre), a,d, \[Mu] (en grados sexagesimales), is e ip.\
\>", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CartSol", "=", 
   RowBox[{"ecu2cart", "[", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]recS", ",", "decS", ",", "distS"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CartLuna", "=", 
   RowBox[{"ecu2cart", "[", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]recL", ",", "decL", ",", "distL"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CartLunaSol", "=", 
   RowBox[{"CartSol", "-", "CartLuna"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EcuLunaSol", "=", 
    RowBox[{"cart2ecu", "[", "CartLunaSol", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elementoa", "=", 
   RowBox[{"EcuLunaSol", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"elementod", "=", 
   RowBox[{"EcuLunaSol", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"elementox", "=", 
   RowBox[{
    FractionBox["1", "radioecT"], "distL", "*", 
    RowBox[{"Cos", "[", 
     RowBox[{"decL", " ", "Degree"}], "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Alpha]recL", "-", "elementoa"}], ")"}], "Degree"}], 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"elementoy", "=", 
   RowBox[{
    FractionBox["1", "radioecT"], "distL", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"decL", " ", "Degree"}], "]"}], "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"elementod", " ", "Degree"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"decL", " ", "Degree"}], "]"}], "*", 
       RowBox[{"Sin", "[", 
        RowBox[{"elementod", " ", "Degree"}], "]"}], "*", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Alpha]recL", "-", "elementoa"}], ")"}], "Degree"}], 
        "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"elementoz", "=", 
   RowBox[{
    FractionBox["1", "radioecT"], "distL", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"decL", " ", "Degree"}], "]"}], "*", 
       RowBox[{"Sin", "[", 
        RowBox[{"elementod", " ", "Degree"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"decL", " ", "Degree"}], "]"}], "*", 
       RowBox[{"Cos", "[", 
        RowBox[{"elementod", " ", "Degree"}], "]"}], "*", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Alpha]recL", "-", "elementoa"}], ")"}], "Degree"}], 
        "]"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"elementois", "=", 
   RowBox[{"Tan", "[", 
    RowBox[{"ArcSin", "[", 
     FractionBox[
      RowBox[{"radioS", "-", "radioL"}], 
      RowBox[{"EcuLunaSol", "[", 
       RowBox[{"[", "3", "]"}], "]"}]], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"elementoip", "=", 
    RowBox[{"Tan", "[", 
     RowBox[{"ArcSin", "[", 
      FractionBox[
       RowBox[{"radioS", "+", "radioL"}], 
       RowBox[{"EcuLunaSol", "[", 
        RowBox[{"[", "3", "]"}], "]"}]], "]"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elementols", "=", 
   RowBox[{
    RowBox[{"elementoz", "*", "elementois"}], "-", 
    RowBox[{
     FractionBox["radioL", "radioecT"], "*", 
     RowBox[{"Sec", "[", 
      RowBox[{"ArcSin", "[", 
       FractionBox[
        RowBox[{"radioS", "-", "radioL"}], 
        RowBox[{"EcuLunaSol", "[", 
         RowBox[{"[", "3", "]"}], "]"}]], "]"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"elementolp", "=", 
   RowBox[{
    RowBox[{"elementoz", "*", "elementoip"}], "+", 
    RowBox[{
     FractionBox["radioL", "radioecT"], "*", 
     RowBox[{"Sec", "[", 
      RowBox[{"ArcSin", "[", 
       FractionBox[
        RowBox[{"radioS", "+", "radioL"}], 
        RowBox[{"EcuLunaSol", "[", 
         RowBox[{"[", "3", "]"}], "]"}]], "]"}], "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"elemento\[Mu]", "=", 
   RowBox[{"TS", "-", "elementoa"}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de funciones interpolantes de los elementos Besselianos y de \
sus derivadas.\
\>", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pelex", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "elementox"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdelex", "=", 
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", "pelex", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"peley", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "elementoy"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdeley", "=", 
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", "peley", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pelez", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "elementoz"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdelez", "=", 
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", "pelez", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"peled", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "elementod"}], "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pdeled", "=", 
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", "peled", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pele\[Mu]", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "elemento\[Mu]"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"pdele\[Mu]", "=", 
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", "pele\[Mu]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pelels", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "elementols"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"pdelels", "=", 
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", "pelels", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pelelp", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "elementolp"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"pdelelp", "=", 
   RowBox[{
    RowBox[{"Derivative", "[", "1", "]"}], "[", "pelelp", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"peleis", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "elementois"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"peleip", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "elementoip"}], "}"}], "]"}], "]"}]}], 
  ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo del eje menor en la elipse del plano fundamental (reliphor) y \
calculo de la distancia del eje de sombra a dicha elipse (disejeelip). \
\>", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"reliphor", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"radeliphor", ",", "elementod"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Para", " ", "cada", " ", "valor", " ", "del", " ", "elementod", " ", 
    "devuelve", " ", "el", " ", "valor", " ", "del", " ", "semieje", " ", 
    "menor", " ", "de", " ", "la", " ", "elipse", " ", "fundamental"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lisEcu", "=", 
    RowBox[{"elementoy", "-", 
     RowBox[{"reliphor", "*", 
      RowBox[{"Sin", "[", "u", "]"}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "reliphor"}], "*", 
      RowBox[{"Tan", "[", "u", "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"elementox", "-", 
        RowBox[{"Cos", "[", "u", "]"}]}], ")"}]}]}]}], ";"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Funci\[OAcute]n", " ", "auxiliar", " ", "con", " ", "variable", " ", "u", 
    " ", "que", " ", "es", " ", "la", " ", "latitud", " ", "reducida", " ", 
    "de", " ", "la", " ", "elipse", " ", "fundamental"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lisVI", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ArcTan", "@@", "#"}], "&"}], ",", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"elementox", ",", "elementoy"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"listaU", "=", 
    RowBox[{"u", "/.", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"lisEcu", ",", "lisVI"}], "}"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Halla", " ", "la", " ", "latitud", " ", "reducida", " ", "del", " ", 
    "punto", " ", "m\[AAcute]s", " ", "cercano", " ", "a", " ", "los", " ", 
    "valores", " ", "x", " ", "e", " ", "y"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"disejeelip", "=", 
    RowBox[{"disEjeElip", "[", 
     RowBox[{"{", 
      RowBox[{"elementox", ",", "elementoy", ",", "reliphor", ",", "listaU"}],
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Da", " ", "la", " ", "distancia", " ", "del", " ", "punto", " ", "x", " ",
     "e", " ", "y", " ", "a", " ", "la", " ", "elipse", " ", "fundamental"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.477309747796875*^9, 3.4773099406875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"preliphor", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "reliphor"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pdisejeelip", "=", 
    RowBox[{"Interpolation", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"horas", ",", "disejeelip"}], "}"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Polinomios", " ", "interpoladores", " ", "del", " ", "valor", " ", "del", 
    " ", "semieje", " ", "y", " ", "de", " ", "la", " ", "distancia", " ", 
    "a", " ", "la", " ", "elipse", " ", "fundamental"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.47730994659375*^9, 3.477309983265625*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Determinaci\[OAcute]n de tipo de eclipse.  \
\>", "Subsection",
 CellChangeTimes->{{3.47730965446875*^9, 3.477309721734375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"FindMinimum", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"pdisejeelip", "[", "t", "]"}], "-", 
            RowBox[{"pelelp", "[", "t", "]"}]}], ",", 
           RowBox[{"0", "\[LessEqual]", "t", "\[LessEqual]", 
            RowBox[{"Max", "[", "horas", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ")"}], "<", "0"}], ",", 
    RowBox[{"flagA", "=", "1"}], ",", 
    RowBox[{"flagA", "=", "0"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pdisejeelip", "[", "t", "]"}], "-", 
             RowBox[{"pelels", "[", "t", "]"}]}], ",", 
            RowBox[{"0", "\[LessEqual]", "t", "\[LessEqual]", 
             RowBox[{"Max", "[", "horas", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ")"}], "<", "0"}], ",", 
     RowBox[{"flagB", "=", "1"}], ",", 
     RowBox[{"flagB", "=", "0"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"pdisejeelip", "[", "t", "]"}], ",", 
            RowBox[{"0", "\[LessEqual]", "t", "\[LessEqual]", 
             RowBox[{"Max", "[", "horas", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ")"}], "<", "0"}], ",", 
     RowBox[{"flagC", "=", "1"}], ",", 
     RowBox[{"flagC", "=", "0"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pdisejeelip", "[", "t", "]"}], "+", 
             RowBox[{"pelels", "[", "t", "]"}]}], ",", 
            RowBox[{"0", "\[LessEqual]", "t", "\[LessEqual]", 
             RowBox[{"Max", "[", "horas", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ")"}], "<", "0"}], ",", 
     RowBox[{"flagD", "=", "1"}], ",", 
     RowBox[{"flagD", "=", "0"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"pdisejeelip", "[", "t", "]"}], "+", 
             RowBox[{"pelelp", "[", "t", "]"}]}], ",", 
            RowBox[{"0", "\[LessEqual]", "t", "\[LessEqual]", 
             RowBox[{"Max", "[", "horas", "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ")"}], "<", "0"}], ",", 
     RowBox[{"flagE", "=", "1"}], ",", 
     RowBox[{"flagE", "=", "0"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Establece", " ", "las", " ", "siguientes", " ", "\"\<flags\>\"", " ", 
    "seg\[UAcute]n", " ", "la", " ", "distancia", " ", "que", " ", "entran", 
    " ", "los", " ", "conos", " ", "y", " ", "el", " ", "eje", " ", "dentro", 
    " ", "del", " ", "elipsoide", " ", "y", " ", "por", " ", "ende", " ", 
    "seg\[UAcute]n", " ", "el", " ", "tipo", " ", "de", " ", "eclipse", " ", 
    "que", " ", "se", " ", "produce"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.47731112921875*^9, 3.477311132375*^9}, {
  3.477311163703125*^9, 3.47731122090625*^9}, {3.477312148921875*^9, 
  3.47731230625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagA", "==", "0"}], ",", "\"\<No hay eclipse\>\"", ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"flagB", "==", "0"}], ",", " ", "\"\<Eclipse parcial\>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"flagC", "==", "0"}], ",", " ", 
       "\"\<Eclipse total sin curva de centralidad\>\"", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"flagD", "==", "0"}], ",", " ", 
         "\"\<Eclipse central con un solo curva l\[IAcute]mite de totalidad \
\>\"", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"flagE", "==", "0"}], ",", " ", 
           "\"\<Eclipse central con una sola curva l\[IAcute]mite de \
parcial\>\"", ",", 
           "\"\<Eclipse central con ambas curvas l\[IAcute]mite de \
parcial\>\""}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.477311414375*^9, 3.477311464484375*^9}, {
  3.477311494640625*^9, 3.4773116269375*^9}, {3.477311674328125*^9, 
  3.477311724765625*^9}, {3.477311776765625*^9, 3.477311781625*^9}, {
  3.477311898375*^9, 3.4773119063125*^9}, {3.477312096171875*^9, 
  3.477312108796875*^9}}],

Cell[BoxData["\<\"Eclipse parcial\"\>"], "Output",
 CellChangeTimes->{3.477312111625*^9, 3.47737183925*^9, 3.477654856921875*^9, 
  3.4777210845625*^9, 3.4777452026875*^9, 3.4777512435*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Funciones Interpolantes de ascensi\[OAcute]n recta, declinaci\[OAcute]n, \
distancia y tiempo sid\[EAcute]reo.\
\>", "Subsection",
 CellChangeTimes->{{3.477301684703125*^9, 3.4773016956875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p\[Alpha]recS", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "\[Alpha]recS"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdecS", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "decS"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pdistS", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "distS"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p\[Alpha]recL", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "\[Alpha]recL"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"pdecL", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "decL"}], "}"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"pdistL", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "distL"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pTS", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"horas", ",", "TS"}], "}"}], "]"}], "]"}]}], ";"}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Conjunci\[OAcute]n en AR (hcon). Obtenci\[OAcute]n de ascensi\[OAcute]n \
recta, declinaciones, paralajes horizontales ecuatoriales y \
semidi\[AAcute]metros verdaderos de Sol y Luna para esa hora. \
\>", "Subsection",
 CellChangeTimes->{3.47730935734375*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagA", "\[Equal]", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"hcon", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"p\[Alpha]recS", "[", "t", "]"}], "-", 
             RowBox[{"p\[Alpha]recL", "[", "t", "]"}]}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0"}], "}"}]}], "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"hcon", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"p\[Alpha]recS", "[", "hcon", "]"}], "/", "15"}], "//", 
      "h2hms"}], ",", "\n", 
     RowBox[{
      RowBox[{"pdecS", "[", "hcon", "]"}], "//", "h2hms"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"ArcSin", "[", 
        RowBox[{"radioecT", "/", " ", 
         RowBox[{"pdistS", "[", "hcon", "]"}]}], "]"}], "/", "Degree"}], "//",
       "h2hms"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"ArcSin", "[", 
        RowBox[{"radioS", "/", " ", 
         RowBox[{"pdistS", "[", "hcon", "]"}]}], "]"}], "/", "Degree"}], "//",
       "h2hms"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"p\[Alpha]recL", "[", "hcon", "]"}], "/", "15"}], "//", 
      "h2hms"}], ",", "\n", 
     RowBox[{
      RowBox[{"pdecL", "[", "hcon", "]"}], "//", "h2hms"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"ArcSin", "[", 
        RowBox[{"radioecT", "/", 
         RowBox[{"pdistL", "[", "hcon", "]"}]}], "]"}], "/", "Degree"}], "//",
       "h2hms"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"ArcSin", "[", 
        RowBox[{"radioL", "/", 
         RowBox[{"pdistL", "[", "hcon", "]"}]}], "]"}], "/", "Degree"}], "//",
       "h2hms"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.47731256915625*^9, 3.477312572640625*^9}, {
  3.4778052864375*^9, 3.477805311328125*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"17", ",", "25", ",", "54.851096120881884`"}], "}"}]], "Output",
 CellChangeTimes->{3.47730930215625*^9, 3.4773718565*^9, 3.477654873234375*^9,
   3.477721093703125*^9, 3.477745216125*^9, 3.477751267984375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"18", ",", "18", ",", "28.186820780446208`"}], "}"}]], "Output",
 CellChangeTimes->{3.47730930215625*^9, 3.4773718565*^9, 3.477654873234375*^9,
   3.477721093703125*^9, 3.477745216125*^9, 3.477751268*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "23"}], ",", 
   RowBox[{"-", "22"}], ",", 
   RowBox[{"-", "13.24219803109694`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47730930215625*^9, 3.4773718565*^9, 3.477654873234375*^9,
   3.477721093703125*^9, 3.477745216125*^9, 3.477751268*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "8.941630000256787`"}], "}"}]], "Output",
 CellChangeTimes->{3.47730930215625*^9, 3.4773718565*^9, 3.477654873234375*^9,
   3.477721093703125*^9, 3.477745216125*^9, 3.477751268*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "16", ",", "15.738646244945143`"}], "}"}]], "Output",
 CellChangeTimes->{3.47730930215625*^9, 3.4773718565*^9, 3.477654873234375*^9,
   3.477721093703125*^9, 3.477745216125*^9, 3.477751268*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"18", ",", "18", ",", "28.186820780446208`"}], "}"}]], "Output",
 CellChangeTimes->{3.47730930215625*^9, 3.4773718565*^9, 3.477654873234375*^9,
   3.477721093703125*^9, 3.477745216125*^9, 3.477751268*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "22"}], ",", 
   RowBox[{"-", "20"}], ",", 
   RowBox[{"-", "26.454302584383594`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47730930215625*^9, 3.4773718565*^9, 3.477654873234375*^9,
   3.477721093703125*^9, 3.477745216125*^9, 3.477751268*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "54", ",", "22.926512086583053`"}], "}"}]], "Output",
 CellChangeTimes->{3.47730930215625*^9, 3.4773718565*^9, 3.477654873234375*^9,
   3.477721093703125*^9, 3.477745216125*^9, 3.477751268*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "14", ",", "49.0910704359864`"}], "}"}]], "Output",
 CellChangeTimes->{3.47730930215625*^9, 3.4773718565*^9, 3.477654873234375*^9,
   3.477721093703125*^9, 3.477745216125*^9, 3.477751268015625*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora y situaci\[OAcute]n de principio y fin del eclipse \
parcial.   \
\>", "Subsection",
 CellChangeTimes->{{3.477313643640625*^9, 3.4773136443125*^9}, 
   3.477313680328125*^9, {3.47731781621875*^9, 3.4773178225625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagA", "==", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tinipar", "=", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pdisejeelip", "[", "t", "]"}], "-", 
              RowBox[{"pelelp", "[", "t", "]"}]}], "\[Equal]", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"First", "[", "horas", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h2hms", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"tinipar", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "tinipar", "]"}]}], "}"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagA", "\[Equal]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tfinpar", "=", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pdisejeelip", "[", "t", "]"}], "-", 
              RowBox[{"pelelp", "[", "t", "]"}]}], "\[Equal]", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"Last", "[", "horas", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h2hms", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"tfinpar", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "tfinpar", "]"}]}], "}"}]}], 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Se", " ", "igualan", " ", "la", " ", "distancia", " ", "de", " ", "la", 
    " ", "elipse", " ", "fundamental", " ", "al", " ", "eje", " ", "de", " ", 
    "sombra", " ", "con", " ", "el", " ", "radio", " ", "del", " ", "cono", 
    " ", "de", " ", "penumbra", " ", "en", " ", "el", " ", "plano", " ", 
    RowBox[{"fundamental", ".", " ", "Se"}], " ", "dan", " ", "coordenadas", 
    " ", "geogr\[AAcute]ficas", " ", "del", " ", "punto", " ", "de", " ", 
    "la", " ", "elipse", " ", "fundamental", " ", "que", " ", "tangentea", 
    " ", "con", " ", "el", " ", "cono", " ", "de", " ", "penumbra", " ", "en",
     " ", "ese", " ", 
    RowBox[{"instante", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagA", "\[Equal]", "1"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"intervaloextparminuto", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"horaspunt", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", 
              RowBox[{"(", 
               RowBox[{"tinipar", " ", "-", " ", 
                RowBox[{"1", "/", "20"}]}], ")"}]}], " ", "&&", " ", 
             RowBox[{"#", "<", 
              RowBox[{"(", 
               RowBox[{"tfinpar", " ", "+", " ", 
                RowBox[{"1", "/", "20"}]}], ")"}]}]}], ")"}], " ", "&"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"intervalointparminuto", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"horaspunt", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", 
              RowBox[{"(", "tinipar", ")"}]}], " ", "&&", " ", 
             RowBox[{"#", "<", 
              RowBox[{"(", "tfinpar", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"intervalointpar5minuto", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"horas5punt", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", 
              RowBox[{"(", "tinipar", ")"}]}], " ", "&&", " ", 
             RowBox[{"#", "<", 
              RowBox[{"(", "tfinpar", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"intervalointpar60minuto", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"horas60punt", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", ">", 
              RowBox[{"(", "tinipar", ")"}]}], " ", "&&", " ", 
             RowBox[{"#", "<", 
              RowBox[{"(", "tfinpar", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
        ";"}], "}"}], ";"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.477313654578125*^9, 3.477313692625*^9}, {
   3.47731373071875*^9, 3.477313755359375*^9}, {3.4773138419375*^9, 
   3.477313852515625*^9}, {3.47731388309375*^9, 3.4773139214375*^9}, {
   3.47731625075*^9, 3.477316267984375*^9}, 3.47731632315625*^9, {
   3.4773172298125*^9, 3.477317285296875*^9}, 3.477317524109375*^9, {
   3.477317718953125*^9, 3.47731779009375*^9}, {3.477317854671875*^9, 
   3.477317859140625*^9}, 3.477318241703125*^9, {3.47732837634375*^9, 
   3.47732838559375*^9}, {3.47732891771875*^9, 3.4773289206875*^9}, {
   3.477328961796875*^9, 3.4773289839375*^9}, {3.477329062328125*^9, 
   3.477329089578125*^9}, {3.477382575828125*^9, 3.4773826210625*^9}, {
   3.477804508234375*^9, 3.47780455759375*^9}, {3.477804621390625*^9, 
   3.477804642546875*^9}, 3.477804712875*^9, {3.4778049089375*^9, 
   3.477804919484375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15", ",", "26", ",", "38.026686627653646`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.477313929546875*^9, 3.4773164873125*^9, {3.477317256890625*^9, 
   3.477317286796875*^9}, 3.477317795765625*^9, 3.4773718665625*^9, 
   3.477654881734375*^9, 3.477721099828125*^9, 3.47774527*^9, 
   3.47775133146875*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "116"}], ",", 
     RowBox[{"-", "11.103461154466743`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"44", ",", "57.74037445401362`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.477313929546875*^9, 3.4773164873125*^9, {3.477317256890625*^9, 
   3.477317286796875*^9}, 3.477317795765625*^9, 3.4773718665625*^9, 
   3.477654881734375*^9, 3.477721099828125*^9, 3.47774527*^9, 
   3.47775133146875*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"19", ",", "43", ",", "10.48556485869736`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.477313929546875*^9, 3.4773164873125*^9, {3.477317256890625*^9, 
   3.477317286796875*^9}, 3.477317795765625*^9, 3.4773718665625*^9, 
   3.477654881734375*^9, 3.477721099828125*^9, 3.47774527*^9, 
   3.47775133146875*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "45"}], ",", 
     RowBox[{"-", "39.29815224875739`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"38", ",", "29.776788084401602`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.477313929546875*^9, 3.4773164873125*^9, {3.477317256890625*^9, 
   3.477317286796875*^9}, 3.477317795765625*^9, 3.4773718665625*^9, 
   3.477654881734375*^9, 3.477721099828125*^9, 3.47774527*^9, 
   3.477751331484375*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora y situaci\[OAcute]n de principio y fin del eclipse \
total/anular. \
\>", "Subsection",
 CellChangeTimes->{{3.477314221859375*^9, 3.47731422628125*^9}, {
  3.47731791153125*^9, 3.47731791696875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagB", "\[Equal]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tinitot", "=", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pdisejeelip", "[", "t", "]"}], "-", 
              RowBox[{"Abs", "[", 
               RowBox[{"pelels", "[", "t", "]"}], "]"}]}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"First", "[", "horas", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h2hms", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"tinitot", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "tinitot", "]"}]}], "}"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagB", "\[Equal]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tfintot", "=", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pdisejeelip", "[", "t", "]"}], "-", 
              RowBox[{"Abs", "[", 
               RowBox[{"pelels", "[", "t", "]"}], "]"}]}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"Last", "[", "horas", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h2hms", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"tfintot", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "tfintot", "]"}]}], "}"}]}], 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Se", " ", "igualan", " ", "la", " ", "distancia", " ", "de", " ", "la", 
    " ", "elipse", " ", "fundamental", " ", "al", " ", "eje", " ", "de", " ", 
    "sombra", " ", "con", " ", "el", " ", "radio", " ", "del", " ", "cono", 
    " ", "de", " ", "sombra", " ", "en", " ", "el", " ", "plano", " ", 
    "fundamental", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "en", " ", "valor", " ", "absoluto", " ", "ya", " ", "que", " ", 
       "puede", " ", "ser", " ", "negativo"}], ")"}], ".", " ", "Se"}], " ", 
    "dan", " ", "coordenadas", " ", "geogr\[AAcute]ficas", " ", "del", " ", 
    "punto", " ", "de", " ", "la", " ", "elipse", " ", "fundamental", " ", 
    "que", " ", "tangentea", " ", "con", " ", "el", " ", "cono", " ", "de", 
    " ", "sombra", " ", "en", " ", "ese", " ", 
    RowBox[{"instante", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagB", "\[Equal]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"intervaloexttotminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", 
              RowBox[{"tinitot", " ", "-", " ", 
               RowBox[{"1", "/", "20"}]}], ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", 
              RowBox[{"tfintot", " ", "+", " ", 
               RowBox[{"1", "/", "20"}]}], ")"}]}]}], ")"}], " ", "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointtotminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "tinitot", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "tfintot", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointtot5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "tinitot", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "tfintot", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";"}], "}"}], ";"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.477314102671875*^9, 3.47731411284375*^9}, {
   3.47731423671875*^9, 3.477314252078125*^9}, {3.477316381875*^9, 
   3.477316435453125*^9}, {3.47731788340625*^9, 3.477317908578125*^9}, {
   3.477317939875*^9, 3.477317948328125*^9}, 3.477318238921875*^9, {
   3.47737127671875*^9, 3.47737130271875*^9}, {3.477382804078125*^9, 
   3.477382822046875*^9}, {3.4778047456875*^9, 3.477804900265625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InterpolatingFunction", "::", "\<\"dmval\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Input value \\\\\\\"\\\", \\\
\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\({\\(-3.9937858535522297`\\)}\\),\
 \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" lies outside the \
range of data in the interpolating function. Extrapolation will be \
used.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.4777514089375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InterpolatingFunction", "::", "\<\"dmval\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Input value \\\\\\\"\\\", \\\
\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\({\\(-3.9937858535522297`\\)}\\),\
 \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" lies outside the \
range of data in the interpolating function. Extrapolation will be \
used.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.477751408953125*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InterpolatingFunction", "::", "\<\"dmval\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Input value \\\\\\\"\\\", \\\
\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\({38.51373951752601`}\\), \\\"MT\
\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" lies outside the range of \
data in the interpolating function. Extrapolation will be used.\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.47775140896875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Further output of \\\\\\\"\\\
\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(InterpolatingFunction :: \
\\\"dmval\\\"\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" will \
be suppressed during this calculation.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.47775140896875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindRoot", "::", "\<\"lstol\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"The line search decreased \
the step size to within tolerance specified by AccuracyGoal and PrecisionGoal \
but was unable to find a sufficient decrease in the merit function.  You may \
need more than \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(MachinePrecision\\), \\\"MT\\\
\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" digits of working precision to \
meet these tolerances.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.477751409046875*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "25"}], ",", 
   RowBox[{"-", "6.342435453671702`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47731421259375*^9, 3.477316491875*^9, 3.4773179555625*^9,
   3.47737188003125*^9, 3.477382825328125*^9, 3.477654909421875*^9, 
  3.477721105296875*^9, 3.477745307671875*^9, 3.4777514090625*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "74"}], ",", 
     RowBox[{"-", "3.918621274520717`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"66", ",", "28.474301298220155`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47731421259375*^9, 3.477316491875*^9, 3.4773179555625*^9,
   3.47737188003125*^9, 3.477382825328125*^9, 3.477654909421875*^9, 
  3.477721105296875*^9, 3.477745307671875*^9, 3.477751409078125*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InterpolatingFunction", "::", "\<\"dmval\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Input value \\\\\\\"\\\", \\\
\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\({19.16326727309612`}\\), \\\"MT\
\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" lies outside the range of \
data in the interpolating function. Extrapolation will be used.\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.47775140909375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InterpolatingFunction", "::", "\<\"dmval\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Input value \\\\\\\"\\\", \\\
\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\({19.16326727309612`}\\), \\\"MT\
\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" lies outside the range of \
data in the interpolating function. Extrapolation will be used.\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.477751409109375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InterpolatingFunction", "::", "\<\"dmval\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Input value \\\\\\\"\\\", \\\
\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\({\\(-20.286060993491752`\\)}\\),\
 \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" lies outside the \
range of data in the interpolating function. Extrapolation will be \
used.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InterpolatingFunction/dmval\\\", \
ButtonNote -> \\\"InterpolatingFunction::dmval\\\"]\\)\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.477751409125*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Further output of \\\\\\\"\\\
\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(InterpolatingFunction :: \
\\\"dmval\\\"\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" will \
be suppressed during this calculation.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.477751409140625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindRoot", "::", "\<\"lstol\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"The line search decreased \
the step size to within tolerance specified by AccuracyGoal and PrecisionGoal \
but was unable to find a sufficient decrease in the merit function.  You may \
need more than \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(MachinePrecision\\), \\\"MT\\\
\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" digits of working precision to \
meet these tolerances.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.477751409140625*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "25"}], ",", 
   RowBox[{"-", "6.346770312738603`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47731421259375*^9, 3.477316491875*^9, 3.4773179555625*^9,
   3.47737188003125*^9, 3.477382825328125*^9, 3.477654909421875*^9, 
  3.477721105296875*^9, 3.477745307671875*^9, 3.47775140915625*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "74"}], ",", 
     RowBox[{"-", "3.9220904281242497`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"66", ",", "28.474582021432298`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47731421259375*^9, 3.477316491875*^9, 3.4773179555625*^9,
   3.47737188003125*^9, 3.477382825328125*^9, 3.477654909421875*^9, 
  3.477721105296875*^9, 3.477745307671875*^9, 3.477751409171875*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora y situaci\[OAcute]n de principio y fin de la curva \
central del eclipse. \
\>", "Subsection",
 CellChangeTimes->{{3.477314429140625*^9, 3.47731443053125*^9}, {
  3.4773179985*^9, 3.477318001078125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagC", "\[Equal]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tinicen", "=", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pdisejeelip", "[", "t", "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"First", "[", "horas", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h2hms", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"tinicen", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "tinicen", "]"}]}], "}"}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagC", "\[Equal]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tfincen", "=", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pdisejeelip", "[", "t", "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"Last", "[", "horas", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h2hms", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"tfincen", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "tfincen", "]"}]}], "}"}]}], 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Se", " ", "anula", " ", "la", " ", "distancia", " ", "de", " ", "la", " ",
     "elipse", " ", "fundamental", " ", "al", " ", "eje", " ", "de", " ", 
    RowBox[{"sombra", ".", " ", "Se"}], " ", "dan", " ", "coordenadas", " ", 
    "geogr\[AAcute]ficas", " ", "del", " ", "punto", " ", "de", " ", "la", 
    " ", "elipse", " ", "fundamental", " ", "que", " ", "tangentea", " ", 
    "con", " ", "el", " ", "eje", " ", "de", " ", "sombra", " ", "en", " ", 
    "ese", " ", 
    RowBox[{"instante", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagC", "\[Equal]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"intervalointcenminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "tinicen", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "tfincen", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointcen5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "tinicen", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "tfincen", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";"}], "}"}], ";"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.47731432534375*^9, 3.47731434153125*^9}, {
   3.477318010015625*^9, 3.47731806584375*^9}, 3.4773182360625*^9, {
   3.477371185015625*^9, 3.47737121090625*^9}, {3.47737130996875*^9, 
   3.4773713118125*^9}, {3.477382842515625*^9, 3.477382878484375*^9}, {
   3.47780495375*^9, 3.477805050890625*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "5", ",", "39.26205873337453`"}], "}"}]], "Output",
 CellChangeTimes->{3.477314346140625*^9, 3.477318075703125*^9, 
  3.477371889578125*^9, 3.477382882734375*^9, 3.477654921375*^9, 
  3.477721112609375*^9, 3.477745326375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "39.2957084670379`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "34"}], ",", 
     RowBox[{"-", "35.02871673539019`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.477314346140625*^9, 3.477318075703125*^9, 
  3.477371889578125*^9, 3.477382882734375*^9, 3.477654921375*^9, 
  3.477721112609375*^9, 3.477745326375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "51", ",", "27.065443734348314`"}], "}"}]], "Output",
 CellChangeTimes->{3.477314346140625*^9, 3.477318075703125*^9, 
  3.477371889578125*^9, 3.477382882734375*^9, 3.477654921375*^9, 
  3.477721112609375*^9, 3.477745326375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"124", ",", "2.0971865380977306`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "42.18770576181652`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.477314346140625*^9, 3.477318075703125*^9, 
  3.477371889578125*^9, 3.477382882734375*^9, 3.477654921375*^9, 
  3.477721112609375*^9, 3.477745326375*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora y situaci\[OAcute]n de contactos interiores del \
cono de sombra.\
\>", "Subsection",
 CellChangeTimes->{{3.47731813421875*^9, 3.477318136953125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagD", "\[Equal]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"t2tot", "=", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"pdisejeelip", "[", "t", "]"}]}], "-", 
              RowBox[{"Abs", "[", 
               RowBox[{"pelels", "[", "t", "]"}], "]"}]}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"First", "[", "horas", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h2hms", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"t2tot", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "t2tot", "]"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagD", "\[Equal]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"t3tot", "=", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"pdisejeelip", "[", "t", "]"}]}], "-", 
              RowBox[{"Abs", "[", 
               RowBox[{"pelels", "[", "t", "]"}], "]"}]}], "\[Equal]", "0"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"Last", "[", "horas", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h2hms", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"t3tot", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "t3tot", "]"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Se", " ", "igualan", " ", "la", " ", "distancia", " ", "de", " ", "la", 
    " ", "elipse", " ", "fundamental", " ", "al", " ", "eje", " ", "de", " ", 
    "sombra", " ", "con", " ", "el", " ", "negativo", " ", "del", " ", 
    "radio", " ", "del", " ", "cono", " ", "de", " ", "sombra", " ", "en", 
    " ", "el", " ", "plano", " ", 
    RowBox[{"fundamental", ".", " ", "Se"}], " ", "dan", " ", "coordenadas", 
    " ", "geogr\[AAcute]ficas", " ", "del", " ", "punto", " ", "de", " ", 
    "la", " ", "elipse", " ", "fundamental", " ", "que", " ", "tangentea", 
    " ", "con", " ", "el", " ", "cono", " ", "de", " ", "sombra", " ", "en", 
    " ", "ese", " ", 
    RowBox[{"instante", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagD", "\[Equal]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"intervalointtotortminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "tinitot", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t2tot", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointtotort5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "tinitot", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t2tot", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointtotocaminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t3tot", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "tfintot", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointtotoca5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t3tot", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "tfintot", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"intervaloexttotortminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", 
              RowBox[{"tinitot", "-", 
               RowBox[{"1", "/", "20"}]}], ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", 
              RowBox[{"t2tot", "+", 
               RowBox[{"1", "/", "20"}]}], ")"}]}]}], ")"}], " ", "&"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"intervaloexttotocaminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", 
              RowBox[{"t3tot", "-", 
               RowBox[{"1", "/", "20"}]}], ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", 
              RowBox[{"tfintot", "+", 
               RowBox[{"1", "/", "20"}]}], ")"}]}]}], ")"}], " ", "&"}]}], 
        "]"}]}], ";"}], "}"}], ";"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.477314440296875*^9, 3.47731446615625*^9}, {
   3.47731456509375*^9, 3.477314568765625*^9}, {3.47731645240625*^9, 
   3.477316464515625*^9}, {3.47731809540625*^9, 3.47731811828125*^9}, {
   3.47731815653125*^9, 3.477318190703125*^9}, 3.477318233421875*^9, {
   3.477655651*^9, 3.47765571628125*^9}, {3.4777408470625*^9, 
   3.477740925421875*^9}, {3.477741762234375*^9, 3.477741777234375*^9}, {
   3.477741865671875*^9, 3.477741876765625*^9}, {3.477741912875*^9, 
   3.477741951296875*^9}, {3.47774198728125*^9, 3.47774202821875*^9}, {
   3.4778050645*^9, 3.477805165375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "8", ",", "47.664533626698436`"}], "}"}]], "Output",
 CellChangeTimes->{3.4773164981875*^9, 3.477318197140625*^9, 
  3.477371895453125*^9, 3.47774093178125*^9, 3.477742024515625*^9, 
  3.477745350703125*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "12"}], ",", 
     RowBox[{"-", "39.08198461643227`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "34"}], ",", 
     RowBox[{"-", "59.8766913640776`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4773164981875*^9, 3.477318197140625*^9, 
  3.477371895453125*^9, 3.47774093178125*^9, 3.477742024515625*^9, 
  3.47774535071875*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "48", ",", "20.76519983755345`"}], "}"}]], "Output",
 CellChangeTimes->{3.4773164981875*^9, 3.477318197140625*^9, 
  3.477371895453125*^9, 3.47774093178125*^9, 3.477742024515625*^9, 
  3.477745350734375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"124", ",", "57.08312617566719`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "17.152429556024433`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4773164981875*^9, 3.477318197140625*^9, 
  3.477371895453125*^9, 3.47774093178125*^9, 3.477742024515625*^9, 
  3.47774535075*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora y situaci\[OAcute]n de contactos interiores del \
cono de penumbra.  \
\>", "Subsection",
 CellChangeTimes->{{3.477318140984375*^9, 3.477318143421875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagE", "\[Equal]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"t2par", "=", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"pdisejeelip", "[", "t", "]"}]}], "-", 
              RowBox[{"pelelp", "[", "t", "]"}]}], "\[Equal]", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"First", "[", "horas", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h2hms", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"t2par", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "t2par", "]"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagE", "\[Equal]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"t3par", "=", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"pdisejeelip", "[", "t", "]"}]}], "-", 
              RowBox[{"pelelp", "[", "t", "]"}]}], "\[Equal]", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"Last", "[", "horas", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h2hms", "[", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"t3par", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "[", "fech", "]"}], "-", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], 
             ")"}], "*", "24"}], "-", 
           RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "t3par", "]"}]}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Se", " ", "igualan", " ", "la", " ", "distancia", " ", "de", " ", "la", 
    " ", "elipse", " ", "fundamental", " ", "al", " ", "eje", " ", "de", " ", 
    "sombra", " ", "con", " ", "el", " ", "negativo", " ", "del", " ", 
    "radio", " ", "del", " ", "cono", " ", "de", " ", "penumbra", " ", "en", 
    " ", "el", " ", "plano", " ", 
    RowBox[{"fundamental", ".", " ", "Se"}], " ", "dan", " ", "coordenadas", 
    " ", "geogr\[AAcute]ficas", " ", "del", " ", "punto", " ", "de", " ", 
    "la", " ", "elipse", " ", "fundamental", " ", "que", " ", "tangentea", 
    " ", "con", " ", "el", " ", "cono", " ", "de", " ", "penumbra", " ", "en",
     " ", "ese", " ", 
    RowBox[{"instante", "."}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagE", "\[Equal]", "1"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"intervalointparortminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "tinipar", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t2par", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointparort5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "tinipar", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t2par", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointparocaminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t3par", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "tfinpar", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointparoca5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t3par", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "tfinpar", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}], 
      ";"}], "}"}], ";"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.47731460953125*^9, 3.477314687421875*^9}, {
  3.477316344234375*^9, 3.47731635340625*^9}, {3.4773181211875*^9, 
  3.477318150078125*^9}, {3.477318203859375*^9, 3.477318230984375*^9}, {
  3.47765572234375*^9, 3.477655749984375*^9}, {3.477805204125*^9, 
  3.4778052641875*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7", ",", "20", ",", "57.03954753286282`"}], "}"}]], "Output",
 CellChangeTimes->{3.477318251359375*^9, 3.47737190040625*^9, 
  3.477655758984375*^9, 3.477721127296875*^9, 3.477745406875*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "48"}], ",", 
     RowBox[{"-", "2.6919344613592955`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "56"}], ",", 
     RowBox[{"-", "53.403265296528986`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.477318251359375*^9, 3.47737190040625*^9, 
  3.477655758984375*^9, 3.477721127296875*^9, 3.477745406890625*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "36", ",", "21.13060560783162`"}], "}"}]], "Output",
 CellChangeTimes->{3.477318251359375*^9, 3.47737190040625*^9, 
  3.477655758984375*^9, 3.477721127296875*^9, 3.47774540690625*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"151", ",", "6.316850288659452`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "20"}], ",", 
     RowBox[{"-", "7.795863612007281`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.477318251359375*^9, 3.47737190040625*^9, 
  3.477655758984375*^9, 3.477721127296875*^9, 3.477745406921875*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la hora de coincidencia de la curva de m\[AAcute]ximo en \
el horizonte con las curvas l\[IAcute]mite Norte/Sur sombra/penumbra. \
\>", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"flagA", "\[Equal]", "1"}], "&&", 
    RowBox[{"flagE", "\[Equal]", "0"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"pdismaxconop", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"intervalointparminuto", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"dismaxconosign", ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"pelex", ",", "intervalointparminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelex", ",", "intervalointparminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peley", ",", "intervalointparminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeley", ",", "intervalointparminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pelelp", ",", "intervalointparminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelelp", ",", "intervalointparminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peleip", ",", "intervalointparminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peled", ",", "intervalointparminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeled", ",", "intervalointparminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pele\[Mu]", ",", "intervalointparminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdele\[Mu]", ",", "intervalointparminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"preliphor", ",", "intervalointparminuto"}], 
                   "]"}]}], "}"}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"NumberQ", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}], "]"}]}], 
      ";", 
      RowBox[{"t1maxpen", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconop", "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"0.8", "tinipar"}], "+", 
              RowBox[{"0.2", " ", "tfinpar"}]}]}], "}"}]}], "]"}]}], ")"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"t4maxpen", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconop", "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"0.2", "*", "tinipar"}], "+", 
              RowBox[{"0.8", "tfinpar"}]}]}], "}"}]}], "]"}]}], ")"}]}], ";", 
      "\n", "     ", 
      RowBox[{"intervalointmaxminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t1maxpen", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t4maxpen", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointmax5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t1maxpen", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t4maxpen", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", 
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"t1maxpen", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}]}], ",", 
     RowBox[{"h2hms", "[", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"t4maxpen", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"First", "[", "fech", "]"}], "-", 
            RowBox[{"IntegerPart", "[", 
             RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}], 
          "*", "24"}], "-", 
         RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
      "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.4772308340625*^9, {3.477721535453125*^9, 3.47772158184375*^9}, {
   3.47772228459375*^9, 3.477722308390625*^9}, {3.477726958234375*^9, 
   3.47772699246875*^9}, 3.477727031046875*^9, {3.477727137234375*^9, 
   3.47772714990625*^9}, {3.4777275815625*^9, 3.47772780903125*^9}, {
   3.477727961703125*^9, 3.47772796275*^9}, {3.47772830115625*^9, 
   3.4777283704375*^9}, {3.4777284100625*^9, 3.477728435765625*^9}, {
   3.4777287783125*^9, 3.477728811296875*^9}, {3.47772890409375*^9, 
   3.477728963015625*^9}, {3.477729215890625*^9, 3.477729226640625*^9}, {
   3.477740462140625*^9, 3.47774047209375*^9}, 3.4777425916875*^9, {
   3.477742644671875*^9, 3.4777427316875*^9}, {3.4778053296875*^9, 
   3.477805353515625*^9}, {3.477805416890625*^9, 3.47780548384375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "7"}], ",", 
     RowBox[{"-", "49"}], ",", 
     RowBox[{"-", "17.230078517593395`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "0", ",", 
     RowBox[{"-", "55.5536330869387`"}]}], "}"}], ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.4777515116875*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagE", "\[Equal]", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"pdismaxconoport", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"intervalointparortminuto", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"dismaxconosign", ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"pelex", ",", "intervalointparortminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelex", ",", "intervalointparortminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peley", ",", "intervalointparortminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeley", ",", "intervalointparortminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pelelp", ",", "intervalointparortminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelelp", ",", "intervalointparortminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peleip", ",", "intervalointparortminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peled", ",", "intervalointparortminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeled", ",", "intervalointparortminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pele\[Mu]", ",", "intervalointparortminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdele\[Mu]", ",", "intervalointparortminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"preliphor", ",", "intervalointparortminuto"}], 
                   "]"}]}], "}"}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"NumberQ", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}], "]"}]}], 
      ";", 
      RowBox[{"t1maxpen", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconoport", "[", "t", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"0.8", "tinipar"}], "+", 
              RowBox[{"0.2", " ", "t2par"}]}]}], "}"}]}], "]"}]}], ")"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"t2maxpen", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconoport", "[", "t", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"0.1", "*", "tinipar"}], "+", 
              RowBox[{"0.9", "t2par"}]}]}], "}"}]}], "]"}]}], ")"}]}], ";", 
      "\n", "     ", 
      RowBox[{"intervalointmaxortminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t1maxpen", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t2maxpen", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointmaxort5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t1maxpen", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t2maxpen", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"t1maxpen", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"h2hms", "[", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"t2maxpen", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"First", "[", "fech", "]"}], "-", 
            RowBox[{"IntegerPart", "[", 
             RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}], 
          "*", "24"}], "-", 
         RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
      "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.4772308340625*^9, {3.477721535453125*^9, 3.47772158184375*^9}, {
   3.47772228459375*^9, 3.477722308390625*^9}, {3.477726958234375*^9, 
   3.47772699246875*^9}, 3.477727031046875*^9, {3.477727137234375*^9, 
   3.477727179328125*^9}, {3.477727223453125*^9, 3.477727269578125*^9}, {
   3.47772898515625*^9, 3.477729101625*^9}, {3.477729167953125*^9, 
   3.47772916815625*^9}, {3.47772919946875*^9, 3.477729208421875*^9}, {
   3.477740479984375*^9, 3.477740483015625*^9}, {3.477742805296875*^9, 
   3.477742831578125*^9}, {3.477742863421875*^9, 3.47774286628125*^9}, {
   3.4778055093125*^9, 3.477805564703125*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagE", "\[Equal]", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"pdismaxconopoca", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"intervalointparocaminuto", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"dismaxconosign", ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"pelex", ",", "intervalointparocaminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelex", ",", "intervalointparocaminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peley", ",", "intervalointparocaminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeley", ",", "intervalointparocaminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pelelp", ",", "intervalointparocaminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelelp", ",", "intervalointparocaminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peleip", ",", "intervalointparocaminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peled", ",", "intervalointparocaminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeled", ",", "intervalointparocaminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pele\[Mu]", ",", "intervalointparocaminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdele\[Mu]", ",", "intervalointparocaminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"preliphor", ",", "intervalointparocaminuto"}], 
                   "]"}]}], "}"}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"NumberQ", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}], "]"}]}], 
      ";", 
      RowBox[{"t3maxpen", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconopoca", "[", "t", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"0.9", " ", "t3par"}], "+", 
              RowBox[{"0.1", "tfinpar"}]}]}], "}"}]}], "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t4maxpen", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconopoca", "[", "t", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"0.2", "*", "t3par"}], "+", 
              RowBox[{"0.8", "tfinpar"}]}]}], "}"}]}], "]"}]}], ")"}]}], ";", 
      "\n", "     ", 
      RowBox[{"intervalointmaxocaminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t3maxpen", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t4maxpen", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointmaxoca5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t3maxpen", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t4maxpen", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", 
      RowBox[{"intervalointmaxminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t1maxpen", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t4maxpen", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointmax5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t1maxpen", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t4maxpen", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"t3maxpen", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}]}], ",", 
     RowBox[{"h2hms", "[", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"t4maxpen", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"First", "[", "fech", "]"}], "-", 
            RowBox[{"IntegerPart", "[", 
             RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}], 
          "*", "24"}], "-", 
         RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
      "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.4772308340625*^9, {3.477721535453125*^9, 3.47772158184375*^9}, {
   3.47772228459375*^9, 3.477722308390625*^9}, {3.477726958234375*^9, 
   3.47772699246875*^9}, 3.477727031046875*^9, {3.477727137234375*^9, 
   3.477727179328125*^9}, {3.477727223453125*^9, 3.477727291921875*^9}, {
   3.47772732496875*^9, 3.47772735746875*^9}, {3.4777334195*^9, 
   3.47773356728125*^9}, {3.477740498859375*^9, 3.477740501671875*^9}, {
   3.47774284075*^9, 3.477742877828125*^9}, {3.477744643109375*^9, 
   3.477744648046875*^9}, {3.47780558590625*^9, 3.47780564515625*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"flagB", "\[Equal]", "1"}], "&&", 
    RowBox[{"flagD", "\[Equal]", "0"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"pdismaxconos", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"intervalointtotminuto", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"dismaxconosign", ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"pelex", ",", "intervalointtotminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelex", ",", "intervalointtotminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peley", ",", "intervalointtotminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeley", ",", "intervalointtotminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pelels", ",", "intervalointtotminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelels", ",", "intervalointtotminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peleis", ",", "intervalointtotminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peled", ",", "intervalointtotminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeled", ",", "intervalointtotminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pele\[Mu]", ",", "intervalointtotminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdele\[Mu]", ",", "intervalointtotminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"preliphor", ",", "intervalointtotminuto"}], 
                   "]"}]}], "}"}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"NumberQ", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}], "]"}]}], 
      ";", 
      RowBox[{"t1maxsom", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconos", "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"0.9", "tinitot"}], "+", 
              RowBox[{"0.9", " ", "tfintot"}]}]}], "}"}]}], "]"}]}], ")"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"t4maxsom", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconos", "[", "t", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"0.1", "*", "tinitot"}], "+", 
              RowBox[{"0.9", "tfintot"}]}]}], "}"}]}], "]"}]}], ")"}]}], ";", 
      "\n", "     ", 
      RowBox[{"intervalointmaxsomminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t1maxsom", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t4maxsom", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointmaxsom5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t1maxsom", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t4maxsom", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"t1maxsom", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}]}], ",", 
     RowBox[{"h2hms", "[", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"t4maxsom", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"First", "[", "fech", "]"}], "-", 
            RowBox[{"IntegerPart", "[", 
             RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}], 
          "*", "24"}], "-", 
         RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
      "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.4772308340625*^9, {3.477721535453125*^9, 3.47772158184375*^9}, {
   3.47772228459375*^9, 3.477722308390625*^9}, {3.477726958234375*^9, 
   3.47772699246875*^9}, 3.477727031046875*^9, {3.477727137234375*^9, 
   3.47772714990625*^9}, {3.4777275815625*^9, 3.47772780903125*^9}, {
   3.477727961703125*^9, 3.47772796275*^9}, {3.47772830115625*^9, 
   3.4777283704375*^9}, {3.4777284100625*^9, 3.477728435765625*^9}, {
   3.4777287783125*^9, 3.477728811296875*^9}, {3.47772890409375*^9, 
   3.477728963015625*^9}, {3.477729215890625*^9, 3.477729226640625*^9}, {
   3.477740462140625*^9, 3.47774047209375*^9}, {3.477740545015625*^9, 
   3.4777405696875*^9}, {3.4777406346875*^9, 3.4777407408125*^9}, {
   3.477744679328125*^9, 3.477744720078125*^9}, {3.477805692265625*^9, 
   3.47780574503125*^9}, 3.477805838296875*^9}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagD", "\[Equal]", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"pdismaxconosort", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"intervaloexttotortminuto", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"dismaxconosign", ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"pelex", ",", "intervaloexttotortminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelex", ",", "intervaloexttotortminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peley", ",", "intervaloexttotortminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeley", ",", "intervaloexttotortminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pelels", ",", "intervaloexttotortminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelels", ",", "intervaloexttotortminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peleis", ",", "intervaloexttotortminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peled", ",", "intervaloexttotortminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeled", ",", "intervaloexttotortminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pele\[Mu]", ",", "intervaloexttotortminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdele\[Mu]", ",", "intervaloexttotortminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"preliphor", ",", "intervaloexttotortminuto"}], 
                   "]"}]}], "}"}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"NumberQ", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}], "]"}]}], 
      ";", 
      RowBox[{"t1maxsom", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconosort", "[", "t", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "tinitot"}], "}"}]}], "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"t1maxsom", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}]}], ",", 
     RowBox[{
      RowBox[{"t2maxsom", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconosort", "[", "t", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "t2tot"}], "}"}]}], "]"}]}], ")"}]}], ";", " ", 
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"t2maxsom", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.4772308340625*^9, {3.477721535453125*^9, 3.47772158184375*^9}, {
   3.47772228459375*^9, 3.477722308390625*^9}, {3.477726958234375*^9, 
   3.47772699246875*^9}, 3.477727031046875*^9, {3.477727137234375*^9, 
   3.477727179328125*^9}, {3.477727223453125*^9, 3.477727269578125*^9}, {
   3.47772898515625*^9, 3.477729101625*^9}, {3.477729167953125*^9, 
   3.47772916815625*^9}, {3.47772919946875*^9, 3.477729208421875*^9}, {
   3.477740479984375*^9, 3.477740483015625*^9}, {3.47774078325*^9, 
   3.47774080665625*^9}, {3.477740963375*^9, 3.47774105484375*^9}, {
   3.477741263859375*^9, 3.47774127146875*^9}, {3.477741319375*^9, 
   3.477741329984375*^9}, {3.477742047921875*^9, 3.477742085859375*^9}, {
   3.47780588865625*^9, 3.477805921828125*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagD", "\[Equal]", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"pdismaxconosoca", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"intervaloexttotocaminuto", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"dismaxconosign", ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"pelex", ",", "intervaloexttotocaminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelex", ",", "intervaloexttotocaminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peley", ",", "intervaloexttotocaminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeley", ",", "intervaloexttotocaminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pelels", ",", "intervaloexttotocaminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdelels", ",", "intervaloexttotocaminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peleis", ",", "intervaloexttotocaminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"peled", ",", "intervaloexttotocaminuto"}], "]"}], 
                  ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdeled", ",", "intervaloexttotocaminuto"}], "]"}],
                   ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pele\[Mu]", ",", "intervaloexttotocaminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"pdele\[Mu]", ",", "intervaloexttotocaminuto"}], 
                   "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{"preliphor", ",", "intervaloexttotocaminuto"}], 
                   "]"}]}], "}"}], "]"}]}], "]"}]}], "}"}], "]"}], ",", 
          RowBox[{
           RowBox[{"NumberQ", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}], "]"}]}], 
      ";", 
      RowBox[{"t3maxsom", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconosoca", "[", "t", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "t3tot"}], "}"}]}], "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t4maxsom", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pdismaxconosoca", "[", "t", "]"}], "\[Equal]", "0"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "tfintot"}], "}"}]}], "]"}]}], ")"}]}], ";", 
      " ", 
      RowBox[{"intervalointmaxsomminuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horaspunt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t1maxsom", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t4maxsom", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"intervalointmaxsom5minuto", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"horas5punt", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", 
             RowBox[{"(", "t1maxsom", ")"}]}], " ", "&&", " ", 
            RowBox[{"#", "<", 
             RowBox[{"(", "t4maxsom", ")"}]}]}], ")"}], " ", "&"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"t3maxsom", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"h2hms", "[", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"t4maxsom", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"First", "[", "fech", "]"}], "-", 
            RowBox[{"IntegerPart", "[", 
             RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}], 
          "*", "24"}], "-", 
         RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
      "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.4772308340625*^9, {3.477721535453125*^9, 3.47772158184375*^9}, {
   3.47772228459375*^9, 3.477722308390625*^9}, {3.477726958234375*^9, 
   3.47772699246875*^9}, 3.477727031046875*^9, {3.477727137234375*^9, 
   3.477727179328125*^9}, {3.477727223453125*^9, 3.477727291921875*^9}, {
   3.47772732496875*^9, 3.47772735746875*^9}, {3.4777334195*^9, 
   3.47773356728125*^9}, {3.477740498859375*^9, 3.477740501671875*^9}, {
   3.4777411218125*^9, 3.477741215984375*^9}, {3.477742116390625*^9, 
   3.477742168828125*^9}, {3.477742286828125*^9, 3.47774229071875*^9}, 
   3.47774474065625*^9, {3.477805947609375*^9, 3.47780599825*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de puntos de inicio/fin del eclipse parcial al orto/ocaso. \
\>", "Subsection",
 CellChangeTimes->{{3.477371389625*^9, 3.4773713904375*^9}, 
   3.47738411809375*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagA", "\[Equal]", "1"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"flagE", "\[Equal]", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"curvainifinort", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"cortehor2lonlatt", ",", "intervalointparort5minuto"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"datoreal", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "curvainifinort"}], 
          "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"curvainifinoca", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"cortehor2lonlatt", ",", "intervalointparoca5minuto"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"datoreal", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "curvainifinoca"}], 
          "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"curvainifinhor", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"cortehor2lonlatt", ",", "intervalointpar5minuto"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"datoreal", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "curvainifinhor"}], 
        "]"}], "]"}]}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Devuelve", " ", "dos", " ", "listas", " ", "o", " ", "una", " ", 
    "seg\[UAcute]n", " ", "haya", " ", "dos", " ", "l\[OAcute]bulos", " ", 
    "diferenciados", " ", "o", " ", "un", " ", "ocho"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.477656029359375*^9, 3.477656029796875*^9}, {
  3.47765619796875*^9, 3.477656233859375*^9}, {3.477656356703125*^9, 
  3.477656432578125*^9}, {3.4776565069375*^9, 3.477656547859375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "121"}], ",", 
         RowBox[{"-", "25.456500991106168`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "50.49613250693511`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "110"}], ",", 
         RowBox[{"-", "18.423526581822216`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"51", ",", "4.255878004904332`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "124"}], ",", 
         RowBox[{"-", "24.673908379117506`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "31.66356738382035`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "106"}], ",", 
         RowBox[{"-", "5.886395911524289`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"54", ",", "50.854166979821684`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "126"}], ",", 
         RowBox[{"-", "34.931755436032006`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "13.694350579032601`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "102"}], ",", 
         RowBox[{"-", "21.184631253363193`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"57", ",", "35.69588079123321`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "128"}], ",", 
         RowBox[{"-", "22.695509386656454`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "25.988421486620155`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "98"}], ",", 
         RowBox[{"-", "36.329154665561134`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"59", ",", "48.62847887900685`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "129"}], ",", 
         RowBox[{"-", "56.29809758411625`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "58.3996785753601`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "94"}], ",", 
         RowBox[{"-", "41.816831481095846`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"61", ",", "38.94504308239419`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "131"}], ",", 
         RowBox[{"-", "19.533883297368675`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "46.05942478108474`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "90"}], ",", 
         RowBox[{"-", "33.40147150224453`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "10.554915398787301`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "132"}], ",", 
         RowBox[{"-", "34.44008281608944`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "46.180747099830484`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "86"}], ",", 
         RowBox[{"-", "9.528592230044808`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"64", ",", "25.24746313989141`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "133"}], ",", 
         RowBox[{"-", "42.2117405074539`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "56.97871868854918`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "81"}], ",", 
         RowBox[{"-", "30.788514550608568`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"65", ",", "23.802704936742316`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "134"}], ",", 
         RowBox[{"-", "43.572045686568686`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "17.22359272499446`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "76"}], ",", 
         RowBox[{"-", "39.6912660086673`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "6.540443038779529`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "135"}], ",", 
         RowBox[{"-", "38.951515902001006`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "46.01647241701542`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "71"}], ",", 
         RowBox[{"-", "40.485429642938584`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "33.636145168017606`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "136"}], ",", 
         RowBox[{"-", "28.599857083727898`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "22.63995826416874`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "66"}], ",", 
         RowBox[{"-", "38.72355634396172`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "45.33553476713365`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "137"}], ",", 
         RowBox[{"-", "12.612459012476052`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "6.522380477241541`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "61"}], ",", 
         RowBox[{"-", "40.5937442418427`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "42.083064672541184`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "137"}], ",", 
         RowBox[{"-", "50.98922980179054`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "57.14885340848369`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "56"}], ",", 
         RowBox[{"-", "52.25277629790966`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "24.580316416328003`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "138"}], ",", 
         RowBox[{"-", "23.63144921535934`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "54.05920655643442`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "52"}], ",", 
         RowBox[{"-", "18.993942131077972`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"65", ",", "53.77813671441686`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "138"}], ",", 
         RowBox[{"-", "50.36281032723082`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "56.80849323118068`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "48"}], ",", 
         RowBox[{"-", "4.867527721962972`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"65", ",", "10.824358999182095`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "10.930743355371533`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "4.9548265309357475`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "44"}], ",", 
         RowBox[{"-", "12.446652831278158`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"64", ",", "16.984135831941103`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "25.00949981559984`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"42", ",", "18.043316887945622`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "40"}], ",", 
         RowBox[{"-", "42.92343433479971`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "13.561926655852403`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "32.19143348231739`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"43", ",", "35.60382419248825`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "37"}], ",", 
         RowBox[{"-", "36.368309762010966`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"62", ",", "1.84113371194087`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "31.993544648771604`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44", ",", "57.13080104302563`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "34"}], ",", 
         RowBox[{"-", "52.036460295464195`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "43.04351563817988`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "23.825792934754304`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"46", ",", "22.104348647850713`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "32"}], ",", 
         RowBox[{"-", "28.65038821612501`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"59", ",", "18.302640538793042`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "7.013962322711791`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"47", ",", "49.95107943333778`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "30"}], ",", 
         RowBox[{"-", "24.656007387696803`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"57", ",", "48.66207631231589`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "138"}], ",", 
         RowBox[{"-", "40.77465848179429`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"49", ",", "20.05853548849018`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "28"}], ",", 
         RowBox[{"-", "38.42257268302603`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"56", ",", "15.09286448266451`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "138"}], ",", 
         RowBox[{"-", "4.194833257207051`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "51.779967716386324`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "27"}], ",", 
         RowBox[{"-", "8.301639923354358`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"54", ",", "38.47536076389872`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "137"}], ",", 
         RowBox[{"-", "16.246402102929096`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"52", ",", "24.41016233617276`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "25"}], ",", 
         RowBox[{"-", "52.75011120304271`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"52", ",", "59.634717548253775`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "136"}], ",", 
         RowBox[{"-", "15.76517817333638`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"53", ",", "57.19571835124157`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "24"}], ",", 
         RowBox[{"-", "50.35011738213093`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"51", ",", "19.34422349322361`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "135"}], ",", 
         RowBox[{"-", "1.4408298084924809`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"55", ",", "29.335520732084746`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "23"}], ",", 
         RowBox[{"-", "59.80954166717261`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"49", ",", "38.32161867314724`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "107"}], ",", 
         RowBox[{"-", "21.017021746341698`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"56", ",", "59.95956571550636`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "50.84126606835426`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"47", ",", "57.2563068972444`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "131"}], ",", 
         RowBox[{"-", "45.466082528825496`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"58", ",", "28.135249580844857`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "49.89978240607378`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"46", ",", "16.80745351894089`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "129"}], ",", 
         RowBox[{"-", "40.726402995696844`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"59", ",", "52.852632831158104`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "28.651853206193678`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44", ",", "37.59617445553502`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "127"}], ",", 
         RowBox[{"-", "16.11693773390158`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"61", ",", "13.025330509045716`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "15.4940519121228`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"43", ",", "0.22740886866358778`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "124"}], ",", 
         RowBox[{"-", "30.29691008999805`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"62", ",", "27.494054830022918`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "9.760902059509533`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "25.263689616634792`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "121"}], ",", 
         RowBox[{"-", "22.338354754625414`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "35.019271598115864`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "10.892270771210733`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "53.25604688248205`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "117"}], ",", 
         RowBox[{"-", "51.950238316329944`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"64", ",", "34.31265026344107`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "18.399706033585588`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "24.717290938235692`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "113"}], ",", 
         RowBox[{"-", "59.813136640470645`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"65", ",", "24.064555308952436`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "31.876687120556966`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "0.1462575430971924`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "109"}], ",", 
         RowBox[{"-", "47.805397949065025`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "3.0116443347122868`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "50.972513958229584`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "40.00472422863737`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "105"}], ",", 
         RowBox[{"-", "19.206656161952083`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "30.00546740992661`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "23"}], ",", 
         RowBox[{"-", "15.398608278571189`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "24.735815540296215`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "100"}], ",", 
         RowBox[{"-", "38.64939903403439`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "44.09858691951683`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "23"}], ",", 
         RowBox[{"-", "44.92359664779272`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "14.767689703834037`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "95"}], ",", 
         RowBox[{"-", "51.86730332135852`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "44.619559741769876`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "24"}], ",", 
         RowBox[{"-", "19.36942716128158`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "10.518516700370384`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "91"}], ",", 
         RowBox[{"-", "5.067792892127443`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "31.221628853858192`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "24"}], ",", 
         RowBox[{"-", "58.60170180674096`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"31", ",", "12.39001399288398`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "86"}], ",", 
         RowBox[{"-", "24.269974409355655`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "3.8775911786038364`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "25"}], ",", 
         RowBox[{"-", "42.54981196867412`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "20.80843208570279`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "81"}], ",", 
         RowBox[{"-", "54.68796155536836`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"65", ",", "22.831056601156092`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "26"}], ",", 
         RowBox[{"-", "31.201808474111346`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "36.22559754146451`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "77"}], ",", 
         RowBox[{"-", "40.20243764439812`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"64", ",", "28.494261165540706`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "27"}], ",", 
         RowBox[{"-", "24.604246633906186`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "59.12517634469751`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "28"}], ",", 
         RowBox[{"-", "22.897889701499423`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "30.088206485303672`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "73"}], ",", 
         RowBox[{"-", "43.21011849466885`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "21.325192831261575`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "29"}], ",", 
         RowBox[{"-", "26.33830456473966`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "9.831998429306594`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "70"}], ",", 
         RowBox[{"-", "4.642731146775532`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"62", ",", "1.6840714760522246`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "30"}], ",", 
         RowBox[{"-", "35.33141568815893`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "59.268812849078714`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "66"}], ",", 
         RowBox[{"-", "44.20372472548877`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "29.697498086672454`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "31"}], ",", 
         RowBox[{"-", "50.536180082188764`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "59.67291319989776`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "63"}], ",", 
         RowBox[{"-", "40.49921609701954`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"58", ",", "45.05531231364046`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "33"}], ",", 
         RowBox[{"-", "12.995890331643238`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "12.877121318177558`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "60"}], ",", 
         RowBox[{"-", "51.2303821219011`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"56", ",", "46.76223000758682`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "34"}], ",", 
         RowBox[{"-", "44.497446444490265`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "41.819444976832045`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "58"}], ",", 
         RowBox[{"-", "13.053471620550994`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"54", ",", "32.61929820646557`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "36"}], ",", 
         RowBox[{"-", "28.312523782661003`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "31.615538293172065`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "55"}], ",", 
         RowBox[{"-", "41.03608665888757`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"51", ",", "58.112120355858394`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "38"}], ",", 
         RowBox[{"-", "31.652775417643966`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "53.09358529840651`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "53"}], ",", 
         RowBox[{"-", "6.283416894704459`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"48", ",", "52.91254556277622`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "41"}], ",", 
         RowBox[{"-", "17.79065444133792`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "19.790612523618165`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "50"}], ",", 
         RowBox[{"-", "3.9161218352445815`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44", ",", "43.87702003376006`"}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.4777516700625*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"flagA", "\[Equal]", "1"}], "&&", 
    RowBox[{"flagE", "\[Equal]", "0"}]}], ",", 
   RowBox[{
    RowBox[{"curvainifinhor", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"cortehor2lonlatt", ",", "intervalointpar5minuto"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"datoreal", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "curvainifinhor"}], 
      "]"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagE", "\[Equal]", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"curvainifinort", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"cortehor2lonlatt", ",", "intervalointparort5minuto"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"datoreal", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "curvainifinort"}], 
        "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curvainifinoca", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"cortehor2lonlatt", ",", "intervalointparoca5minuto"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"datoreal", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", "curvainifinoca"}], 
        "]"}], "]"}]}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.477745565703125*^9, 3.477745691890625*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "121"}], ",", 
         RowBox[{"-", "25.456500991106168`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "50.49613250693511`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "110"}], ",", 
         RowBox[{"-", "18.423526581822216`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"51", ",", "4.255878004904332`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "124"}], ",", 
         RowBox[{"-", "24.673908379117506`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "31.66356738382035`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "106"}], ",", 
         RowBox[{"-", "5.886395911524289`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"54", ",", "50.854166979821684`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "126"}], ",", 
         RowBox[{"-", "34.931755436032006`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "13.694350579032601`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "102"}], ",", 
         RowBox[{"-", "21.184631253363193`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"57", ",", "35.69588079123321`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "128"}], ",", 
         RowBox[{"-", "22.695509386656454`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "25.988421486620155`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "98"}], ",", 
         RowBox[{"-", "36.329154665561134`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"59", ",", "48.62847887900685`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "129"}], ",", 
         RowBox[{"-", "56.29809758411625`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "58.3996785753601`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "94"}], ",", 
         RowBox[{"-", "41.816831481095846`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"61", ",", "38.94504308239419`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "131"}], ",", 
         RowBox[{"-", "19.533883297368675`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "46.05942478108474`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "90"}], ",", 
         RowBox[{"-", "33.40147150224453`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "10.554915398787301`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "132"}], ",", 
         RowBox[{"-", "34.44008281608944`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "46.180747099830484`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "86"}], ",", 
         RowBox[{"-", "9.528592230044808`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"64", ",", "25.24746313989141`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "133"}], ",", 
         RowBox[{"-", "42.2117405074539`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "56.97871868854918`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "81"}], ",", 
         RowBox[{"-", "30.788514550608568`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"65", ",", "23.802704936742316`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "134"}], ",", 
         RowBox[{"-", "43.572045686568686`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "17.22359272499446`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "76"}], ",", 
         RowBox[{"-", "39.6912660086673`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "6.540443038779529`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "135"}], ",", 
         RowBox[{"-", "38.951515902001006`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "46.01647241701542`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "71"}], ",", 
         RowBox[{"-", "40.485429642938584`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "33.636145168017606`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "136"}], ",", 
         RowBox[{"-", "28.599857083727898`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "22.63995826416874`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "66"}], ",", 
         RowBox[{"-", "38.72355634396172`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "45.33553476713365`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "137"}], ",", 
         RowBox[{"-", "12.612459012476052`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "6.522380477241541`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "61"}], ",", 
         RowBox[{"-", "40.5937442418427`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "42.083064672541184`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "137"}], ",", 
         RowBox[{"-", "50.98922980179054`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "57.14885340848369`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "56"}], ",", 
         RowBox[{"-", "52.25277629790966`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "24.580316416328003`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "138"}], ",", 
         RowBox[{"-", "23.63144921535934`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "54.05920655643442`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "52"}], ",", 
         RowBox[{"-", "18.993942131077972`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"65", ",", "53.77813671441686`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "138"}], ",", 
         RowBox[{"-", "50.36281032723082`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "56.80849323118068`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "48"}], ",", 
         RowBox[{"-", "4.867527721962972`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"65", ",", "10.824358999182095`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "10.930743355371533`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "4.9548265309357475`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "44"}], ",", 
         RowBox[{"-", "12.446652831278158`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"64", ",", "16.984135831941103`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "25.00949981559984`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"42", ",", "18.043316887945622`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "40"}], ",", 
         RowBox[{"-", "42.92343433479971`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "13.561926655852403`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "32.19143348231739`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"43", ",", "35.60382419248825`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "37"}], ",", 
         RowBox[{"-", "36.368309762010966`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"62", ",", "1.84113371194087`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "31.993544648771604`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44", ",", "57.13080104302563`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "34"}], ",", 
         RowBox[{"-", "52.036460295464195`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "43.04351563817988`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "23.825792934754304`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"46", ",", "22.104348647850713`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "32"}], ",", 
         RowBox[{"-", "28.65038821612501`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"59", ",", "18.302640538793042`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "139"}], ",", 
         RowBox[{"-", "7.013962322711791`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"47", ",", "49.95107943333778`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "30"}], ",", 
         RowBox[{"-", "24.656007387696803`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"57", ",", "48.66207631231589`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "138"}], ",", 
         RowBox[{"-", "40.77465848179429`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"49", ",", "20.05853548849018`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "28"}], ",", 
         RowBox[{"-", "38.42257268302603`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"56", ",", "15.09286448266451`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "138"}], ",", 
         RowBox[{"-", "4.194833257207051`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "51.779967716386324`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "27"}], ",", 
         RowBox[{"-", "8.301639923354358`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"54", ",", "38.47536076389872`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "137"}], ",", 
         RowBox[{"-", "16.246402102929096`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"52", ",", "24.41016233617276`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "25"}], ",", 
         RowBox[{"-", "52.75011120304271`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"52", ",", "59.634717548253775`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "136"}], ",", 
         RowBox[{"-", "15.76517817333638`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"53", ",", "57.19571835124157`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "24"}], ",", 
         RowBox[{"-", "50.35011738213093`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"51", ",", "19.34422349322361`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "135"}], ",", 
         RowBox[{"-", "1.4408298084924809`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"55", ",", "29.335520732084746`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "23"}], ",", 
         RowBox[{"-", "59.80954166717261`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"49", ",", "38.32161867314724`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "107"}], ",", 
         RowBox[{"-", "21.017021746341698`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"56", ",", "59.95956571550636`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "50.84126606835426`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"47", ",", "57.2563068972444`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "131"}], ",", 
         RowBox[{"-", "45.466082528825496`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"58", ",", "28.135249580844857`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "49.89978240607378`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"46", ",", "16.80745351894089`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "129"}], ",", 
         RowBox[{"-", "40.726402995696844`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"59", ",", "52.852632831158104`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "28.651853206193678`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44", ",", "37.59617445553502`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "127"}], ",", 
         RowBox[{"-", "16.11693773390158`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"61", ",", "13.025330509045716`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "15.4940519121228`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"43", ",", "0.22740886866358778`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "124"}], ",", 
         RowBox[{"-", "30.29691008999805`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"62", ",", "27.494054830022918`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "9.760902059509533`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "25.263689616634792`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "121"}], ",", 
         RowBox[{"-", "22.338354754625414`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "35.019271598115864`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "10.892270771210733`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "53.25604688248205`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "117"}], ",", 
         RowBox[{"-", "51.950238316329944`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"64", ",", "34.31265026344107`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "18.399706033585588`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "24.717290938235692`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "113"}], ",", 
         RowBox[{"-", "59.813136640470645`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"65", ",", "24.064555308952436`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "31.876687120556966`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "0.1462575430971924`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "109"}], ",", 
         RowBox[{"-", "47.805397949065025`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "3.0116443347122868`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "22"}], ",", 
         RowBox[{"-", "50.972513958229584`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "40.00472422863737`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "105"}], ",", 
         RowBox[{"-", "19.206656161952083`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "30.00546740992661`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "23"}], ",", 
         RowBox[{"-", "15.398608278571189`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "24.735815540296215`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "100"}], ",", 
         RowBox[{"-", "38.64939903403439`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "44.09858691951683`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "23"}], ",", 
         RowBox[{"-", "44.92359664779272`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "14.767689703834037`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "95"}], ",", 
         RowBox[{"-", "51.86730332135852`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "44.619559741769876`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "24"}], ",", 
         RowBox[{"-", "19.36942716128158`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "10.518516700370384`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "91"}], ",", 
         RowBox[{"-", "5.067792892127443`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "31.221628853858192`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "24"}], ",", 
         RowBox[{"-", "58.60170180674096`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"31", ",", "12.39001399288398`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "86"}], ",", 
         RowBox[{"-", "24.269974409355655`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "3.8775911786038364`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "25"}], ",", 
         RowBox[{"-", "42.54981196867412`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "20.80843208570279`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "81"}], ",", 
         RowBox[{"-", "54.68796155536836`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"65", ",", "22.831056601156092`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "26"}], ",", 
         RowBox[{"-", "31.201808474111346`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "36.22559754146451`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "77"}], ",", 
         RowBox[{"-", "40.20243764439812`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"64", ",", "28.494261165540706`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "27"}], ",", 
         RowBox[{"-", "24.604246633906186`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "59.12517634469751`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "28"}], ",", 
         RowBox[{"-", "22.897889701499423`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "30.088206485303672`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "73"}], ",", 
         RowBox[{"-", "43.21011849466885`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "21.325192831261575`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "29"}], ",", 
         RowBox[{"-", "26.33830456473966`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "9.831998429306594`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "70"}], ",", 
         RowBox[{"-", "4.642731146775532`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"62", ",", "1.6840714760522246`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "30"}], ",", 
         RowBox[{"-", "35.33141568815893`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "59.268812849078714`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "66"}], ",", 
         RowBox[{"-", "44.20372472548877`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "29.697498086672454`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "31"}], ",", 
         RowBox[{"-", "50.536180082188764`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "59.67291319989776`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "63"}], ",", 
         RowBox[{"-", "40.49921609701954`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"58", ",", "45.05531231364046`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "33"}], ",", 
         RowBox[{"-", "12.995890331643238`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "12.877121318177558`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "60"}], ",", 
         RowBox[{"-", "51.2303821219011`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"56", ",", "46.76223000758682`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "34"}], ",", 
         RowBox[{"-", "44.497446444490265`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "41.819444976832045`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "58"}], ",", 
         RowBox[{"-", "13.053471620550994`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"54", ",", "32.61929820646557`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "36"}], ",", 
         RowBox[{"-", "28.312523782661003`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "31.615538293172065`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "55"}], ",", 
         RowBox[{"-", "41.03608665888757`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"51", ",", "58.112120355858394`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "38"}], ",", 
         RowBox[{"-", "31.652775417643966`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "53.09358529840651`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "53"}], ",", 
         RowBox[{"-", "6.283416894704459`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"48", ",", "52.91254556277622`"}], "}"}]}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "41"}], ",", 
         RowBox[{"-", "17.79065444133792`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "19.790612523618165`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "50"}], ",", 
         RowBox[{"-", "3.9161218352445815`"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44", ",", "43.87702003376006`"}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.477745695921875*^9, 3.47775167059375*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de m\[AAcute]ximo de eclipse al orto/ocaso.  \
\>", "Subsection",
 CellChangeTimes->{{3.477656997859375*^9, 3.477657003296875*^9}, 
   3.47774402696875*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"flagA", "\[Equal]", "1"}], "&&", 
    RowBox[{"flagE", "\[Equal]", "0"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"maxhorbisp", "[", "t1maxpen", "]"}], ",", 
     RowBox[{"curvasmaxhor", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"maxhor", ",", "intervalointmax5minuto"}], "]"}]}], ",", 
     RowBox[{"maxhorbisp", "[", "t4maxpen", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4772309401875*^9, 3.477230940671875*^9}, {
  3.477230974421875*^9, 3.477230975375*^9}, {3.477231137015625*^9, 
  3.477231142640625*^9}, {3.477232266890625*^9, 3.4772322679375*^9}, {
  3.47765697278125*^9, 3.4776569758125*^9}, {3.47765703846875*^9, 
  3.47765704709375*^9}, {3.477742407609375*^9, 3.477742437546875*^9}, {
  3.47774321*^9, 3.47774327725*^9}, {3.477745844234375*^9, 
  3.477745850453125*^9}, {3.477745888625*^9, 3.4777458899375*^9}, {
  3.477751791390625*^9, 3.477751794125*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "134"}], ",", 
        RowBox[{"-", "51.70878291669908`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"35", ",", "20.996362101945607`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "132"}], ",", 
          RowBox[{"-", "49.24766548698358`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"39", ",", "39.054898903535076`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "130"}], ",", 
          RowBox[{"-", "32.156873626415745`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"43", ",", "52.35316253011291`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "128"}], ",", 
          RowBox[{"-", "18.376963776416915`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"47", ",", "25.41381766613526`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "126"}], ",", 
          RowBox[{"-", "0.3457009650259124`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"50", ",", "31.017725821027682`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "123"}], ",", 
          RowBox[{"-", "33.678563723950674`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"53", ",", "15.294951542791608`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "120"}], ",", 
          RowBox[{"-", "55.79767820773753`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"55", ",", "41.32239476653098`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "118"}], ",", 
          RowBox[{"-", "3.150595720155991`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"57", ",", "51.77486587810051`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "114"}], ",", 
          RowBox[{"-", "53.26449033975962`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"59", ",", "47.871109539231895`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "111"}], ",", 
          RowBox[{"-", "24.898793080336645`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"61", ",", "29.945876958544915`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "107"}], ",", 
          RowBox[{"-", "35.73793338254234`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"62", ",", "58.51858850114397`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "103"}], ",", 
          RowBox[{"-", "26.487332548410336`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"64", ",", "13.094914687991093`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "98"}], ",", 
          RowBox[{"-", "57.56282147726665`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"65", ",", "13.434990235400903`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "94"}], ",", 
          RowBox[{"-", "11.565511834655524`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"65", ",", "59.02667546707306`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "89"}], ",", 
          RowBox[{"-", "12.908404511948675`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"66", ",", "29.408209624189965`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "84"}], ",", 
          RowBox[{"-", "6.506409394046386`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"66", ",", "44.345815900994126`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "78"}], ",", 
          RowBox[{"-", "59.50866890986646`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"66", ",", "43.78572239585935`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "73"}], ",", 
          RowBox[{"-", "57.415843882428135`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"66", ",", "27.971896241099046`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "43"}], ",", 
          RowBox[{"-", "53.43837381503249`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"66", ",", "3.2676798979028376`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "64"}], ",", 
          RowBox[{"-", "32.86332208886222`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"65", ",", "12.931080188720898`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "60"}], ",", 
          RowBox[{"-", "17.89621865587975`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"64", ",", "15.228213843750495`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "56"}], ",", 
          RowBox[{"-", "24.040482689759273`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"63", ",", "5.205063208806422`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "52"}], ",", 
          RowBox[{"-", "51.96552316659009`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"61", ",", "43.71967654496842`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "49"}], ",", 
          RowBox[{"-", "40.66580946091406`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"60", ",", "11.30292393251878`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "46"}], ",", 
          RowBox[{"-", "48.675866261544485`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"58", ",", "28.291456720050974`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "44"}], ",", 
          RowBox[{"-", "14.61302522802356`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"56", ",", "35.00322381941956`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "41"}], ",", 
          RowBox[{"-", "56.008825678366065`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"54", ",", "31.061204740533697`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "39"}], ",", 
          RowBox[{"-", "51.230776522483694`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"52", ",", "16.259392289733086`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "37"}], ",", 
          RowBox[{"-", "57.404095051798265`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"49", ",", "49.17389320259815`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "36"}], ",", 
          RowBox[{"-", "12.491248385302782`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"47", ",", "8.360870456511975`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "34"}], ",", 
          RowBox[{"-", "34.306283604268515`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"44", ",", "11.64412552999437`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "32"}], ",", 
          RowBox[{"-", "59.12775826784042`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"40", ",", "54.191819630050304`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "31"}], ",", 
          RowBox[{"-", "23.691879016992416`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"37", ",", "9.95758714324296`"}], "}"}]}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "29"}], ",", 
          RowBox[{"-", "41.45540659300245`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"32", ",", "45.905402320219366`"}], "}"}]}], "}"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "28"}], ",", 
        RowBox[{"-", "11.783049399689034`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"28", ",", "34.929073544685565`"}], "}"}]}], "}"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.477751736453125*^9, 3.477751812421875*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagE", "\[Equal]", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"maxhorbisp", "[", "t1maxpen", "]"}], ",", 
     RowBox[{"curvasmaxhorort", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"maxhor", ",", "intervalointmaxort5minuto"}], "]"}]}], ",", 
     RowBox[{"maxhorbisp", "[", "t2maxpen", "]"}], ",", 
     RowBox[{"maxhorbisp", "[", "t3maxpen", "]"}], ",", 
     RowBox[{"curvasmaxhoroca", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"maxhor", ",", "intervalointmaxoca5minuto"}], "]"}]}], ",", 
     RowBox[{"maxhorbisp", "[", "t4maxpen", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4777424600625*^9, 3.47774251109375*^9}, {
  3.477743131359375*^9, 3.477743137546875*^9}, {3.47774329134375*^9, 
  3.477743325046875*^9}, {3.47774388065625*^9, 3.47774388084375*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de curvas l\[IAcute]mite (penumbra y sombra) Norte y Sur.\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagE", "\[Equal]", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"extresmospuntoslimitep", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"maxhorbisp", ",", 
        RowBox[{"{", 
         RowBox[{
         "t1maxpen", ",", "t2maxpen", ",", "t3maxpen", ",", "t4maxpen"}], 
         "}"}]}], "]"}]}], ",", 
     RowBox[{"curvaslimitep", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"puntoslimitep", ",", "intervalointmax5minuto"}], "]"}]}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.47723125021875*^9, {3.477658481125*^9, 3.477658485875*^9}, {
   3.477744097109375*^9, 3.477744101578125*^9}, {3.477744189*^9, 
   3.47774427290625*^9}, {3.477744303*^9, 3.477744306*^9}, 
   3.477746045984375*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"flagA", "\[Equal]", "1"}], "&&", 
    RowBox[{"flagE", "\[Equal]", "0"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"extresmospuntoslimitep", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"maxhorbisp", ",", 
        RowBox[{"{", 
         RowBox[{"t1maxpen", ",", "t4maxpen"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"curvaslimitep", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"puntoslimitep", ",", "intervalointmax5minuto"}], "]"}]}]}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.47723125021875*^9, {3.477658481125*^9, 3.477658485875*^9}, {
   3.477744097109375*^9, 3.477744101578125*^9}, {3.477744189*^9, 
   3.47774427290625*^9}, {3.477744303*^9, 3.477744306*^9}, {
   3.477744409203125*^9, 3.477744417375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used by \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Solve\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\", so some solutions may not be found; \
use Reduce for complete solution information.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/ifun\\\", \
ButtonNote -> \\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.47775189821875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used by \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Solve\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\", so some solutions may not be found; \
use Reduce for complete solution information.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/ifun\\\", \
ButtonNote -> \\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.47775189909375*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used by \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Solve\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\", so some solutions may not be found; \
use Reduce for complete solution information.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/ifun\\\", \
ButtonNote -> \\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.477751899890625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Further output of \\\\\\\"\\\
\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Solve :: \\\"ifun\\\"\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" will be suppressed \
during this calculation.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.477751899890625*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "134"}], ",", 
          RowBox[{"-", "51.70878291669908`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"35", ",", "20.996362101945607`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "28"}], ",", 
          RowBox[{"-", "11.783049399689034`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"28", ",", "34.929073544685565`"}], "}"}]}], "}"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "124"}], ",", 
          RowBox[{"-", "22.65778879847943`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"30", ",", "19.56803984474007`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "118"}], ",", 
          RowBox[{"-", "35.225529680419356`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"27", ",", "18.658716610940758`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "114"}], ",", 
          RowBox[{"-", "27.71662515870588`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25", ",", "4.843410473230492`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "111"}], ",", 
          RowBox[{"-", "6.477839474792972`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"23", ",", "14.172619394941322`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "108"}], ",", 
          RowBox[{"-", "12.760403991859732`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"21", ",", "38.31470260455582`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "105"}], ",", 
          RowBox[{"-", "39.061644228630996`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20", ",", "14.174840350053088`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "103"}], ",", 
          RowBox[{"-", "18.052238155947293`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"18", ",", "58.38442916961725`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "101"}], ",", 
          RowBox[{"-", "5.876441041335738`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"17", ",", "49.34972809938564`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "99"}], ",", 
          RowBox[{"-", "1.6308037875333525`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"16", ",", "46.96283475355045`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "97"}], ",", 
          RowBox[{"-", "0.5430670092982837`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15", ",", "49.18371354462252`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "95"}], ",", 
          RowBox[{"-", "3.8652402229851646`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"14", ",", "56.98482571695482`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "93"}], ",", 
          RowBox[{"-", "8.658318735589887`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"14", ",", "9.368508156966833`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "91"}], ",", 
          RowBox[{"-", "14.3334211632353`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"13", ",", "26.5129840056656`"}], "}"}]}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "89"}], ",", 
          RowBox[{"-", "21.108124976942122`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12", ",", "48.85577513296173`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "87"}], ",", 
          RowBox[{"-", "26.780344845655293`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12", ",", "16.06054772748866`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "85"}], ",", 
          RowBox[{"-", "33.08580510185578`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "48.97715389709429`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "83"}], ",", 
          RowBox[{"-", "36.69506905982189`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "27.202768168149944`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "53"}], ",", 
          RowBox[{"-", "4.305675931881439`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "3.818014370241549`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "79"}], ",", 
          RowBox[{"-", "41.380090859555025`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "2.0833966329693254`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "77"}], ",", 
          RowBox[{"-", "40.50009965548668`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "59.02867871221755`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "75"}], ",", 
          RowBox[{"-", "37.59081202046218`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "2.6291030326101605`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "73"}], ",", 
          RowBox[{"-", "33.67422827326635`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "12.864708632998756`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "71"}], ",", 
          RowBox[{"-", "26.986428802032947`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "29.85674482984347`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "69"}], ",", 
          RowBox[{"-", "16.495594575755206`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"11", ",", "53.81284150084262`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "67"}], ",", 
          RowBox[{"-", "2.9663562925685483`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"12", ",", "24.565582300591338`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "64"}], ",", 
          RowBox[{"-", "43.55145193868793`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"13", ",", "2.7378578949572585`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "62"}], ",", 
          RowBox[{"-", "18.666418110643264`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"13", ",", "48.18593567564843`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "59"}], ",", 
          RowBox[{"-", "43.429967536340826`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"14", ",", "42.47633265831048`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "56"}], ",", 
          RowBox[{"-", "55.481779920094`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"15", ",", "46.58799525062456`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "53"}], ",", 
          RowBox[{"-", "50.5250348127548`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"17", ",", "2.2506873039098707`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "50"}], ",", 
          RowBox[{"-", "16.1939048026818`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"18", ",", "34.755674236436604`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "45"}], ",", 
          RowBox[{"-", "55.19225765372752`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"20", ",", "31.82193906084521`"}], "}"}]}], "}"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "39"}], ",", 
          RowBox[{"-", "50.986464791033654`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"23", ",", "18.62379222567519`"}], "}"}]}], "}"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47775192515625*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagD", "\[Equal]", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"extresmospuntoslimites", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"maxhorbiss", ",", 
        RowBox[{"{", 
         RowBox[{
         "t1maxsom", ",", "t2maxsom", ",", "t3maxsom", ",", "t4maxsom"}], 
         "}"}]}], "]"}]}], ",", 
     RowBox[{"curvaslimites", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"puntoslimites", ",", "intervalointmaxsom5minuto"}], "]"}]}]}],
     "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.47723125021875*^9, {3.477658481125*^9, 3.477658485875*^9}, {
   3.477744097109375*^9, 3.477744101578125*^9}, {3.477744189*^9, 
   3.47774427290625*^9}, {3.477744303*^9, 3.477744306*^9}, {
   3.477744446671875*^9, 3.47774447678125*^9}, {3.477744528109375*^9, 
   3.477744528265625*^9}, {3.477744773953125*^9, 3.477744795015625*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"flagB", "\[Equal]", "1"}], "&&", 
    RowBox[{"flagD", "\[Equal]", "0"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"extresmospuntoslimites", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"maxhorbiss", ",", 
        RowBox[{"{", 
         RowBox[{"t1maxsom", ",", "t4maxsom"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"curvaslimites", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"puntoslimites", ",", "intervalointmaxsom5minuto"}], "]"}]}]}],
     "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.47723125021875*^9, {3.477658481125*^9, 3.477658485875*^9}, {
   3.477744097109375*^9, 3.477744101578125*^9}, {3.477744189*^9, 
   3.47774427290625*^9}, {3.477744303*^9, 3.477744306*^9}, {
   3.477744446671875*^9, 3.477744521046875*^9}, {3.477744798453125*^9, 
   3.47774479984375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagE", "\[Equal]", "0"}], ",", 
   RowBox[{"curvaslimitehor", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"climite", ",", "intervalointmax5minuto"}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.477668671328125*^9, 3.477668697125*^9}, {
  3.477668845515625*^9, 3.477668863515625*^9}, {3.477744830140625*^9, 
  3.477744833328125*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"No hay puntos limite en ese instante\"\>", 
   ",", "\<\"No hay puntos limite en ese instante\"\>", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "66"}], ",", 
        RowBox[{"-", "8.881527813729804`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.9119961352809`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "67"}], ",", 
        RowBox[{"-", "23.862573057259056`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.91910429401622`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "68"}], ",", 
        RowBox[{"-", "38.87469278155862`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.92627124788436`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "69"}], ",", 
        RowBox[{"-", "53.855639895111835`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.933378925904265`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "71"}], ",", 
        RowBox[{"-", "8.805692173155535`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.94048704102477`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "72"}], ",", 
        RowBox[{"-", "23.817720529144424`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.94765319081887`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "73"}], ",", 
        RowBox[{"-", "38.76763504612455`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.95476082749627`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "74"}], ",", 
        RowBox[{"-", "53.739106207742964`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.961927947658694`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "76"}], ",", 
        RowBox[{"-", "8.760607762722543`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.96909276487651`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "77"}], ",", 
        RowBox[{"-", "23.741649554375783`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.976258875511746`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "78"}], ",", 
        RowBox[{"-", "38.72273848853098`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.983424659775096`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "79"}], ",", 
        RowBox[{"-", "53.7036868697183`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.99059012444087`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "81"}], ",", 
        RowBox[{"-", "8.684772765615207`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "45.99775542269299`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "82"}], ",", 
        RowBox[{"-", "23.625085332915603`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.004921695551104`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "83"}], ",", 
        RowBox[{"-", "38.62195212592127`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.01208575147922`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "58"}], ",", 
        RowBox[{"-", "43.68200566639061`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.019351065303056`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "86"}], ",", 
        RowBox[{"-", "8.574294963544844`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.02647483094955`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "87"}], ",", 
        RowBox[{"-", "23.549200599700555`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.03369894355154`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "88"}], ",", 
        RowBox[{"-", "38.545941316737355`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.040862027589355`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "89"}], ",", 
        RowBox[{"-", "53.5172889674476`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.04808596748086`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "91"}], ",", 
        RowBox[{"-", "8.498263173511873`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.05530904629603`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "92"}], ",", 
        RowBox[{"-", "23.47933592236501`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.06253195945982`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "93"}], ",", 
        RowBox[{"-", "38.46030104297881`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.06975455114849`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "94"}], ",", 
        RowBox[{"-", "53.45097028344526`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.07697644243444`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "96"}], ",", 
        RowBox[{"-", "8.416155760189099`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.084259190172645`"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "97"}], ",", 
        RowBox[{"-", "23.403405489953002`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"66", ",", "46.09148090366716`"}], "}"}]}], "}"}], "}"}], 
   ",", "\<\"No hay puntos limite en ese instante\"\>", 
   ",", "\<\"No hay puntos limite en ese instante\"\>", 
   ",", "\<\"No hay puntos limite en ese instante\"\>", 
   ",", "\<\"No hay puntos limite en ese instante\"\>", 
   ",", "\<\"No hay puntos limite en ese instante\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.4777519254375*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de puntos de corte cono de penumbra con elipsoide para las \
horas UT exactas. \
\>", "Subsection",
 CellChangeTimes->{{3.4773841219375*^9, 3.47738412275*^9}, {3.47765387225*^9, 
  3.47765390853125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"corteconopelip", ",", "intervalointpar60minuto"}], "]"}]], "Input",
 CellChangeTimes->{{3.4773833843125*^9, 3.47738339475*^9}, {
  3.47738351153125*^9, 3.47738351328125*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"16", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "84"}], ",", 
             RowBox[{"-", "14.287903168214768`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"62", ",", "17.970312786165294`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "130"}], ",", 
             RowBox[{"-", "8.391394374928609`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"33", ",", "40.294235646673826`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "82"}], ",", 
             RowBox[{"-", "40.78764661842769`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"60", ",", "7.818447789944116`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "127"}], ",", 
             RowBox[{"-", "43.67293593104961`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"32", ",", "34.51890537521621`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "81"}], ",", 
             RowBox[{"-", "25.172604796428857`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"57", ",", "54.9993372919964`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "125"}], ",", 
             RowBox[{"-", "19.71712680917875`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"31", ",", "28.921506785446027`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "80"}], ",", 
             RowBox[{"-", "24.663299572792994`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"55", ",", "39.54415249537362`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "122"}], ",", 
             RowBox[{"-", "55.89624973531272`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"30", ",", "23.634463093941136`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "79"}], ",", 
             RowBox[{"-", "37.31649113506421`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"53", ",", "21.3357797977514`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "120"}], ",", 
             RowBox[{"-", "31.494243761009386`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"29", ",", "18.864841791315`"}], "}"}]}], "}"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "118"}], ",", 
             RowBox[{"-", "5.667290004153074`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"28", ",", "14.911309148338532`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "79"}], ",", 
             RowBox[{"-", "1.8695525126005919`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"51", ",", "0.11595796835550232`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "115"}], ",", 
             RowBox[{"-", "37.384618266650875`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"27", ",", "12.193503172996358`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "78"}], ",", 
             RowBox[{"-", "37.65800397863643`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"48", ",", "35.47172838770109`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "113"}], ",", 
             RowBox[{"-", "5.333253021079827`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"26", ",", "11.302750022927412`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "78"}], ",", 
             RowBox[{"-", "24.607462281176993`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"46", ",", "6.795199518043944`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "110"}], ",", 
             RowBox[{"-", "27.752801298493353`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"25", ",", "13.093098109262158`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "78"}], ",", 
             RowBox[{"-", "23.322902406032142`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"43", ",", "33.19951231066071`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "107"}], ",", 
             RowBox[{"-", "42.12161775432378`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"24", ",", "18.85701150291098`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "78"}], ",", 
             RowBox[{"-", "35.34605030064739`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"40", ",", "53.347860177353965`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "104"}], ",", 
             RowBox[{"-", "44.483752125991884`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"23", ",", "30.70465739441339`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "79"}], ",", 
             RowBox[{"-", "3.7859544546395796`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"38", ",", "5.077406372733577`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "101"}], ",", 
             RowBox[{"-", "27.723213779778177`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"22", ",", "52.53851461661789`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "79"}], ",", 
             RowBox[{"-", "55.01228057035462`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"35", ",", "4.426885519693684`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "97"}], ",", 
             RowBox[{"-", "35.5577940806441`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"22", ",", "33.446209896917054`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "81"}], ",", 
             RowBox[{"-", "24.636302830944885`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"31", ",", "42.2453284581524`"}], "}"}]}], "}"}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "91"}], ",", 
             RowBox[{"-", "56.43734630678722`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"23", ",", "13.733576139988344`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "84"}], ",", 
             RowBox[{"-", "43.5926966264401`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"27", ",", "18.160154654191558`"}], "}"}]}], "}"}]}], 
        "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"17", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "37"}], ",", 
             RowBox[{"-", "29.903836239036394`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"58", ",", "50.97093866045469`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "136"}], ",", 
             RowBox[{"-", "53.981558136335366`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"43", ",", "38.944412386145046`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "39"}], ",", 
             RowBox[{"-", "52.11233486026231`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"56", ",", "55.96493272032774`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "134"}], ",", 
             RowBox[{"-", "22.330111851782135`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"42", ",", "17.366381930453656`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "42"}], ",", 
             RowBox[{"-", "1.2434891859912511`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"54", ",", "58.30749463975749`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "131"}], ",", 
             RowBox[{"-", "56.431215578392084`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"40", ",", "52.583710535297996`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "43"}], ",", 
             RowBox[{"-", "59.518667932802174`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"52", ",", "58.196626317800195`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "129"}], ",", 
             RowBox[{"-", "35.64241968000033`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"39", ",", "24.77635372780597`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "45"}], ",", 
             RowBox[{"-", "48.869468744821205`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", "55.762131278062554`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "127"}], ",", 
             RowBox[{"-", "19.2863064201282`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"37", ",", "54.11719946760911`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "47"}], ",", 
             RowBox[{"-", "31.00127410508634`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"48", ",", "51.077044382595176`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "125"}], ",", 
             RowBox[{"-", "6.647175156353455`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"36", ",", "20.772786222794366`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "49"}], ",", 
             RowBox[{"-", "7.450287483367077`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"46", ",", "44.16550175657548`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "122"}], ",", 
             RowBox[{"-", "56.96421718537522`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"34", ",", "44.904782369054885`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "50"}], ",", 
             RowBox[{"-", "39.635873218210804`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"44", ",", "35.00759116367604`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "120"}], ",", 
             RowBox[{"-", "49.420167699827005`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"33", ",", "6.672330066324577`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "52"}], ",", 
             RowBox[{"-", "8.911013665901208`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"42", ",", "23.541442545464832`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "118"}], ",", 
             RowBox[{"-", "43.12385472478496`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"31", ",", "26.23547881730744`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "53"}], ",", 
             RowBox[{"-", "36.6147498765325`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"40", ",", "9.662498196739477`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "116"}], ",", 
             RowBox[{"-", "37.08406191882915`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"29", ",", "43.76012815124895`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "55"}], ",", 
             RowBox[{"-", "4.132157801812042`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"37", ",", "53.219474082933544`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "114"}], ",", 
             RowBox[{"-", "30.170322899490714`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"27", ",", "59.42523024065906`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "112"}], ",", 
             RowBox[{"-", "21.052900498048075`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"26", ",", "13.433608715945908`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "56"}], ",", 
             RowBox[{"-", "32.9706042805762`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"35", ",", "34.00584538517535`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "110"}], ",", 
             RowBox[{"-", "8.107535020490957`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"24", ",", "26.028937863665647`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "58"}], ",", 
             RowBox[{"-", "4.867515216954956`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"33", ",", "11.744446338662442`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "107"}], ",", 
             RowBox[{"-", "49.25630473109493`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"22", ",", "37.52395064527228`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "59"}], ",", 
             RowBox[{"-", "41.958959819944965`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"30", ",", "46.06020804643897`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "105"}], ",", 
             RowBox[{"-", "21.68253817921908`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"20", ",", "48.35084868965971`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "61"}], ",", 
             RowBox[{"-", "27.071607298852456`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"28", ",", "16.430120189510546`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "102"}], ",", 
             RowBox[{"-", "41.269154380598536`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"18", ",", "59.16051088463533`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "63"}], ",", 
             RowBox[{"-", "24.2890428571053`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"25", ",", "42.08385213243943`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "99"}], ",", 
             RowBox[{"-", "41.331888885250976`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"17", ",", "11.04603386814695`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "65"}], ",", 
             RowBox[{"-", "40.22122872523198`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"23", ",", "1.7795090824506588`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "96"}], ",", 
             RowBox[{"-", "9.095341599217477`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"15", ",", "26.16360441262575`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "68"}], ",", 
             RowBox[{"-", "27.52930752949908`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"20", ",", "13.181511061568258`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "91"}], ",", 
             RowBox[{"-", "31.198207856536158`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"13", ",", "50.27988126388376`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "72"}], ",", 
             RowBox[{"-", "19.419410641983177`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"17", ",", "10.311384131978016`"}], "}"}]}], "}"}]}], 
        "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"18", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "24"}], ",", 
             RowBox[{"-", "42.99670021558576`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"40", ",", "11.404152005178787`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "122"}], ",", 
             RowBox[{"-", "3.943632540863007`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"60", ",", "29.241617139096263`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "27"}], ",", 
             RowBox[{"-", "10.966371901543113`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"38", ",", "54.228233505886436`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "119"}], ",", 
             RowBox[{"-", "54.14226764368465`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"58", ",", "28.44830271040081`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "29"}], ",", 
             RowBox[{"-", "34.156060141610354`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"37", ",", "33.896476346009194`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "117"}], ",", 
             RowBox[{"-", "57.87967778664893`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"56", ",", "25.35184526518904`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "31"}], ",", 
             RowBox[{"-", "53.091316076261705`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"36", ",", "10.570375005103472`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "116"}], ",", 
             RowBox[{"-", "12.659170897621266`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"54", ",", "20.101471798036243`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "34"}], ",", 
             RowBox[{"-", "8.33887152902804`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"34", ",", "44.41195214748731`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "114"}], ",", 
             RowBox[{"-", "36.380118302263895`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"52", ",", "12.77667816388444`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "36"}], ",", 
             RowBox[{"-", "20.51038269543099`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"33", ",", "15.584132451437114`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "113"}], ",", 
             RowBox[{"-", "7.240837914168026`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", "3.4000005091120045`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "38"}], ",", 
             RowBox[{"-", "30.268898684896897`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"31", ",", "44.25199230717794`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "111"}], ",", 
             RowBox[{"-", "43.659430108805566`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"47", ",", "51.94523106420874`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "40"}], ",", 
             RowBox[{"-", "38.33905897818099`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"30", ",", "10.585046398924902`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "110"}], ",", 
             RowBox[{"-", "24.207282717856344`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"45", ",", "38.34197815592361`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "42"}], ",", 
             RowBox[{"-", "45.52248587270512`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"28", ",", "34.760861942281025`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "109"}], ",", 
             RowBox[{"-", "7.550194378307538`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"43", ",", "22.477010832339914`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "44"}], ",", 
             RowBox[{"-", "52.720656448140915`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"26", ",", "56.97050318088152`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "107"}], ",", 
             RowBox[{"-", "52.39198284911197`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"41", ",", "4.192387491413427`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "47"}], ",", 
             RowBox[{"-", "0.9690006130730922`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"25", ",", "17.42667212645621`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "106"}], ",", 
             RowBox[{"-", "37.414629037194516`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"38", ",", "43.279846323107165`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "49"}], ",", 
             RowBox[{"-", "11.488673887556757`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"23", ",", "36.37606996426754`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "105"}], ",", 
             RowBox[{"-", "21.206832211191795`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"36", ",", "19.470167650026582`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "51"}], ",", 
             RowBox[{"-", "25.76771175475642`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"21", ",", "54.11877253012072`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "104"}], ",", 
             RowBox[{"-", "2.1680097063685366`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"33", ",", "52.41487326239394`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "53"}], ",", 
             RowBox[{"-", "45.694218218236244`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"20", ",", "11.040041694226588`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "102"}], ",", 
             RowBox[{"-", "38.36415388281978`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"31", ",", "21.65494589094621`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "56"}], ",", 
             RowBox[{"-", "13.78906970013162`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"18", ",", "27.665938527355536`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "101"}], ",", 
             RowBox[{"-", "7.287386386364574`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"28", ",", "46.56526950758057`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "99"}], ",", 
             RowBox[{"-", "25.408311787124944`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"26", ",", "6.248428310206506`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "58"}], ",", 
             RowBox[{"-", "53.6485587050926`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"16", ",", "44.769138654352005`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "97"}], ",", 
             RowBox[{"-", "27.225005352270273`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"23", ",", "19.307276975487184`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "61"}], ",", 
             RowBox[{"-", "50.8928400215396`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"15", ",", "3.595553911316145`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "95"}], ",", 
             RowBox[{"-", "2.8330944915316536`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"20", ",", "23.264014873099015`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "65"}], ",", 
             RowBox[{"-", "15.595568121298413`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"13", ",", "26.444027265872165`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "91"}], ",", 
             RowBox[{"-", "49.46239177222594`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"17", ",", "12.543709491531203`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "69"}], ",", 
             RowBox[{"-", "30.74925904526026`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"11", ",", "58.68114148402036`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "86"}], ",", 
             RowBox[{"-", "5.624849704621511`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"13", ",", "22.856752330891865`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "76"}], ",", 
             RowBox[{"-", "18.121745663169406`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"11", ",", "4.3566325390693095`"}], "}"}]}], "}"}]}], 
        "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"19", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "30"}], ",", 
             RowBox[{"-", "42.1701773306053`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"27", ",", "28.36581942761299`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "75"}], ",", 
             RowBox[{"-", "55.613704095517846`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"61", ",", "18.48222520664976`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "33"}], ",", 
             RowBox[{"-", "0.4623428957687281`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"26", ",", "26.56643085977244`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "77"}], ",", 
             RowBox[{"-", "47.20130368573422`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"59", ",", "12.424852020070034`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "35"}], ",", 
             RowBox[{"-", "18.21795603145432`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"25", ",", "24.75104838889706`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "79"}], ",", 
             RowBox[{"-", "21.47245838089418`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"57", ",", "3.4230436303974443`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "37"}], ",", 
             RowBox[{"-", "35.92408720607352`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"24", ",", "23.034525116055633`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "80"}], ",", 
             RowBox[{"-", "41.06216677199541`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"54", ",", "51.57816766811564`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "39"}], ",", 
             RowBox[{"-", "54.12818647249921`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"23", ",", "21.591424979968323`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "81"}], ",", 
             RowBox[{"-", "47.91643287372665`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"52", ",", "36.8522511309132`"}], "}"}]}], "}"}]}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "42"}], ",", 
             RowBox[{"-", "13.460335768555609`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"22", ",", "20.66663676743481`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "82"}], ",", 
             RowBox[{"-", "43.41919174808339`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"50", ",", "19.081412050201436`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "44"}], ",", 
             RowBox[{"-", "34.66443985167473`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"21", ",", "20.59285430748467`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "83"}], ",", 
             RowBox[{"-", "28.474890469919956`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"47", ",", "57.974922710917696`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "46"}], ",", 
             RowBox[{"-", "58.64448646110432`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"20", ",", "21.818829668273878`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "84"}], ",", 
             RowBox[{"-", "3.54856469942888`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"45", ",", "33.09842293591274`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "49"}], ",", 
             RowBox[{"-", "26.537199374608065`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"19", ",", "24.955824030827216`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "84"}], ",", 
             RowBox[{"-", "28.65881037763529`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"43", ",", "3.835492138958756`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "51"}], ",", 
             RowBox[{"-", "59.833684461602274`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"18", ",", "30.85723501055341`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "84"}], ",", 
             RowBox[{"-", "43.306314119190006`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"40", ",", "29.313704162602363`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "54"}], ",", 
             RowBox[{"-", "40.599575865981166`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"17", ",", "40.764324542979224`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "84"}], ",", 
             RowBox[{"-", "46.29241723081208`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"37", ",", "48.262991463356`"}], "}"}]}], "}"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "57"}], ",", 
             RowBox[{"-", "31.916019272966878`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"16", ",", "56.599448429124735`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "84"}], ",", 
             RowBox[{"-", "35.308342236110946`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"34", ",", "58.725435223500426`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "60"}], ",", 
             RowBox[{"-", "38.89894652553778`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"16", ",", "21.644517968377244`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "84"}], ",", 
             RowBox[{"-", "5.939823919650564`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"31", ",", "57.37911456580832`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "64"}], ",", 
             RowBox[{"-", "11.648211476924075`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"16", ",", "2.5029260423535504`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "83"}], ",", 
             RowBox[{"-", "8.737200875159203`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"28", ",", "37.57804450671024`"}], "}"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "68"}], ",", 
             RowBox[{"-", "38.44746262860667`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"16", ",", "17.87096290810034`"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "81"}], ",", 
             RowBox[{"-", "16.031298429601577`"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"24", ",", "40.58237301531484`"}], "}"}]}], "}"}]}], 
        "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.477383707140625*^9, 3.477383819125*^9, 3.477746265*^9, 
  3.4777520683125*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de la curva de eclipse central mediante el corte del eje de \
sombra con el elipsoide terrestre (hora UT, lon, lat, duraci\[OAcute]n).\
\>", "Subsection",
 CellChangeTimes->{3.477744057296875*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"flagC", "\[Equal]", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "tinicen", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"curvacentral", "=", 
        RowBox[{"datoreal", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"corteejeelip", ",", "intervalointcen5minuto"}], "]"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "tfincen", "]"}]}], "}"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Da", " ", "los", " ", "puntos", " ", "de", " ", "la", " ", "curva", " ", 
     "central", " ", "incluidos", " ", "los", " ", "l\[IAcute]mites"}], " ", 
    "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.477235924453125*^9, 3.477235937546875*^9}, {
  3.4772360064375*^9, 3.47723603240625*^9}, {3.4772360776875*^9, 
  3.477236084359375*^9}, {3.47723643040625*^9, 3.4772364579375*^9}, {
  3.4772364903125*^9, 3.477236527015625*^9}, {3.477236697171875*^9, 
  3.477236705640625*^9}, {3.47765402959375*^9, 3.477654040140625*^9}, {
  3.477806112453125*^9, 3.477806131484375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "39.2957084670379`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "34"}], ",", 
     RowBox[{"-", "35.02871673539019`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.477654997203125*^9, 3.477746273875*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "14.763798262179737`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "39"}], ",", 
       RowBox[{"-", "46.191557013374194`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "12.136723456504619`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "41"}], ",", 
       RowBox[{"-", "35.50422551567081`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"19", ",", "12.3479567432139`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "42"}], ",", 
       RowBox[{"-", "38.54248697075988`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"24", ",", "13.982013970507836`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "17.100759244417958`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"28", ",", "38.04142754143719`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "39.35934143658727`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"32", ",", "34.88431499919869`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "49.54239596054549`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"36", ",", "10.516171440382465`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "50.204289014241965`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"39", ",", "28.792131117372293`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "43.06526580994017`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"42", ",", "32.38613627109288`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "29.349481883386233`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"45", ",", "23.267210373965383`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "9.987372615513976`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"48", ",", "2.952476855695778`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "42"}], ",", 
       RowBox[{"-", "45.697376366237705`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"50", ",", "32.672818178438945`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "42"}], ",", 
       RowBox[{"-", "17.057306784045068`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"52", ",", "53.45405798655264`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "41"}], ",", 
       RowBox[{"-", "44.53604695506996`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"55", ",", "6.151972869700728`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "41"}], ",", 
       RowBox[{"-", "8.529708865882952`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"57", ",", "11.546195845830027`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "40"}], ",", 
       RowBox[{"-", "29.355492272337784`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"59", ",", "10.311910833793831`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "39"}], ",", 
       RowBox[{"-", "47.290753861443164`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"61", ",", "3.061428358874707`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "39"}], ",", 
       RowBox[{"-", "2.5701612735984725`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"62", ",", "50.36301659184517`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "38"}], ",", 
       RowBox[{"-", "15.375708172840774`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"64", ",", "32.73253820199784`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "37"}], ",", 
       RowBox[{"-", "25.878243976969202`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"66", ",", "10.671737819322402`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "36"}], ",", 
       RowBox[{"-", "34.209857718315675`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"67", ",", "44.639594532882825`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "35"}], ",", 
       RowBox[{"-", "40.48836320829807`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"69", ",", "15.076310514027682`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "34"}], ",", 
       RowBox[{"-", "44.797718610792714`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"70", ",", "42.42440721522598`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "33"}], ",", 
       RowBox[{"-", "47.20487834170214`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"72", ",", "7.086630795063229`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "32"}], ",", 
       RowBox[{"-", "47.7655330993197`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"73", ",", "29.472443896402467`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "31"}], ",", 
       RowBox[{"-", "46.509423531229714`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"74", ",", "50.000980287157404`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "30"}], ",", 
       RowBox[{"-", "43.45070104075603`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"76", ",", "9.086974532391423`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "29"}], ",", 
       RowBox[{"-", "38.58859690629771`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"77", ",", "27.140154621764907`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "28"}], ",", 
       RowBox[{"-", "31.899151695484917`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"78", ",", "44.61071459958106`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "27"}], ",", 
       RowBox[{"-", "23.341863885389884`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"80", ",", "1.9673140754392193`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "26"}], ",", 
       RowBox[{"-", "12.856628296111055`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"81", ",", "19.69644830778776`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "25"}], ",", 
       RowBox[{"-", "0.3512120427058818`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"82", ",", "38.36590592941974`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "23"}], ",", 
       RowBox[{"-", "45.71333510862331`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"83", ",", "58.570533142455474`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "22"}], ",", 
       RowBox[{"-", "28.789631066692323`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"85", ",", "21.03207347963462`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "21"}], ",", 
       RowBox[{"-", "9.396688340548565`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"86", ",", "46.56941798190644`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "19"}], ",", 
       RowBox[{"-", "47.28169681477745`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"88", ",", "16.19071592705211`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "18"}], ",", 
       RowBox[{"-", "22.13416983953998`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"89", ",", "51.116046895925535`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "16"}], ",", 
       RowBox[{"-", "53.54471421455024`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"91", ",", "32.96165918079339`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "15"}], ",", 
       RowBox[{"-", "20.963231101251232`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"93", ",", "23.8402299531856`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "13"}], ",", 
       RowBox[{"-", "43.6515270268162`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"95", ",", "26.717711666258026`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "12"}], ",", 
       RowBox[{"-", "0.5536704212055099`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"97", ",", "46.07094613711865`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "10"}], ",", 
       RowBox[{"-", "10.07575630122517`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"100", ",", "29.11696112441831`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "8"}], ",", 
       RowBox[{"-", "9.641340250848174`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"103", ",", "49.25153142378349`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5"}], ",", 
       RowBox[{"-", "54.49813995215262`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"108", ",", "17.60950805345857`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3"}], ",", 
       RowBox[{"-", "13.714868402716531`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"116", ",", "6.436162389698552`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "38.462857164871586`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.477654997203125*^9, 3.4777462744375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"124", ",", "2.0971865380977306`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "42.18770576181652`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.477654997203125*^9, 3.477746274453125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagC", "\[Equal]", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"curvacentralt", "=", 
      RowBox[{"datoreal", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"corteejeelipt", ",", "intervalointcen5minuto"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"curvacentraldur", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"puntoejedur", ",", "curvacentralt"}], "]"}]}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Da", " ", "la", " ", "hora", " ", "los", " ", "puntos", " ", "y", " ", 
    "la", " ", "totalidad", " ", "para", " ", "intervalosminuto"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.47723653571875*^9, 3.477236550515625*^9}, {
   3.4772367145*^9, 3.477236719609375*^9}, 3.477654080015625*^9, {
   3.47780613759375*^9, 3.477806158359375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "10", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "14.763798262179737`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "39"}], ",", 
       RowBox[{"-", "46.191557013374194`"}]}], "}"}], ",", 
     RowBox[{"{", "367.85495849055076`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "15", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "12.136723456504619`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "41"}], ",", 
       RowBox[{"-", "35.50422551567081`"}]}], "}"}], ",", 
     RowBox[{"{", "382.5454019427476`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "20", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"19", ",", "12.3479567432139`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "42"}], ",", 
       RowBox[{"-", "38.54248697075988`"}]}], "}"}], ",", 
     RowBox[{"{", "394.3143533425765`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "25", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"24", ",", "13.982013970507836`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "17.100759244417958`"}]}], "}"}], ",", 
     RowBox[{"{", "404.53440389914243`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "30", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"28", ",", "38.04142754143719`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "39.35934143658727`"}]}], "}"}], ",", 
     RowBox[{"{", "413.625443352328`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "35", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"32", ",", "34.88431499919869`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "49.54239596054549`"}]}], "}"}], ",", 
     RowBox[{"{", "421.86163074022716`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "40", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"36", ",", "10.516171440382465`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "50.204289014241965`"}]}], "}"}], ",", 
     RowBox[{"{", "429.34246148724975`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "45", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"39", ",", "28.792131117372293`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "43.06526580994017`"}]}], "}"}], ",", 
     RowBox[{"{", "436.14071250883467`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "50", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"42", ",", "32.38613627109288`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "29.349481883386233`"}]}], "}"}], ",", 
     RowBox[{"{", "442.2659415299165`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "55", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"45", ",", "23.267210373965383`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "43"}], ",", 
       RowBox[{"-", "9.987372615513976`"}]}], "}"}], ",", 
     RowBox[{"{", "447.7604672094309`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"48", ",", "2.952476855695778`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "42"}], ",", 
       RowBox[{"-", "45.697376366237705`"}]}], "}"}], ",", 
     RowBox[{"{", "452.6703536355951`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "5", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"50", ",", "32.672818178438945`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "42"}], ",", 
       RowBox[{"-", "17.057306784045068`"}]}], "}"}], ",", 
     RowBox[{"{", "456.9451956009598`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "10", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"52", ",", "53.45405798655264`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "41"}], ",", 
       RowBox[{"-", "44.53604695506996`"}]}], "}"}], ",", 
     RowBox[{"{", "460.6588273537042`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "15", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"55", ",", "6.151972869700728`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "41"}], ",", 
       RowBox[{"-", "8.529708865882952`"}]}], "}"}], ",", 
     RowBox[{"{", "463.7886522678933`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "20", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"57", ",", "11.546195845830027`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "40"}], ",", 
       RowBox[{"-", "29.355492272337784`"}]}], "}"}], ",", 
     RowBox[{"{", "466.3508104026546`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "25", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"59", ",", "10.311910833793831`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "39"}], ",", 
       RowBox[{"-", "47.290753861443164`"}]}], "}"}], ",", 
     RowBox[{"{", "468.3649634675174`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "30", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"61", ",", "3.061428358874707`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "39"}], ",", 
       RowBox[{"-", "2.5701612735984725`"}]}], "}"}], ",", 
     RowBox[{"{", "469.8232913285029`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "35", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"62", ",", "50.36301659184517`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "38"}], ",", 
       RowBox[{"-", "15.375708172840774`"}]}], "}"}], ",", 
     RowBox[{"{", "470.7785345813562`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "40", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"64", ",", "32.73253820199784`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "37"}], ",", 
       RowBox[{"-", "25.878243976969202`"}]}], "}"}], ",", 
     RowBox[{"{", "471.24308846480875`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "45", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"66", ",", "10.671737819322402`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "36"}], ",", 
       RowBox[{"-", "34.209857718315675`"}]}], "}"}], ",", 
     RowBox[{"{", "471.1953978632833`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "50", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"67", ",", "44.639594532882825`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "35"}], ",", 
       RowBox[{"-", "40.48836320829807`"}]}], "}"}], ",", 
     RowBox[{"{", "470.67861094339867`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "55", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"69", ",", "15.076310514027682`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "34"}], ",", 
       RowBox[{"-", "44.797718610792714`"}]}], "}"}], ",", 
     RowBox[{"{", "469.7099363312246`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"70", ",", "42.42440721522598`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "33"}], ",", 
       RowBox[{"-", "47.20487834170214`"}]}], "}"}], ",", 
     RowBox[{"{", "468.34362739057855`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "5", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"72", ",", "7.086630795063229`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "32"}], ",", 
       RowBox[{"-", "47.7655330993197`"}]}], "}"}], ",", 
     RowBox[{"{", "466.56585995586914`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "9", ",", "59.99999999999789`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"73", ",", "29.472443896402467`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "31"}], ",", 
       RowBox[{"-", "46.509423531229714`"}]}], "}"}], ",", 
     RowBox[{"{", "464.41662218406117`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "15", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"74", ",", "50.000980287157404`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "30"}], ",", 
       RowBox[{"-", "43.45070104075603`"}]}], "}"}], ",", 
     RowBox[{"{", "461.9174966526671`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "20", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"76", ",", "9.086974532391423`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "29"}], ",", 
       RowBox[{"-", "38.58859690629771`"}]}], "}"}], ",", 
     RowBox[{"{", "459.0702878667667`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "24", ",", "59.99999999999779`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"77", ",", "27.140154621764907`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "28"}], ",", 
       RowBox[{"-", "31.899151695484917`"}]}], "}"}], ",", 
     RowBox[{"{", "455.9027541536558`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "30", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"78", ",", "44.61071459958106`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "27"}], ",", 
       RowBox[{"-", "23.341863885389884`"}]}], "}"}], ",", 
     RowBox[{"{", "452.43541389259735`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "35", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"80", ",", "1.9673140754392193`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "26"}], ",", 
       RowBox[{"-", "12.856628296111055`"}]}], "}"}], ",", 
     RowBox[{"{", "448.7043635169616`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "39", ",", "59.99999999999779`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"81", ",", "19.69644830778776`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "25"}], ",", 
       RowBox[{"-", "0.3512120427058818`"}]}], "}"}], ",", 
     RowBox[{"{", "444.6920093235583`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "45", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"82", ",", "38.36590592941974`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "23"}], ",", 
       RowBox[{"-", "45.71333510862331`"}]}], "}"}], ",", 
     RowBox[{"{", "440.4297891732572`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "50", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"83", ",", "58.570533142455474`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "22"}], ",", 
       RowBox[{"-", "28.789631066692323`"}]}], "}"}], ",", 
     RowBox[{"{", "435.9062850751567`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "54", ",", "59.99999999999779`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"85", ",", "21.03207347963462`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "21"}], ",", 
       RowBox[{"-", "9.396688340548565`"}]}], "}"}], ",", 
     RowBox[{"{", "431.1469843543073`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"86", ",", "46.56941798190644`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "19"}], ",", 
       RowBox[{"-", "47.28169681477745`"}]}], "}"}], ",", 
     RowBox[{"{", "426.1306342379481`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "5", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"88", ",", "16.19071592705211`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "18"}], ",", 
       RowBox[{"-", "22.13416983953998`"}]}], "}"}], ",", 
     RowBox[{"{", "420.86215734891005`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "9", ",", "59.99999999999789`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"89", ",", "51.116046895925535`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "16"}], ",", 
       RowBox[{"-", "53.54471421455024`"}]}], "}"}], ",", 
     RowBox[{"{", "415.3538672510674`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "15", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"91", ",", "32.96165918079339`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "15"}], ",", 
       RowBox[{"-", "20.963231101251232`"}]}], "}"}], ",", 
     RowBox[{"{", "409.5383863620491`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "20", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"93", ",", "23.8402299531856`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "13"}], ",", 
       RowBox[{"-", "43.6515270268162`"}]}], "}"}], ",", 
     RowBox[{"{", "403.42324313589444`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "24", ",", "59.99999999999779`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"95", ",", "26.717711666258026`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "12"}], ",", 
       RowBox[{"-", "0.5536704212055099`"}]}], "}"}], ",", 
     RowBox[{"{", "396.93193369776515`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "30", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"97", ",", "46.07094613711865`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "10"}], ",", 
       RowBox[{"-", "10.07575630122517`"}]}], "}"}], ",", 
     RowBox[{"{", "389.96046079925793`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "35", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "29.11696112441831`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "8"}], ",", 
       RowBox[{"-", "9.641340250848174`"}]}], "}"}], ",", 
     RowBox[{"{", "382.381396009292`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "39", ",", "59.99999999999779`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"103", ",", "49.25153142378349`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "5"}], ",", 
       RowBox[{"-", "54.49813995215262`"}]}], "}"}], ",", 
     RowBox[{"{", "373.908055929973`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "45", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"108", ",", "17.60950805345857`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3"}], ",", 
       RowBox[{"-", "13.714868402716531`"}]}], "}"}], ",", 
     RowBox[{"{", "363.8307538085474`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "50", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"116", ",", "6.436162389698552`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "38.462857164871586`"}], "}"}], ",", 
     RowBox[{"{", "349.19390713305455`", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.477655033921875*^9, 3.47774627565625*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
C\[AAcute]lculo de punto de m\[AAcute]ximo eclipse (punto eje sombra m\
\[AAcute]s pr\[OAcute]ximo a centro tierra).\
\>", "Subsection",
 CellChangeTimes->{3.477744060609375*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"flagA", "\[Equal]", "1"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pdisejecen", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"horas", ",", 
           RowBox[{
            SuperscriptBox["elementox", "2"], "+", 
            SuperscriptBox["elementoy", "2"]}]}], "}"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmaxecl", "=", 
       RowBox[{"(", 
        RowBox[{"t", "/.", 
         RowBox[{"FindRoot", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"pdisejecen", "[", "t", "]"}], ",", "t"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "tinipar"}], "}"}]}], "]"}]}], ")"}]}], ";", 
      RowBox[{"h2hms", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"tmaxecl", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"First", "[", "fech", "]"}], "-", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{"First", "[", "fech", "]"}], "]"}], "-", "0.5"}], ")"}],
            "*", "24"}], "-", 
          RowBox[{"\[CapitalDelta]t", "/", "3600"}]}], ",", "24"}], "]"}], 
       "]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Instante", " ", "en", " ", "que", " ", "el", " ", "eje", " ", "de", " ", 
    "sombra", " ", "est\[AAcute]", " ", "mas", " ", "cerca", " ", "del", " ", 
    "centro", " ", "del", " ", "elipsoide"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"flagA", "\[Equal]", "1"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"flagC", "\[Equal]", "1"}], ",", 
     RowBox[{"corteejeelip2lonlat", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"pelex", "[", "tmaxecl", "]"}], ",", 
        RowBox[{"peley", "[", "tmaxecl", "]"}], ",", 
        RowBox[{"peled", "[", "tmaxecl", "]"}], ",", 
        RowBox[{"pele\[Mu]", "[", "tmaxecl", "]"}], ",", "tmaxecl"}], "}"}], 
      "]"}], ",", 
     RowBox[{"\[Xi]\[Eta]fun2lonlat", "[", "tmaxecl", "]"}]}], "]"}]}], " ", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "si", " ", "hay", " ", "corte", " ", "con", " ", "el", " ", "eje", " ", 
     "el", " ", "punto", " ", "de", " ", "corte"}], ",", " ", 
    RowBox[{
    "si", " ", "no", " ", "el", " ", "punto", " ", "de", " ", "la", " ", 
     "Tierra", " ", "m\[AAcute]s", " ", "cercano", " ", "al", " ", "eje", " ",
      "en", " ", "ese", " ", "instante"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4777448859375*^9, 3.477744913078125*^9}, {
  3.47774494946875*^9, 3.47774506778125*^9}, {3.477745118078125*^9, 
  3.477745155328125*^9}, {3.477806175453125*^9, 3.47780618184375*^9}, {
  3.477806258953125*^9, 3.477806317671875*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "6"}], ",", 
   RowBox[{"-", "25"}], ",", 
   RowBox[{"-", "9.96442518215581`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47774629796875*^9, 3.47775214125*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "74"}], ",", 
     RowBox[{"-", "6.817865079373178`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"66", ",", "28.708090116377036`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47774629796875*^9, 3.477752141265625*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{568, 527},
WindowMargins->{{Automatic, 161}, {Automatic, 21}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 43, 0, 36, "Subsection"],
Cell[CellGroupData[{
Cell[635, 26, 61, 0, 27, "Subsubsection"],
Cell[699, 28, 340, 10, 52, "Input"],
Cell[1042, 40, 902, 25, 72, "Input"],
Cell[1947, 67, 678, 18, 52, "Input"],
Cell[2628, 87, 378, 12, 52, "Input"],
Cell[3009, 101, 907, 27, 92, "Input"],
Cell[3919, 130, 489, 15, 52, "Input"],
Cell[4411, 147, 458, 14, 72, "Input"],
Cell[4872, 163, 1011, 31, 92, "Input"],
Cell[5886, 196, 158, 4, 31, "Input"],
Cell[6047, 202, 158, 4, 31, "Input"],
Cell[6208, 208, 263, 8, 31, "Input"],
Cell[6474, 218, 528, 17, 52, "Input"],
Cell[7005, 237, 338, 10, 31, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[7380, 252, 41, 0, 21, "Subsubsection"],
Cell[7424, 254, 629, 19, 100, "Input"],
Cell[8056, 275, 1367, 40, 144, "Input"],
Cell[9426, 317, 1012, 23, 108, "Input"],
Cell[10441, 342, 203, 5, 47, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[10681, 352, 59, 0, 21, "Subsubsection"],
Cell[10743, 354, 1322, 35, 92, "Input"],
Cell[12068, 391, 905, 28, 77, "Input"],
Cell[12976, 421, 1419, 48, 157, "Input"],
Cell[14398, 471, 257, 8, 31, "Input"],
Cell[14658, 481, 223, 6, 31, "Input"],
Cell[14884, 489, 283, 8, 31, "Input"],
Cell[15170, 499, 2004, 60, 175, "Input"],
Cell[17177, 561, 475, 15, 68, "Input"],
Cell[17655, 578, 2629, 66, 212, "Input"],
Cell[20287, 646, 2146, 58, 192, "Input"],
Cell[22436, 706, 855, 24, 72, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[23328, 735, 76, 2, 21, "Subsubsection"],
Cell[23407, 739, 1671, 48, 142, "Input"],
Cell[25081, 789, 1452, 41, 112, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[26570, 835, 382, 6, 37, "Subsubsection"],
Cell[26955, 843, 1394, 40, 172, "Input"],
Cell[28352, 885, 232, 5, 31, "Input"],
Cell[28587, 892, 414, 12, 52, "Input"],
Cell[29004, 906, 234, 5, 31, "Input"],
Cell[29241, 913, 268, 6, 31, "Input"],
Cell[29512, 921, 177, 4, 31, "Input"],
Cell[29692, 927, 267, 6, 31, "Input"],
Cell[29962, 935, 632, 17, 72, "Input"],
Cell[30597, 954, 525, 14, 52, "Input"],
Cell[31125, 970, 632, 17, 72, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[31794, 992, 251, 5, 37, "Subsubsection"],
Cell[32048, 999, 1015, 31, 114, "Input"],
Cell[33066, 1032, 1291, 36, 134, "Input"],
Cell[34360, 1070, 320, 8, 31, "Input"],
Cell[34683, 1080, 343, 8, 31, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[35063, 1093, 140, 3, 21, "Subsubsection"],
Cell[35206, 1098, 2228, 61, 250, "Input"],
Cell[37437, 1161, 842, 24, 92, "Input"],
Cell[38282, 1187, 1221, 33, 112, "Input"],
Cell[39506, 1222, 1186, 32, 112, "Input"],
Cell[40695, 1256, 429, 11, 72, "Input"],
Cell[41127, 1269, 426, 11, 72, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[41590, 1285, 149, 3, 21, "Subsubsection"],
Cell[41742, 1290, 522, 15, 52, "Input"],
Cell[42267, 1307, 984, 23, 112, "Input"],
Cell[43254, 1332, 1895, 51, 182, "Input"],
Cell[45152, 1385, 681, 18, 92, "Input"],
Cell[45836, 1405, 2075, 56, 232, "Input"],
Cell[47914, 1463, 1084, 30, 132, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[49035, 1498, 147, 2, 21, "Subsubsection"],
Cell[49185, 1502, 1854, 55, 207, "Input"],
Cell[51042, 1559, 1153, 33, 132, "Input"],
Cell[52198, 1594, 1460, 39, 192, "Input"],
Cell[53661, 1635, 1351, 36, 172, "Input"],
Cell[55015, 1673, 1021, 23, 132, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[56073, 1701, 115, 1, 21, "Subsubsection"],
Cell[56191, 1704, 278, 7, 31, "Input"],
Cell[56472, 1713, 3766, 95, 469, "Input"],
Cell[60241, 1810, 1429, 39, 172, "Input"],
Cell[61673, 1851, 1950, 51, 252, "Input"],
Cell[63626, 1904, 1507, 40, 232, "Input"],
Cell[65136, 1946, 987, 27, 152, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[66160, 1978, 164, 3, 21, "Subsubsection"],
Cell[66327, 1983, 15950, 385, 1329, "Input"],
Cell[82280, 2370, 2126, 56, 252, "Input"],
Cell[84409, 2428, 1623, 40, 212, "Input"],
Cell[86035, 2470, 1729, 42, 172, "Input"],
Cell[87767, 2514, 1343, 29, 172, "Input"],
Cell[89113, 2545, 1601, 41, 192, "Input"],
Cell[90717, 2588, 1156, 27, 152, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[91910, 2620, 195, 4, 21, "Subsubsection"],
Cell[92108, 2626, 4325, 110, 433, "Input"],
Cell[96436, 2738, 1568, 40, 172, "Input"],
Cell[98007, 2780, 1646, 41, 212, "Input"],
Cell[99656, 2823, 1680, 42, 172, "Input"],
Cell[101339, 2867, 1089, 26, 132, "Input"],
Cell[102431, 2895, 89, 1, 31, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[102557, 2901, 94, 2, 21, "Subsubsection"],
Cell[102654, 2905, 5567, 145, 511, "Input"],
Cell[108224, 3052, 1519, 39, 172, "Input"],
Cell[109746, 3093, 1613, 40, 212, "Input"],
Cell[111362, 3135, 1725, 43, 172, "Input"],
Cell[113090, 3180, 1136, 27, 132, "Input"],
Cell[114229, 3209, 217, 3, 132, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[114483, 3217, 260, 5, 37, "Subsubsection"],
Cell[114746, 3224, 7614, 185, 660, "Input"],
Cell[122363, 3411, 1721, 43, 158, "Input"],
Cell[124087, 3456, 650, 15, 72, "Input"],
Cell[124740, 3473, 891, 25, 112, "Input"],
Cell[125634, 3500, 1998, 43, 232, "Input"],
Cell[127635, 3545, 2072, 48, 232, "Input"],
Cell[129710, 3595, 2806, 66, 323, "Input"],
Cell[132519, 3663, 1054, 27, 112, "Input"],
Cell[133576, 3692, 1284, 33, 172, "Input"],
Cell[134863, 3727, 1177, 27, 132, "Input"],
Cell[136043, 3756, 1718, 42, 192, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[137810, 3804, 54, 0, 36, "Subsection"],
Cell[137867, 3806, 1373, 35, 279, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[139277, 3846, 38, 0, 28, "Subsection"],
Cell[139318, 3848, 231, 4, 47, "Text"],
Cell[139552, 3854, 9227, 255, 1308, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[148816, 4114, 186, 3, 62, "Subsection"],
Cell[149005, 4119, 4082, 126, 632, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[153124, 4250, 123, 3, 45, "Subsection"],
Cell[153250, 4255, 2945, 96, 332, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[156232, 4356, 181, 3, 62, "Subsection"],
Cell[156416, 4361, 2826, 79, 312, "Input"],
Cell[159245, 4442, 832, 22, 112, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[160114, 4469, 138, 3, 28, "Subsection"],
Cell[160255, 4474, 4323, 118, 472, "Input"],
Cell[CellGroupData[{
Cell[164603, 4596, 1189, 27, 172, "Input"],
Cell[165795, 4625, 189, 2, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[166033, 4633, 204, 4, 53, "Subsection"],
Cell[166240, 4639, 1491, 47, 152, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[167768, 4691, 269, 5, 62, "Subsection"],
Cell[CellGroupData[{
Cell[168062, 4700, 2463, 70, 272, "Input"],
Cell[170528, 4772, 249, 4, 30, "Output"],
Cell[170780, 4778, 243, 4, 30, "Output"],
Cell[171026, 4784, 299, 7, 30, "Output"],
Cell[171328, 4793, 240, 4, 30, "Output"],
Cell[171571, 4799, 242, 4, 30, "Output"],
Cell[171816, 4805, 243, 4, 30, "Output"],
Cell[172062, 4811, 300, 7, 30, "Output"],
Cell[172365, 4820, 242, 4, 30, "Output"],
Cell[172610, 4826, 246, 4, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[172905, 4836, 254, 5, 45, "Subsection"],
Cell[CellGroupData[{
Cell[173184, 4845, 6208, 151, 692, "Input"],
Cell[179395, 4998, 348, 7, 30, "Output"],
Cell[179746, 5007, 496, 13, 30, "Output"],
Cell[180245, 5022, 347, 7, 30, "Output"],
Cell[180595, 5031, 496, 13, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[181140, 5050, 236, 5, 45, "Subsection"],
Cell[CellGroupData[{
Cell[181401, 5059, 5519, 140, 652, "Input"],
Cell[186923, 5201, 723, 14, 56, "Message"],
Cell[187649, 5217, 725, 14, 56, "Message"],
Cell[188377, 5233, 714, 13, 56, "Message"],
Cell[189094, 5248, 643, 11, 39, "Message"],
Cell[189740, 5261, 822, 14, 90, "Message"],
Cell[190565, 5277, 373, 8, 30, "Output"],
Cell[190941, 5287, 467, 11, 30, "Output"],
Cell[191411, 5300, 714, 13, 56, "Message"],
Cell[192128, 5315, 715, 13, 56, "Message"],
Cell[192846, 5330, 722, 14, 56, "Message"],
Cell[193571, 5346, 644, 11, 39, "Message"],
Cell[194218, 5359, 822, 14, 90, "Message"],
Cell[195043, 5375, 374, 8, 30, "Output"],
Cell[195420, 5385, 468, 11, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[195937, 5402, 240, 5, 45, "Subsection"],
Cell[CellGroupData[{
Cell[196202, 5411, 4245, 109, 492, "Input"],
Cell[200450, 5522, 274, 5, 30, "Output"],
Cell[200727, 5529, 464, 13, 30, "Output"],
Cell[201194, 5544, 276, 5, 30, "Output"],
Cell[201473, 5551, 382, 9, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[201904, 5566, 187, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[202116, 5574, 7007, 179, 772, "Input"],
Cell[209126, 5755, 256, 5, 30, "Output"],
Cell[209385, 5762, 444, 13, 30, "Output"],
Cell[209832, 5777, 256, 5, 30, "Output"],
Cell[210091, 5784, 359, 9, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[210499, 5799, 192, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[210716, 5807, 5455, 140, 632, "Input"],
Cell[216174, 5949, 230, 4, 30, "Output"],
Cell[216407, 5955, 425, 12, 30, "Output"],
Cell[216835, 5969, 232, 4, 30, "Output"],
Cell[217070, 5975, 382, 10, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[217501, 5991, 178, 3, 45, "Subsection"],
Cell[CellGroupData[{
Cell[217704, 5998, 6020, 147, 692, "Input"],
Cell[223727, 6147, 387, 13, 30, "Output"]
}, Open  ]],
Cell[224129, 6163, 5927, 145, 692, "Input"],
Cell[230059, 6310, 6656, 166, 772, "Input"],
Cell[236718, 6478, 6099, 148, 692, "Input"],
Cell[242820, 6628, 4999, 119, 552, "Input"],
Cell[247822, 6749, 5716, 139, 632, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[253575, 6893, 191, 4, 28, "Subsection"],
Cell[CellGroupData[{
Cell[253791, 6901, 2085, 53, 272, "Input"],
Cell[255879, 6956, 29191, 970, 1950, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[285107, 7931, 1666, 47, 232, "Input"],
Cell[286776, 7980, 29214, 970, 1950, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[316039, 8956, 182, 4, 28, "Subsection"],
Cell[CellGroupData[{
Cell[316246, 8964, 969, 20, 92, "Input"],
Cell[317218, 8986, 10758, 353, 677, "Output"]
}, Open  ]],
Cell[327991, 9342, 856, 18, 112, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[328884, 9365, 103, 2, 28, "Subsection"],
Cell[328990, 9369, 782, 21, 92, "Input"],
Cell[CellGroupData[{
Cell[329797, 9394, 811, 21, 72, "Input"],
Cell[330611, 9417, 663, 12, 56, "Message"],
Cell[331277, 9431, 663, 12, 56, "Message"],
Cell[331943, 9445, 664, 12, 56, "Message"],
Cell[332610, 9459, 627, 11, 21, "Message"],
Cell[333240, 9472, 10802, 356, 677, "Output"]
}, Open  ]],
Cell[344057, 9831, 904, 22, 92, "Input"],
Cell[344964, 9855, 866, 22, 72, "Input"],
Cell[CellGroupData[{
Cell[345855, 9881, 400, 10, 52, "Input"],
Cell[346258, 9893, 7756, 243, 639, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[354063, 10142, 229, 5, 45, "Subsection"],
Cell[CellGroupData[{
Cell[354317, 10151, 221, 4, 31, "Input"],
Cell[354541, 10157, 44854, 1320, 2577, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[399444, 11483, 222, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[399691, 11491, 1241, 27, 152, "Input"],
Cell[400935, 11520, 351, 11, 30, "Output"],
Cell[401289, 11533, 11224, 362, 829, "Output"],
Cell[412516, 11897, 272, 7, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[412825, 11909, 898, 23, 112, "Input"],
Cell[413726, 11934, 17061, 496, 867, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[430836, 12436, 188, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[431049, 12444, 2934, 74, 361, "Input"],
Cell[433986, 12520, 216, 6, 30, "Output"],
Cell[434205, 12528, 313, 9, 30, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
