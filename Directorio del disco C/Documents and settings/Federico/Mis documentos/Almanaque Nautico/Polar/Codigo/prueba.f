      PROGRAM PRUEBA
        IMPLICIT NONE
        CHARACTER*4 can
        CHARACTER*98 u(0:52)
	  INTEGER ano, j, k, m, dT
        REAL*8 DIAJUL, dj, al(13), de(13), deg, a0, d0, cd, ha, t
        REAL*8 pa, pd, pap, pdp, ppi, pvr, h(0:6), co(2:14)
        REAL*8 sol(3), b_e(7), dpsi, deps, ct, pn(3,3)
        REAL*8 alt, sti2dia, TOCENT
        INTEGER agr, ami, dgr, dmi
        REAL*8 ase, dse
        DATA sti2dia/0.1157407407407407e-04/ ! 1/60/60/24
        DATA pa/0.662403647456573/ ! 9108.704(s) 1/60/60 (2 Pi)/24
        DATA pap/1.445496230912137D-03/ ! 19.877(s/SJ) 1/60/60 (2 Pi)/24
        DATA pd/1.55795225490400/ ! 321350.72(") 1/60/60 (2 Pi)/360
        DATA pdp/-7.369167952864947D-06/ ! -1.52("/SJ) 1/60/60 (2 Pi)/360
        DATA ppi/0./ ! 0.003(") 1/60/60 (2 Pi)/360
        DATA pvr/0./ ! -17.4(km/s) 60 60 24 36525/1.4959787066e+8
        DATA deg/0.174532925199433d-01/
        REAL*8 PI
        COMMON /pipi/ PI
        PI = 4.D0*ATAN(1.D0)
C --- Latitud por la polar
        WRITE(6,*) " introduzca a–o (XXXX)"
        READ(*,*) ano
        WRITE(can,'(I4)') ano
        WRITE(6,*) " introduzca ¶T = TT - UT"
        READ(*,*) dT
c --- c‡lculo de valores medios de (AR,¶)
        a0 = 0.
        d0 = 0.
        CALL ABRDE200(12) !# 12 == OBLIGATORIO
        DO k = 1, 13
          dj = DIAJUL(1,k,ano,0.)
          CALL BARNULEE(dj,dT,sol,b_e,dpsi,deps)
          ct = TOCENT(dj + dT*sti2dia) ! intervalo en centurias
          CALL PRENUT(ct,dpsi,deps,pn) ! Corregimos por precesi—n y nutaci—n
          al(k) = pa
          de(k) = pd
          CALL REDUESTR(al(k),de(k),pap,pdp,ppi,pvr,pn,b_e,sol,ct)
          ase = al(k)/deg
          agr = INT(ase)
          ase = 60.*(ase - agr)
          ami = INT(ase)
          ase = 60.*(ase - ami)
          dse = de(k)/deg
          dgr = INT(dse)
          dse = 60.*(dse - dgr)
          dmi = INT(dse)
          dse = 60.*(dse - dmi)
          write(*,'(1X,I2,1X,I3,1X,I2,1X,F5.2,1X,I2,1X,I2,1X,F5.2)') 
     &              k, agr, ami, ase, dgr, dmi, dse
          a0 = a0 + al(k)
          d0 = d0 + de(k)
        END DO
99      CALL CIERRADE(12) !# CLOSES u = 'JPLEPH'
        a0 = a0/13.
        d0 = d0/13.
        cd = PI/2. - d0
c --- c‡lculo de la TABLA I
        WRITE(6,*) ' TABLA I'        
    
	   
	  
	  DO k = 0, 26*2
          DO j = 0, 6
            h(j) = (0.5*k+26*j)*deg
            t = h(j) - a0
            co(j+2) = -cd*DCOS(t)*60./deg
          END DO
          WRITE(u(k),'(7(F6.1,F3.0,F5.1))') (h(j)/deg, SIGN(1.,co(j+2)),
     +    ABS(co(j+2)), j = 0, 6)

C	esto para que ponga el signo +    
		IF(u(k)(7:7).EQ.' ') u(k)(7:7)='+'
	    IF(u(k)(21:21).EQ.' ') u(k)(21:21)='+'
	    IF(u(k)(35:35).EQ.' ') u(k)(35:35)='+'
	    IF(u(k)(49:49).EQ.' ') u(k)(49:49)='+'
	    IF(u(k)(63:63).EQ.' ') u(k)(63:63)='+'
	    IF(u(k)(77:77).EQ.' ') u(k)(77:77)='+'
	    IF(u(k)(91:91).EQ.' ') u(k)(91:91)='+'

C	esto para que ponga no ponga signo si es 0.0    
		IF(u(k)(11:14).EQ.' 0.0') u(k)(7:7)=' '
	    IF(u(k)(25:28).EQ.' 0.0') u(k)(21:21)=' '
	    IF(u(k)(39:42).EQ.' 0.0') u(k)(35:35)=' '
	    IF(u(k)(53:56).EQ.' 0.0') u(k)(49:49)=' '
	    IF(u(k)(67:70).EQ.' 0.0') u(k)(63:63)=' '
	    IF(u(k)(81:84).EQ.' 0.0') u(k)(77:77)=' '
	    IF(u(k)(95:98).EQ.' 0.0') u(k)(91:91)=' '
        END DO
        	  




C	  OPEN(UNIT = 22, FILE = 'AN'//can//'382.DAT', STATUS ='UNKNOWN')
	  OPEN(UNIT = 22, FILE = '/Almanaque Nautico/DATOS/'//can//'/AN'
     +       //can//'382.DAT', STATUS ='UNKNOWN')
	   
	   DO k = 0, 52
           IF(MOD(k,2).EQ.0)THEN	       
	        WRITE(22,'(42(A))') u(k)(2:4),'&00&$',u(k)(7:7),'$&',
     +        u(k)(10:14),
     +        '&',u(k)(16:18),'&00&$',u(k)(21:21),'$&',u(k)(24:28),  
     +        '&',u(k)(30:32),'&00&$',u(k)(35:35),'$&',u(k)(38:42),  		   
     +        '&',u(k)(44:46),'&00&$',u(k)(49:49),'$&',u(k)(52:56),  	        
     +        '&',u(k)(58:60),'&00&$',u(k)(63:63),'$&',u(k)(66:70),  
     +        '&',u(k)(72:74),'&00&$',u(k)(77:77),'$&',u(k)(80:84),  
     +        '&',u(k)(86:88),'&00&$',u(k)(91:91),'$&',u(k)(94:98),
     +        '\\'
	     ELSE
	 	   IF(MOD(k,6).EQ.5)THEN
	        WRITE(22,'(42(A))') u(k)(2:4),'&30&$',u(k)(7:7),'$&',
     +        u(k)(10:14),
     +        '&',u(k)(16:18),'&30&$',u(k)(21:21),'$&',u(k)(24:28),  
     +        '&',u(k)(30:32),'&30&$',u(k)(35:35),'$&',u(k)(38:42),  		   
     +        '&',u(k)(44:46),'&30&$',u(k)(49:49),'$&',u(k)(52:56),  	        
     +        '&',u(k)(58:60),'&30&$',u(k)(63:63),'$&',u(k)(66:70),  
     +        '&',u(k)(72:74),'&30&$',u(k)(77:77),'$&',u(k)(80:84),  
     +        '&',u(k)(86:88),'&30&$',u(k)(91:91),'$&',u(k)(94:98),
     +        '\\[1ex]'	     
		   ELSE
	        WRITE(22,'(42(A))') u(k)(2:4),'&30&$',u(k)(7:7),'$&',
     +        u(k)(10:14),
     +        '&',u(k)(16:18),'&30&$',u(k)(21:21),'$&',u(k)(24:28),  
     +        '&',u(k)(30:32),'&30&$',u(k)(35:35),'$&',u(k)(38:42),  		   
     +        '&',u(k)(44:46),'&30&$',u(k)(49:49),'$&',u(k)(52:56),  	        
     +        '&',u(k)(58:60),'&30&$',u(k)(63:63),'$&',u(k)(66:70),  
     +        '&',u(k)(72:74),'&30&$',u(k)(77:77),'$&',u(k)(80:84),  
     +        '&',u(k)(86:88),'&30&$',u(k)(91:91),'$&',u(k)(94:98),
     +        '\\'	     
		   END IF
	     END IF
	   END DO

	  CLOSE(22)
	  

	  
        DO k = 182*2, 26*2 + 182*2
          m=k-364
		DO j = 0, 6
            h(j) = (0.5*k+26*j)*deg
            t = h(j) - a0
            co(j+2) = -cd*DCOS(t)*60./deg
          END DO
          WRITE(u(m),'(7(F6.1,F3.0,F5.1))') (h(j)/deg, SIGN(1.,co(j+2)),
     +    ABS(co(j+2)), j = 0, 6)
C	esto para que ponga el signo +    
		IF(u(m)(7:7).EQ.' ') u(m)(7:7)='+'
	    IF(u(m)(21:21).EQ.' ') u(m)(21:21)='+'
	    IF(u(m)(35:35).EQ.' ') u(m)(35:35)='+'
	    IF(u(m)(49:49).EQ.' ') u(m)(49:49)='+'
	    IF(u(m)(63:63).EQ.' ') u(m)(63:63)='+'
	    IF(u(m)(77:77).EQ.' ') u(m)(77:77)='+'
	    IF(u(m)(91:91).EQ.' ') u(m)(91:91)='+'

C	esto para que ponga no ponga signo si es 0.0    
		IF(u(m)(11:14).EQ.' 0.0') u(m)(7:7)=' '
	    IF(u(m)(25:28).EQ.' 0.0') u(m)(21:21)=' '
	    IF(u(m)(39:42).EQ.' 0.0') u(m)(35:35)=' '
	    IF(u(m)(53:56).EQ.' 0.0') u(m)(49:49)=' '
	    IF(u(m)(67:70).EQ.' 0.0') u(m)(63:63)=' '
	    IF(u(m)(81:84).EQ.' 0.0') u(m)(77:77)=' '
	    IF(u(m)(95:98).EQ.' 0.0') u(m)(91:91)=' '
C	esto para que no escriba más de 360    
		IF(m.GT.44) u(m)(85:98)='              '
        END DO



C       OPEN(UNIT = 22, FILE = 'AN'//can//'383.DAT', STATUS ='UNKNOWN')	  
        OPEN(UNIT = 22, FILE = '/Almanaque Nautico/DATOS/'//can//'/AN'
     +       //can//'383.DAT', STATUS ='UNKNOWN')
	   
	   DO k = 0, 44
           IF(MOD(k,2).EQ.0)THEN	       
	        WRITE(22,'(42(A))') u(k)(2:4),'&00&$',u(k)(7:7),'$&',
     +        u(k)(10:14),
     +        '&',u(k)(16:18),'&00&$',u(k)(21:21),'$&',u(k)(24:28),  
     +        '&',u(k)(30:32),'&00&$',u(k)(35:35),'$&',u(k)(38:42),  		   
     +        '&',u(k)(44:46),'&00&$',u(k)(49:49),'$&',u(k)(52:56),  	        
     +        '&',u(k)(58:60),'&00&$',u(k)(63:63),'$&',u(k)(66:70),  
     +        '&',u(k)(72:74),'&00&$',u(k)(77:77),'$&',u(k)(80:84),  
     +        '&',u(k)(86:88),'&00&$',u(k)(91:91),'$&',u(k)(94:98),
     +        '\\'
	     ELSE
	 	   IF(MOD(k,6).EQ.5)THEN
	        WRITE(22,'(42(A))') u(k)(2:4),'&30&$',u(k)(7:7),'$&',
     +        u(k)(10:14),
     +        '&',u(k)(16:18),'&30&$',u(k)(21:21),'$&',u(k)(24:28),  
     +        '&',u(k)(30:32),'&30&$',u(k)(35:35),'$&',u(k)(38:42),  		   
     +        '&',u(k)(44:46),'&30&$',u(k)(49:49),'$&',u(k)(52:56),  	        
     +        '&',u(k)(58:60),'&30&$',u(k)(63:63),'$&',u(k)(66:70),  
     +        '&',u(k)(72:74),'&30&$',u(k)(77:77),'$&',u(k)(80:84),  
     +        '&',u(k)(86:88),'&30&$',u(k)(91:91),'$&',u(k)(94:98),
     +        '\\[1ex]'	     
		   ELSE
	        WRITE(22,'(42(A))') u(k)(2:4),'&30&$',u(k)(7:7),'$&',
     +        u(k)(10:14),
     +        '&',u(k)(16:18),'&30&$',u(k)(21:21),'$&',u(k)(24:28),  
     +        '&',u(k)(30:32),'&30&$',u(k)(35:35),'$&',u(k)(38:42),  		   
     +        '&',u(k)(44:46),'&30&$',u(k)(49:49),'$&',u(k)(52:56),  	        
     +        '&',u(k)(58:60),'&30&$',u(k)(63:63),'$&',u(k)(66:70),  
     +        '&',u(k)(72:74),'&30&$',u(k)(77:77),'$&',u(k)(80:84),  
     +        '&',u(k)(86:88),'&30&$',u(k)(91:91),'$&',u(k)(94:98),
     +        '\\'	     
		   END IF
	     END IF
	   END DO

	   DO k = 45, 52
           IF(MOD(k,2).EQ.0)THEN	       
	        WRITE(22,'(42(A))') u(k)(2:4),'&00&$',u(k)(7:7),'$&',
     +        u(k)(10:14),
     +        '&',u(k)(16:18),'&00&$',u(k)(21:21),'$&',u(k)(24:28),  
     +        '&',u(k)(30:32),'&00&$',u(k)(35:35),'$&',u(k)(38:42),  		   
     +        '&',u(k)(44:46),'&00&$',u(k)(49:49),'$&',u(k)(52:56),  	        
     +        '&',u(k)(58:60),'&00&$',u(k)(63:63),'$&',u(k)(66:70),  
     +        '&',u(k)(72:74),'&00&$',u(k)(77:77),'$&',u(k)(80:84),  
     +        '&',u(k)(86:88),'&  & ',u(k)(91:91),' &',u(k)(94:98),
     +        '\\'
	     ELSE
	 	   IF(MOD(k,6).EQ.5)THEN
	        WRITE(22,'(42(A))') u(k)(2:4),'&30&$',u(k)(7:7),'$&',
     +        u(k)(10:14),
     +        '&',u(k)(16:18),'&30&$',u(k)(21:21),'$&',u(k)(24:28),  
     +        '&',u(k)(30:32),'&30&$',u(k)(35:35),'$&',u(k)(38:42),  		   
     +        '&',u(k)(44:46),'&30&$',u(k)(49:49),'$&',u(k)(52:56),  	        
     +        '&',u(k)(58:60),'&30&$',u(k)(63:63),'$&',u(k)(66:70),  
     +        '&',u(k)(72:74),'&30&$',u(k)(77:77),'$&',u(k)(80:84),  
     +        '&',u(k)(86:88),'&  & ',u(k)(91:91),' &',u(k)(94:98),
     +        '\\[1ex]'	     
		   ELSE
	        WRITE(22,'(42(A))') u(k)(2:4),'&30&$',u(k)(7:7),'$&',
     +        u(k)(10:14),
     +        '&',u(k)(16:18),'&30&$',u(k)(21:21),'$&',u(k)(24:28),  
     +        '&',u(k)(30:32),'&30&$',u(k)(35:35),'$&',u(k)(38:42),  		   
     +        '&',u(k)(44:46),'&30&$',u(k)(49:49),'$&',u(k)(52:56),  	        
     +        '&',u(k)(58:60),'&30&$',u(k)(63:63),'$&',u(k)(66:70),  
     +        '&',u(k)(72:74),'&30&$',u(k)(77:77),'$&',u(k)(80:84),  
     +        '&',u(k)(86:88),'&  & ',u(k)(91:91),' &',u(k)(94:98),
     +        '\\'	     
		   END IF
	     END IF
	   END DO

	  CLOSE(22)



	  

c --- c‡lculo de la TABLA II
        WRITE(6,*) ' TABLA II'
        
C	 OPEN(UNIT = 22, FILE = 'AN'//can//'384A.DAT', STATUS = 'UNKNOWN')
	 OPEN(UNIT = 22, FILE = '/Almanaque Nautico/DATOS/'//can//'/AN'
     +       //can//'384A.DAT', STATUS ='UNKNOWN')

        DO j = 0, 18
          ha = 20.*j*deg
          t = ha - a0
          DO k = 2, 14
                alt = 5.*k*deg
                co(k) = 0.5*cd**2*DSIN(t)**2*DTAN(alt)*60./deg
          END DO
          IF ((j.NE.0).AND.((MOD(j,5).EQ.0).or.(j.EQ.18)))THEN
		  WRITE(22,'(I3,A,F3.1,A,F3.1,A,F3.1,A,F3.1,A,F3.1,A,F3.1,
     +      A,F3.1,A,F3.1,A,F3.1,A,F3.1,A,F3.1,A,F3.1,A)')
     +      INT(ha/deg+0.5),'&',co(2),'&',co(3),'&', co(4),'&', co(5),
     +      '&', co(6),'&', co(7),'&', co(8),'&', co(9),'&', co(10),
     +      '&', co(11),'&', co(12), '&', co(13),'\\[2ex]'
	    ELSE
		  WRITE(22,'(I3,A,F3.1,A,F3.1,A,F3.1,A,F3.1,A,F3.1,A,F3.1,
     +      A,F3.1,A,F3.1,A,F3.1,A,F3.1,A,F3.1,A,F3.1,A)')
     +      INT(ha/deg+0.5),'&',co(2),'&',co(3),'&', co(4),'&', co(5),
     +      '&', co(6),'&', co(7),'&', co(8),'&', co(9),'&', co(10),
     +      '&', co(11),'&', co(12), '&', co(13),'\\'
	    ENDIF
        END DO
        CLOSE(22)



c --- c‡lculo de la TABLA III
        WRITE(6,*) ' TABLA III'                

	  DO j = 0, 18
          ha = 20.*j*deg
          t = ha - a0
          DO k = 1, 13
            co(k+1) = ((de(k)-d0)*DCOS(t) - cd*DSIN(al(k)-a0)*DSIN(t)
     &                )*60./deg
          END DO          
		WRITE(u(j),'(I3,13F6.1)') INT(ha/deg+0.5), co
	    IF((u(j)(6:6).NE.'-').AND.(u(j)(7:9).NE.'0.0')) u(j)(6:6)='+'
          IF((u(j)(12:12).NE.'-').AND.(u(j)(13:15).NE.'0.0')) 
     +    u(j)(12:12)='+'
          IF((u(j)(18:18).NE.'-').AND.(u(j)(19:21).NE.'0.0'))
     +    u(j)(18:18)='+'
          IF((u(j)(24:24).NE.'-').AND.(u(j)(25:27).NE.'0.0')) 
     +    u(j)(24:24)='+'
          IF((u(j)(30:30).NE.'-').AND.(u(j)(31:33).NE.'0.0'))
     +    u(j)(30:30)='+'
          IF((u(j)(36:36).NE.'-').AND.(u(j)(37:39).NE.'0.0'))
     +    u(j)(36:36)='+'
          IF((u(j)(42:42).NE.'-').AND.(u(j)(43:45).NE.'0.0')) 
     +    u(j)(42:42)='+'
          IF((u(j)(48:48).NE.'-').AND.(u(j)(49:51).NE.'0.0')) 
     +    u(j)(48:48)='+'
          IF((u(j)(54:54).NE.'-').AND.(u(j)(55:57).NE.'0.0')) 
     +    u(j)(54:54)='+'
          IF((u(j)(60:60).NE.'-').AND.(u(j)(61:63).NE.'0.0')) 
     +    u(j)(60:60)='+'
          IF((u(j)(66:66).NE.'-').AND.(u(j)(67:69).NE.'0.0')) 
     +    u(j)(66:66)='+'
		IF((u(j)(72:72).NE.'-').AND.(u(j)(73:75).NE.'0.0')) 
     +    u(j)(72:72)='+'
		IF((u(j)(78:78).NE.'-').AND.(u(j)(79:81).NE.'0.0')) 
     +    u(j)(78:78)='+'
        END DO

C        OPEN(UNIT = 22,FILE='AN'//can//'384B.DAT',STATUS='UNKNOWN')
         OPEN(UNIT = 22,FILE = '/Almanaque Nautico/DATOS/'//can//'/AN'
     +       //can//'384B.DAT', STATUS ='UNKNOWN')

	  DO j = 0, 18  
	    IF((MOD(j,5).EQ.0).AND.(j.NE.0)) THEN
		 WRITE(22,'(54(A))') u(j)(1:3),'&$',u(j)(6:6),'$&',
     +     u(j)(7:9),'&$',u(j)(12:12),'$&',u(j)(13:15),'&$',
     +     u(j)(18:18),'$&',u(j)(19:21),'&$',u(j)(24:24),'$&',
     +     u(j)(25:27),'&$',u(j)(30:30),'$&',u(j)(31:33),'&$',
     +     u(j)(36:36),'$&',u(j)(37:39),'&$',u(j)(42:42),'$&',
     +     u(j)(43:45),'&$',u(j)(48:48),'$&',u(j)(49:51),'&$',
     +     u(j)(54:54),'$&',u(j)(55:57),'&$',u(j)(60:60),'$&',
     +     u(j)(61:63),'&$',u(j)(66:66),'$&',u(j)(67:69),'&$',
     +     u(j)(72:72),'$&',u(j)(73:75),'&$',u(j)(78:78),'$&',
     +     u(j)(79:81),'\\[2ex]'	   
		ELSE
		 WRITE(22,'(54(A))') u(j)(1:3),'&$',u(j)(6:6),'$&',
     +     u(j)(7:9),'&$',u(j)(12:12),'$&',u(j)(13:15),'&$',
     +     u(j)(18:18),'$&',u(j)(19:21),'&$',u(j)(24:24),'$&',
     +     u(j)(25:27),'&$',u(j)(30:30),'$&',u(j)(31:33),'&$',
     +     u(j)(36:36),'$&',u(j)(37:39),'&$',u(j)(42:42),'$&',
     +     u(j)(43:45),'&$',u(j)(48:48),'$&',u(j)(49:51),'&$',
     +     u(j)(54:54),'$&',u(j)(55:57),'&$',u(j)(60:60),'$&',
     +     u(j)(61:63),'&$',u(j)(66:66),'$&',u(j)(67:69),'&$',
     +     u(j)(72:72),'$&',u(j)(73:75),'&$',u(j)(78:78),'$&',
     +     u(j)(79:81),'\\'	  
	    END IF
        END DO
        CLOSE(22)


c --- c‡lculo de la AZIMUTES
        WRITE(6,*) ' AZIMUTES'        
        DO j = 0, 36
          ha = 10.*j*deg
          t = ha - a0
          DO k = 2, 14
            co(k) = DATAN(-DSIN(t)/DTAN(d0)/DCOS(5.*k*deg))/deg
          END DO
          WRITE(u(j),'(I3,13F6.1,I3)')INT(ha/deg+0.5),co,INT(ha/deg+0.5) 
	    IF((u(j)(6:6).NE.'-').AND.(u(j)(7:9).NE.'0.0')) u(j)(6:6)='+'
          IF((u(j)(12:12).NE.'-').AND.(u(j)(13:15).NE.'0.0')) 
     +    u(j)(12:12)='+'
          IF((u(j)(18:18).NE.'-').AND.(u(j)(19:21).NE.'0.0'))
     +    u(j)(18:18)='+'
          IF((u(j)(24:24).NE.'-').AND.(u(j)(25:27).NE.'0.0')) 
     +    u(j)(24:24)='+'
          IF((u(j)(30:30).NE.'-').AND.(u(j)(31:33).NE.'0.0'))
     +    u(j)(30:30)='+'
          IF((u(j)(36:36).NE.'-').AND.(u(j)(37:39).NE.'0.0'))
     +    u(j)(36:36)='+'
          IF((u(j)(42:42).NE.'-').AND.(u(j)(43:45).NE.'0.0')) 
     +    u(j)(42:42)='+'
          IF((u(j)(48:48).NE.'-').AND.(u(j)(49:51).NE.'0.0')) 
     +    u(j)(48:48)='+'
          IF((u(j)(54:54).NE.'-').AND.(u(j)(55:57).NE.'0.0')) 
     +    u(j)(54:54)='+'
          IF((u(j)(60:60).NE.'-').AND.(u(j)(61:63).NE.'0.0')) 
     +    u(j)(60:60)='+'
          IF((u(j)(66:66).NE.'-').AND.(u(j)(67:69).NE.'0.0')) 
     +    u(j)(66:66)='+'
		IF((u(j)(72:72).NE.'-').AND.(u(j)(73:75).NE.'0.0')) 
     +    u(j)(72:72)='+'
		IF((u(j)(78:78).NE.'-').AND.(u(j)(79:81).NE.'0.0')) 
     +    u(j)(78:78)='+'
        END DO
        
C	  OPEN(UNIT=22, FILE ='AN'//can//'385.DAT', STATUS='UNKNOWN')
	  OPEN(UNIT=22, FILE = '/Almanaque Nautico/DATOS/'//can//'/AN'
     +       //can//'385.DAT', STATUS ='UNKNOWN')
	  DO j = 0, 36  
	    IF(MOD(j,4).EQ.3) THEN
		 WRITE(22,'(53(A))') '\bf ',u(j)(1:3),'&$',u(j)(6:6),'$',
     +     u(j)(7:9),'&$',u(j)(12:12),'$',u(j)(13:15),'&$',
     +     u(j)(18:18),'$',u(j)(19:21),'&$',u(j)(24:24),'$',
     +     u(j)(25:27),'&$',u(j)(30:30),'$',u(j)(31:33),'&$',
     +     u(j)(36:36),'$',u(j)(37:39),'&$',u(j)(42:42),'$',
     +     u(j)(43:45),'&$',u(j)(48:48),'$',u(j)(49:51),'&$',
     +     u(j)(54:54),'$',u(j)(55:57),'&$',u(j)(60:60),'$',
     +     u(j)(61:63),'&$',u(j)(66:66),'$',u(j)(67:69),'&$',
     +     u(j)(72:72),'$',u(j)(73:75),'&\bf ',u(j)(82:84),'\\[2ex]'
    	   
		ELSE
		 WRITE(22,'(53(A))') '\bf ',u(j)(1:3),'&$',u(j)(6:6),'$',
     +     u(j)(7:9),'&$',u(j)(12:12),'$',u(j)(13:15),'&$',
     +     u(j)(18:18),'$',u(j)(19:21),'&$',u(j)(24:24),'$',
     +     u(j)(25:27),'&$',u(j)(30:30),'$',u(j)(31:33),'&$',
     +     u(j)(36:36),'$',u(j)(37:39),'&$',u(j)(42:42),'$',
     +     u(j)(43:45),'&$',u(j)(48:48),'$',u(j)(49:51),'&$',
     +     u(j)(54:54),'$',u(j)(55:57),'&$',u(j)(60:60),'$',
     +     u(j)(61:63),'&$',u(j)(66:66),'$',u(j)(67:69),'&$',
     +     u(j)(72:72),'$',u(j)(73:75),'&\bf ',u(j)(82:84),'\\'
    	  
	    END IF
        END DO
	  CLOSE(22)
        STOP
      END
