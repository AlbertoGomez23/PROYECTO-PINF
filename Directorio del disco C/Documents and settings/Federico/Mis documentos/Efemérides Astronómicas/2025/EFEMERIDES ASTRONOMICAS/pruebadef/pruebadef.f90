PROGRAM PRUEBA

IMPLICIT NONE

INTEGER IY, IM, ID

DOUBLE PRECISION TTA, TTB, UTA, UTB, XP, YP, RC2T (3,3), MJD, X1, Y1, Z1, X2, Y2, Z2, X1MOD, Y1MOD, Z1MOD, X2MOD, Y2MOD, Z2MOD, FD, J, IH

TTB = 0D0
UTB = 0D0


WRITE(*,*) 'Introduzca COORDENADA "X" EN MILISEGUNDOS DEL CIP'
READ (*,*) XP
WRITE(*,*) 'Introduzca COORDENADA "Y" EN MILISEGUNDOS DEL CIP'
READ (*,*) YP

XP = XP/(206265000D0)
YP = YP/(206265000D0)


OPEN(UNIT=8, FILE='a92052A_roa(2).TXT') 
OPEN(UNIT=9, FILE='a92052A_roa(2)mod.TXT', status='REPLACE')

DO

READ(8,*, END=10) MJD, X1, Y1, Z1, X2, Y2, Z2

!PRINT *, 'MJD=', MJD
!PRINT *, ''
!PRINT *, 'X1=', X1
!PRINT *, ''
!PRINT *, 'Y1=', Y1
!PRINT *, ''
!PRINT *, 'Z1=', Z1
!PRINT *, ''

TTA = MJD + 2451544.5007870D0
UTA = MJD + 2451544.5D0

CALL iau_JD2CAL(UTA, UTB, IY, IM, ID, FD, J)

IH = FD * 24D0

PRINT *, 'MES=', IM, 'DIA=', ID, 'HORA=', IH
PRINT *, ''

!PRINT *, TTA
!PRINT *, UTA

!TTA = 2457882.387D0
!UTA = 2457882.387D0



!PRINT *, 'UTA=', UTA
!PRINT *, 'TTA=', TTA
!PRINT *, 'TTB=', TTB
!PRINT *, 'UTA=', UTA
!PRINT *, 'UTB=', UTB

CALL iau_C2T06A(TTA, TTB, UTA, UTB, XP, YP, RC2T )

!PRINT *, 'RC2T=', RC2T
!PRINT *, ''
!PRINT *, 'RC2T(1,1)=', RC2T(1,1)
!PRINT *, '(1,2)=', RC2T(1,2)
!PRINT *, '(1,3)=', RC2T(1,3)
!PRINT *, '(2,1)=', RC2T(2,1)

X1MOD = RC2T(1,1) * X1 + RC2T(1,2) * Y1 + RC2T(1,3) * Z1
Y1MOD = RC2T(2,1) * X1 + RC2T(2,2) * Y1 + RC2T(2,3) * Z1
Z1MOD = RC2T(3,1) * X1 + RC2T(3,2) * Y1 + RC2T(3,3) * Z1

X2MOD = RC2T(1,1) * X2 + RC2T(1,2) * Y2 + RC2T(1,3) * Z2
Y2MOD = RC2T(2,1) * X2 + RC2T(2,2) * Y2 + RC2T(2,3) * Z2
Z2MOD = RC2T(3,1) * X2 + RC2T(3,2) * Y2 + RC2T(3,3) * Z2

!PRINT *, RC2T(1,1)*X1
!PRINT *, RC2T(2,1)*Y1
!PRINT *, RC2T(3,1)*Z1
!PRINT *, 'SOL1=', RC2T(1,1)*X1 + RC2T(2,1)*Y1 + RC2T(3,1)*Z1
!PRINT *, ''
!PRINT *, RC2T(1,1)*X1
!PRINT *, RC2T(1,2)*Y1
!PRINT *, RC2T(1,3)*Z1
!PRINT *, 'SOL2=', RC2T(1,1)*X1 + RC2T(1,2)*Y1 + RC2T(1,3)*Z1
!PRINT *, ''

WRITE(9,"(7F17.11)") MJD, X1MOD, Y1MOD, Z1MOD, X2MOD, Y2MOD, Z2MOD

!11 FORMTAT(MJD, 1X, X1MOD, 1X, Y1MOD, 1X, Z1MOD, 1X, X1MOD, 1X, Y2MOD, 1X, Z2MOD)

END DO

10 CONTINUE

END